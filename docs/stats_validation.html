<!DOCTYPE html>
<html lang="en-US" xml:lang="en-US">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 6 Statistical Analysis: Validation | SfM Processing Software Comparison</title>
  <meta name="description" content="Using the bookdown package to write a book of data exploration. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 6 Statistical Analysis: Validation | SfM Processing Software Comparison" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Using the bookdown package to write a book of data exploration. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 6 Statistical Analysis: Validation | SfM Processing Software Comparison" />
  
  <meta name="twitter:description" content="Using the bookdown package to write a book of data exploration. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="George Woolsey" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="field_valid.html"/>
<link rel="next" href="stats_detected.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />
<script src="libs/canopy ht. (m)_914fae-1/data_stars_canopyhtm849eca.txt"></script>
<script src="libs/joda-0.0.1/joda.js"></script>
<script src="libs/joda-0.0.1/addImageQuery-bindings.js"></script>
<script type="text/javascript">

// toggle visibility of R source blocks in R Markdown output
function toggle_R() {
  var x = document.getElementsByClassName('r');
  if (x.length == 0) return;
  function toggle_vis(o) {
    var d = o.style.display;
    o.style.display = (d == 'block' || d == '') ? 'none':'block';
  }

  for (i = 0; i < x.length; i++) {
    var y = x[i];
    if (y.tagName.toLowerCase() === 'pre') toggle_vis(y);
  }

    var elem = document.getElementById("myButton1");
    if (elem.value === "Hide Code") elem.value = "Show Code";
    else elem.value = "Hide Code";
}

document.write('<input onclick="toggle_R();" type="button" value="Hide Code" id="myButton1" style="position: absolute; top: 10%; right: 2%; z-index: 200"></input>')

</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="sfm_data.html"><a href="sfm_data.html"><i class="fa fa-check"></i><b>2</b> SfM Image Processing Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sfm_data.html"><a href="sfm_data.html#udp"><i class="fa fa-check"></i><b>2.1</b> User-Defined Parameters</a></li>
<li class="chapter" data-level="2.2" data-path="sfm_data.html"><a href="sfm_data.html#metashape-image-processing"><i class="fa fa-check"></i><b>2.2</b> Metashape Image Processing</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="sfm_data.html"><a href="sfm_data.html#metashape-report-pdf-data-extraction"><i class="fa fa-check"></i><b>2.2.1</b> Metashape Report PDF Data Extraction</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sfm_data.html"><a href="sfm_data.html#metashape-report-data-exploration"><i class="fa fa-check"></i><b>2.3</b> Metashape Report Data Exploration</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="sfm_data.html"><a href="sfm_data.html#preliminaries"><i class="fa fa-check"></i><b>2.3.1</b> Preliminaries</a></li>
<li class="chapter" data-level="2.3.2" data-path="sfm_data.html"><a href="sfm_data.html#metashape-processing-time-summary"><i class="fa fa-check"></i><b>2.3.2</b> Metashape Processing Time Summary</a></li>
<li class="chapter" data-level="2.3.3" data-path="sfm_data.html"><a href="sfm_data.html#flight-and-sparse-cloud-metrics"><i class="fa fa-check"></i><b>2.3.3</b> Flight and Sparse Cloud Metrics</a></li>
<li class="chapter" data-level="2.3.4" data-path="sfm_data.html"><a href="sfm_data.html#metashape-dense-point-cloud-summary"><i class="fa fa-check"></i><b>2.3.4</b> Metashape Dense Point Cloud Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ptcld_analysis.html"><a href="ptcld_analysis.html"><i class="fa fa-check"></i><b>3</b> <strong>R</strong> Point Cloud Processing</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ptcld_analysis.html"><a href="ptcld_analysis.html#number-of-files-summary"><i class="fa fa-check"></i><b>3.1</b> Number of files summary</a></li>
<li class="chapter" data-level="3.2" data-path="ptcld_analysis.html"><a href="ptcld_analysis.html#processing-time-summary"><i class="fa fa-check"></i><b>3.2</b> Processing Time Summary</a></li>
<li class="chapter" data-level="3.3" data-path="ptcld_analysis.html"><a href="ptcld_analysis.html#processing-time-vs-points"><i class="fa fa-check"></i><b>3.3</b> Processing Time vs # Points</a></li>
<li class="chapter" data-level="3.4" data-path="ptcld_analysis.html"><a href="ptcld_analysis.html#processing-section-timing"><i class="fa fa-check"></i><b>3.4</b> Processing Section Timing</a></li>
<li class="chapter" data-level="3.5" data-path="ptcld_analysis.html"><a href="ptcld_analysis.html#summary-of-point-cloud-data"><i class="fa fa-check"></i><b>3.5</b> Summary of point cloud data</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="ptcld_analysis.html"><a href="ptcld_analysis.html#table"><i class="fa fa-check"></i><b>3.5.1</b> Table</a></li>
<li class="chapter" data-level="3.5.2" data-path="ptcld_analysis.html"><a href="ptcld_analysis.html#plot-summary"><i class="fa fa-check"></i><b>3.5.2</b> Plot summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="stats_processing_time.html"><a href="stats_processing_time.html"><i class="fa fa-check"></i><b>4</b> Statistical Analysis: Processing Time</a>
<ul>
<li class="chapter" data-level="4.1" data-path="stats_processing_time.html"><a href="stats_processing_time.html#one_pred_mod"><i class="fa fa-check"></i><b>4.1</b> One Nominal Predictor</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="stats_processing_time.html"><a href="stats_processing_time.html#summary-statistics"><i class="fa fa-check"></i><b>4.1.1</b> Summary Statistics</a></li>
<li class="chapter" data-level="4.1.2" data-path="stats_processing_time.html"><a href="stats_processing_time.html#linear-model"><i class="fa fa-check"></i><b>4.1.2</b> Linear Model</a></li>
<li class="chapter" data-level="4.1.3" data-path="stats_processing_time.html"><a href="stats_processing_time.html#anova"><i class="fa fa-check"></i><b>4.1.3</b> ANOVA</a></li>
<li class="chapter" data-level="4.1.4" data-path="stats_processing_time.html"><a href="stats_processing_time.html#one_pred_mod_bays"><i class="fa fa-check"></i><b>4.1.4</b> Bayesian</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="stats_processing_time.html"><a href="stats_processing_time.html#two_pred_mod"><i class="fa fa-check"></i><b>4.2</b> Two Nominal Predictors</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="stats_processing_time.html"><a href="stats_processing_time.html#summary-statistics-1"><i class="fa fa-check"></i><b>4.2.1</b> Summary Statistics</a></li>
<li class="chapter" data-level="4.2.2" data-path="stats_processing_time.html"><a href="stats_processing_time.html#linear-model-1"><i class="fa fa-check"></i><b>4.2.2</b> Linear Model</a></li>
<li class="chapter" data-level="4.2.3" data-path="stats_processing_time.html"><a href="stats_processing_time.html#anova-1"><i class="fa fa-check"></i><b>4.2.3</b> ANOVA</a></li>
<li class="chapter" data-level="4.2.4" data-path="stats_processing_time.html"><a href="stats_processing_time.html#two_pred_mod_bays"><i class="fa fa-check"></i><b>4.2.4</b> Bayesian</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="stats_processing_time.html"><a href="stats_processing_time.html#two-nominal-predictors-site-effects"><i class="fa fa-check"></i><b>4.3</b> Two Nominal Predictors + site effects</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="stats_processing_time.html"><a href="stats_processing_time.html#summary-statistics-2"><i class="fa fa-check"></i><b>4.3.1</b> Summary Statistics</a></li>
<li class="chapter" data-level="4.3.2" data-path="stats_processing_time.html"><a href="stats_processing_time.html#id_3_pred_mod_bays"><i class="fa fa-check"></i><b>4.3.2</b> Bayesian</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="stats_processing_time.html"><a href="stats_processing_time.html#gamma-two-nominal-predictors-site-effects"><i class="fa fa-check"></i><b>4.4</b> Gamma: Two Nominal Predictors + site effects</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="stats_processing_time.html"><a href="stats_processing_time.html#summary-statistics-3"><i class="fa fa-check"></i><b>4.4.1</b> Summary Statistics</a></li>
<li class="chapter" data-level="4.4.2" data-path="stats_processing_time.html"><a href="stats_processing_time.html#id_4_pred_mod_bays"><i class="fa fa-check"></i><b>4.4.2</b> Bayesian</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="field_valid.html"><a href="field_valid.html"><i class="fa fa-check"></i><b>5</b> Field Validation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="field_valid.html"><a href="field_valid.html#setup"><i class="fa fa-check"></i><b>5.1</b> Setup</a></li>
<li class="chapter" data-level="5.2" data-path="field_valid.html"><a href="field_valid.html#data-load-functions"><i class="fa fa-check"></i><b>5.2</b> Data Load Functions</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="field_valid.html"><a href="field_valid.html#summary-of-field-validation-plot-data"><i class="fa fa-check"></i><b>5.2.1</b> Summary of field validation plot data</a></li>
<li class="chapter" data-level="5.2.2" data-path="field_valid.html"><a href="field_valid.html#load-uas-data-function"><i class="fa fa-check"></i><b>5.2.2</b> Load UAS data function</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="field_valid.html"><a href="field_valid.html#validation-data-functions"><i class="fa fa-check"></i><b>5.3</b> Validation Data Functions</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="field_valid.html"><a href="field_valid.html#true-positive-identification"><i class="fa fa-check"></i><b>5.3.1</b> True Positive Identification</a></li>
<li class="chapter" data-level="5.3.2" data-path="field_valid.html"><a href="field_valid.html#combine-with-commission-and-omission"><i class="fa fa-check"></i><b>5.3.2</b> Combine with Commission and Omission</a></li>
<li class="chapter" data-level="5.3.3" data-path="field_valid.html"><a href="field_valid.html#full-validation-function"><i class="fa fa-check"></i><b>5.3.3</b> Full validation function</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="field_valid.html"><a href="field_valid.html#full-pipeline-function"><i class="fa fa-check"></i><b>5.4</b> Full pipeline function</a></li>
<li class="chapter" data-level="5.5" data-path="field_valid.html"><a href="field_valid.html#apply-validation-for-all"><i class="fa fa-check"></i><b>5.5</b> Apply validation for all</a></li>
<li class="chapter" data-level="5.6" data-path="field_valid.html"><a href="field_valid.html#full-validation-summary-data"><i class="fa fa-check"></i><b>5.6</b> Full Validation Summary Data</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="field_valid.html"><a href="field_valid.html#true-positive-commission-ommission"><i class="fa fa-check"></i><b>5.6.1</b> True Positive, Commission, Ommission</a></li>
<li class="chapter" data-level="5.6.2" data-path="field_valid.html"><a href="field_valid.html#f-score"><i class="fa fa-check"></i><b>5.6.2</b> F-score</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="field_valid.html"><a href="field_valid.html#valid_ex"><i class="fa fa-check"></i><b>5.7</b> Example Validation Process</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="field_valid.html"><a href="field_valid.html#data-load"><i class="fa fa-check"></i><b>5.7.1</b> Data Load</a></li>
<li class="chapter" data-level="5.7.2" data-path="field_valid.html"><a href="field_valid.html#orthomosaic-data"><i class="fa fa-check"></i><b>5.7.2</b> Orthomosaic Data</a></li>
<li class="chapter" data-level="5.7.3" data-path="field_valid.html"><a href="field_valid.html#field-data"><i class="fa fa-check"></i><b>5.7.3</b> Field Data</a></li>
<li class="chapter" data-level="5.7.4" data-path="field_valid.html"><a href="field_valid.html#uas-data"><i class="fa fa-check"></i><b>5.7.4</b> UAS Data</a></li>
<li class="chapter" data-level="5.7.5" data-path="field_valid.html"><a href="field_valid.html#true-positives"><i class="fa fa-check"></i><b>5.7.5</b> True Positives</a></li>
<li class="chapter" data-level="5.7.6" data-path="field_valid.html"><a href="field_valid.html#field-uas-comparison"><i class="fa fa-check"></i><b>5.7.6</b> Field &amp; UAS Comparison</a></li>
<li class="chapter" data-level="5.7.7" data-path="field_valid.html"><a href="field_valid.html#combine-plots"><i class="fa fa-check"></i><b>5.7.7</b> Combine Plots</a></li>
<li class="chapter" data-level="5.7.8" data-path="field_valid.html"><a href="field_valid.html#height-vs.-dbh-of-tp-co-om"><i class="fa fa-check"></i><b>5.7.8</b> Height vs. DBH of <span class="math inline">\(Tp\)</span>, <span class="math inline">\(Co\)</span>, <span class="math inline">\(Om\)</span></a></li>
<li class="chapter" data-level="5.7.9" data-path="field_valid.html"><a href="field_valid.html#height-and-dbh-distribution-tp-co-om"><i class="fa fa-check"></i><b>5.7.9</b> Height and DBH Distribution <span class="math inline">\(Tp\)</span>, <span class="math inline">\(Co\)</span>, <span class="math inline">\(Om\)</span></a></li>
<li class="chapter" data-level="5.7.10" data-path="field_valid.html"><a href="field_valid.html#detected-overstory-tp-height-difference"><i class="fa fa-check"></i><b>5.7.10</b> Detected Overstory (<span class="math inline">\(TP\)</span>) Height Difference</a></li>
<li class="chapter" data-level="5.7.11" data-path="field_valid.html"><a href="field_valid.html#detected-overstory-tp-dbh-difference"><i class="fa fa-check"></i><b>5.7.11</b> Detected Overstory (<span class="math inline">\(TP\)</span>) DBH Difference</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="field_valid.html"><a href="field_valid.html#mapped-validation-for-all-sites"><i class="fa fa-check"></i><b>5.8</b> Mapped validation for all sites</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="field_valid.html"><a href="field_valid.html#plotting-function"><i class="fa fa-check"></i><b>5.8.1</b> Plotting Function</a></li>
<li class="chapter" data-level="5.8.2" data-path="field_valid.html"><a href="field_valid.html#validation-maps"><i class="fa fa-check"></i><b>5.8.2</b> Validation Maps</a></li>
<li class="chapter" data-level="5.8.3" data-path="field_valid.html"><a href="field_valid.html#validation-maps-combined"><i class="fa fa-check"></i><b>5.8.3</b> Validation Maps Combined</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="field_valid.html"><a href="field_valid.html#field-data-descriptive-statistics"><i class="fa fa-check"></i><b>5.9</b> Field Data Descriptive Statistics</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="field_valid.html"><a href="field_valid.html#table-of-height-summary-statistics"><i class="fa fa-check"></i><b>5.9.1</b> Table of Height Summary Statistics</a></li>
<li class="chapter" data-level="5.9.2" data-path="field_valid.html"><a href="field_valid.html#table-of-dbh-summary-statistics"><i class="fa fa-check"></i><b>5.9.2</b> Table of DBH Summary Statistics</a></li>
<li class="chapter" data-level="5.9.3" data-path="field_valid.html"><a href="field_valid.html#height-and-dbh-distribution"><i class="fa fa-check"></i><b>5.9.3</b> Height and DBH Distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="stats_validation.html"><a href="stats_validation.html"><i class="fa fa-check"></i><b>6</b> Statistical Analysis: Validation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="stats_validation.html"><a href="stats_validation.html#setup-1"><i class="fa fa-check"></i><b>6.1</b> Setup</a></li>
<li class="chapter" data-level="6.2" data-path="stats_validation.html"><a href="stats_validation.html#summary-statistics-4"><i class="fa fa-check"></i><b>6.2</b> Summary Statistics</a></li>
<li class="chapter" data-level="6.3" data-path="stats_validation.html"><a href="stats_validation.html#f_one_pred_mod"><i class="fa fa-check"></i><b>6.3</b> One Nominal Predictor</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="stats_validation.html"><a href="stats_validation.html#summary-statistics-5"><i class="fa fa-check"></i><b>6.3.1</b> Summary Statistics</a></li>
<li class="chapter" data-level="6.3.2" data-path="stats_validation.html"><a href="stats_validation.html#f_one_pred_mod_bays"><i class="fa fa-check"></i><b>6.3.2</b> Bayesian</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="stats_validation.html"><a href="stats_validation.html#f_two_pred_mod"><i class="fa fa-check"></i><b>6.4</b> Two Nominal Predictors</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="stats_validation.html"><a href="stats_validation.html#summary-statistics-6"><i class="fa fa-check"></i><b>6.4.1</b> Summary Statistics</a></li>
<li class="chapter" data-level="6.4.2" data-path="stats_validation.html"><a href="stats_validation.html#f_two_pred_mod_bays"><i class="fa fa-check"></i><b>6.4.2</b> Bayesian</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="stats_validation.html"><a href="stats_validation.html#f_three_pred_mod"><i class="fa fa-check"></i><b>6.5</b> Three Nominal Predictors</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="stats_validation.html"><a href="stats_validation.html#summary-statistics-7"><i class="fa fa-check"></i><b>6.5.1</b> Summary Statistics</a></li>
<li class="chapter" data-level="6.5.2" data-path="stats_validation.html"><a href="stats_validation.html#f_three_pred_mod_bays"><i class="fa fa-check"></i><b>6.5.2</b> Bayesian</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="stats_validation.html"><a href="stats_validation.html#three-nominal-predictors-site-effects"><i class="fa fa-check"></i><b>6.6</b> Three Nominal Predictors + site effects</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="stats_validation.html"><a href="stats_validation.html#summary-statistics-8"><i class="fa fa-check"></i><b>6.6.1</b> Summary Statistics</a></li>
<li class="chapter" data-level="6.6.2" data-path="stats_validation.html"><a href="stats_validation.html#f_4_pred_mod_bays"><i class="fa fa-check"></i><b>6.6.2</b> Bayesian</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="stats_validation.html"><a href="stats_validation.html#beta_mod"><i class="fa fa-check"></i><b>6.7</b> The beta: Three Nominal Predictors + site effects</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="stats_validation.html"><a href="stats_validation.html#summary-statistics-9"><i class="fa fa-check"></i><b>6.7.1</b> Summary Statistics</a></li>
<li class="chapter" data-level="6.7.2" data-path="stats_validation.html"><a href="stats_validation.html#f_5_pred_mod_bays"><i class="fa fa-check"></i><b>6.7.2</b> Bayesian</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="stats_validation.html"><a href="stats_validation.html#heterogeneous-variances-and-robustness-against-outliers"><i class="fa fa-check"></i><b>6.8</b> Heterogeneous variances and robustness against outliers</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="stats_validation.html"><a href="stats_validation.html#f_5_5_pred_mod_bays"><i class="fa fa-check"></i><b>6.8.1</b> Bayesian</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="stats_validation.html"><a href="stats_validation.html#overstory-and-understory-validation"><i class="fa fa-check"></i><b>6.9</b> Overstory and Understory Validation</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="stats_validation.html"><a href="stats_validation.html#summary-statistics-10"><i class="fa fa-check"></i><b>6.9.1</b> Summary Statistics</a></li>
<li class="chapter" data-level="6.9.2" data-path="stats_validation.html"><a href="stats_validation.html#f_6_pred_mod_bays"><i class="fa fa-check"></i><b>6.9.2</b> Bayesian</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="stats_detected.html"><a href="stats_detected.html"><i class="fa fa-check"></i><b>7</b> Statistical Analysis: Detected Tree Reliability</a>
<ul>
<li class="chapter" data-level="7.1" data-path="stats_detected.html"><a href="stats_detected.html#model-definition"><i class="fa fa-check"></i><b>7.1</b> Model Definition</a></li>
<li class="chapter" data-level="7.2" data-path="stats_detected.html"><a href="stats_detected.html#setup-2"><i class="fa fa-check"></i><b>7.2</b> Setup</a></li>
<li class="chapter" data-level="7.3" data-path="stats_detected.html"><a href="stats_detected.html#tree-height"><i class="fa fa-check"></i><b>7.3</b> Tree Height</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="stats_detected.html"><a href="stats_detected.html#summary-statistics-11"><i class="fa fa-check"></i><b>7.3.1</b> Summary Statistics</a></li>
<li class="chapter" data-level="7.3.2" data-path="stats_detected.html"><a href="stats_detected.html#model-height-mean-error-bias"><i class="fa fa-check"></i><b>7.3.2</b> Model: Height Mean Error (bias)</a></li>
<li class="chapter" data-level="7.3.3" data-path="stats_detected.html"><a href="stats_detected.html#model-height-rmse-precision"><i class="fa fa-check"></i><b>7.3.3</b> Model: Height RMSE (precision)</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="stats_detected.html"><a href="stats_detected.html#tree-dbh"><i class="fa fa-check"></i><b>7.4</b> Tree DBH</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="stats_detected.html"><a href="stats_detected.html#summary-statistics-12"><i class="fa fa-check"></i><b>7.4.1</b> Summary Statistics</a></li>
<li class="chapter" data-level="7.4.2" data-path="stats_detected.html"><a href="stats_detected.html#model-dbh-mean-error-bias"><i class="fa fa-check"></i><b>7.4.2</b> Model: DBH Mean Error (bias)</a></li>
<li class="chapter" data-level="7.4.3" data-path="stats_detected.html"><a href="stats_detected.html#model-dbh-rmse-precision"><i class="fa fa-check"></i><b>7.4.3</b> Model: DBH RMSE (precision)</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="stats_detected.html"><a href="stats_detected.html#posterior-predictive-checks-1"><i class="fa fa-check"></i><b>7.5</b> Posterior Predictive Checks</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="stats_detected.html"><a href="stats_detected.html#trace-plots"><i class="fa fa-check"></i><b>7.5.1</b> Trace-plots</a></li>
<li class="chapter" data-level="7.5.2" data-path="stats_detected.html"><a href="stats_detected.html#hatr-values"><i class="fa fa-check"></i><b>7.5.2</b> <span class="math inline">\(\hat{R}\)</span> values</a></li>
<li class="chapter" data-level="7.5.3" data-path="stats_detected.html"><a href="stats_detected.html#mean-and-sd"><i class="fa fa-check"></i><b>7.5.3</b> Mean and SD</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">SfM Processing Software Comparison</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="stats_validation" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Section 6</span> Statistical Analysis: Validation<a href="stats_validation.html#stats_validation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this section, we’ll evaluate the influence of the processing parameters on UAS-derived tree detection and monitoring.</p>
<p>The UAS and Field validation data was built and described in <a href="field_valid.html#field_valid">this section</a>.</p>
<p>The objective of this study is to determine the influence of different structure from motion (SfM) software (e.g. Agisoft Metashap, OpenDroneMap, Pix4D) and processing parameters on F-score which is a measure of overall tree detection performance.</p>
<p>All of the predictor variables of interest in this study are categorical (a.k.a. factor or nominal) while the predicted variables are metric and include F-score (ranges from 0-1) and error (e.g. MAPE, RMSE). This type of statistical analysis is described in the second edition of Kruschke’s <a href="https://sites.google.com/site/doingbayesiandataanalysis/"><em>Doing Bayesian data analysis</em> (2015)</a> and here we will build a Bayesian approach based on <a href="https://sites.google.com/site/doingbayesiandataanalysis/">Kruschke (2015)</a>. This analysis was greatly enhanced by <a href="https://solomonkurz.netlify.app/book/">A. Solomon Kurz’s ebook supplement</a> to <a href="https://sites.google.com/site/doingbayesiandataanalysis/">Kruschke (2015)</a>.</p>
<p>For a more in-depth review of the traditional treatment of this sort of data structure called multifactor analysis of variance (ANOVA) compared to the Bayesian hierarchical generalization of the traditional ANOVA model used here see <a href="stats_processing_time.html#stats_processing_time">this previous section</a>.</p>
<div id="setup-1" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Setup<a href="stats_validation.html#setup-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>first we’re going to define a function to ingest a formula as text and separate it into multiple rows based on the number of characters for plotting</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="stats_validation.html#cb199-1" tabindex="-1"></a><span class="co"># function to pull the formula for labeling below</span></span>
<span id="cb199-2"><a href="stats_validation.html#cb199-2" tabindex="-1"></a>get_frmla_text <span class="ot">=</span> <span class="cf">function</span>(frmla_chr, <span class="at">split_chrs =</span> <span class="dv">100</span>){</span>
<span id="cb199-3"><a href="stats_validation.html#cb199-3" tabindex="-1"></a></span>
<span id="cb199-4"><a href="stats_validation.html#cb199-4" tabindex="-1"></a>  cumsum_group <span class="ot">=</span> <span class="cf">function</span>(x, threshold) {</span>
<span id="cb199-5"><a href="stats_validation.html#cb199-5" tabindex="-1"></a>    cumsum <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb199-6"><a href="stats_validation.html#cb199-6" tabindex="-1"></a>    group <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb199-7"><a href="stats_validation.html#cb199-7" tabindex="-1"></a>    result <span class="ot">=</span> <span class="fu">numeric</span>()</span>
<span id="cb199-8"><a href="stats_validation.html#cb199-8" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb199-9"><a href="stats_validation.html#cb199-9" tabindex="-1"></a>      cumsum <span class="ot">=</span> cumsum <span class="sc">+</span> x[i]</span>
<span id="cb199-10"><a href="stats_validation.html#cb199-10" tabindex="-1"></a>      <span class="cf">if</span> (cumsum <span class="sc">&gt;</span> threshold) {</span>
<span id="cb199-11"><a href="stats_validation.html#cb199-11" tabindex="-1"></a>        group <span class="ot">=</span> group <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb199-12"><a href="stats_validation.html#cb199-12" tabindex="-1"></a>        cumsum <span class="ot">=</span> x[i]</span>
<span id="cb199-13"><a href="stats_validation.html#cb199-13" tabindex="-1"></a>      }</span>
<span id="cb199-14"><a href="stats_validation.html#cb199-14" tabindex="-1"></a>      result <span class="ot">=</span> <span class="fu">c</span>(result, group)</span>
<span id="cb199-15"><a href="stats_validation.html#cb199-15" tabindex="-1"></a>    }</span>
<span id="cb199-16"><a href="stats_validation.html#cb199-16" tabindex="-1"></a>    <span class="fu">return</span> (result)</span>
<span id="cb199-17"><a href="stats_validation.html#cb199-17" tabindex="-1"></a>  }</span>
<span id="cb199-18"><a href="stats_validation.html#cb199-18" tabindex="-1"></a>  </span>
<span id="cb199-19"><a href="stats_validation.html#cb199-19" tabindex="-1"></a>  r <span class="ot">=</span> stringr<span class="sc">::</span><span class="fu">str_sub</span>(</span>
<span id="cb199-20"><a href="stats_validation.html#cb199-20" tabindex="-1"></a>    frmla_chr</span>
<span id="cb199-21"><a href="stats_validation.html#cb199-21" tabindex="-1"></a>    , <span class="co"># get the two column matrix of start end</span></span>
<span id="cb199-22"><a href="stats_validation.html#cb199-22" tabindex="-1"></a>      frmla_chr <span class="sc">%&gt;%</span> </span>
<span id="cb199-23"><a href="stats_validation.html#cb199-23" tabindex="-1"></a>        stringr<span class="sc">::</span><span class="fu">str_locate_all</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">+&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb199-24"><a href="stats_validation.html#cb199-24" tabindex="-1"></a>        .[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb199-25"><a href="stats_validation.html#cb199-25" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb199-26"><a href="stats_validation.html#cb199-26" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(start) <span class="sc">%&gt;%</span> </span>
<span id="cb199-27"><a href="stats_validation.html#cb199-27" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb199-28"><a href="stats_validation.html#cb199-28" tabindex="-1"></a>          <span class="at">len =</span> dplyr<span class="sc">::</span><span class="fu">coalesce</span>(start<span class="sc">-</span>dplyr<span class="sc">::</span><span class="fu">lag</span>(start),<span class="dv">0</span>)</span>
<span id="cb199-29"><a href="stats_validation.html#cb199-29" tabindex="-1"></a>          , <span class="at">ld =</span> dplyr<span class="sc">::</span><span class="fu">coalesce</span>(dplyr<span class="sc">::</span><span class="fu">lead</span>(start)<span class="sc">-</span><span class="dv">1</span>, stringr<span class="sc">::</span><span class="fu">str_length</span>(frmla_chr))</span>
<span id="cb199-30"><a href="stats_validation.html#cb199-30" tabindex="-1"></a>          , <span class="at">cum =</span> <span class="fu">cumsum_group</span>(len, split_chrs)</span>
<span id="cb199-31"><a href="stats_validation.html#cb199-31" tabindex="-1"></a>          , <span class="at">start =</span> <span class="fu">ifelse</span>(dplyr<span class="sc">::</span><span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>,<span class="dv">1</span>,start)</span>
<span id="cb199-32"><a href="stats_validation.html#cb199-32" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span> </span>
<span id="cb199-33"><a href="stats_validation.html#cb199-33" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">group_by</span>(cum) <span class="sc">%&gt;%</span> </span>
<span id="cb199-34"><a href="stats_validation.html#cb199-34" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">start =</span> <span class="fu">min</span>(start), <span class="at">end =</span> <span class="fu">max</span>(ld)) <span class="sc">%&gt;%</span> </span>
<span id="cb199-35"><a href="stats_validation.html#cb199-35" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb199-36"><a href="stats_validation.html#cb199-36" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>cum) <span class="sc">%&gt;%</span> </span>
<span id="cb199-37"><a href="stats_validation.html#cb199-37" tabindex="-1"></a>        <span class="fu">as.matrix</span>()</span>
<span id="cb199-38"><a href="stats_validation.html#cb199-38" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb199-39"><a href="stats_validation.html#cb199-39" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_squish</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb199-40"><a href="stats_validation.html#cb199-40" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="at">collapse =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb199-41"><a href="stats_validation.html#cb199-41" tabindex="-1"></a>  </span>
<span id="cb199-42"><a href="stats_validation.html#cb199-42" tabindex="-1"></a>  <span class="fu">return</span>(r)</span>
<span id="cb199-43"><a href="stats_validation.html#cb199-43" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="summary-statistics-4" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Summary Statistics<a href="stats_validation.html#summary-statistics-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>What is this data?</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="stats_validation.html#cb200-1" tabindex="-1"></a><span class="co"># load data if needed</span></span>
<span id="cb200-2"><a href="stats_validation.html#cb200-2" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">ls</span>()[<span class="fu">ls</span>() <span class="sc">%in%</span> <span class="st">&quot;ptcld_validation_data&quot;</span>] <span class="sc">%&gt;%</span> <span class="fu">length</span>()<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb200-3"><a href="stats_validation.html#cb200-3" tabindex="-1"></a> ptcld_validation_data <span class="ot">=</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;../data/ptcld_full_analysis_data.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb200-4"><a href="stats_validation.html#cb200-4" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb200-5"><a href="stats_validation.html#cb200-5" tabindex="-1"></a>      <span class="at">depth_maps_generation_quality =</span> <span class="fu">factor</span>(</span>
<span id="cb200-6"><a href="stats_validation.html#cb200-6" tabindex="-1"></a>          depth_maps_generation_quality <span class="sc">%&gt;%</span> </span>
<span id="cb200-7"><a href="stats_validation.html#cb200-7" tabindex="-1"></a>            <span class="fu">tolower</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb200-8"><a href="stats_validation.html#cb200-8" tabindex="-1"></a>            stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;ultrahigh&quot;</span>, <span class="st">&quot;ultra high&quot;</span>)</span>
<span id="cb200-9"><a href="stats_validation.html#cb200-9" tabindex="-1"></a>          , <span class="at">ordered =</span> <span class="cn">TRUE</span></span>
<span id="cb200-10"><a href="stats_validation.html#cb200-10" tabindex="-1"></a>          , <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb200-11"><a href="stats_validation.html#cb200-11" tabindex="-1"></a>            <span class="st">&quot;lowest&quot;</span></span>
<span id="cb200-12"><a href="stats_validation.html#cb200-12" tabindex="-1"></a>            , <span class="st">&quot;low&quot;</span></span>
<span id="cb200-13"><a href="stats_validation.html#cb200-13" tabindex="-1"></a>            , <span class="st">&quot;medium&quot;</span></span>
<span id="cb200-14"><a href="stats_validation.html#cb200-14" tabindex="-1"></a>            , <span class="st">&quot;high&quot;</span></span>
<span id="cb200-15"><a href="stats_validation.html#cb200-15" tabindex="-1"></a>            , <span class="st">&quot;ultra high&quot;</span></span>
<span id="cb200-16"><a href="stats_validation.html#cb200-16" tabindex="-1"></a>          )</span>
<span id="cb200-17"><a href="stats_validation.html#cb200-17" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>()</span>
<span id="cb200-18"><a href="stats_validation.html#cb200-18" tabindex="-1"></a>      , <span class="at">depth_maps_generation_filtering_mode =</span> <span class="fu">factor</span>(</span>
<span id="cb200-19"><a href="stats_validation.html#cb200-19" tabindex="-1"></a>          depth_maps_generation_filtering_mode <span class="sc">%&gt;%</span> <span class="fu">tolower</span>()</span>
<span id="cb200-20"><a href="stats_validation.html#cb200-20" tabindex="-1"></a>          , <span class="at">ordered =</span> <span class="cn">TRUE</span></span>
<span id="cb200-21"><a href="stats_validation.html#cb200-21" tabindex="-1"></a>          , <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb200-22"><a href="stats_validation.html#cb200-22" tabindex="-1"></a>            <span class="st">&quot;disabled&quot;</span></span>
<span id="cb200-23"><a href="stats_validation.html#cb200-23" tabindex="-1"></a>            , <span class="st">&quot;mild&quot;</span></span>
<span id="cb200-24"><a href="stats_validation.html#cb200-24" tabindex="-1"></a>            , <span class="st">&quot;moderate&quot;</span></span>
<span id="cb200-25"><a href="stats_validation.html#cb200-25" tabindex="-1"></a>            , <span class="st">&quot;aggressive&quot;</span></span>
<span id="cb200-26"><a href="stats_validation.html#cb200-26" tabindex="-1"></a>          )</span>
<span id="cb200-27"><a href="stats_validation.html#cb200-27" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>()</span>
<span id="cb200-28"><a href="stats_validation.html#cb200-28" tabindex="-1"></a>    )</span>
<span id="cb200-29"><a href="stats_validation.html#cb200-29" tabindex="-1"></a>}</span>
<span id="cb200-30"><a href="stats_validation.html#cb200-30" tabindex="-1"></a><span class="co"># replace 0 F-score with very small positive to run models</span></span>
<span id="cb200-31"><a href="stats_validation.html#cb200-31" tabindex="-1"></a>ptcld_validation_data <span class="ot">=</span> ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb200-32"><a href="stats_validation.html#cb200-32" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb200-33"><a href="stats_validation.html#cb200-33" tabindex="-1"></a>    <span class="at">.cols =</span> tidyselect<span class="sc">::</span><span class="fu">ends_with</span>(<span class="st">&quot;f_score&quot;</span>)</span>
<span id="cb200-34"><a href="stats_validation.html#cb200-34" tabindex="-1"></a>    , <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">ifelse</span>(.x<span class="sc">==</span><span class="dv">0</span>,<span class="fl">1e-4</span>,.x)</span>
<span id="cb200-35"><a href="stats_validation.html#cb200-35" tabindex="-1"></a>  ))</span>
<span id="cb200-36"><a href="stats_validation.html#cb200-36" tabindex="-1"></a><span class="co"># what is this data?</span></span>
<span id="cb200-37"><a href="stats_validation.html#cb200-37" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 260
## Columns: 89
## $ tracking_file_full_path              &lt;chr&gt; &quot;D:\\SfM_Software_Comparison\\Met…
## $ software                             &lt;chr&gt; &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;METASH…
## $ study_site                           &lt;chr&gt; &quot;KAIBAB_HIGH&quot;, &quot;KAIBAB_HIGH&quot;, &quot;KA…
## $ processing_attribute1                &lt;chr&gt; &quot;HIGH&quot;, &quot;HIGH&quot;, &quot;HIGH&quot;, &quot;HIGH&quot;, &quot;…
## $ processing_attribute2                &lt;chr&gt; &quot;AGGRESSIVE&quot;, &quot;DISABLED&quot;, &quot;MILD&quot;,…
## $ processing_attribute3                &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ file_name                            &lt;chr&gt; &quot;HIGH_AGGRESSIVE&quot;, &quot;HIGH_DISABLED…
## $ number_of_points                     &lt;int&gt; 52974294, 72549206, 69858217, 698…
## $ las_area_m2                          &lt;dbl&gt; 86661.27, 87175.42, 86404.78, 864…
## $ timer_tile_time_mins                 &lt;dbl&gt; 0.63600698, 2.49318542, 0.8413380…
## $ timer_class_dtm_norm_chm_time_mins   &lt;dbl&gt; 3.6559556, 5.3289152, 5.1638296, …
## $ timer_treels_time_mins               &lt;dbl&gt; 8.9065272, 19.2119663, 12.3391793…
## $ timer_itd_time_mins                  &lt;dbl&gt; 0.02202115, 0.02449968, 0.0379844…
## $ timer_competition_time_mins          &lt;dbl&gt; 0.10590740, 0.17865245, 0.1212486…
## $ timer_estdbh_time_mins               &lt;dbl&gt; 0.02290262, 0.02382533, 0.0219917…
## $ timer_silv_time_mins                 &lt;dbl&gt; 0.012565533, 0.015940932, 0.01503…
## $ timer_total_time_mins                &lt;dbl&gt; 13.361886, 27.276985, 18.540606, …
## $ sttng_input_las_dir                  &lt;chr&gt; &quot;D:/Metashape_Testing_2024&quot;, &quot;D:/…
## $ sttng_use_parallel_processing        &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE…
## $ sttng_desired_chm_res                &lt;dbl&gt; 0.25, 0.25, 0.25, 0.25, 0.25, 0.2…
## $ sttng_max_height_threshold_m         &lt;int&gt; 60, 60, 60, 60, 60, 60, 60, 60, 6…
## $ sttng_minimum_tree_height_m          &lt;int&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …
## $ sttng_dbh_max_size_m                 &lt;int&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …
## $ sttng_local_dbh_model                &lt;chr&gt; &quot;rf&quot;, &quot;rf&quot;, &quot;rf&quot;, &quot;rf&quot;, &quot;rf&quot;, &quot;rf…
## $ sttng_user_supplied_epsg             &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ sttng_accuracy_level                 &lt;int&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …
## $ sttng_pts_m2_for_triangulation       &lt;int&gt; 20, 20, 20, 20, 20, 20, 20, 20, 2…
## $ sttng_normalization_with             &lt;chr&gt; &quot;triangulation&quot;, &quot;triangulation&quot;,…
## $ sttng_competition_buffer_m           &lt;int&gt; 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, …
## $ depth_maps_generation_quality        &lt;ord&gt; high, high, high, high, low, low,…
## $ depth_maps_generation_filtering_mode &lt;ord&gt; aggressive, disabled, mild, moder…
## $ processed_data_dir                   &lt;chr&gt; &quot;D:/SfM_Software_Comparison/Metas…
## $ processing_id                        &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11…
## $ true_positive_n_trees                &lt;dbl&gt; 229, 261, 260, 234, 220, 175, 231…
## $ commission_n_trees                   &lt;dbl&gt; 173, 222, 213, 193, 148, 223, 163…
## $ omission_n_trees                     &lt;dbl&gt; 772, 740, 741, 767, 781, 826, 770…
## $ f_score                              &lt;dbl&gt; 0.3264433, 0.3517520, 0.3527815, …
## $ tree_height_m_me                     &lt;dbl&gt; 0.270336679, 0.283568790, 0.31223…
## $ tree_height_m_mpe                    &lt;dbl&gt; 0.002357383, 0.013286785, 0.01427…
## $ tree_height_m_mae                    &lt;dbl&gt; 0.7873610, 0.6886235, 0.6914983, …
## $ tree_height_m_mape                   &lt;dbl&gt; 0.06624939, 0.06903969, 0.0605504…
## $ tree_height_m_smape                  &lt;dbl&gt; 0.06776453, 0.06838733, 0.0604101…
## $ tree_height_m_mse                    &lt;dbl&gt; 0.9842433, 0.8507862, 0.8259923, …
## $ tree_height_m_rmse                   &lt;dbl&gt; 0.9920904, 0.9223807, 0.9088412, …
## $ dbh_cm_me                            &lt;dbl&gt; 9.1574422, 6.5724212, 8.4176764, …
## $ dbh_cm_mpe                           &lt;dbl&gt; 0.864045437, 0.815188062, 0.95647…
## $ dbh_cm_mae                           &lt;dbl&gt; 11.563377, 9.446345, 11.669532, 8…
## $ dbh_cm_mape                          &lt;dbl&gt; 0.9054747, 0.8694597, 1.0134134, …
## $ dbh_cm_smape                         &lt;dbl&gt; 0.4587661, 0.4675111, 0.5094006, …
## $ dbh_cm_mse                           &lt;dbl&gt; 168.76487, 113.76273, 165.36220, …
## $ dbh_cm_rmse                          &lt;dbl&gt; 12.990954, 10.665961, 12.859323, …
## $ overstory_commission_n_trees         &lt;dbl&gt; 141, 178, 178, 160, 95, 173, 120,…
## $ understory_commission_n_trees        &lt;dbl&gt; 32, 44, 35, 33, 53, 50, 43, 39, 1…
## $ overstory_omission_n_trees           &lt;dbl&gt; 558, 560, 545, 556, 554, 598, 545…
## $ understory_omission_n_trees          &lt;dbl&gt; 214, 180, 196, 211, 227, 228, 225…
## $ overstory_true_positive_n_trees      &lt;dbl&gt; 185, 183, 198, 187, 189, 145, 198…
## $ understory_true_positive_n_trees     &lt;dbl&gt; 44, 78, 62, 47, 31, 30, 33, 40, 2…
## $ overstory_f_score                    &lt;dbl&gt; 0.3461179, 0.3315217, 0.3538874, …
## $ understory_f_score                   &lt;dbl&gt; 0.2634731, 0.4105263, 0.3492958, …
## $ overstory_tree_height_m_me           &lt;dbl&gt; 0.41693172, 0.44114110, 0.4421674…
## $ understory_tree_height_m_me          &lt;dbl&gt; -0.34602886, -0.08612009, -0.1027…
## $ overstory_tree_height_m_mpe          &lt;dbl&gt; 0.020790675, 0.024558478, 0.02411…
## $ understory_tree_height_m_mpe         &lt;dbl&gt; -0.075146232, -0.013158341, -0.01…
## $ overstory_tree_height_m_mae          &lt;dbl&gt; 0.8201433, 0.7820879, 0.7770369, …
## $ understory_tree_height_m_mae         &lt;dbl&gt; 0.6495266, 0.4693415, 0.4183269, …
## $ overstory_tree_height_m_mape         &lt;dbl&gt; 0.04662933, 0.04863237, 0.0487081…
## $ understory_tree_height_m_mape        &lt;dbl&gt; 0.14874284, 0.11691842, 0.0983694…
## $ overstory_tree_height_m_smape        &lt;dbl&gt; 0.04589942, 0.04776615, 0.0479123…
## $ understory_tree_height_m_smape       &lt;dbl&gt; 0.15969736, 0.11676780, 0.1003222…
## $ overstory_tree_height_m_mse          &lt;dbl&gt; 1.0623763, 1.0055835, 0.9739823, …
## $ understory_tree_height_m_mse         &lt;dbl&gt; 0.6557300, 0.4876080, 0.3533791, …
## $ overstory_tree_height_m_rmse         &lt;dbl&gt; 1.0307164, 1.0027878, 0.9869054, …
## $ understory_tree_height_m_rmse        &lt;dbl&gt; 0.8097715, 0.6982893, 0.5944570, …
## $ overstory_dbh_cm_me                  &lt;dbl&gt; 7.14062864, 4.28291683, 5.9942336…
## $ understory_dbh_cm_me                 &lt;dbl&gt; 17.637226, 11.943951, 16.157058, …
## $ overstory_dbh_cm_mpe                 &lt;dbl&gt; 0.35616828, 0.28046688, 0.3848487…
## $ understory_dbh_cm_mpe                &lt;dbl&gt; 2.99943801, 2.06972621, 2.7820046…
## $ overstory_dbh_cm_mae                 &lt;dbl&gt; 10.118785, 8.381792, 10.264347, 8…
## $ understory_dbh_cm_mae                &lt;dbl&gt; 17.637226, 11.943951, 16.157058, …
## $ overstory_dbh_cm_mape                &lt;dbl&gt; 0.4074510, 0.3578707, 0.4596121, …
## $ understory_dbh_cm_mape               &lt;dbl&gt; 2.9994380, 2.0697262, 2.7820046, …
## $ overstory_dbh_cm_smape               &lt;dbl&gt; 0.3090883, 0.2850588, 0.3444494, …
## $ understory_dbh_cm_smape              &lt;dbl&gt; 1.0880930, 0.8955723, 1.0361800, …
## $ overstory_dbh_cm_mse                 &lt;dbl&gt; 133.06320, 98.05838, 132.81185, 9…
## $ understory_dbh_cm_mse                &lt;dbl&gt; 318.874161, 150.607541, 269.31332…
## $ overstory_dbh_cm_rmse                &lt;dbl&gt; 11.535303, 9.902443, 11.524402, 9…
## $ understory_dbh_cm_rmse               &lt;dbl&gt; 17.857048, 12.272226, 16.410768, …
## $ validation_file_full_path            &lt;chr&gt; &quot;D:/SfM_Software_Comparison/Metas…
## $ overstory_ht_m                       &lt;dbl&gt; 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, …</code></pre>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="stats_validation.html#cb202-1" tabindex="-1"></a><span class="co"># a row is unique by...</span></span>
<span id="cb202-2"><a href="stats_validation.html#cb202-2" tabindex="-1"></a><span class="fu">identical</span>(</span>
<span id="cb202-3"><a href="stats_validation.html#cb202-3" tabindex="-1"></a>  <span class="fu">nrow</span>(ptcld_validation_data)</span>
<span id="cb202-4"><a href="stats_validation.html#cb202-4" tabindex="-1"></a>  , ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb202-5"><a href="stats_validation.html#cb202-5" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(</span>
<span id="cb202-6"><a href="stats_validation.html#cb202-6" tabindex="-1"></a>      study_site, software</span>
<span id="cb202-7"><a href="stats_validation.html#cb202-7" tabindex="-1"></a>      , depth_maps_generation_quality</span>
<span id="cb202-8"><a href="stats_validation.html#cb202-8" tabindex="-1"></a>      , depth_maps_generation_filtering_mode</span>
<span id="cb202-9"><a href="stats_validation.html#cb202-9" tabindex="-1"></a>      , processing_attribute3 <span class="co"># need to align all by software so this will go away or be filled</span></span>
<span id="cb202-10"><a href="stats_validation.html#cb202-10" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb202-11"><a href="stats_validation.html#cb202-11" tabindex="-1"></a>    <span class="fu">nrow</span>()</span>
<span id="cb202-12"><a href="stats_validation.html#cb202-12" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Summary by metrics of interest</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="stats_validation.html#cb204-1" tabindex="-1"></a>sum_stats_dta <span class="ot">=</span> <span class="cf">function</span>(my_var){</span>
<span id="cb204-2"><a href="stats_validation.html#cb204-2" tabindex="-1"></a>  sum_fns <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb204-3"><a href="stats_validation.html#cb204-3" tabindex="-1"></a>    <span class="at">n =</span> <span class="sc">~</span><span class="fu">sum</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(.x), <span class="dv">0</span>, <span class="dv">1</span>))  </span>
<span id="cb204-4"><a href="stats_validation.html#cb204-4" tabindex="-1"></a>    , <span class="at">min =</span> <span class="sc">~</span><span class="fu">min</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb204-5"><a href="stats_validation.html#cb204-5" tabindex="-1"></a>    , <span class="at">max =</span> <span class="sc">~</span><span class="fu">max</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb204-6"><a href="stats_validation.html#cb204-6" tabindex="-1"></a>    , <span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb204-7"><a href="stats_validation.html#cb204-7" tabindex="-1"></a>    , <span class="at">median =</span> <span class="sc">~</span><span class="fu">median</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb204-8"><a href="stats_validation.html#cb204-8" tabindex="-1"></a>    , <span class="at">sd =</span> <span class="sc">~</span><span class="fu">sd</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb204-9"><a href="stats_validation.html#cb204-9" tabindex="-1"></a>  )</span>
<span id="cb204-10"><a href="stats_validation.html#cb204-10" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb204-11"><a href="stats_validation.html#cb204-11" tabindex="-1"></a>  (</span>
<span id="cb204-12"><a href="stats_validation.html#cb204-12" tabindex="-1"></a>    <span class="fu">ggplot</span>(</span>
<span id="cb204-13"><a href="stats_validation.html#cb204-13" tabindex="-1"></a>      <span class="at">data =</span> ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb204-14"><a href="stats_validation.html#cb204-14" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">group_by</span>(.data[[my_var]]) <span class="sc">%&gt;%</span></span>
<span id="cb204-15"><a href="stats_validation.html#cb204-15" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">m =</span> <span class="fu">median</span>(f_score))</span>
<span id="cb204-16"><a href="stats_validation.html#cb204-16" tabindex="-1"></a>      , <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb204-17"><a href="stats_validation.html#cb204-17" tabindex="-1"></a>        <span class="at">y =</span> .data[[my_var]]</span>
<span id="cb204-18"><a href="stats_validation.html#cb204-18" tabindex="-1"></a>        , <span class="at">x =</span> f_score, <span class="at">fill =</span> m)</span>
<span id="cb204-19"><a href="stats_validation.html#cb204-19" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb204-20"><a href="stats_validation.html#cb204-20" tabindex="-1"></a>      <span class="fu">geom_violin</span>(<span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb204-21"><a href="stats_validation.html#cb204-21" tabindex="-1"></a>      <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb204-22"><a href="stats_validation.html#cb204-22" tabindex="-1"></a>      <span class="fu">geom_rug</span>() <span class="sc">+</span></span>
<span id="cb204-23"><a href="stats_validation.html#cb204-23" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;mako&quot;</span>, <span class="at">begin =</span> <span class="fl">0.3</span>, <span class="at">end =</span> <span class="fl">0.9</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb204-24"><a href="stats_validation.html#cb204-24" tabindex="-1"></a>      <span class="fu">labs</span>(</span>
<span id="cb204-25"><a href="stats_validation.html#cb204-25" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb204-26"><a href="stats_validation.html#cb204-26" tabindex="-1"></a>        , <span class="at">y =</span> stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(my_var, <span class="at">pattern =</span> <span class="st">&quot;_&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb204-27"><a href="stats_validation.html#cb204-27" tabindex="-1"></a>        , <span class="at">subtitle =</span> stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(my_var, <span class="at">pattern =</span> <span class="st">&quot;_&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot; &quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb204-28"><a href="stats_validation.html#cb204-28" tabindex="-1"></a>          stringr<span class="sc">::</span><span class="fu">str_to_title</span>()</span>
<span id="cb204-29"><a href="stats_validation.html#cb204-29" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb204-30"><a href="stats_validation.html#cb204-30" tabindex="-1"></a>      <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb204-31"><a href="stats_validation.html#cb204-31" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb204-32"><a href="stats_validation.html#cb204-32" tabindex="-1"></a>  )</span>
<span id="cb204-33"><a href="stats_validation.html#cb204-33" tabindex="-1"></a>  <span class="co"># # summarize data</span></span>
<span id="cb204-34"><a href="stats_validation.html#cb204-34" tabindex="-1"></a>  <span class="co"># (</span></span>
<span id="cb204-35"><a href="stats_validation.html#cb204-35" tabindex="-1"></a>  <span class="co"># ptcld_validation_data %&gt;% </span></span>
<span id="cb204-36"><a href="stats_validation.html#cb204-36" tabindex="-1"></a>  <span class="co">#   dplyr::group_by(dplyr::across(dplyr::all_of(my_var))) %&gt;%</span></span>
<span id="cb204-37"><a href="stats_validation.html#cb204-37" tabindex="-1"></a>  <span class="co">#   dplyr::summarise(</span></span>
<span id="cb204-38"><a href="stats_validation.html#cb204-38" tabindex="-1"></a>  <span class="co">#     dplyr::across(f_score, sum_fns)</span></span>
<span id="cb204-39"><a href="stats_validation.html#cb204-39" tabindex="-1"></a>  <span class="co">#     , .groups = &#39;drop_last&#39;</span></span>
<span id="cb204-40"><a href="stats_validation.html#cb204-40" tabindex="-1"></a>  <span class="co">#   ) %&gt;% </span></span>
<span id="cb204-41"><a href="stats_validation.html#cb204-41" tabindex="-1"></a>  <span class="co">#   kableExtra::kbl() %&gt;% </span></span>
<span id="cb204-42"><a href="stats_validation.html#cb204-42" tabindex="-1"></a>  <span class="co">#   kableExtra::kable_styling()</span></span>
<span id="cb204-43"><a href="stats_validation.html#cb204-43" tabindex="-1"></a>  <span class="co"># )</span></span>
<span id="cb204-44"><a href="stats_validation.html#cb204-44" tabindex="-1"></a>}</span>
<span id="cb204-45"><a href="stats_validation.html#cb204-45" tabindex="-1"></a><span class="co"># sum_stats_dta(&quot;software&quot;)</span></span></code></pre></div>
<p>summarize for all variables of interest</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="stats_validation.html#cb205-1" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;software&quot;</span>, <span class="st">&quot;study_site&quot;</span></span>
<span id="cb205-2"><a href="stats_validation.html#cb205-2" tabindex="-1"></a>  , <span class="st">&quot;depth_maps_generation_quality&quot;</span></span>
<span id="cb205-3"><a href="stats_validation.html#cb205-3" tabindex="-1"></a>  , <span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span></span>
<span id="cb205-4"><a href="stats_validation.html#cb205-4" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb205-5"><a href="stats_validation.html#cb205-5" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(sum_stats_dta)</span></code></pre></div>
<pre><code>## [[1]]</code></pre>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-138-1.png" width="1008" /></p>
<pre><code>## 
## [[2]]</code></pre>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-138-2.png" width="1008" /></p>
<pre><code>## 
## [[3]]</code></pre>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-138-3.png" width="1008" /></p>
<pre><code>## 
## [[4]]</code></pre>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-138-4.png" width="1008" /></p>
</div>
<div id="f_one_pred_mod" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> One Nominal Predictor<a href="stats_validation.html#f_one_pred_mod" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’ll start by exploring the influence of the depth map generation quality parameter on the SfM-derived tree detection performance based on the F-score.</p>
<div id="summary-statistics-5" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Summary Statistics<a href="stats_validation.html#summary-statistics-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Summary statistics by group:</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="stats_validation.html#cb210-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb210-2"><a href="stats_validation.html#cb210-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb210-3"><a href="stats_validation.html#cb210-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb210-4"><a href="stats_validation.html#cb210-4" tabindex="-1"></a>    <span class="at">mean_f_score =</span> <span class="fu">mean</span>(f_score, <span class="at">na.rm =</span> T)</span>
<span id="cb210-5"><a href="stats_validation.html#cb210-5" tabindex="-1"></a>    <span class="co"># , med_f_score = median(f_score, na.rm = T)</span></span>
<span id="cb210-6"><a href="stats_validation.html#cb210-6" tabindex="-1"></a>    , <span class="at">sd_f_score =</span> <span class="fu">sd</span>(f_score, <span class="at">na.rm =</span> T)</span>
<span id="cb210-7"><a href="stats_validation.html#cb210-7" tabindex="-1"></a>    , <span class="at">n =</span> dplyr<span class="sc">::</span><span class="fu">n</span>()</span>
<span id="cb210-8"><a href="stats_validation.html#cb210-8" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb210-9"><a href="stats_validation.html#cb210-9" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">2</span>, <span class="at">caption =</span> <span class="st">&quot;summary statistics: F-score by dense cloud quality&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb210-10"><a href="stats_validation.html#cb210-10" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-139">Table 6.1: </span>summary statistics: F-score by dense cloud quality
</caption>
<thead>
<tr>
<th style="text-align:left;">
depth_maps_generation_quality
</th>
<th style="text-align:right;">
mean_f_score
</th>
<th style="text-align:right;">
sd_f_score
</th>
<th style="text-align:right;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
55
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
55
</td>
</tr>
<tr>
<td style="text-align:left;">
medium
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
55
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
55
</td>
</tr>
<tr>
<td style="text-align:left;">
lowest
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
40
</td>
</tr>
</tbody>
</table>
</div>
<div id="f_one_pred_mod_bays" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Bayesian<a href="stats_validation.html#f_one_pred_mod_bays" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://sites.google.com/site/doingbayesiandataanalysis/">Kruschke (2015)</a> notes:</p>
<blockquote>
<p>The terminology, “analysis of variance,” comes from a decomposition of overall data variance into within-group variance and between-group variance (Fisher, 1925). Algebraically, the sum of squared deviations of the scores from their overall mean equals the sum of squared deviations of the scores from their respective group means plus the sum of squared deviations of the group means from the overall mean. In other words, the total variance can be partitioned into within-group variance plus between-group variance. Because one definition of the word “analysis” is separation into constituent parts, the term ANOVA accurately describes the underlying algebra in the traditional methods. That algebraic relation is not used in the hierarchical Bayesian approach presented here. The Bayesian method can estimate component variances, however. Therefore, the Bayesian approach is not ANOVA, but is analogous to ANOVA. (p. 556)</p>
</blockquote>
<p>and see section 19 from <a href="https://bookdown.org/content/3686/metric-predicted-variable-with-one-nominal-predictor.html">Kurz’s ebook supplement</a></p>
<p>The metric predicted variable with one nominal predictor variable model has the form:</p>
<p><span class="math display">\[\begin{align*}
y_{i}  &amp;\sim {\sf Normal} \bigl(\mu_{i}, \sigma_{y} \bigr) \\
\mu_{i} &amp;= \beta_0 + \sum_{j=1}^{J} \beta_{1[j]} x_{1[j]} \bigl(i\bigr) \\
\beta_{0}  &amp;\sim {\sf Normal} (0,10) \\
\beta_{1[j]}  &amp;\sim {\sf Normal} (0,\sigma_{\beta_{1}}) \\
\sigma_{\beta_{1}} &amp;\sim {\sf uniform} (0,100) \\
\sigma_{y} &amp;\sim {\sf uniform} (0,100) \\
\end{align*}\]</span></p>
<p>, where <span class="math inline">\(j\)</span> is the depth map generation quality setting corresponding to observation <span class="math inline">\(i\)</span></p>
<p><em>to start, we’ll use the default <code>brms::brm</code> prior settings which may not match those described in the model specification above</em></p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="stats_validation.html#cb211-1" tabindex="-1"></a>brms_f_mod1 <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb211-2"><a href="stats_validation.html#cb211-2" tabindex="-1"></a>  <span class="at">formula =</span> f_score <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality)</span>
<span id="cb211-3"><a href="stats_validation.html#cb211-3" tabindex="-1"></a>  , <span class="at">data =</span> ptcld_validation_data</span>
<span id="cb211-4"><a href="stats_validation.html#cb211-4" tabindex="-1"></a>  , <span class="at">family =</span> brms<span class="sc">::</span><span class="fu">brmsfamily</span>(<span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>)</span>
<span id="cb211-5"><a href="stats_validation.html#cb211-5" tabindex="-1"></a>  , <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">warmup =</span> <span class="dv">2000</span>, <span class="at">chains =</span> <span class="dv">4</span></span>
<span id="cb211-6"><a href="stats_validation.html#cb211-6" tabindex="-1"></a>  , <span class="at">cores =</span> <span class="fu">round</span>(parallel<span class="sc">::</span><span class="fu">detectCores</span>()<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb211-7"><a href="stats_validation.html#cb211-7" tabindex="-1"></a>  , <span class="at">file =</span> <span class="fu">paste0</span>(rootdir, <span class="st">&quot;/fits/brms_f_mod1&quot;</span>)</span>
<span id="cb211-8"><a href="stats_validation.html#cb211-8" tabindex="-1"></a>)</span></code></pre></div>
<p>check the trace plots for problems with convergence of the Markov chains</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="stats_validation.html#cb212-1" tabindex="-1"></a><span class="fu">plot</span>(brms_f_mod1)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-141-1.png" width="1008" /></p>
<p>check the prior distributions</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="stats_validation.html#cb213-1" tabindex="-1"></a><span class="co"># check priors</span></span>
<span id="cb213-2"><a href="stats_validation.html#cb213-2" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">prior_summary</span>(brms_f_mod1) <span class="sc">%&gt;%</span> </span>
<span id="cb213-3"><a href="stats_validation.html#cb213-3" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb213-4"><a href="stats_validation.html#cb213-4" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
prior
</th>
<th style="text-align:left;">
class
</th>
<th style="text-align:left;">
coef
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
resp
</th>
<th style="text-align:left;">
dpar
</th>
<th style="text-align:left;">
nlpar
</th>
<th style="text-align:left;">
lb
</th>
<th style="text-align:left;">
ub
</th>
<th style="text-align:left;">
source
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
student_t(3, 0.4, 2.5)
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
student_t(3, 0, 2.5)
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_quality
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_quality
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
student_t(3, 0, 2.5)
</td>
<td style="text-align:left;">
sigma
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
</tbody>
</table>
<p>The <code>brms::brm</code> model summary</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="stats_validation.html#cb214-1" tabindex="-1"></a>brms_f_mod1 <span class="sc">%&gt;%</span> </span>
<span id="cb214-2"><a href="stats_validation.html#cb214-2" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">posterior_summary</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb214-3"><a href="stats_validation.html#cb214-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb214-4"><a href="stats_validation.html#cb214-4" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameter&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb214-5"><a href="stats_validation.html#cb214-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(tolower) <span class="sc">%&gt;%</span> </span>
<span id="cb214-6"><a href="stats_validation.html#cb214-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb214-7"><a href="stats_validation.html#cb214-7" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_starts</span>(parameter, <span class="st">&quot;b_&quot;</span>) </span>
<span id="cb214-8"><a href="stats_validation.html#cb214-8" tabindex="-1"></a>    <span class="sc">|</span> stringr<span class="sc">::</span><span class="fu">str_starts</span>(parameter, <span class="st">&quot;r_&quot;</span>) </span>
<span id="cb214-9"><a href="stats_validation.html#cb214-9" tabindex="-1"></a>    <span class="sc">|</span> parameter <span class="sc">==</span> <span class="st">&quot;sigma&quot;</span></span>
<span id="cb214-10"><a href="stats_validation.html#cb214-10" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb214-11"><a href="stats_validation.html#cb214-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb214-12"><a href="stats_validation.html#cb214-12" tabindex="-1"></a>    <span class="at">parameter =</span> parameter <span class="sc">%&gt;%</span> </span>
<span id="cb214-13"><a href="stats_validation.html#cb214-13" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(<span class="st">&quot;b_depth_maps_generation_quality&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb214-14"><a href="stats_validation.html#cb214-14" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(<span class="st">&quot;r_depth_maps_generation_quality&quot;</span>)</span>
<span id="cb214-15"><a href="stats_validation.html#cb214-15" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb214-16"><a href="stats_validation.html#cb214-16" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">2</span>, <span class="at">caption =</span> <span class="st">&quot;Bayesian one nominal predictor: F-score by dense cloud quality&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb214-17"><a href="stats_validation.html#cb214-17" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-143">Table 6.2: </span>Bayesian one nominal predictor: F-score by dense cloud quality
</caption>
<thead>
<tr>
<th style="text-align:left;">
parameter
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
est.error
</th>
<th style="text-align:right;">
q2.5
</th>
<th style="text-align:right;">
q97.5
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
b_Intercept
</td>
<td style="text-align:right;">
0.46
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.65
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;">
[ultra.high,Intercept]
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.29
</td>
</tr>
<tr>
<td style="text-align:left;">
[high,Intercept]
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;">
[medium,Intercept]
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.18
</td>
</tr>
<tr>
<td style="text-align:left;">
[low,Intercept]
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
<tr>
<td style="text-align:left;">
[lowest,Intercept]
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
-0.37
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
</tbody>
</table>
<p>With the <code>stats::coef</code> function, we can get the group-level summaries in a “non-deflection” metric. In the model, the group means represented by <span class="math inline">\(\beta_{1[j]}\)</span> are deflections from overall baseline, such that the deflections sum to zero (see <a href="https://sites.google.com/site/doingbayesiandataanalysis/">Kruschke (2015, p.554)</a>). Summaries of the group-specific deflections are available via the <code>brms::ranef</code> function.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="stats_validation.html#cb215-1" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">coef</span>(brms_f_mod1) <span class="sc">%&gt;%</span></span>
<span id="cb215-2"><a href="stats_validation.html#cb215-2" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb215-3"><a href="stats_validation.html#cb215-3" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;group&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb215-4"><a href="stats_validation.html#cb215-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(</span>
<span id="cb215-5"><a href="stats_validation.html#cb215-5" tabindex="-1"></a>    <span class="at">.cols =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="st">&quot;group&quot;</span>)</span>
<span id="cb215-6"><a href="stats_validation.html#cb215-6" tabindex="-1"></a>    , <span class="at">.fn =</span> <span class="sc">~</span> stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(.x, <span class="st">&quot;depth_maps_generation_quality.&quot;</span>)</span>
<span id="cb215-7"><a href="stats_validation.html#cb215-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb215-8"><a href="stats_validation.html#cb215-8" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">2</span>, <span class="at">caption =</span> <span class="st">&quot;brms::brm model: F-score by dense cloud quality&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb215-9"><a href="stats_validation.html#cb215-9" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-144">Table 6.3: </span>brms::brm model: F-score by dense cloud quality
</caption>
<thead>
<tr>
<th style="text-align:left;">
group
</th>
<th style="text-align:right;">
Estimate.Intercept
</th>
<th style="text-align:right;">
Est.Error.Intercept
</th>
<th style="text-align:right;">
Q2.5.Intercept
</th>
<th style="text-align:right;">
Q97.5.Intercept
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:right;">
0.57
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
0.62
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.48
</td>
<td style="text-align:right;">
0.59
</td>
</tr>
<tr>
<td style="text-align:left;">
medium
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
0.52
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.35
</td>
<td style="text-align:right;">
0.46
</td>
</tr>
<tr>
<td style="text-align:left;">
lowest
</td>
<td style="text-align:right;">
0.28
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
0.35
</td>
</tr>
</tbody>
</table>
<p>We can look at the model noise standard deviation <span class="math inline">\(\sigma_y\)</span></p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="stats_validation.html#cb216-1" tabindex="-1"></a><span class="co"># get formula</span></span>
<span id="cb216-2"><a href="stats_validation.html#cb216-2" tabindex="-1"></a>form_temp <span class="ot">=</span> brms_f_mod1<span class="sc">$</span>formula<span class="sc">$</span>formula[<span class="dv">3</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb216-3"><a href="stats_validation.html#cb216-3" tabindex="-1"></a>  <span class="fu">as.character</span>() <span class="sc">%&gt;%</span> <span class="fu">get_frmla_text</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb216-4"><a href="stats_validation.html#cb216-4" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_quality&quot;</span>, <span class="st">&quot;quality&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb216-5"><a href="stats_validation.html#cb216-5" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span>, <span class="st">&quot;filtering&quot;</span>)</span>
<span id="cb216-6"><a href="stats_validation.html#cb216-6" tabindex="-1"></a><span class="co"># extract the posterior draws</span></span>
<span id="cb216-7"><a href="stats_validation.html#cb216-7" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod1) <span class="sc">%&gt;%</span> </span>
<span id="cb216-8"><a href="stats_validation.html#cb216-8" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb216-9"><a href="stats_validation.html#cb216-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sigma, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb216-10"><a href="stats_validation.html#cb216-10" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_dotsinterval</span>(</span>
<span id="cb216-11"><a href="stats_validation.html#cb216-11" tabindex="-1"></a>    <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb216-12"><a href="stats_validation.html#cb216-12" tabindex="-1"></a>    , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.04</span></span>
<span id="cb216-13"><a href="stats_validation.html#cb216-13" tabindex="-1"></a>    , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_size =</span> <span class="dv">3</span></span>
<span id="cb216-14"><a href="stats_validation.html#cb216-14" tabindex="-1"></a>    , <span class="at">quantiles =</span> <span class="dv">100</span></span>
<span id="cb216-15"><a href="stats_validation.html#cb216-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb216-16"><a href="stats_validation.html#cb216-16" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb216-17"><a href="stats_validation.html#cb216-17" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb216-18"><a href="stats_validation.html#cb216-18" tabindex="-1"></a>    <span class="at">x =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">sigma_y$&quot;</span>)</span>
<span id="cb216-19"><a href="stats_validation.html#cb216-19" tabindex="-1"></a>    , <span class="at">caption =</span> form_temp</span>
<span id="cb216-20"><a href="stats_validation.html#cb216-20" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb216-21"><a href="stats_validation.html#cb216-21" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-145-1.png" width="1008" /></p>
<p>plot the posterior predictive distributions of the conditional means with the median F-score and the 95% highest posterior density interval (HDI)</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="stats_validation.html#cb217-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb217-2"><a href="stats_validation.html#cb217-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb217-3"><a href="stats_validation.html#cb217-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(brms_f_mod1) <span class="sc">%&gt;%</span> </span>
<span id="cb217-4"><a href="stats_validation.html#cb217-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb217-5"><a href="stats_validation.html#cb217-5" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb217-6"><a href="stats_validation.html#cb217-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb217-7"><a href="stats_validation.html#cb217-7" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb217-8"><a href="stats_validation.html#cb217-8" tabindex="-1"></a>      <span class="at">x =</span> value, <span class="at">y =</span> depth_maps_generation_quality</span>
<span id="cb217-9"><a href="stats_validation.html#cb217-9" tabindex="-1"></a>      , <span class="at">fill =</span> depth_maps_generation_quality</span>
<span id="cb217-10"><a href="stats_validation.html#cb217-10" tabindex="-1"></a>    )</span>
<span id="cb217-11"><a href="stats_validation.html#cb217-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb217-12"><a href="stats_validation.html#cb217-12" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb217-13"><a href="stats_validation.html#cb217-13" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb217-14"><a href="stats_validation.html#cb217-14" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;gray66&quot;</span></span>
<span id="cb217-15"><a href="stats_validation.html#cb217-15" tabindex="-1"></a>      , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_color =</span> <span class="st">&quot;gray66&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb217-16"><a href="stats_validation.html#cb217-16" tabindex="-1"></a>      , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb217-17"><a href="stats_validation.html#cb217-17" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb217-18"><a href="stats_validation.html#cb217-18" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;inferno&quot;</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb217-19"><a href="stats_validation.html#cb217-19" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb217-20"><a href="stats_validation.html#cb217-20" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb217-21"><a href="stats_validation.html#cb217-21" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;quality&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb217-22"><a href="stats_validation.html#cb217-22" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI&quot;</span></span>
<span id="cb217-23"><a href="stats_validation.html#cb217-23" tabindex="-1"></a>      , <span class="at">caption =</span> form_temp</span>
<span id="cb217-24"><a href="stats_validation.html#cb217-24" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb217-25"><a href="stats_validation.html#cb217-25" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb217-26"><a href="stats_validation.html#cb217-26" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-146-1.png" width="1008" /></p>
<p>we can also make pairwise comparisons</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="stats_validation.html#cb218-1" tabindex="-1"></a><span class="co"># first we need to define the contrasts to make</span></span>
<span id="cb218-2"><a href="stats_validation.html#cb218-2" tabindex="-1"></a>contrast_list <span class="ot">=</span> </span>
<span id="cb218-3"><a href="stats_validation.html#cb218-3" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">crossing</span>(</span>
<span id="cb218-4"><a href="stats_validation.html#cb218-4" tabindex="-1"></a>    <span class="at">x1 =</span> <span class="fu">unique</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_quality)</span>
<span id="cb218-5"><a href="stats_validation.html#cb218-5" tabindex="-1"></a>    , <span class="at">x2 =</span> <span class="fu">unique</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_quality)</span>
<span id="cb218-6"><a href="stats_validation.html#cb218-6" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb218-7"><a href="stats_validation.html#cb218-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb218-8"><a href="stats_validation.html#cb218-8" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb218-9"><a href="stats_validation.html#cb218-9" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">everything</span>()</span>
<span id="cb218-10"><a href="stats_validation.html#cb218-10" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="cf">function</span>(x){<span class="fu">factor</span>(</span>
<span id="cb218-11"><a href="stats_validation.html#cb218-11" tabindex="-1"></a>        x, <span class="at">ordered =</span> T</span>
<span id="cb218-12"><a href="stats_validation.html#cb218-12" tabindex="-1"></a>        , <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_quality)</span>
<span id="cb218-13"><a href="stats_validation.html#cb218-13" tabindex="-1"></a>      )}</span>
<span id="cb218-14"><a href="stats_validation.html#cb218-14" tabindex="-1"></a>    )</span>
<span id="cb218-15"><a href="stats_validation.html#cb218-15" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb218-16"><a href="stats_validation.html#cb218-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(x1<span class="sc">&lt;</span>x2) <span class="sc">%&gt;%</span> </span>
<span id="cb218-17"><a href="stats_validation.html#cb218-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(x1,x2) <span class="sc">%&gt;%</span> </span>
<span id="cb218-18"><a href="stats_validation.html#cb218-18" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(dplyr<span class="sc">::</span><span class="fu">across</span>(dplyr<span class="sc">::</span><span class="fu">everything</span>(), as.character)) <span class="sc">%&gt;%</span> </span>
<span id="cb218-19"><a href="stats_validation.html#cb218-19" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">transpose</span>()</span>
<span id="cb218-20"><a href="stats_validation.html#cb218-20" tabindex="-1"></a></span>
<span id="cb218-21"><a href="stats_validation.html#cb218-21" tabindex="-1"></a><span class="co"># contrast_list</span></span>
<span id="cb218-22"><a href="stats_validation.html#cb218-22" tabindex="-1"></a></span>
<span id="cb218-23"><a href="stats_validation.html#cb218-23" tabindex="-1"></a><span class="co"># obtain posterior draws and calculate contrasts using tidybayes::compare_levels</span></span>
<span id="cb218-24"><a href="stats_validation.html#cb218-24" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> </span>
<span id="cb218-25"><a href="stats_validation.html#cb218-25" tabindex="-1"></a>  brms_f_mod1 <span class="sc">%&gt;%</span> </span>
<span id="cb218-26"><a href="stats_validation.html#cb218-26" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(r_depth_maps_generation_quality[depth_maps_generation_quality]) <span class="sc">%&gt;%</span> </span>
<span id="cb218-27"><a href="stats_validation.html#cb218-27" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb218-28"><a href="stats_validation.html#cb218-28" tabindex="-1"></a>      <span class="at">depth_maps_generation_quality =</span> depth_maps_generation_quality <span class="sc">%&gt;%</span> </span>
<span id="cb218-29"><a href="stats_validation.html#cb218-29" tabindex="-1"></a>        stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>, <span class="st">&quot; &quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb218-30"><a href="stats_validation.html#cb218-30" tabindex="-1"></a>        <span class="fu">factor</span>(</span>
<span id="cb218-31"><a href="stats_validation.html#cb218-31" tabindex="-1"></a>          <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_quality)</span>
<span id="cb218-32"><a href="stats_validation.html#cb218-32" tabindex="-1"></a>          , <span class="at">ordered =</span> T</span>
<span id="cb218-33"><a href="stats_validation.html#cb218-33" tabindex="-1"></a>        )</span>
<span id="cb218-34"><a href="stats_validation.html#cb218-34" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb218-35"><a href="stats_validation.html#cb218-35" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> r_depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb218-36"><a href="stats_validation.html#cb218-36" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb218-37"><a href="stats_validation.html#cb218-37" tabindex="-1"></a>      value</span>
<span id="cb218-38"><a href="stats_validation.html#cb218-38" tabindex="-1"></a>      , <span class="at">by =</span> depth_maps_generation_quality</span>
<span id="cb218-39"><a href="stats_validation.html#cb218-39" tabindex="-1"></a>      , <span class="at">comparison =</span> contrast_list</span>
<span id="cb218-40"><a href="stats_validation.html#cb218-40" tabindex="-1"></a>        <span class="co"># tidybayes::emmeans_comparison(&quot;revpairwise&quot;) </span></span>
<span id="cb218-41"><a href="stats_validation.html#cb218-41" tabindex="-1"></a>        <span class="co">#&quot;pairwise&quot;</span></span>
<span id="cb218-42"><a href="stats_validation.html#cb218-42" tabindex="-1"></a>    ) </span>
<span id="cb218-43"><a href="stats_validation.html#cb218-43" tabindex="-1"></a></span>
<span id="cb218-44"><a href="stats_validation.html#cb218-44" tabindex="-1"></a><span class="co"># generate the contrast column for creating an ordered factor</span></span>
<span id="cb218-45"><a href="stats_validation.html#cb218-45" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span></span>
<span id="cb218-46"><a href="stats_validation.html#cb218-46" tabindex="-1"></a>  brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb218-47"><a href="stats_validation.html#cb218-47" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb218-48"><a href="stats_validation.html#cb218-48" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(</span>
<span id="cb218-49"><a href="stats_validation.html#cb218-49" tabindex="-1"></a>    <span class="at">cols =</span> depth_maps_generation_quality</span>
<span id="cb218-50"><a href="stats_validation.html#cb218-50" tabindex="-1"></a>    , <span class="at">delim =</span> <span class="st">&quot; - &quot;</span></span>
<span id="cb218-51"><a href="stats_validation.html#cb218-51" tabindex="-1"></a>    , <span class="at">names =</span> <span class="fu">paste0</span>(</span>
<span id="cb218-52"><a href="stats_validation.html#cb218-52" tabindex="-1"></a>        <span class="st">&quot;sorter&quot;</span></span>
<span id="cb218-53"><a href="stats_validation.html#cb218-53" tabindex="-1"></a>        , <span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(stringr<span class="sc">::</span><span class="fu">str_count</span>(brms_contrast_temp<span class="sc">$</span>depth_maps_generation_quality, <span class="st">&quot;-&quot;</span>))<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb218-54"><a href="stats_validation.html#cb218-54" tabindex="-1"></a>      )</span>
<span id="cb218-55"><a href="stats_validation.html#cb218-55" tabindex="-1"></a>    , <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span></span>
<span id="cb218-56"><a href="stats_validation.html#cb218-56" tabindex="-1"></a>    , <span class="at">cols_remove =</span> F</span>
<span id="cb218-57"><a href="stats_validation.html#cb218-57" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb218-58"><a href="stats_validation.html#cb218-58" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sorter1<span class="sc">!=</span>sorter2) <span class="sc">%&gt;%</span> </span>
<span id="cb218-59"><a href="stats_validation.html#cb218-59" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb218-60"><a href="stats_validation.html#cb218-60" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb218-61"><a href="stats_validation.html#cb218-61" tabindex="-1"></a>      tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sorter&quot;</span>)</span>
<span id="cb218-62"><a href="stats_validation.html#cb218-62" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="cf">function</span>(x){<span class="fu">factor</span>(</span>
<span id="cb218-63"><a href="stats_validation.html#cb218-63" tabindex="-1"></a>        x, <span class="at">ordered =</span> T</span>
<span id="cb218-64"><a href="stats_validation.html#cb218-64" tabindex="-1"></a>        , <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_quality)</span>
<span id="cb218-65"><a href="stats_validation.html#cb218-65" tabindex="-1"></a>      )}</span>
<span id="cb218-66"><a href="stats_validation.html#cb218-66" tabindex="-1"></a>    )</span>
<span id="cb218-67"><a href="stats_validation.html#cb218-67" tabindex="-1"></a>    , <span class="at">contrast =</span> depth_maps_generation_quality <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb218-68"><a href="stats_validation.html#cb218-68" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="fu">as.numeric</span>(sorter1), <span class="fu">as.numeric</span>(sorter2)) <span class="sc">%&gt;%</span> </span>
<span id="cb218-69"><a href="stats_validation.html#cb218-69" tabindex="-1"></a>        <span class="fu">as.numeric</span>()</span>
<span id="cb218-70"><a href="stats_validation.html#cb218-70" tabindex="-1"></a>      )</span>
<span id="cb218-71"><a href="stats_validation.html#cb218-71" tabindex="-1"></a>  )</span>
<span id="cb218-72"><a href="stats_validation.html#cb218-72" tabindex="-1"></a></span>
<span id="cb218-73"><a href="stats_validation.html#cb218-73" tabindex="-1"></a><span class="co"># median_hdi summary for coloring </span></span>
<span id="cb218-74"><a href="stats_validation.html#cb218-74" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb218-75"><a href="stats_validation.html#cb218-75" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb218-76"><a href="stats_validation.html#cb218-76" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb218-77"><a href="stats_validation.html#cb218-77" tabindex="-1"></a>    <span class="co"># get median_hdi</span></span>
<span id="cb218-78"><a href="stats_validation.html#cb218-78" tabindex="-1"></a>    <span class="at">median_hdi_est =</span> tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value)<span class="sc">$</span>y</span>
<span id="cb218-79"><a href="stats_validation.html#cb218-79" tabindex="-1"></a>    , <span class="at">median_hdi_lower =</span> tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value)<span class="sc">$</span>ymin</span>
<span id="cb218-80"><a href="stats_validation.html#cb218-80" tabindex="-1"></a>    , <span class="at">median_hdi_upper =</span> tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value)<span class="sc">$</span>ymax</span>
<span id="cb218-81"><a href="stats_validation.html#cb218-81" tabindex="-1"></a>    <span class="co"># check probability that this direction is true</span></span>
<span id="cb218-82"><a href="stats_validation.html#cb218-82" tabindex="-1"></a>    , <span class="at">is_gt_zero =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb218-83"><a href="stats_validation.html#cb218-83" tabindex="-1"></a>      median_hdi_est <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> value <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb218-84"><a href="stats_validation.html#cb218-84" tabindex="-1"></a>      , median_hdi_est <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> value <span class="sc">&lt;</span> <span class="dv">0</span></span>
<span id="cb218-85"><a href="stats_validation.html#cb218-85" tabindex="-1"></a>    )</span>
<span id="cb218-86"><a href="stats_validation.html#cb218-86" tabindex="-1"></a>    , <span class="at">pct_gt_zero =</span> <span class="fu">mean</span>(is_gt_zero)</span>
<span id="cb218-87"><a href="stats_validation.html#cb218-87" tabindex="-1"></a>    <span class="co"># make a label</span></span>
<span id="cb218-88"><a href="stats_validation.html#cb218-88" tabindex="-1"></a>    , <span class="at">pct_gt_zero_lab =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb218-89"><a href="stats_validation.html#cb218-89" tabindex="-1"></a>      median_hdi_est <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="fu">paste0</span>(</span>
<span id="cb218-90"><a href="stats_validation.html#cb218-90" tabindex="-1"></a>        <span class="st">&quot;Pr(&quot;</span></span>
<span id="cb218-91"><a href="stats_validation.html#cb218-91" tabindex="-1"></a>        , stringr<span class="sc">::</span><span class="fu">word</span>(contrast, <span class="dv">1</span>, <span class="at">sep =</span> <span class="fu">fixed</span>(<span class="st">&quot;-&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb218-92"><a href="stats_validation.html#cb218-92" tabindex="-1"></a>          stringr<span class="sc">::</span><span class="fu">str_squish</span>()</span>
<span id="cb218-93"><a href="stats_validation.html#cb218-93" tabindex="-1"></a>        , <span class="st">&quot;&gt;&quot;</span></span>
<span id="cb218-94"><a href="stats_validation.html#cb218-94" tabindex="-1"></a>        , stringr<span class="sc">::</span><span class="fu">word</span>(contrast, <span class="dv">2</span>, <span class="at">sep =</span> <span class="fu">fixed</span>(<span class="st">&quot;-&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb218-95"><a href="stats_validation.html#cb218-95" tabindex="-1"></a>          stringr<span class="sc">::</span><span class="fu">str_squish</span>()</span>
<span id="cb218-96"><a href="stats_validation.html#cb218-96" tabindex="-1"></a>        , <span class="st">&quot;)=&quot;</span></span>
<span id="cb218-97"><a href="stats_validation.html#cb218-97" tabindex="-1"></a>        , pct_gt_zero <span class="sc">%&gt;%</span> scales<span class="sc">::</span><span class="fu">percent</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)</span>
<span id="cb218-98"><a href="stats_validation.html#cb218-98" tabindex="-1"></a>      )</span>
<span id="cb218-99"><a href="stats_validation.html#cb218-99" tabindex="-1"></a>      , median_hdi_est <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="fu">paste0</span>(</span>
<span id="cb218-100"><a href="stats_validation.html#cb218-100" tabindex="-1"></a>        <span class="st">&quot;Pr(&quot;</span></span>
<span id="cb218-101"><a href="stats_validation.html#cb218-101" tabindex="-1"></a>        , stringr<span class="sc">::</span><span class="fu">word</span>(contrast, <span class="dv">2</span>, <span class="at">sep =</span> <span class="fu">fixed</span>(<span class="st">&quot;-&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb218-102"><a href="stats_validation.html#cb218-102" tabindex="-1"></a>          stringr<span class="sc">::</span><span class="fu">str_squish</span>()</span>
<span id="cb218-103"><a href="stats_validation.html#cb218-103" tabindex="-1"></a>        , <span class="st">&quot;&gt;&quot;</span></span>
<span id="cb218-104"><a href="stats_validation.html#cb218-104" tabindex="-1"></a>        , stringr<span class="sc">::</span><span class="fu">word</span>(contrast, <span class="dv">1</span>, <span class="at">sep =</span> <span class="fu">fixed</span>(<span class="st">&quot;-&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb218-105"><a href="stats_validation.html#cb218-105" tabindex="-1"></a>          stringr<span class="sc">::</span><span class="fu">str_squish</span>()</span>
<span id="cb218-106"><a href="stats_validation.html#cb218-106" tabindex="-1"></a>        , <span class="st">&quot;)=&quot;</span></span>
<span id="cb218-107"><a href="stats_validation.html#cb218-107" tabindex="-1"></a>        , pct_gt_zero <span class="sc">%&gt;%</span> scales<span class="sc">::</span><span class="fu">percent</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)</span>
<span id="cb218-108"><a href="stats_validation.html#cb218-108" tabindex="-1"></a>      )</span>
<span id="cb218-109"><a href="stats_validation.html#cb218-109" tabindex="-1"></a>    )</span>
<span id="cb218-110"><a href="stats_validation.html#cb218-110" tabindex="-1"></a>    <span class="co"># make a SMALLER label</span></span>
<span id="cb218-111"><a href="stats_validation.html#cb218-111" tabindex="-1"></a>    , <span class="at">pct_gt_zero_lab_sm =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb218-112"><a href="stats_validation.html#cb218-112" tabindex="-1"></a>      median_hdi_est <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">~</span> <span class="fu">paste0</span>(</span>
<span id="cb218-113"><a href="stats_validation.html#cb218-113" tabindex="-1"></a>        <span class="st">&quot;Pr(&gt;0)=&quot;</span></span>
<span id="cb218-114"><a href="stats_validation.html#cb218-114" tabindex="-1"></a>        , pct_gt_zero <span class="sc">%&gt;%</span> scales<span class="sc">::</span><span class="fu">percent</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)</span>
<span id="cb218-115"><a href="stats_validation.html#cb218-115" tabindex="-1"></a>      )</span>
<span id="cb218-116"><a href="stats_validation.html#cb218-116" tabindex="-1"></a>      , median_hdi_est <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="fu">paste0</span>(</span>
<span id="cb218-117"><a href="stats_validation.html#cb218-117" tabindex="-1"></a>        <span class="st">&quot;Pr(&lt;0)=&quot;</span></span>
<span id="cb218-118"><a href="stats_validation.html#cb218-118" tabindex="-1"></a>        , pct_gt_zero <span class="sc">%&gt;%</span> scales<span class="sc">::</span><span class="fu">percent</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)</span>
<span id="cb218-119"><a href="stats_validation.html#cb218-119" tabindex="-1"></a>      )</span>
<span id="cb218-120"><a href="stats_validation.html#cb218-120" tabindex="-1"></a>    )</span>
<span id="cb218-121"><a href="stats_validation.html#cb218-121" tabindex="-1"></a>    , <span class="at">pct_gt_zero_lab_pos =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb218-122"><a href="stats_validation.html#cb218-122" tabindex="-1"></a>      median_hdi_est <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> median_hdi_upper</span>
<span id="cb218-123"><a href="stats_validation.html#cb218-123" tabindex="-1"></a>      , median_hdi_est <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> median_hdi_lower</span>
<span id="cb218-124"><a href="stats_validation.html#cb218-124" tabindex="-1"></a>    ) <span class="sc">*</span> <span class="fl">1.09</span></span>
<span id="cb218-125"><a href="stats_validation.html#cb218-125" tabindex="-1"></a>    , <span class="at">sig_level =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb218-126"><a href="stats_validation.html#cb218-126" tabindex="-1"></a>      pct_gt_zero <span class="sc">&gt;</span> <span class="fl">0.99</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb218-127"><a href="stats_validation.html#cb218-127" tabindex="-1"></a>      , pct_gt_zero <span class="sc">&gt;</span> <span class="fl">0.95</span> <span class="sc">~</span> <span class="dv">1</span></span>
<span id="cb218-128"><a href="stats_validation.html#cb218-128" tabindex="-1"></a>      , pct_gt_zero <span class="sc">&gt;</span> <span class="fl">0.9</span> <span class="sc">~</span> <span class="dv">2</span></span>
<span id="cb218-129"><a href="stats_validation.html#cb218-129" tabindex="-1"></a>      , pct_gt_zero <span class="sc">&gt;</span> <span class="fl">0.8</span> <span class="sc">~</span> <span class="dv">3</span></span>
<span id="cb218-130"><a href="stats_validation.html#cb218-130" tabindex="-1"></a>      , T <span class="sc">~</span> <span class="dv">4</span></span>
<span id="cb218-131"><a href="stats_validation.html#cb218-131" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb218-132"><a href="stats_validation.html#cb218-132" tabindex="-1"></a>    <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&gt;99%&quot;</span>,<span class="st">&quot;95%&quot;</span>,<span class="st">&quot;90%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;&lt;80%&quot;</span>), <span class="at">ordered =</span> T)</span>
<span id="cb218-133"><a href="stats_validation.html#cb218-133" tabindex="-1"></a>  )</span>
<span id="cb218-134"><a href="stats_validation.html#cb218-134" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb218-135"><a href="stats_validation.html#cb218-135" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb218-136"><a href="stats_validation.html#cb218-136" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb218-137"><a href="stats_validation.html#cb218-137" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>(contrast, median_hdi_est, pct_gt_zero_lab,pct_gt_zero_lab_sm)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 5
##    contrast            median_hdi_est pct_gt_zero_lab   pct_gt_zero_lab_sm     n
##    &lt;fct&gt;                        &lt;dbl&gt; &lt;chr&gt;             &lt;chr&gt;              &lt;int&gt;
##  1 ultra high - high           0.0370 Pr(ultra high&gt;hi… Pr(&gt;0)=83%          8000
##  2 ultra high - medium         0.105  Pr(ultra high&gt;me… Pr(&gt;0)=100%         8000
##  3 ultra high - low            0.165  Pr(ultra high&gt;lo… Pr(&gt;0)=100%         8000
##  4 ultra high - lowest         0.287  Pr(ultra high&gt;lo… Pr(&gt;0)=100%         8000
##  5 high - medium               0.0670 Pr(high&gt;medium)=… Pr(&gt;0)=95%          8000
##  6 high - low                  0.128  Pr(high&gt;low)=100% Pr(&gt;0)=100%         8000
##  7 high - lowest               0.250  Pr(high&gt;lowest)=… Pr(&gt;0)=100%         8000
##  8 medium - low                0.0607 Pr(medium&gt;low)=9… Pr(&gt;0)=95%          8000
##  9 medium - lowest             0.183  Pr(medium&gt;lowest… Pr(&gt;0)=100%         8000
## 10 low - lowest                0.121  Pr(low&gt;lowest)=1… Pr(&gt;0)=100%         8000</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="stats_validation.html#cb220-1" tabindex="-1"></a><span class="co"># plot, finally</span></span>
<span id="cb220-2"><a href="stats_validation.html#cb220-2" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb220-3"><a href="stats_validation.html#cb220-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> contrast, <span class="at">fill =</span> pct_gt_zero)) <span class="sc">+</span></span>
<span id="cb220-4"><a href="stats_validation.html#cb220-4" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb220-5"><a href="stats_validation.html#cb220-5" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.95</span>)</span>
<span id="cb220-6"><a href="stats_validation.html#cb220-6" tabindex="-1"></a>      <span class="co"># , slab_fill = &quot;gray22&quot;, slab_alpha = 1</span></span>
<span id="cb220-7"><a href="stats_validation.html#cb220-7" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb220-8"><a href="stats_validation.html#cb220-8" tabindex="-1"></a>      , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb220-9"><a href="stats_validation.html#cb220-9" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb220-10"><a href="stats_validation.html#cb220-10" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray44&quot;</span>) <span class="sc">+</span></span>
<span id="cb220-11"><a href="stats_validation.html#cb220-11" tabindex="-1"></a>    <span class="fu">geom_text</span>(</span>
<span id="cb220-12"><a href="stats_validation.html#cb220-12" tabindex="-1"></a>      <span class="at">data =</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb220-13"><a href="stats_validation.html#cb220-13" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb220-14"><a href="stats_validation.html#cb220-14" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(contrast, pct_gt_zero_lab, pct_gt_zero_lab_pos, pct_gt_zero)</span>
<span id="cb220-15"><a href="stats_validation.html#cb220-15" tabindex="-1"></a>      , <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> pct_gt_zero_lab_pos, <span class="at">label =</span> pct_gt_zero_lab)</span>
<span id="cb220-16"><a href="stats_validation.html#cb220-16" tabindex="-1"></a>      , <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">2.5</span></span>
<span id="cb220-17"><a href="stats_validation.html#cb220-17" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb220-18"><a href="stats_validation.html#cb220-18" tabindex="-1"></a>    <span class="fu">scale_fill_fermenter</span>(</span>
<span id="cb220-19"><a href="stats_validation.html#cb220-19" tabindex="-1"></a>      <span class="at">n.breaks =</span> <span class="dv">10</span>, <span class="at">palette =</span> <span class="st">&quot;PuOr&quot;</span></span>
<span id="cb220-20"><a href="stats_validation.html#cb220-20" tabindex="-1"></a>      , <span class="at">direction =</span> <span class="dv">1</span></span>
<span id="cb220-21"><a href="stats_validation.html#cb220-21" tabindex="-1"></a>      , <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb220-22"><a href="stats_validation.html#cb220-22" tabindex="-1"></a>      , <span class="at">labels =</span> scales<span class="sc">::</span>percent</span>
<span id="cb220-23"><a href="stats_validation.html#cb220-23" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb220-24"><a href="stats_validation.html#cb220-24" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">8</span>), <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>))) <span class="sc">+</span></span>
<span id="cb220-25"><a href="stats_validation.html#cb220-25" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb220-26"><a href="stats_validation.html#cb220-26" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;quality&quot;</span></span>
<span id="cb220-27"><a href="stats_validation.html#cb220-27" tabindex="-1"></a>      , <span class="at">x =</span> <span class="st">&quot;constrast (F-score)&quot;</span></span>
<span id="cb220-28"><a href="stats_validation.html#cb220-28" tabindex="-1"></a>      , <span class="at">fill =</span> <span class="st">&quot;Pr(contrast)&quot;</span></span>
<span id="cb220-29"><a href="stats_validation.html#cb220-29" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of group constrasts with 95% &amp; 50% HDI&quot;</span></span>
<span id="cb220-30"><a href="stats_validation.html#cb220-30" tabindex="-1"></a>      , <span class="at">caption =</span> form_temp</span>
<span id="cb220-31"><a href="stats_validation.html#cb220-31" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb220-32"><a href="stats_validation.html#cb220-32" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb220-33"><a href="stats_validation.html#cb220-33" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb220-34"><a href="stats_validation.html#cb220-34" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>)</span>
<span id="cb220-35"><a href="stats_validation.html#cb220-35" tabindex="-1"></a>      , <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb220-36"><a href="stats_validation.html#cb220-36" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb220-37"><a href="stats_validation.html#cb220-37" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb220-38"><a href="stats_validation.html#cb220-38" tabindex="-1"></a>      <span class="at">legend.key.width  =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;lines&quot;</span>),</span>
<span id="cb220-39"><a href="stats_validation.html#cb220-39" tabindex="-1"></a>      <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">12</span>, <span class="st">&quot;lines&quot;</span>)</span>
<span id="cb220-40"><a href="stats_validation.html#cb220-40" tabindex="-1"></a>    )))</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-148-1.png" width="1008" /></p>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="stats_validation.html#cb221-1" tabindex="-1"></a><span class="co"># # can also use the following as substitute for the &quot;tidybayes::spread_draws&quot; used above to get same result</span></span>
<span id="cb221-2"><a href="stats_validation.html#cb221-2" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb221-3"><a href="stats_validation.html#cb221-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb221-4"><a href="stats_validation.html#cb221-4" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb221-5"><a href="stats_validation.html#cb221-5" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(.point,.interval, .width)) <span class="sc">%&gt;%</span> </span>
<span id="cb221-6"><a href="stats_validation.html#cb221-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(contrast)) <span class="sc">%&gt;%</span> </span>
<span id="cb221-7"><a href="stats_validation.html#cb221-7" tabindex="-1"></a>   </span>
<span id="cb221-8"><a href="stats_validation.html#cb221-8" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb221-9"><a href="stats_validation.html#cb221-9" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb221-10"><a href="stats_validation.html#cb221-10" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts in F-score&quot;</span></span>
<span id="cb221-11"><a href="stats_validation.html#cb221-11" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb221-12"><a href="stats_validation.html#cb221-12" tabindex="-1"></a>      <span class="st">&quot;quality contrast&quot;</span></span>
<span id="cb221-13"><a href="stats_validation.html#cb221-13" tabindex="-1"></a>      , <span class="st">&quot;difference (F-score)&quot;</span></span>
<span id="cb221-14"><a href="stats_validation.html#cb221-14" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb221-15"><a href="stats_validation.html#cb221-15" tabindex="-1"></a>    )</span>
<span id="cb221-16"><a href="stats_validation.html#cb221-16" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb221-17"><a href="stats_validation.html#cb221-17" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-149">Table 6.4: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts in F-score
</caption>
<thead>
<tr>
<th style="text-align:left;">
quality contrast
</th>
<th style="text-align:right;">
difference (F-score)
</th>
<th style="text-align:right;">
HDI low
</th>
<th style="text-align:right;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
low - lowest
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.21
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.27
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.13
</td>
</tr>
<tr>
<td style="text-align:left;">
high - lowest
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.33
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.20
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.15
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - lowest
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.37
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.24
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.18
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
</tbody>
</table>
<p>Before we move on to the next section, look above at how many arguments we fiddled with to configure our <code>tidybayes::stat_halfeye()</code> plot. Given how many more contrast plots we have looming in our not-too-distant future, we might go ahead and save these settings as a new function. We’ll call it <code>plt_contrast()</code>.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="stats_validation.html#cb222-1" tabindex="-1"></a>plt_contrast <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb222-2"><a href="stats_validation.html#cb222-2" tabindex="-1"></a>    my_data</span>
<span id="cb222-3"><a href="stats_validation.html#cb222-3" tabindex="-1"></a>    , <span class="at">x =</span> <span class="st">&quot;value&quot;</span></span>
<span id="cb222-4"><a href="stats_validation.html#cb222-4" tabindex="-1"></a>    , <span class="at">y =</span> <span class="st">&quot;contrast&quot;</span></span>
<span id="cb222-5"><a href="stats_validation.html#cb222-5" tabindex="-1"></a>    , <span class="at">fill =</span> <span class="st">&quot;pct_gt_zero&quot;</span></span>
<span id="cb222-6"><a href="stats_validation.html#cb222-6" tabindex="-1"></a>    , <span class="at">label =</span> <span class="st">&quot;pct_gt_zero_lab&quot;</span></span>
<span id="cb222-7"><a href="stats_validation.html#cb222-7" tabindex="-1"></a>    , <span class="at">label_pos =</span> <span class="st">&quot;pct_gt_zero_lab_pos&quot;</span></span>
<span id="cb222-8"><a href="stats_validation.html#cb222-8" tabindex="-1"></a>    , <span class="at">label_size =</span> <span class="dv">3</span></span>
<span id="cb222-9"><a href="stats_validation.html#cb222-9" tabindex="-1"></a>    , <span class="at">x_expand =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>)</span>
<span id="cb222-10"><a href="stats_validation.html#cb222-10" tabindex="-1"></a>    , <span class="at">facet =</span> <span class="cn">NA</span></span>
<span id="cb222-11"><a href="stats_validation.html#cb222-11" tabindex="-1"></a>    , <span class="at">y_axis_title =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb222-12"><a href="stats_validation.html#cb222-12" tabindex="-1"></a>    , <span class="at">caption_text =</span> <span class="st">&quot;&quot;</span> <span class="co"># form_temp</span></span>
<span id="cb222-13"><a href="stats_validation.html#cb222-13" tabindex="-1"></a>    , <span class="at">annotate_size =</span> <span class="fl">2.2</span></span>
<span id="cb222-14"><a href="stats_validation.html#cb222-14" tabindex="-1"></a>    ) {</span>
<span id="cb222-15"><a href="stats_validation.html#cb222-15" tabindex="-1"></a>  <span class="co"># df for annotation</span></span>
<span id="cb222-16"><a href="stats_validation.html#cb222-16" tabindex="-1"></a>  get_annotation_df <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb222-17"><a href="stats_validation.html#cb222-17" tabindex="-1"></a>        <span class="at">my_text_list =</span> <span class="fu">c</span>(</span>
<span id="cb222-18"><a href="stats_validation.html#cb222-18" tabindex="-1"></a>          <span class="st">&quot;Bottom Left (h0,v0)&quot;</span>,<span class="st">&quot;Top Left (h0,v1)&quot;</span></span>
<span id="cb222-19"><a href="stats_validation.html#cb222-19" tabindex="-1"></a>          ,<span class="st">&quot;Bottom Right h1,v0&quot;</span>,<span class="st">&quot;Top Right h1,v1&quot;</span></span>
<span id="cb222-20"><a href="stats_validation.html#cb222-20" tabindex="-1"></a>          )</span>
<span id="cb222-21"><a href="stats_validation.html#cb222-21" tabindex="-1"></a>        , <span class="at">hjust =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>) <span class="co"># higher values = right, lower values = left </span></span>
<span id="cb222-22"><a href="stats_validation.html#cb222-22" tabindex="-1"></a>        , <span class="at">vjust =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.3</span>,<span class="dv">0</span>,<span class="fl">1.3</span>) <span class="co"># higher values = down, lower values = up</span></span>
<span id="cb222-23"><a href="stats_validation.html#cb222-23" tabindex="-1"></a>    ){</span>
<span id="cb222-24"><a href="stats_validation.html#cb222-24" tabindex="-1"></a>      df <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb222-25"><a href="stats_validation.html#cb222-25" tabindex="-1"></a>        <span class="at">xpos =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>,<span class="sc">-</span><span class="cn">Inf</span>,<span class="cn">Inf</span>,<span class="cn">Inf</span>)</span>
<span id="cb222-26"><a href="stats_validation.html#cb222-26" tabindex="-1"></a>        , <span class="at">ypos =</span>  <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="cn">Inf</span>,<span class="sc">-</span><span class="cn">Inf</span>,<span class="cn">Inf</span>)</span>
<span id="cb222-27"><a href="stats_validation.html#cb222-27" tabindex="-1"></a>        , <span class="at">annotate_text =</span> my_text_list</span>
<span id="cb222-28"><a href="stats_validation.html#cb222-28" tabindex="-1"></a>        , <span class="at">hjustvar =</span> hjust</span>
<span id="cb222-29"><a href="stats_validation.html#cb222-29" tabindex="-1"></a>        , <span class="at">vjustvar =</span> vjust</span>
<span id="cb222-30"><a href="stats_validation.html#cb222-30" tabindex="-1"></a>      )  </span>
<span id="cb222-31"><a href="stats_validation.html#cb222-31" tabindex="-1"></a>      <span class="fu">return</span>(df)</span>
<span id="cb222-32"><a href="stats_validation.html#cb222-32" tabindex="-1"></a>  }</span>
<span id="cb222-33"><a href="stats_validation.html#cb222-33" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb222-34"><a href="stats_validation.html#cb222-34" tabindex="-1"></a>  plt <span class="ot">=</span> </span>
<span id="cb222-35"><a href="stats_validation.html#cb222-35" tabindex="-1"></a>    my_data <span class="sc">%&gt;%</span></span>
<span id="cb222-36"><a href="stats_validation.html#cb222-36" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .data[[x]], <span class="at">y =</span> .data[[y]])) <span class="sc">+</span></span>
<span id="cb222-37"><a href="stats_validation.html#cb222-37" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray33&quot;</span>, <span class="at">lwd =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb222-38"><a href="stats_validation.html#cb222-38" tabindex="-1"></a>      tidybayes<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb222-39"><a href="stats_validation.html#cb222-39" tabindex="-1"></a>        <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> .data[[fill]])</span>
<span id="cb222-40"><a href="stats_validation.html#cb222-40" tabindex="-1"></a>        , <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.95</span>)</span>
<span id="cb222-41"><a href="stats_validation.html#cb222-41" tabindex="-1"></a>        <span class="co"># , slab_fill = &quot;gray22&quot;, slab_alpha = 1</span></span>
<span id="cb222-42"><a href="stats_validation.html#cb222-42" tabindex="-1"></a>        , <span class="at">interval_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb222-43"><a href="stats_validation.html#cb222-43" tabindex="-1"></a>        , <span class="at">point_size =</span> <span class="fl">0.9</span></span>
<span id="cb222-44"><a href="stats_validation.html#cb222-44" tabindex="-1"></a>        , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb222-45"><a href="stats_validation.html#cb222-45" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb222-46"><a href="stats_validation.html#cb222-46" tabindex="-1"></a>      <span class="fu">geom_text</span>(</span>
<span id="cb222-47"><a href="stats_validation.html#cb222-47" tabindex="-1"></a>        <span class="at">data =</span> <span class="fu">get_annotation_df</span>(</span>
<span id="cb222-48"><a href="stats_validation.html#cb222-48" tabindex="-1"></a>          <span class="at">my_text_list =</span> <span class="fu">c</span>(</span>
<span id="cb222-49"><a href="stats_validation.html#cb222-49" tabindex="-1"></a>          <span class="st">&quot;&quot;</span>,<span class="st">&quot;L.H.S. &lt; R.H.S.&quot;</span></span>
<span id="cb222-50"><a href="stats_validation.html#cb222-50" tabindex="-1"></a>          ,<span class="st">&quot;&quot;</span>,<span class="st">&quot;L.H.S. &gt; R.H.S.&quot;</span></span>
<span id="cb222-51"><a href="stats_validation.html#cb222-51" tabindex="-1"></a>          )</span>
<span id="cb222-52"><a href="stats_validation.html#cb222-52" tabindex="-1"></a>        )</span>
<span id="cb222-53"><a href="stats_validation.html#cb222-53" tabindex="-1"></a>        , <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb222-54"><a href="stats_validation.html#cb222-54" tabindex="-1"></a>          <span class="at">x =</span> xpos, <span class="at">y =</span> ypos</span>
<span id="cb222-55"><a href="stats_validation.html#cb222-55" tabindex="-1"></a>          , <span class="at">hjust =</span> hjustvar, <span class="at">vjust =</span> vjustvar</span>
<span id="cb222-56"><a href="stats_validation.html#cb222-56" tabindex="-1"></a>          , <span class="at">label =</span> annotate_text</span>
<span id="cb222-57"><a href="stats_validation.html#cb222-57" tabindex="-1"></a>          , <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span></span>
<span id="cb222-58"><a href="stats_validation.html#cb222-58" tabindex="-1"></a>        )</span>
<span id="cb222-59"><a href="stats_validation.html#cb222-59" tabindex="-1"></a>        , <span class="at">size =</span> annotate_size</span>
<span id="cb222-60"><a href="stats_validation.html#cb222-60" tabindex="-1"></a>        , <span class="at">color =</span> <span class="st">&quot;gray30&quot;</span> <span class="co"># &quot;#2d2a4d&quot; #&quot;#204445&quot;</span></span>
<span id="cb222-61"><a href="stats_validation.html#cb222-61" tabindex="-1"></a>      ) <span class="sc">+</span> </span>
<span id="cb222-62"><a href="stats_validation.html#cb222-62" tabindex="-1"></a>      <span class="co"># scale_fill_fermenter(</span></span>
<span id="cb222-63"><a href="stats_validation.html#cb222-63" tabindex="-1"></a>      <span class="co">#   n.breaks = 5 # 10 use 10 if can go full range 0-1</span></span>
<span id="cb222-64"><a href="stats_validation.html#cb222-64" tabindex="-1"></a>      <span class="co">#   , palette = &quot;PuOr&quot; # &quot;RdYlBu&quot;</span></span>
<span id="cb222-65"><a href="stats_validation.html#cb222-65" tabindex="-1"></a>      <span class="co">#   , direction = 1</span></span>
<span id="cb222-66"><a href="stats_validation.html#cb222-66" tabindex="-1"></a>      <span class="co">#   , limits = c(0.5,1) # use c(0,1) if can go full range 0-1</span></span>
<span id="cb222-67"><a href="stats_validation.html#cb222-67" tabindex="-1"></a>      <span class="co">#   , labels = scales::percent</span></span>
<span id="cb222-68"><a href="stats_validation.html#cb222-68" tabindex="-1"></a>      <span class="co"># ) +</span></span>
<span id="cb222-69"><a href="stats_validation.html#cb222-69" tabindex="-1"></a>      <span class="fu">scale_fill_stepsn</span>(</span>
<span id="cb222-70"><a href="stats_validation.html#cb222-70" tabindex="-1"></a>        <span class="at">n.breaks =</span> <span class="dv">5</span> <span class="co"># 10 use 10 if can go full range 0-1</span></span>
<span id="cb222-71"><a href="stats_validation.html#cb222-71" tabindex="-1"></a>        , <span class="at">colors =</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">11</span>,<span class="st">&quot;PuOr&quot;</span>)[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">11</span>)]</span>
<span id="cb222-72"><a href="stats_validation.html#cb222-72" tabindex="-1"></a>        , <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>) <span class="co"># use c(0,1) if can go full range 0-1</span></span>
<span id="cb222-73"><a href="stats_validation.html#cb222-73" tabindex="-1"></a>        , <span class="at">labels =</span> scales<span class="sc">::</span>percent</span>
<span id="cb222-74"><a href="stats_validation.html#cb222-74" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb222-75"><a href="stats_validation.html#cb222-75" tabindex="-1"></a>      <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> x_expand)) <span class="sc">+</span></span>
<span id="cb222-76"><a href="stats_validation.html#cb222-76" tabindex="-1"></a>      <span class="fu">labs</span>(</span>
<span id="cb222-77"><a href="stats_validation.html#cb222-77" tabindex="-1"></a>        <span class="at">y =</span> y_axis_title</span>
<span id="cb222-78"><a href="stats_validation.html#cb222-78" tabindex="-1"></a>        , <span class="at">x =</span> <span class="st">&quot;constrast (F-score)&quot;</span></span>
<span id="cb222-79"><a href="stats_validation.html#cb222-79" tabindex="-1"></a>        , <span class="at">fill =</span> <span class="st">&quot;Pr(contrast)&quot;</span></span>
<span id="cb222-80"><a href="stats_validation.html#cb222-80" tabindex="-1"></a>        , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of group constrasts with 95% &amp; 50% HDI&quot;</span></span>
<span id="cb222-81"><a href="stats_validation.html#cb222-81" tabindex="-1"></a>        , <span class="at">caption =</span> caption_text</span>
<span id="cb222-82"><a href="stats_validation.html#cb222-82" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb222-83"><a href="stats_validation.html#cb222-83" tabindex="-1"></a>      <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb222-84"><a href="stats_validation.html#cb222-84" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb222-85"><a href="stats_validation.html#cb222-85" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>)</span>
<span id="cb222-86"><a href="stats_validation.html#cb222-86" tabindex="-1"></a>        , <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb222-87"><a href="stats_validation.html#cb222-87" tabindex="-1"></a>        , <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="fl">1.05</span>)</span>
<span id="cb222-88"><a href="stats_validation.html#cb222-88" tabindex="-1"></a>        , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb222-89"><a href="stats_validation.html#cb222-89" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb222-90"><a href="stats_validation.html#cb222-90" tabindex="-1"></a>      <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb222-91"><a href="stats_validation.html#cb222-91" tabindex="-1"></a>        <span class="at">legend.key.width  =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;lines&quot;</span>),</span>
<span id="cb222-92"><a href="stats_validation.html#cb222-92" tabindex="-1"></a>        <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">12</span>, <span class="st">&quot;lines&quot;</span>)</span>
<span id="cb222-93"><a href="stats_validation.html#cb222-93" tabindex="-1"></a>      )))</span>
<span id="cb222-94"><a href="stats_validation.html#cb222-94" tabindex="-1"></a>  <span class="co"># return facet or not</span></span>
<span id="cb222-95"><a href="stats_validation.html#cb222-95" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">max</span>(<span class="fu">is.na</span>(facet))<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb222-96"><a href="stats_validation.html#cb222-96" tabindex="-1"></a>    <span class="fu">return</span>(</span>
<span id="cb222-97"><a href="stats_validation.html#cb222-97" tabindex="-1"></a>      plt <span class="sc">+</span></span>
<span id="cb222-98"><a href="stats_validation.html#cb222-98" tabindex="-1"></a>        <span class="fu">geom_text</span>(</span>
<span id="cb222-99"><a href="stats_validation.html#cb222-99" tabindex="-1"></a>          <span class="at">data =</span> my_data <span class="sc">%&gt;%</span></span>
<span id="cb222-100"><a href="stats_validation.html#cb222-100" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(pct_gt_zero_lab_pos<span class="sc">&gt;=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb222-101"><a href="stats_validation.html#cb222-101" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb222-102"><a href="stats_validation.html#cb222-102" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">select</span>(tidyselect<span class="sc">::</span><span class="fu">all_of</span>(<span class="fu">c</span>(</span>
<span id="cb222-103"><a href="stats_validation.html#cb222-103" tabindex="-1"></a>              y</span>
<span id="cb222-104"><a href="stats_validation.html#cb222-104" tabindex="-1"></a>              , fill</span>
<span id="cb222-105"><a href="stats_validation.html#cb222-105" tabindex="-1"></a>              , label</span>
<span id="cb222-106"><a href="stats_validation.html#cb222-106" tabindex="-1"></a>              , label_pos</span>
<span id="cb222-107"><a href="stats_validation.html#cb222-107" tabindex="-1"></a>              , facet</span>
<span id="cb222-108"><a href="stats_validation.html#cb222-108" tabindex="-1"></a>            ))) <span class="sc">%&gt;%</span> </span>
<span id="cb222-109"><a href="stats_validation.html#cb222-109" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">distinct</span>()</span>
<span id="cb222-110"><a href="stats_validation.html#cb222-110" tabindex="-1"></a>          , <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> .data[[label_pos]], <span class="at">label =</span> .data[[label]])</span>
<span id="cb222-111"><a href="stats_validation.html#cb222-111" tabindex="-1"></a>          , <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> label_size</span>
<span id="cb222-112"><a href="stats_validation.html#cb222-112" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb222-113"><a href="stats_validation.html#cb222-113" tabindex="-1"></a>        <span class="fu">geom_text</span>(</span>
<span id="cb222-114"><a href="stats_validation.html#cb222-114" tabindex="-1"></a>          <span class="at">data =</span> my_data <span class="sc">%&gt;%</span></span>
<span id="cb222-115"><a href="stats_validation.html#cb222-115" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(pct_gt_zero_lab_pos<span class="sc">&lt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb222-116"><a href="stats_validation.html#cb222-116" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb222-117"><a href="stats_validation.html#cb222-117" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">select</span>(tidyselect<span class="sc">::</span><span class="fu">all_of</span>(<span class="fu">c</span>(</span>
<span id="cb222-118"><a href="stats_validation.html#cb222-118" tabindex="-1"></a>              y</span>
<span id="cb222-119"><a href="stats_validation.html#cb222-119" tabindex="-1"></a>              , fill</span>
<span id="cb222-120"><a href="stats_validation.html#cb222-120" tabindex="-1"></a>              , label</span>
<span id="cb222-121"><a href="stats_validation.html#cb222-121" tabindex="-1"></a>              , label_pos</span>
<span id="cb222-122"><a href="stats_validation.html#cb222-122" tabindex="-1"></a>              , facet</span>
<span id="cb222-123"><a href="stats_validation.html#cb222-123" tabindex="-1"></a>            ))) <span class="sc">%&gt;%</span> </span>
<span id="cb222-124"><a href="stats_validation.html#cb222-124" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">distinct</span>()</span>
<span id="cb222-125"><a href="stats_validation.html#cb222-125" tabindex="-1"></a>          , <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> .data[[label_pos]], <span class="at">label =</span> .data[[label]])</span>
<span id="cb222-126"><a href="stats_validation.html#cb222-126" tabindex="-1"></a>          , <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="sc">+</span><span class="dv">1</span>, <span class="at">size =</span> label_size</span>
<span id="cb222-127"><a href="stats_validation.html#cb222-127" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb222-128"><a href="stats_validation.html#cb222-128" tabindex="-1"></a>        <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(.data[[facet]]))</span>
<span id="cb222-129"><a href="stats_validation.html#cb222-129" tabindex="-1"></a>        </span>
<span id="cb222-130"><a href="stats_validation.html#cb222-130" tabindex="-1"></a>    )</span>
<span id="cb222-131"><a href="stats_validation.html#cb222-131" tabindex="-1"></a>  }</span>
<span id="cb222-132"><a href="stats_validation.html#cb222-132" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb222-133"><a href="stats_validation.html#cb222-133" tabindex="-1"></a>    <span class="fu">return</span>(</span>
<span id="cb222-134"><a href="stats_validation.html#cb222-134" tabindex="-1"></a>      plt <span class="sc">+</span></span>
<span id="cb222-135"><a href="stats_validation.html#cb222-135" tabindex="-1"></a>        <span class="fu">geom_text</span>(</span>
<span id="cb222-136"><a href="stats_validation.html#cb222-136" tabindex="-1"></a>          <span class="at">data =</span> my_data <span class="sc">%&gt;%</span></span>
<span id="cb222-137"><a href="stats_validation.html#cb222-137" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(pct_gt_zero_lab_pos<span class="sc">&gt;=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb222-138"><a href="stats_validation.html#cb222-138" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb222-139"><a href="stats_validation.html#cb222-139" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">select</span>(tidyselect<span class="sc">::</span><span class="fu">all_of</span>(<span class="fu">c</span>(</span>
<span id="cb222-140"><a href="stats_validation.html#cb222-140" tabindex="-1"></a>              y</span>
<span id="cb222-141"><a href="stats_validation.html#cb222-141" tabindex="-1"></a>              , fill</span>
<span id="cb222-142"><a href="stats_validation.html#cb222-142" tabindex="-1"></a>              , label</span>
<span id="cb222-143"><a href="stats_validation.html#cb222-143" tabindex="-1"></a>              , label_pos</span>
<span id="cb222-144"><a href="stats_validation.html#cb222-144" tabindex="-1"></a>            ))) <span class="sc">%&gt;%</span> </span>
<span id="cb222-145"><a href="stats_validation.html#cb222-145" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">distinct</span>()</span>
<span id="cb222-146"><a href="stats_validation.html#cb222-146" tabindex="-1"></a>          , <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> .data[[label_pos]], <span class="at">label =</span> .data[[label]])</span>
<span id="cb222-147"><a href="stats_validation.html#cb222-147" tabindex="-1"></a>          , <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> label_size</span>
<span id="cb222-148"><a href="stats_validation.html#cb222-148" tabindex="-1"></a>        )<span class="sc">+</span></span>
<span id="cb222-149"><a href="stats_validation.html#cb222-149" tabindex="-1"></a>        <span class="fu">geom_text</span>(</span>
<span id="cb222-150"><a href="stats_validation.html#cb222-150" tabindex="-1"></a>          <span class="at">data =</span> my_data <span class="sc">%&gt;%</span></span>
<span id="cb222-151"><a href="stats_validation.html#cb222-151" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(pct_gt_zero_lab_pos<span class="sc">&lt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb222-152"><a href="stats_validation.html#cb222-152" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb222-153"><a href="stats_validation.html#cb222-153" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">select</span>(tidyselect<span class="sc">::</span><span class="fu">all_of</span>(<span class="fu">c</span>(</span>
<span id="cb222-154"><a href="stats_validation.html#cb222-154" tabindex="-1"></a>              y</span>
<span id="cb222-155"><a href="stats_validation.html#cb222-155" tabindex="-1"></a>              , fill</span>
<span id="cb222-156"><a href="stats_validation.html#cb222-156" tabindex="-1"></a>              , label</span>
<span id="cb222-157"><a href="stats_validation.html#cb222-157" tabindex="-1"></a>              , label_pos</span>
<span id="cb222-158"><a href="stats_validation.html#cb222-158" tabindex="-1"></a>            ))) <span class="sc">%&gt;%</span> </span>
<span id="cb222-159"><a href="stats_validation.html#cb222-159" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">distinct</span>()</span>
<span id="cb222-160"><a href="stats_validation.html#cb222-160" tabindex="-1"></a>          , <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> .data[[label_pos]], <span class="at">label =</span> .data[[label]])</span>
<span id="cb222-161"><a href="stats_validation.html#cb222-161" tabindex="-1"></a>          , <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="sc">+</span><span class="dv">1</span>, <span class="at">size =</span> label_size</span>
<span id="cb222-162"><a href="stats_validation.html#cb222-162" tabindex="-1"></a>        )</span>
<span id="cb222-163"><a href="stats_validation.html#cb222-163" tabindex="-1"></a>    )</span>
<span id="cb222-164"><a href="stats_validation.html#cb222-164" tabindex="-1"></a>  }</span>
<span id="cb222-165"><a href="stats_validation.html#cb222-165" tabindex="-1"></a>}</span>
<span id="cb222-166"><a href="stats_validation.html#cb222-166" tabindex="-1"></a><span class="co"># plt_contrast(brms_contrast_temp, label = &quot;pct_gt_zero_lab_sm&quot;)</span></span></code></pre></div>
<p>We’ll also create a function to create all of the probability labeling columns in the contrast data called <code>make_contrast_vars()</code></p>
<p>Note, here we use <code>tidybayes::median_hdci()</code> to avoid potential for returning multiple rows by group if our data is grouped. See the <a href="https://search.r-project.org/CRAN/refmans/ggdist/html/point_interval.html">documentation</a> for the <code>ggdist</code> package which notes that “If the distribution is multimodal, hdi may return multiple intervals for each probability level (these will be spread over rows).”</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="stats_validation.html#cb223-1" tabindex="-1"></a>make_contrast_vars <span class="ot">=</span> <span class="cf">function</span>(my_data){</span>
<span id="cb223-2"><a href="stats_validation.html#cb223-2" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span></span>
<span id="cb223-3"><a href="stats_validation.html#cb223-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb223-4"><a href="stats_validation.html#cb223-4" tabindex="-1"></a>      <span class="co"># get median_hdi</span></span>
<span id="cb223-5"><a href="stats_validation.html#cb223-5" tabindex="-1"></a>      <span class="at">median_hdi_est =</span> tidybayes<span class="sc">::</span><span class="fu">median_hdci</span>(value)<span class="sc">$</span>y</span>
<span id="cb223-6"><a href="stats_validation.html#cb223-6" tabindex="-1"></a>      , <span class="at">median_hdi_lower =</span> tidybayes<span class="sc">::</span><span class="fu">median_hdci</span>(value)<span class="sc">$</span>ymin</span>
<span id="cb223-7"><a href="stats_validation.html#cb223-7" tabindex="-1"></a>      , <span class="at">median_hdi_upper =</span> tidybayes<span class="sc">::</span><span class="fu">median_hdci</span>(value)<span class="sc">$</span>ymax</span>
<span id="cb223-8"><a href="stats_validation.html#cb223-8" tabindex="-1"></a>      <span class="co"># check probability that this direction is true</span></span>
<span id="cb223-9"><a href="stats_validation.html#cb223-9" tabindex="-1"></a>      , <span class="at">is_gt_zero =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb223-10"><a href="stats_validation.html#cb223-10" tabindex="-1"></a>        median_hdi_est <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> value <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb223-11"><a href="stats_validation.html#cb223-11" tabindex="-1"></a>        , median_hdi_est <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> value <span class="sc">&lt;</span> <span class="dv">0</span></span>
<span id="cb223-12"><a href="stats_validation.html#cb223-12" tabindex="-1"></a>      )</span>
<span id="cb223-13"><a href="stats_validation.html#cb223-13" tabindex="-1"></a>      , <span class="at">pct_gt_zero =</span> <span class="fu">mean</span>(is_gt_zero)</span>
<span id="cb223-14"><a href="stats_validation.html#cb223-14" tabindex="-1"></a>      <span class="co"># make a label</span></span>
<span id="cb223-15"><a href="stats_validation.html#cb223-15" tabindex="-1"></a>      , <span class="at">pct_gt_zero_lab =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb223-16"><a href="stats_validation.html#cb223-16" tabindex="-1"></a>          median_hdi_est <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="fu">paste0</span>(</span>
<span id="cb223-17"><a href="stats_validation.html#cb223-17" tabindex="-1"></a>            <span class="st">&quot;Pr(&quot;</span></span>
<span id="cb223-18"><a href="stats_validation.html#cb223-18" tabindex="-1"></a>            , stringr<span class="sc">::</span><span class="fu">word</span>(contrast, <span class="dv">1</span>, <span class="at">sep =</span> <span class="fu">fixed</span>(<span class="st">&quot;-&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb223-19"><a href="stats_validation.html#cb223-19" tabindex="-1"></a>              stringr<span class="sc">::</span><span class="fu">str_squish</span>()</span>
<span id="cb223-20"><a href="stats_validation.html#cb223-20" tabindex="-1"></a>            , <span class="st">&quot;&gt;&quot;</span></span>
<span id="cb223-21"><a href="stats_validation.html#cb223-21" tabindex="-1"></a>            , stringr<span class="sc">::</span><span class="fu">word</span>(contrast, <span class="dv">2</span>, <span class="at">sep =</span> <span class="fu">fixed</span>(<span class="st">&quot;-&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb223-22"><a href="stats_validation.html#cb223-22" tabindex="-1"></a>              stringr<span class="sc">::</span><span class="fu">str_squish</span>()</span>
<span id="cb223-23"><a href="stats_validation.html#cb223-23" tabindex="-1"></a>            , <span class="st">&quot;)=&quot;</span></span>
<span id="cb223-24"><a href="stats_validation.html#cb223-24" tabindex="-1"></a>            , pct_gt_zero <span class="sc">%&gt;%</span> scales<span class="sc">::</span><span class="fu">percent</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)</span>
<span id="cb223-25"><a href="stats_validation.html#cb223-25" tabindex="-1"></a>          )</span>
<span id="cb223-26"><a href="stats_validation.html#cb223-26" tabindex="-1"></a>          , median_hdi_est <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="fu">paste0</span>(</span>
<span id="cb223-27"><a href="stats_validation.html#cb223-27" tabindex="-1"></a>            <span class="st">&quot;Pr(&quot;</span></span>
<span id="cb223-28"><a href="stats_validation.html#cb223-28" tabindex="-1"></a>            , stringr<span class="sc">::</span><span class="fu">word</span>(contrast, <span class="dv">2</span>, <span class="at">sep =</span> <span class="fu">fixed</span>(<span class="st">&quot;-&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb223-29"><a href="stats_validation.html#cb223-29" tabindex="-1"></a>              stringr<span class="sc">::</span><span class="fu">str_squish</span>()</span>
<span id="cb223-30"><a href="stats_validation.html#cb223-30" tabindex="-1"></a>            , <span class="st">&quot;&gt;&quot;</span></span>
<span id="cb223-31"><a href="stats_validation.html#cb223-31" tabindex="-1"></a>            , stringr<span class="sc">::</span><span class="fu">word</span>(contrast, <span class="dv">1</span>, <span class="at">sep =</span> <span class="fu">fixed</span>(<span class="st">&quot;-&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb223-32"><a href="stats_validation.html#cb223-32" tabindex="-1"></a>              stringr<span class="sc">::</span><span class="fu">str_squish</span>()</span>
<span id="cb223-33"><a href="stats_validation.html#cb223-33" tabindex="-1"></a>            , <span class="st">&quot;)=&quot;</span></span>
<span id="cb223-34"><a href="stats_validation.html#cb223-34" tabindex="-1"></a>            , pct_gt_zero <span class="sc">%&gt;%</span> scales<span class="sc">::</span><span class="fu">percent</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)</span>
<span id="cb223-35"><a href="stats_validation.html#cb223-35" tabindex="-1"></a>          )</span>
<span id="cb223-36"><a href="stats_validation.html#cb223-36" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span> </span>
<span id="cb223-37"><a href="stats_validation.html#cb223-37" tabindex="-1"></a>        stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;OPENDRONEMAP&quot;</span>, <span class="st">&quot;ODM&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb223-38"><a href="stats_validation.html#cb223-38" tabindex="-1"></a>        stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;METASHAPE&quot;</span>, <span class="st">&quot;MtaShp&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb223-39"><a href="stats_validation.html#cb223-39" tabindex="-1"></a>        stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;PIX4D&quot;</span>, <span class="st">&quot;Pix4D&quot;</span>)</span>
<span id="cb223-40"><a href="stats_validation.html#cb223-40" tabindex="-1"></a>      <span class="co"># make a SMALLER label</span></span>
<span id="cb223-41"><a href="stats_validation.html#cb223-41" tabindex="-1"></a>      , <span class="at">pct_gt_zero_lab_sm =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb223-42"><a href="stats_validation.html#cb223-42" tabindex="-1"></a>        median_hdi_est <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">~</span> <span class="fu">paste0</span>(</span>
<span id="cb223-43"><a href="stats_validation.html#cb223-43" tabindex="-1"></a>          <span class="st">&quot;Pr(&gt;0)=&quot;</span></span>
<span id="cb223-44"><a href="stats_validation.html#cb223-44" tabindex="-1"></a>          , pct_gt_zero <span class="sc">%&gt;%</span> scales<span class="sc">::</span><span class="fu">percent</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)</span>
<span id="cb223-45"><a href="stats_validation.html#cb223-45" tabindex="-1"></a>        )</span>
<span id="cb223-46"><a href="stats_validation.html#cb223-46" tabindex="-1"></a>        , median_hdi_est <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="fu">paste0</span>(</span>
<span id="cb223-47"><a href="stats_validation.html#cb223-47" tabindex="-1"></a>          <span class="st">&quot;Pr(&lt;0)=&quot;</span></span>
<span id="cb223-48"><a href="stats_validation.html#cb223-48" tabindex="-1"></a>          , pct_gt_zero <span class="sc">%&gt;%</span> scales<span class="sc">::</span><span class="fu">percent</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)</span>
<span id="cb223-49"><a href="stats_validation.html#cb223-49" tabindex="-1"></a>        )</span>
<span id="cb223-50"><a href="stats_validation.html#cb223-50" tabindex="-1"></a>      )</span>
<span id="cb223-51"><a href="stats_validation.html#cb223-51" tabindex="-1"></a>      , <span class="at">pct_gt_zero_lab_pos =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb223-52"><a href="stats_validation.html#cb223-52" tabindex="-1"></a>        median_hdi_est <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> median_hdi_upper</span>
<span id="cb223-53"><a href="stats_validation.html#cb223-53" tabindex="-1"></a>        , median_hdi_est <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> median_hdi_lower</span>
<span id="cb223-54"><a href="stats_validation.html#cb223-54" tabindex="-1"></a>      ) <span class="sc">*</span> <span class="fl">1.075</span></span>
<span id="cb223-55"><a href="stats_validation.html#cb223-55" tabindex="-1"></a>      , <span class="at">sig_level =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb223-56"><a href="stats_validation.html#cb223-56" tabindex="-1"></a>        pct_gt_zero <span class="sc">&gt;</span> <span class="fl">0.99</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb223-57"><a href="stats_validation.html#cb223-57" tabindex="-1"></a>        , pct_gt_zero <span class="sc">&gt;</span> <span class="fl">0.95</span> <span class="sc">~</span> <span class="dv">1</span></span>
<span id="cb223-58"><a href="stats_validation.html#cb223-58" tabindex="-1"></a>        , pct_gt_zero <span class="sc">&gt;</span> <span class="fl">0.9</span> <span class="sc">~</span> <span class="dv">2</span></span>
<span id="cb223-59"><a href="stats_validation.html#cb223-59" tabindex="-1"></a>        , pct_gt_zero <span class="sc">&gt;</span> <span class="fl">0.8</span> <span class="sc">~</span> <span class="dv">3</span></span>
<span id="cb223-60"><a href="stats_validation.html#cb223-60" tabindex="-1"></a>        , T <span class="sc">~</span> <span class="dv">4</span></span>
<span id="cb223-61"><a href="stats_validation.html#cb223-61" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb223-62"><a href="stats_validation.html#cb223-62" tabindex="-1"></a>      <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&gt;99%&quot;</span>,<span class="st">&quot;95%&quot;</span>,<span class="st">&quot;90%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;&lt;80%&quot;</span>), <span class="at">ordered =</span> T)</span>
<span id="cb223-63"><a href="stats_validation.html#cb223-63" tabindex="-1"></a>    )</span>
<span id="cb223-64"><a href="stats_validation.html#cb223-64" tabindex="-1"></a>}</span>
<span id="cb223-65"><a href="stats_validation.html#cb223-65" tabindex="-1"></a><span class="co"># brms_contrast_temp %&gt;% dplyr::group_by(contrast) %&gt;% make_contrast_vars() %&gt;% dplyr::glimpse()</span></span></code></pre></div>
</div>
</div>
<div id="f_two_pred_mod" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Two Nominal Predictors<a href="stats_validation.html#f_two_pred_mod" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now, we’ll determine the combined influence of the depth map generation quality and the depth map filtering parameters on the SfM-derived tree detection performance based on the F-score.</p>
<div id="summary-statistics-6" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Summary Statistics<a href="stats_validation.html#summary-statistics-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Summary statistics by group:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="stats_validation.html#cb224-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb224-2"><a href="stats_validation.html#cb224-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(depth_maps_generation_quality, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb224-3"><a href="stats_validation.html#cb224-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb224-4"><a href="stats_validation.html#cb224-4" tabindex="-1"></a>    <span class="at">mean_f_score =</span> <span class="fu">mean</span>(f_score, <span class="at">na.rm =</span> T)</span>
<span id="cb224-5"><a href="stats_validation.html#cb224-5" tabindex="-1"></a>    <span class="co"># , med_f_score = median(f_score, na.rm = T)</span></span>
<span id="cb224-6"><a href="stats_validation.html#cb224-6" tabindex="-1"></a>    , <span class="at">sd_f_score =</span> <span class="fu">sd</span>(f_score, <span class="at">na.rm =</span> T)</span>
<span id="cb224-7"><a href="stats_validation.html#cb224-7" tabindex="-1"></a>    , <span class="at">n =</span> dplyr<span class="sc">::</span><span class="fu">n</span>()</span>
<span id="cb224-8"><a href="stats_validation.html#cb224-8" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb224-9"><a href="stats_validation.html#cb224-9" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb224-10"><a href="stats_validation.html#cb224-10" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb224-11"><a href="stats_validation.html#cb224-11" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;summary statistics: F-score by dense cloud quality and filtering mode&quot;</span></span>
<span id="cb224-12"><a href="stats_validation.html#cb224-12" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb224-13"><a href="stats_validation.html#cb224-13" tabindex="-1"></a>      <span class="st">&quot;quality&quot;</span></span>
<span id="cb224-14"><a href="stats_validation.html#cb224-14" tabindex="-1"></a>      , <span class="st">&quot;filtering mode&quot;</span></span>
<span id="cb224-15"><a href="stats_validation.html#cb224-15" tabindex="-1"></a>      , <span class="st">&quot;mean F-score&quot;</span></span>
<span id="cb224-16"><a href="stats_validation.html#cb224-16" tabindex="-1"></a>      , <span class="st">&quot;sd&quot;</span></span>
<span id="cb224-17"><a href="stats_validation.html#cb224-17" tabindex="-1"></a>      , <span class="st">&quot;n&quot;</span></span>
<span id="cb224-18"><a href="stats_validation.html#cb224-18" tabindex="-1"></a>    )</span>
<span id="cb224-19"><a href="stats_validation.html#cb224-19" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb224-20"><a href="stats_validation.html#cb224-20" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb224-21"><a href="stats_validation.html#cb224-21" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;6in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:6in; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-154">Table 6.5: </span>summary statistics: F-score by dense cloud quality and filtering mode
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
quality
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
filtering mode
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mean F-score
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
sd
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.52
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
medium
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
medium
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
medium
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
medium
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.48
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.37
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.46
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
lowest
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
lowest
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
lowest
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
lowest
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
10
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="f_two_pred_mod_bays" class="section level3 hasAnchor" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Bayesian<a href="stats_validation.html#f_two_pred_mod_bays" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://sites.google.com/site/doingbayesiandataanalysis/">Kruschke (2015)</a> describes the Hierarchical Bayesian approach to describe groups of metric data with multiple nominal predictors:</p>
<blockquote>
<p>This chapter considers data structures that consist of a metric predicted variable and two (or more) nominal predictors….The traditional treatment of this sort of data structure is called multifactor analysis of variance (ANOVA). Our Bayesian approach will be a hierarchical generalization of the traditional ANOVA model. The chapter also considers generalizations of the traditional models, because it is straight forward in Bayesian software to implement heavy-tailed distributions to accommodate outliers, along with hierarchical structure to accommodate heterogeneous variances in the different groups. (pp. 583–584)</p>
</blockquote>
<p>and see section 20 from <a href="https://bookdown.org/content/3686/metric-predicted-variable-with-multiple-nominal-predictors.html">Kurz’s ebook supplement</a></p>
<p>The metric predicted variable with two nominal predictor variables model has the form:</p>
<p><span class="math display">\[\begin{align*}
y_{i}  &amp;\sim {\sf Normal} \bigl(\mu_{i}, \sigma_{y} \bigr) \\
\mu_{i} &amp;= \beta_0 + \sum_{j} \beta_{1[j]} x_{1[j]} + \sum_{k} \beta_{2[k]} x_{2[k]}  + \sum_{j,k} \beta_{1\times2[j,k]} x_{1\times2[j,k]} \\
\beta_{0}  &amp;\sim {\sf Normal} (0,100) \\
\beta_{1[j]}  &amp;\sim {\sf Normal} (0,\sigma_{\beta_{1}}) \\
\beta_{2[k]}  &amp;\sim {\sf Normal} (0,\sigma_{\beta_{2}}) \\
\beta_{1\times2[j,k]}  &amp;\sim {\sf Normal} (0,\sigma_{\beta_{1\times2}}) \\
\sigma_{\beta_{1}} &amp;\sim {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{2}} &amp;\sim {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{1\times2}} &amp;\sim {\sf Gamma} (1.28,0.005) \\
\sigma_{y} &amp;\sim {\sf Cauchy} (0,109) \\
\end{align*}\]</span></p>
<p>, where <span class="math inline">\(j\)</span> is the depth map generation quality setting corresponding to observation <span class="math inline">\(i\)</span> and <span class="math inline">\(k\)</span> is the depth map filtering mode setting corresponding to observation <span class="math inline">\(i\)</span></p>
<p><em>for this model, we’ll define the priors following <a href="https://bookdown.org/content/3686/metric-predicted-variable-with-multiple-nominal-predictors.html#implementation-in-jags-brms.-1">Kurz</a></em> who notes that:</p>
<blockquote>
<p>The noise standard deviation <span class="math inline">\(\sigma_y\)</span> is depicted in the prior statement including the argument <code>class = sigma</code>…in order to be weakly informative, we will use the half-Cauchy. Recall that since the brms default is to set the lower bound for any variance parameter to 0, there’s no need to worry about doing so ourselves. So even though the syntax only indicates <code>cauchy</code>, it’s understood to mean Cauchy with a lower bound at zero; since the mean is usually 0, that makes this a half-Cauchy…The tails of the half-Cauchy are sufficiently fat that, in practice, I’ve found it doesn’t matter much what you set the <span class="math inline">\(SD\)</span> of its prior to.</p>
</blockquote>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="stats_validation.html#cb225-1" tabindex="-1"></a><span class="co"># from Kurz: </span></span>
<span id="cb225-2"><a href="stats_validation.html#cb225-2" tabindex="-1"></a>gamma_a_b_from_omega_sigma <span class="ot">=</span> <span class="cf">function</span>(mode, sd) {</span>
<span id="cb225-3"><a href="stats_validation.html#cb225-3" tabindex="-1"></a>  <span class="cf">if</span> (mode <span class="sc">&lt;=</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">&quot;mode must be &gt; 0&quot;</span>)</span>
<span id="cb225-4"><a href="stats_validation.html#cb225-4" tabindex="-1"></a>  <span class="cf">if</span> (sd   <span class="sc">&lt;=</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">&quot;sd must be &gt; 0&quot;</span>)</span>
<span id="cb225-5"><a href="stats_validation.html#cb225-5" tabindex="-1"></a>  rate <span class="ot">=</span> (mode <span class="sc">+</span> <span class="fu">sqrt</span>(mode<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sd<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sd<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb225-6"><a href="stats_validation.html#cb225-6" tabindex="-1"></a>  shape <span class="ot">=</span> <span class="dv">1</span> <span class="sc">+</span> mode <span class="sc">*</span> rate</span>
<span id="cb225-7"><a href="stats_validation.html#cb225-7" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">shape =</span> shape, <span class="at">rate =</span> rate))</span>
<span id="cb225-8"><a href="stats_validation.html#cb225-8" tabindex="-1"></a>}</span>
<span id="cb225-9"><a href="stats_validation.html#cb225-9" tabindex="-1"></a></span>
<span id="cb225-10"><a href="stats_validation.html#cb225-10" tabindex="-1"></a>mean_y_temp <span class="ot">=</span> <span class="fu">mean</span>(ptcld_validation_data<span class="sc">$</span>f_score)</span>
<span id="cb225-11"><a href="stats_validation.html#cb225-11" tabindex="-1"></a>sd_y_temp   <span class="ot">=</span> <span class="fu">sd</span>(ptcld_validation_data<span class="sc">$</span>f_score)</span>
<span id="cb225-12"><a href="stats_validation.html#cb225-12" tabindex="-1"></a></span>
<span id="cb225-13"><a href="stats_validation.html#cb225-13" tabindex="-1"></a>omega_temp <span class="ot">=</span> sd_y_temp <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb225-14"><a href="stats_validation.html#cb225-14" tabindex="-1"></a>sigma_temp <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> sd_y_temp</span>
<span id="cb225-15"><a href="stats_validation.html#cb225-15" tabindex="-1"></a></span>
<span id="cb225-16"><a href="stats_validation.html#cb225-16" tabindex="-1"></a>s_r_temp <span class="ot">=</span> <span class="fu">gamma_a_b_from_omega_sigma</span>(<span class="at">mode =</span> omega_temp, <span class="at">sd =</span> sigma_temp)</span>
<span id="cb225-17"><a href="stats_validation.html#cb225-17" tabindex="-1"></a></span>
<span id="cb225-18"><a href="stats_validation.html#cb225-18" tabindex="-1"></a>stanvars_temp <span class="ot">=</span> </span>
<span id="cb225-19"><a href="stats_validation.html#cb225-19" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">stanvar</span>(mean_y_temp,    <span class="at">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="sc">+</span> </span>
<span id="cb225-20"><a href="stats_validation.html#cb225-20" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">stanvar</span>(sd_y_temp,      <span class="at">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb225-21"><a href="stats_validation.html#cb225-21" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">stanvar</span>(s_r_temp<span class="sc">$</span>shape, <span class="at">name =</span> <span class="st">&quot;alpha&quot;</span>) <span class="sc">+</span></span>
<span id="cb225-22"><a href="stats_validation.html#cb225-22" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">stanvar</span>(s_r_temp<span class="sc">$</span>rate,  <span class="at">name =</span> <span class="st">&quot;beta&quot;</span>)</span></code></pre></div>
<p>Now fit the model.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="stats_validation.html#cb226-1" tabindex="-1"></a>brms_f_mod2 <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb226-2"><a href="stats_validation.html#cb226-2" tabindex="-1"></a>  <span class="at">formula =</span> f_score <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb226-3"><a href="stats_validation.html#cb226-3" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span></span>
<span id="cb226-4"><a href="stats_validation.html#cb226-4" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode) <span class="sc">+</span> </span>
<span id="cb226-5"><a href="stats_validation.html#cb226-5" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode)</span>
<span id="cb226-6"><a href="stats_validation.html#cb226-6" tabindex="-1"></a>  , <span class="at">data =</span> ptcld_validation_data</span>
<span id="cb226-7"><a href="stats_validation.html#cb226-7" tabindex="-1"></a>  , <span class="at">family =</span> brms<span class="sc">::</span><span class="fu">brmsfamily</span>(<span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>)</span>
<span id="cb226-8"><a href="stats_validation.html#cb226-8" tabindex="-1"></a>  , <span class="at">iter =</span> <span class="dv">6000</span>, <span class="at">warmup =</span> <span class="dv">3000</span>, <span class="at">chains =</span> <span class="dv">4</span></span>
<span id="cb226-9"><a href="stats_validation.html#cb226-9" tabindex="-1"></a>  , <span class="at">cores =</span> <span class="fu">round</span>(parallel<span class="sc">::</span><span class="fu">detectCores</span>()<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb226-10"><a href="stats_validation.html#cb226-10" tabindex="-1"></a>  , <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb226-11"><a href="stats_validation.html#cb226-11" tabindex="-1"></a>    brms<span class="sc">::</span><span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">5</span>), <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>)</span>
<span id="cb226-12"><a href="stats_validation.html#cb226-12" tabindex="-1"></a>    , brms<span class="sc">::</span><span class="fu">prior</span>(<span class="fu">gamma</span>(alpha, beta), <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>)</span>
<span id="cb226-13"><a href="stats_validation.html#cb226-13" tabindex="-1"></a>    , brms<span class="sc">::</span><span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>)</span>
<span id="cb226-14"><a href="stats_validation.html#cb226-14" tabindex="-1"></a>  )</span>
<span id="cb226-15"><a href="stats_validation.html#cb226-15" tabindex="-1"></a>  , <span class="at">stanvars =</span> stanvars_temp</span>
<span id="cb226-16"><a href="stats_validation.html#cb226-16" tabindex="-1"></a>  , <span class="at">file =</span> <span class="fu">paste0</span>(rootdir, <span class="st">&quot;/fits/brms_f_mod2&quot;</span>)</span>
<span id="cb226-17"><a href="stats_validation.html#cb226-17" tabindex="-1"></a>)</span></code></pre></div>
<p>check the trace plots for problems with convergence of the Markov chains</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="stats_validation.html#cb227-1" tabindex="-1"></a><span class="fu">plot</span>(brms_f_mod2)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-157-1.png" width="1008" /></p>
<p>check the prior distributions</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="stats_validation.html#cb228-1" tabindex="-1"></a><span class="co"># check priors</span></span>
<span id="cb228-2"><a href="stats_validation.html#cb228-2" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">prior_summary</span>(brms_f_mod2) <span class="sc">%&gt;%</span> </span>
<span id="cb228-3"><a href="stats_validation.html#cb228-3" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb228-4"><a href="stats_validation.html#cb228-4" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
prior
</th>
<th style="text-align:left;">
class
</th>
<th style="text-align:left;">
coef
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
resp
</th>
<th style="text-align:left;">
dpar
</th>
<th style="text-align:left;">
nlpar
</th>
<th style="text-align:left;">
lb
</th>
<th style="text-align:left;">
ub
</th>
<th style="text-align:left;">
source
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
normal(mean_y, sd_y * 5)
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
user
</td>
</tr>
<tr>
<td style="text-align:left;">
gamma(alpha, beta)
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
user
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_filtering_mode
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_filtering_mode
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_quality
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_quality
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_quality:depth_maps_generation_filtering_mode
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_quality:depth_maps_generation_filtering_mode
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
cauchy(0, sd_y)
</td>
<td style="text-align:left;">
sigma
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
user
</td>
</tr>
</tbody>
</table>
<p>The <code>brms::brm</code> model summary</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="stats_validation.html#cb229-1" tabindex="-1"></a>brms_f_mod2 <span class="sc">%&gt;%</span> </span>
<span id="cb229-2"><a href="stats_validation.html#cb229-2" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">posterior_summary</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb229-3"><a href="stats_validation.html#cb229-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb229-4"><a href="stats_validation.html#cb229-4" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameter&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb229-5"><a href="stats_validation.html#cb229-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(tolower) <span class="sc">%&gt;%</span> </span>
<span id="cb229-6"><a href="stats_validation.html#cb229-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb229-7"><a href="stats_validation.html#cb229-7" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_starts</span>(parameter, <span class="st">&quot;b_&quot;</span>) </span>
<span id="cb229-8"><a href="stats_validation.html#cb229-8" tabindex="-1"></a>    <span class="sc">|</span> stringr<span class="sc">::</span><span class="fu">str_starts</span>(parameter, <span class="st">&quot;r_&quot;</span>) </span>
<span id="cb229-9"><a href="stats_validation.html#cb229-9" tabindex="-1"></a>    <span class="sc">|</span> stringr<span class="sc">::</span><span class="fu">str_starts</span>(parameter, <span class="st">&quot;sd_&quot;</span>) </span>
<span id="cb229-10"><a href="stats_validation.html#cb229-10" tabindex="-1"></a>    <span class="sc">|</span> parameter <span class="sc">==</span> <span class="st">&quot;sigma&quot;</span></span>
<span id="cb229-11"><a href="stats_validation.html#cb229-11" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb229-12"><a href="stats_validation.html#cb229-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb229-13"><a href="stats_validation.html#cb229-13" tabindex="-1"></a>    <span class="at">parameter =</span> parameter <span class="sc">%&gt;%</span> </span>
<span id="cb229-14"><a href="stats_validation.html#cb229-14" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_quality&quot;</span>, <span class="st">&quot;quality&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb229-15"><a href="stats_validation.html#cb229-15" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span>, <span class="st">&quot;filtering&quot;</span>)</span>
<span id="cb229-16"><a href="stats_validation.html#cb229-16" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb229-17"><a href="stats_validation.html#cb229-17" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">2</span>, <span class="at">caption =</span> <span class="st">&quot;Bayesian two nominal predictors: F-score by dense cloud quality and filtering mode&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb229-18"><a href="stats_validation.html#cb229-18" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb229-19"><a href="stats_validation.html#cb229-19" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;6in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:6in; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-159">Table 6.6: </span>Bayesian two nominal predictors: F-score by dense cloud quality and filtering mode
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
parameter
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
est.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
q2.5
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
q97.5
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
b_Intercept
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.63
</td>
</tr>
<tr>
<td style="text-align:left;">
sd_filtering__Intercept
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
<tr>
<td style="text-align:left;">
sd_quality__Intercept
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.39
</td>
</tr>
<tr>
<td style="text-align:left;">
sd_quality:filtering__Intercept
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;">
r_filtering[aggressive,Intercept]
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
r_filtering[moderate,Intercept]
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.08
</td>
</tr>
<tr>
<td style="text-align:left;">
r_filtering[mild,Intercept]
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
r_filtering[disabled,Intercept]
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.10
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality[ultra.high,Intercept]
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.29
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality[high,Intercept]
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality[medium,Intercept]
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.15
</td>
<td style="text-align:right;">
0.18
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality[low,Intercept]
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.22
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality[lowest,Intercept]
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.34
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality:filtering[high_aggressive,Intercept]
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality:filtering[high_disabled,Intercept]
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality:filtering[high_mild,Intercept]
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality:filtering[high_moderate,Intercept]
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality:filtering[low_aggressive,Intercept]
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.03
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality:filtering[low_disabled,Intercept]
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.06
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality:filtering[low_mild,Intercept]
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.06
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality:filtering[low_moderate,Intercept]
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.04
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality:filtering[lowest_aggressive,Intercept]
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.04
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality:filtering[lowest_disabled,Intercept]
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality:filtering[lowest_mild,Intercept]
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality:filtering[lowest_moderate,Intercept]
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.04
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality:filtering[medium_aggressive,Intercept]
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.04
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality:filtering[medium_disabled,Intercept]
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality:filtering[medium_mild,Intercept]
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality:filtering[medium_moderate,Intercept]
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality:filtering[ultra.high_aggressive,Intercept]
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.06
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality:filtering[ultra.high_disabled,Intercept]
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.04
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality:filtering[ultra.high_mild,Intercept]
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
r_quality:filtering[ultra.high_moderate,Intercept]
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
</tbody>
</table>
</div>
<p>We can look at the model noise standard deviation <span class="math inline">\(\sigma_y\)</span></p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="stats_validation.html#cb230-1" tabindex="-1"></a><span class="co"># get formula</span></span>
<span id="cb230-2"><a href="stats_validation.html#cb230-2" tabindex="-1"></a>form_temp <span class="ot">=</span> brms_f_mod2<span class="sc">$</span>formula<span class="sc">$</span>formula[<span class="dv">3</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb230-3"><a href="stats_validation.html#cb230-3" tabindex="-1"></a>  <span class="fu">as.character</span>() <span class="sc">%&gt;%</span> <span class="fu">get_frmla_text</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb230-4"><a href="stats_validation.html#cb230-4" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_quality&quot;</span>, <span class="st">&quot;quality&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb230-5"><a href="stats_validation.html#cb230-5" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span>, <span class="st">&quot;filtering&quot;</span>)</span>
<span id="cb230-6"><a href="stats_validation.html#cb230-6" tabindex="-1"></a><span class="co"># extract the posterior draws</span></span>
<span id="cb230-7"><a href="stats_validation.html#cb230-7" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod2) <span class="sc">%&gt;%</span> </span>
<span id="cb230-8"><a href="stats_validation.html#cb230-8" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb230-9"><a href="stats_validation.html#cb230-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sigma, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb230-10"><a href="stats_validation.html#cb230-10" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_dotsinterval</span>(</span>
<span id="cb230-11"><a href="stats_validation.html#cb230-11" tabindex="-1"></a>    <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb230-12"><a href="stats_validation.html#cb230-12" tabindex="-1"></a>    , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.04</span></span>
<span id="cb230-13"><a href="stats_validation.html#cb230-13" tabindex="-1"></a>    , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_size =</span> <span class="dv">3</span></span>
<span id="cb230-14"><a href="stats_validation.html#cb230-14" tabindex="-1"></a>    , <span class="at">quantiles =</span> <span class="dv">100</span></span>
<span id="cb230-15"><a href="stats_validation.html#cb230-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb230-16"><a href="stats_validation.html#cb230-16" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb230-17"><a href="stats_validation.html#cb230-17" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb230-18"><a href="stats_validation.html#cb230-18" tabindex="-1"></a>    <span class="at">x =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">sigma_y$&quot;</span>)</span>
<span id="cb230-19"><a href="stats_validation.html#cb230-19" tabindex="-1"></a>    , <span class="at">caption =</span> form_temp</span>
<span id="cb230-20"><a href="stats_validation.html#cb230-20" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb230-21"><a href="stats_validation.html#cb230-21" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-160-1.png" width="1008" /></p>
<p>how is it compared to the first model?</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="stats_validation.html#cb231-1" tabindex="-1"></a><span class="co"># how is it compared to the first model</span></span>
<span id="cb231-2"><a href="stats_validation.html#cb231-2" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb231-3"><a href="stats_validation.html#cb231-3" tabindex="-1"></a>    brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod1) <span class="sc">%&gt;%</span> tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(sigma) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;one nominal predictor&quot;</span>)</span>
<span id="cb231-4"><a href="stats_validation.html#cb231-4" tabindex="-1"></a>    , brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod2) <span class="sc">%&gt;%</span> tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(sigma) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;two nominal predictor&quot;</span>)</span>
<span id="cb231-5"><a href="stats_validation.html#cb231-5" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb231-6"><a href="stats_validation.html#cb231-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb231-7"><a href="stats_validation.html#cb231-7" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">2</span>, <span class="at">caption =</span> <span class="st">&quot;brms::brm model noise standard deviation comparison&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb231-8"><a href="stats_validation.html#cb231-8" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-161">Table 6.7: </span>brms::brm model noise standard deviation comparison
</caption>
<thead>
<tr>
<th style="text-align:left;">
model
</th>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
.lower
</th>
<th style="text-align:right;">
.upper
</th>
<th style="text-align:right;">
.width
</th>
<th style="text-align:left;">
.point
</th>
<th style="text-align:left;">
.interval
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
one nominal predictor
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:left;">
median
</td>
<td style="text-align:left;">
hdi
</td>
</tr>
<tr>
<td style="text-align:left;">
two nominal predictor
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:left;">
median
</td>
<td style="text-align:left;">
hdi
</td>
</tr>
</tbody>
</table>
<p>plot the posterior predictive distributions of the conditional means with the median F-score and the 95% highest posterior density interval (HDI)</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="stats_validation.html#cb232-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb232-2"><a href="stats_validation.html#cb232-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb232-3"><a href="stats_validation.html#cb232-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(brms_f_mod2, <span class="at">allow_new_levels =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb232-4"><a href="stats_validation.html#cb232-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb232-5"><a href="stats_validation.html#cb232-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">depth_maps_generation_quality =</span> depth_maps_generation_quality <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb232-6"><a href="stats_validation.html#cb232-6" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb232-7"><a href="stats_validation.html#cb232-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb232-8"><a href="stats_validation.html#cb232-8" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb232-9"><a href="stats_validation.html#cb232-9" tabindex="-1"></a>      <span class="at">y =</span> value, <span class="at">x =</span> depth_maps_generation_filtering_mode</span>
<span id="cb232-10"><a href="stats_validation.html#cb232-10" tabindex="-1"></a>      , <span class="at">fill =</span> depth_maps_generation_filtering_mode</span>
<span id="cb232-11"><a href="stats_validation.html#cb232-11" tabindex="-1"></a>    )</span>
<span id="cb232-12"><a href="stats_validation.html#cb232-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb232-13"><a href="stats_validation.html#cb232-13" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_eye</span>(</span>
<span id="cb232-14"><a href="stats_validation.html#cb232-14" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb232-15"><a href="stats_validation.html#cb232-15" tabindex="-1"></a>      , <span class="at">slab_alpha =</span> <span class="fl">0.8</span></span>
<span id="cb232-16"><a href="stats_validation.html#cb232-16" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb232-17"><a href="stats_validation.html#cb232-17" tabindex="-1"></a>      , <span class="at">point_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_size =</span> <span class="dv">1</span></span>
<span id="cb232-18"><a href="stats_validation.html#cb232-18" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb232-19"><a href="stats_validation.html#cb232-19" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb232-20"><a href="stats_validation.html#cb232-20" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb232-21"><a href="stats_validation.html#cb232-21" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(depth_maps_generation_quality)) <span class="sc">+</span></span>
<span id="cb232-22"><a href="stats_validation.html#cb232-22" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb232-23"><a href="stats_validation.html#cb232-23" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">&quot;filtering mode&quot;</span>, <span class="at">y =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb232-24"><a href="stats_validation.html#cb232-24" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI</span><span class="sc">\n</span><span class="st">by dense cloud quality&quot;</span></span>
<span id="cb232-25"><a href="stats_validation.html#cb232-25" tabindex="-1"></a>      , <span class="at">fill =</span> <span class="st">&quot;Filtering Mode&quot;</span></span>
<span id="cb232-26"><a href="stats_validation.html#cb232-26" tabindex="-1"></a>      , <span class="at">caption =</span> form_temp</span>
<span id="cb232-27"><a href="stats_validation.html#cb232-27" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb232-28"><a href="stats_validation.html#cb232-28" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb232-29"><a href="stats_validation.html#cb232-29" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb232-30"><a href="stats_validation.html#cb232-30" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb232-31"><a href="stats_validation.html#cb232-31" tabindex="-1"></a>      , <span class="at">legend.direction  =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb232-32"><a href="stats_validation.html#cb232-32" tabindex="-1"></a>      , <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb232-33"><a href="stats_validation.html#cb232-33" tabindex="-1"></a>      , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb232-34"><a href="stats_validation.html#cb232-34" tabindex="-1"></a>    ) </span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-162-1.png" width="1008" /></p>
<p>we can also make pairwise comparisons</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="stats_validation.html#cb233-1" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span></span>
<span id="cb233-2"><a href="stats_validation.html#cb233-2" tabindex="-1"></a>  ptcld_validation_data <span class="sc">%&gt;%</span></span>
<span id="cb233-3"><a href="stats_validation.html#cb233-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb233-4"><a href="stats_validation.html#cb233-4" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(brms_f_mod2, <span class="at">allow_new_levels =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb233-5"><a href="stats_validation.html#cb233-5" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb233-6"><a href="stats_validation.html#cb233-6" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb233-7"><a href="stats_validation.html#cb233-7" tabindex="-1"></a>      value</span>
<span id="cb233-8"><a href="stats_validation.html#cb233-8" tabindex="-1"></a>      , <span class="at">by =</span> depth_maps_generation_quality</span>
<span id="cb233-9"><a href="stats_validation.html#cb233-9" tabindex="-1"></a>      , <span class="at">comparison =</span> </span>
<span id="cb233-10"><a href="stats_validation.html#cb233-10" tabindex="-1"></a>        contrast_list</span>
<span id="cb233-11"><a href="stats_validation.html#cb233-11" tabindex="-1"></a>        <span class="co"># tidybayes::emmeans_comparison(&quot;revpairwise&quot;) </span></span>
<span id="cb233-12"><a href="stats_validation.html#cb233-12" tabindex="-1"></a>        <span class="co">#&quot;pairwise&quot;</span></span>
<span id="cb233-13"><a href="stats_validation.html#cb233-13" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb233-14"><a href="stats_validation.html#cb233-14" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> depth_maps_generation_quality)</span>
<span id="cb233-15"><a href="stats_validation.html#cb233-15" tabindex="-1"></a></span>
<span id="cb233-16"><a href="stats_validation.html#cb233-16" tabindex="-1"></a><span class="co"># separate contrast</span></span>
<span id="cb233-17"><a href="stats_validation.html#cb233-17" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb233-18"><a href="stats_validation.html#cb233-18" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb233-19"><a href="stats_validation.html#cb233-19" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(</span>
<span id="cb233-20"><a href="stats_validation.html#cb233-20" tabindex="-1"></a>    <span class="at">cols =</span> contrast</span>
<span id="cb233-21"><a href="stats_validation.html#cb233-21" tabindex="-1"></a>    , <span class="at">delim =</span> <span class="st">&quot; - &quot;</span></span>
<span id="cb233-22"><a href="stats_validation.html#cb233-22" tabindex="-1"></a>    , <span class="at">names =</span> <span class="fu">paste0</span>(</span>
<span id="cb233-23"><a href="stats_validation.html#cb233-23" tabindex="-1"></a>        <span class="st">&quot;sorter&quot;</span></span>
<span id="cb233-24"><a href="stats_validation.html#cb233-24" tabindex="-1"></a>        , <span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(stringr<span class="sc">::</span><span class="fu">str_count</span>(brms_contrast_temp<span class="sc">$</span>contrast, <span class="st">&quot;-&quot;</span>))<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb233-25"><a href="stats_validation.html#cb233-25" tabindex="-1"></a>      )</span>
<span id="cb233-26"><a href="stats_validation.html#cb233-26" tabindex="-1"></a>    , <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span></span>
<span id="cb233-27"><a href="stats_validation.html#cb233-27" tabindex="-1"></a>    , <span class="at">cols_remove =</span> F</span>
<span id="cb233-28"><a href="stats_validation.html#cb233-28" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb233-29"><a href="stats_validation.html#cb233-29" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sorter1<span class="sc">!=</span>sorter2) <span class="sc">%&gt;%</span> </span>
<span id="cb233-30"><a href="stats_validation.html#cb233-30" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb233-31"><a href="stats_validation.html#cb233-31" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb233-32"><a href="stats_validation.html#cb233-32" tabindex="-1"></a>      tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sorter&quot;</span>)</span>
<span id="cb233-33"><a href="stats_validation.html#cb233-33" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="cf">function</span>(x){<span class="fu">factor</span>(</span>
<span id="cb233-34"><a href="stats_validation.html#cb233-34" tabindex="-1"></a>        x, <span class="at">ordered =</span> T</span>
<span id="cb233-35"><a href="stats_validation.html#cb233-35" tabindex="-1"></a>        , <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_quality)</span>
<span id="cb233-36"><a href="stats_validation.html#cb233-36" tabindex="-1"></a>      )}</span>
<span id="cb233-37"><a href="stats_validation.html#cb233-37" tabindex="-1"></a>    )</span>
<span id="cb233-38"><a href="stats_validation.html#cb233-38" tabindex="-1"></a>    , <span class="at">contrast =</span> contrast <span class="sc">%&gt;%</span> </span>
<span id="cb233-39"><a href="stats_validation.html#cb233-39" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb233-40"><a href="stats_validation.html#cb233-40" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="fu">as.numeric</span>(sorter1), <span class="fu">as.numeric</span>(sorter2)) <span class="sc">%&gt;%</span> </span>
<span id="cb233-41"><a href="stats_validation.html#cb233-41" tabindex="-1"></a>        <span class="fu">as.numeric</span>()</span>
<span id="cb233-42"><a href="stats_validation.html#cb233-42" tabindex="-1"></a>      )</span>
<span id="cb233-43"><a href="stats_validation.html#cb233-43" tabindex="-1"></a>    , <span class="at">depth_maps_generation_filtering_mode =</span> depth_maps_generation_filtering_mode <span class="sc">%&gt;%</span> </span>
<span id="cb233-44"><a href="stats_validation.html#cb233-44" tabindex="-1"></a>      <span class="fu">factor</span>(</span>
<span id="cb233-45"><a href="stats_validation.html#cb233-45" tabindex="-1"></a>        <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_filtering_mode)</span>
<span id="cb233-46"><a href="stats_validation.html#cb233-46" tabindex="-1"></a>        , <span class="at">ordered =</span> T</span>
<span id="cb233-47"><a href="stats_validation.html#cb233-47" tabindex="-1"></a>      )</span>
<span id="cb233-48"><a href="stats_validation.html#cb233-48" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb233-49"><a href="stats_validation.html#cb233-49" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb233-50"><a href="stats_validation.html#cb233-50" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb233-51"><a href="stats_validation.html#cb233-51" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb233-52"><a href="stats_validation.html#cb233-52" tabindex="-1"></a></span>
<span id="cb233-53"><a href="stats_validation.html#cb233-53" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb233-54"><a href="stats_validation.html#cb233-54" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 480,000
## Columns: 17
## Groups: contrast, depth_maps_generation_filtering_mode [40]
## $ depth_maps_generation_filtering_mode &lt;ord&gt; aggressive, aggressive, aggressiv…
## $ .chain                               &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ .iteration                           &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ .draw                                &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11…
## $ sorter1                              &lt;ord&gt; ultra high, ultra high, ultra hig…
## $ sorter2                              &lt;ord&gt; high, high, high, high, high, hig…
## $ contrast                             &lt;fct&gt; ultra high - high, ultra high - h…
## $ value                                &lt;dbl&gt; 0.078887252, 0.064029088, 0.02146…
## $ median_hdi_est                       &lt;dbl&gt; 0.03770622, 0.03770622, 0.0377062…
## $ median_hdi_lower                     &lt;dbl&gt; -0.05514285, -0.05514285, -0.0551…
## $ median_hdi_upper                     &lt;dbl&gt; 0.135536, 0.135536, 0.135536, 0.1…
## $ is_gt_zero                           &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, FAL…
## $ pct_gt_zero                          &lt;dbl&gt; 0.7908333, 0.7908333, 0.7908333, …
## $ pct_gt_zero_lab                      &lt;chr&gt; &quot;Pr(ultra high&gt;high)=79%&quot;, &quot;Pr(ul…
## $ pct_gt_zero_lab_sm                   &lt;chr&gt; &quot;Pr(&gt;0)=79%&quot;, &quot;Pr(&gt;0)=79%&quot;, &quot;Pr(&gt;…
## $ pct_gt_zero_lab_pos                  &lt;dbl&gt; 0.1457012, 0.1457012, 0.1457012, …
## $ sig_level                            &lt;ord&gt; &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80…</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="stats_validation.html#cb235-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb235-2"><a href="stats_validation.html#cb235-2" tabindex="-1"></a>  brms_contrast_temp, <span class="at">caption_text =</span> form_temp</span>
<span id="cb235-3"><a href="stats_validation.html#cb235-3" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;quality&quot;</span></span>
<span id="cb235-4"><a href="stats_validation.html#cb235-4" tabindex="-1"></a>  , <span class="at">facet =</span> <span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span></span>
<span id="cb235-5"><a href="stats_validation.html#cb235-5" tabindex="-1"></a>  , <span class="at">label_size =</span> <span class="fl">2.1</span></span>
<span id="cb235-6"><a href="stats_validation.html#cb235-6" tabindex="-1"></a>  , <span class="at">x_expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.65</span>)</span>
<span id="cb235-7"><a href="stats_validation.html#cb235-7" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb235-8"><a href="stats_validation.html#cb235-8" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb235-9"><a href="stats_validation.html#cb235-9" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of group constrasts with 95% &amp; 50% HDI</span><span class="sc">\n</span><span class="st">by filtering mode&quot;</span></span>
<span id="cb235-10"><a href="stats_validation.html#cb235-10" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-164-1.png" width="1008" /></p>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="stats_validation.html#cb236-1" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb236-2"><a href="stats_validation.html#cb236-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb236-3"><a href="stats_validation.html#cb236-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb236-4"><a href="stats_validation.html#cb236-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb236-5"><a href="stats_validation.html#cb236-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, depth_maps_generation_filtering_mode, value, .lower, .upper) <span class="sc">%&gt;%</span> </span>
<span id="cb236-6"><a href="stats_validation.html#cb236-6" tabindex="-1"></a>   </span>
<span id="cb236-7"><a href="stats_validation.html#cb236-7" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb236-8"><a href="stats_validation.html#cb236-8" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb236-9"><a href="stats_validation.html#cb236-9" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb236-10"><a href="stats_validation.html#cb236-10" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb236-11"><a href="stats_validation.html#cb236-11" tabindex="-1"></a>      <span class="st">&quot;quality contrast&quot;</span></span>
<span id="cb236-12"><a href="stats_validation.html#cb236-12" tabindex="-1"></a>      , <span class="st">&quot;filtering mode&quot;</span></span>
<span id="cb236-13"><a href="stats_validation.html#cb236-13" tabindex="-1"></a>      , <span class="st">&quot;difference (F-score)&quot;</span></span>
<span id="cb236-14"><a href="stats_validation.html#cb236-14" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb236-15"><a href="stats_validation.html#cb236-15" tabindex="-1"></a>    )</span>
<span id="cb236-16"><a href="stats_validation.html#cb236-16" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb236-17"><a href="stats_validation.html#cb236-17" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb236-18"><a href="stats_validation.html#cb236-18" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;6in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:6in; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-165">Table 6.8: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
quality contrast
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
filtering mode
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
difference (F-score)
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI low
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.14
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.13
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.13
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.21
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.27
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.26
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - lowest
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.39
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - lowest
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.39
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - lowest
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.28
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.38
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - lowest
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.28
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.38
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.15
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.15
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.16
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.21
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;">
high - lowest
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.36
</td>
</tr>
<tr>
<td style="text-align:left;">
high - lowest
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.35
</td>
</tr>
<tr>
<td style="text-align:left;">
high - lowest
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.35
</td>
</tr>
<tr>
<td style="text-align:left;">
high - lowest
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.35
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.16
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.15
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.15
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.15
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.28
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.28
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.28
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.28
</td>
</tr>
<tr>
<td style="text-align:left;">
low - lowest
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;">
low - lowest
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.21
</td>
</tr>
<tr>
<td style="text-align:left;">
low - lowest
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;">
low - lowest
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
</tbody>
</table>
</div>
<p><a href="https://sites.google.com/site/doingbayesiandataanalysis/">Kruschke (2015)</a> notes that for the multiple nominal predictors model:</p>
<blockquote>
<p>In applications with multiple levels of the factors, it is virtually always the case that we are interested in comparing particular levels with each other…These sorts of comparisons, which involve levels of a single factor and collapse across the other factor(s), are called main effect comparisons or contrasts.(p. 595)</p>
</blockquote>
<p>First, let’s collapse across the filtering mode to compare the dense cloud quality setting effect.
In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="stats_validation.html#cb237-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb237-2"><a href="stats_validation.html#cb237-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb237-3"><a href="stats_validation.html#cb237-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb237-4"><a href="stats_validation.html#cb237-4" tabindex="-1"></a>    brms_f_mod2</span>
<span id="cb237-5"><a href="stats_validation.html#cb237-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb237-6"><a href="stats_validation.html#cb237-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality)</span>
<span id="cb237-7"><a href="stats_validation.html#cb237-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb237-8"><a href="stats_validation.html#cb237-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb237-9"><a href="stats_validation.html#cb237-9" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb237-10"><a href="stats_validation.html#cb237-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb237-11"><a href="stats_validation.html#cb237-11" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb237-12"><a href="stats_validation.html#cb237-12" tabindex="-1"></a>      <span class="at">x =</span> value, <span class="at">y =</span> depth_maps_generation_quality</span>
<span id="cb237-13"><a href="stats_validation.html#cb237-13" tabindex="-1"></a>      , <span class="at">fill =</span> depth_maps_generation_quality</span>
<span id="cb237-14"><a href="stats_validation.html#cb237-14" tabindex="-1"></a>    )</span>
<span id="cb237-15"><a href="stats_validation.html#cb237-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb237-16"><a href="stats_validation.html#cb237-16" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb237-17"><a href="stats_validation.html#cb237-17" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb237-18"><a href="stats_validation.html#cb237-18" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;gray66&quot;</span></span>
<span id="cb237-19"><a href="stats_validation.html#cb237-19" tabindex="-1"></a>      , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_color =</span> <span class="st">&quot;gray66&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb237-20"><a href="stats_validation.html#cb237-20" tabindex="-1"></a>      , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb237-21"><a href="stats_validation.html#cb237-21" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb237-22"><a href="stats_validation.html#cb237-22" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;inferno&quot;</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb237-23"><a href="stats_validation.html#cb237-23" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb237-24"><a href="stats_validation.html#cb237-24" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb237-25"><a href="stats_validation.html#cb237-25" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;quality&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb237-26"><a href="stats_validation.html#cb237-26" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI&quot;</span></span>
<span id="cb237-27"><a href="stats_validation.html#cb237-27" tabindex="-1"></a>      , <span class="at">caption =</span> form_temp</span>
<span id="cb237-28"><a href="stats_validation.html#cb237-28" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb237-29"><a href="stats_validation.html#cb237-29" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb237-30"><a href="stats_validation.html#cb237-30" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-166-1.png" width="1008" /></p>
<p>let’s compare these results to the results from our <a href="stats_validation.html#f_one_pred_mod_bays">one nominal predictor model above</a></p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="stats_validation.html#cb238-1" tabindex="-1"></a><span class="co"># let&#39;s compare these results to the results from our [one nominal predictor model above](#one_pred_mod)</span></span>
<span id="cb238-2"><a href="stats_validation.html#cb238-2" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb238-3"><a href="stats_validation.html#cb238-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb238-4"><a href="stats_validation.html#cb238-4" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb238-5"><a href="stats_validation.html#cb238-5" tabindex="-1"></a>    brms_f_mod2</span>
<span id="cb238-6"><a href="stats_validation.html#cb238-6" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb238-7"><a href="stats_validation.html#cb238-7" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality)</span>
<span id="cb238-8"><a href="stats_validation.html#cb238-8" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb238-9"><a href="stats_validation.html#cb238-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb238-10"><a href="stats_validation.html#cb238-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb238-11"><a href="stats_validation.html#cb238-11" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb238-12"><a href="stats_validation.html#cb238-12" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb238-13"><a href="stats_validation.html#cb238-13" tabindex="-1"></a>      tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(brms_f_mod1) <span class="sc">%&gt;%</span> </span>
<span id="cb238-14"><a href="stats_validation.html#cb238-14" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod1&quot;</span>)</span>
<span id="cb238-15"><a href="stats_validation.html#cb238-15" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb238-16"><a href="stats_validation.html#cb238-16" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> src, <span class="at">x =</span> value, <span class="at">color =</span> src, <span class="at">group =</span> src)) <span class="sc">+</span></span>
<span id="cb238-17"><a href="stats_validation.html#cb238-17" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_pointinterval</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb238-18"><a href="stats_validation.html#cb238-18" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(depth_maps_generation_quality), <span class="at">switch =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb238-19"><a href="stats_validation.html#cb238-19" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb238-20"><a href="stats_validation.html#cb238-20" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> viridis<span class="sc">::</span><span class="fu">turbo</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb238-21"><a href="stats_validation.html#cb238-21" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb238-22"><a href="stats_validation.html#cb238-22" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb238-23"><a href="stats_validation.html#cb238-23" tabindex="-1"></a>    , <span class="at">color =</span> <span class="st">&quot;model&quot;</span></span>
<span id="cb238-24"><a href="stats_validation.html#cb238-24" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb238-25"><a href="stats_validation.html#cb238-25" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb238-26"><a href="stats_validation.html#cb238-26" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-167-1.png" width="1008" /></p>
<p>these results are as expected, with <a href="https://sites.google.com/site/doingbayesiandataanalysis/">Kruschke (2015)</a> noting:</p>
<blockquote>
<p>It is important to realize that the estimates of interaction contrasts are typically much more uncertain than the estimates of simple effects or main effects…This large uncertainty of an interaction contrast is caused by the fact that it involves at least four sources of uncertainty (i.e., at least four groups of data), unlike its component simple effects which each involve only half of those sources of uncertainty. In general, interaction contrasts require a lot of data to estimate accurately. (p. 598)</p>
</blockquote>
<p>For completeness, let’s also collapse across the dense cloud quality to compare the filtering mode setting effect.
In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="stats_validation.html#cb239-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb239-2"><a href="stats_validation.html#cb239-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb239-3"><a href="stats_validation.html#cb239-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb239-4"><a href="stats_validation.html#cb239-4" tabindex="-1"></a>    brms_f_mod2</span>
<span id="cb239-5"><a href="stats_validation.html#cb239-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb239-6"><a href="stats_validation.html#cb239-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode)</span>
<span id="cb239-7"><a href="stats_validation.html#cb239-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb239-8"><a href="stats_validation.html#cb239-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb239-9"><a href="stats_validation.html#cb239-9" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb239-10"><a href="stats_validation.html#cb239-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb239-11"><a href="stats_validation.html#cb239-11" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb239-12"><a href="stats_validation.html#cb239-12" tabindex="-1"></a>      <span class="at">x =</span> value, <span class="at">y =</span> depth_maps_generation_filtering_mode</span>
<span id="cb239-13"><a href="stats_validation.html#cb239-13" tabindex="-1"></a>      , <span class="at">fill =</span> depth_maps_generation_filtering_mode</span>
<span id="cb239-14"><a href="stats_validation.html#cb239-14" tabindex="-1"></a>    )</span>
<span id="cb239-15"><a href="stats_validation.html#cb239-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb239-16"><a href="stats_validation.html#cb239-16" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb239-17"><a href="stats_validation.html#cb239-17" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb239-18"><a href="stats_validation.html#cb239-18" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;gray66&quot;</span></span>
<span id="cb239-19"><a href="stats_validation.html#cb239-19" tabindex="-1"></a>      , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_color =</span> <span class="st">&quot;gray66&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb239-20"><a href="stats_validation.html#cb239-20" tabindex="-1"></a>      , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb239-21"><a href="stats_validation.html#cb239-21" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb239-22"><a href="stats_validation.html#cb239-22" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb239-23"><a href="stats_validation.html#cb239-23" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb239-24"><a href="stats_validation.html#cb239-24" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb239-25"><a href="stats_validation.html#cb239-25" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;filtering mode&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb239-26"><a href="stats_validation.html#cb239-26" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI&quot;</span></span>
<span id="cb239-27"><a href="stats_validation.html#cb239-27" tabindex="-1"></a>      , <span class="at">caption =</span> form_temp</span>
<span id="cb239-28"><a href="stats_validation.html#cb239-28" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb239-29"><a href="stats_validation.html#cb239-29" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb239-30"><a href="stats_validation.html#cb239-30" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-168-1.png" width="1008" /></p>
<p>…it looks like the variation in F-score is driven by the dense cloud quality setting. We can quantify the variation in F-score by comparing the <span class="math inline">\(\sigma\)</span> posteriors.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="stats_validation.html#cb240-1" tabindex="-1"></a><span class="co"># extract the posterior draws</span></span>
<span id="cb240-2"><a href="stats_validation.html#cb240-2" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod2) <span class="sc">%&gt;%</span> </span>
<span id="cb240-3"><a href="stats_validation.html#cb240-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(sigma,tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sd_&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb240-4"><a href="stats_validation.html#cb240-4" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(dplyr<span class="sc">::</span><span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb240-5"><a href="stats_validation.html#cb240-5" tabindex="-1"></a>  <span class="co"># dplyr::group_by(name) %&gt;% </span></span>
<span id="cb240-6"><a href="stats_validation.html#cb240-6" tabindex="-1"></a>  <span class="co"># tidybayes::median_hdi(value) %&gt;% </span></span>
<span id="cb240-7"><a href="stats_validation.html#cb240-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb240-8"><a href="stats_validation.html#cb240-8" tabindex="-1"></a>    <span class="at">name =</span> name <span class="sc">%&gt;%</span> </span>
<span id="cb240-9"><a href="stats_validation.html#cb240-9" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_quality&quot;</span>, <span class="st">&quot;quality&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb240-10"><a href="stats_validation.html#cb240-10" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span>, <span class="st">&quot;filtering&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb240-11"><a href="stats_validation.html#cb240-11" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(value)</span>
<span id="cb240-12"><a href="stats_validation.html#cb240-12" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb240-13"><a href="stats_validation.html#cb240-13" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb240-14"><a href="stats_validation.html#cb240-14" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> name)) <span class="sc">+</span></span>
<span id="cb240-15"><a href="stats_validation.html#cb240-15" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_dotsinterval</span>(</span>
<span id="cb240-16"><a href="stats_validation.html#cb240-16" tabindex="-1"></a>    <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb240-17"><a href="stats_validation.html#cb240-17" tabindex="-1"></a>    , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.04</span></span>
<span id="cb240-18"><a href="stats_validation.html#cb240-18" tabindex="-1"></a>    , <span class="at">shape =</span> <span class="dv">21</span> <span class="co">#, point_size = 3</span></span>
<span id="cb240-19"><a href="stats_validation.html#cb240-19" tabindex="-1"></a>    , <span class="at">quantiles =</span> <span class="dv">100</span></span>
<span id="cb240-20"><a href="stats_validation.html#cb240-20" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb240-21"><a href="stats_validation.html#cb240-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">caption =</span> form_temp) <span class="sc">+</span></span>
<span id="cb240-22"><a href="stats_validation.html#cb240-22" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-169-1.png" width="1008" /></p>
<p>Finally we can perform model selection via information criteria, from section 10 in <a href="https://bookdown.org/content/3686/metric-predicted-variable-with-one-nominal-predictor.html">Kurz’s ebook supplement</a>:</p>
<blockquote>
<p>expected log predictive density (<code>elpd_loo</code>), the estimated effective number of parameters (<code>p_loo</code>), and the Pareto smoothed importance-sampling leave-one-out cross-validation (PSIS-LOO; <code>looic</code>). Each estimate comes with a standard error (i.e., <code>SE</code>). Like other information criteria, the LOO values aren’t of interest in and of themselves. However, the estimate of one model’s LOO relative to that of another can be of great interest. We generally prefer models with lower information criteria. With the <code>brms::loo_compare()</code> function, we can compute a formal difference score between two models…The <code>brms::loo_compare()</code> output rank orders the models such that the best fitting model appears on top.</p>
</blockquote>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="stats_validation.html#cb241-1" tabindex="-1"></a>brms_f_mod1 <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">add_criterion</span>(brms_f_mod1, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</span>
<span id="cb241-2"><a href="stats_validation.html#cb241-2" tabindex="-1"></a>brms_f_mod2 <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">add_criterion</span>(brms_f_mod2, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</span>
<span id="cb241-3"><a href="stats_validation.html#cb241-3" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">loo_compare</span>(brms_f_mod1, brms_f_mod2, <span class="at">criterion =</span> <span class="st">&quot;loo&quot;</span>)</span></code></pre></div>
<pre><code>##             elpd_diff se_diff
## brms_f_mod1  0.0       0.0   
## brms_f_mod2 -1.7       1.2</code></pre>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="stats_validation.html#cb243-1" tabindex="-1"></a><span class="co"># brms::model_weights(brms_f_mod1, brms_f_mod2) %&gt;% round()</span></span></code></pre></div>
<p>These models are not significantly different suggesting that the filtering mode is not contributing much to the variation in SfM-derived tree detection reliability after accounting for the quality setting</p>
</div>
</div>
<div id="f_three_pred_mod" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Three Nominal Predictors<a href="stats_validation.html#f_three_pred_mod" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now, we’ll add the SfM processing software to our model which includes the depth map generation quality and the depth map filtering parameters to quantify the SfM-derived tree detection performance based on the F-score.</p>
<div id="summary-statistics-7" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Summary Statistics<a href="stats_validation.html#summary-statistics-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Summary statistics by group:</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="stats_validation.html#cb244-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb244-2"><a href="stats_validation.html#cb244-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(depth_maps_generation_quality, depth_maps_generation_filtering_mode, software) <span class="sc">%&gt;%</span></span>
<span id="cb244-3"><a href="stats_validation.html#cb244-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb244-4"><a href="stats_validation.html#cb244-4" tabindex="-1"></a>    <span class="at">mean_f_score =</span> <span class="fu">mean</span>(f_score, <span class="at">na.rm =</span> T)</span>
<span id="cb244-5"><a href="stats_validation.html#cb244-5" tabindex="-1"></a>    <span class="co"># , med_f_score = median(f_score, na.rm = T)</span></span>
<span id="cb244-6"><a href="stats_validation.html#cb244-6" tabindex="-1"></a>    , <span class="at">sd_f_score =</span> <span class="fu">sd</span>(f_score, <span class="at">na.rm =</span> T)</span>
<span id="cb244-7"><a href="stats_validation.html#cb244-7" tabindex="-1"></a>    , <span class="at">n =</span> dplyr<span class="sc">::</span><span class="fu">n</span>()</span>
<span id="cb244-8"><a href="stats_validation.html#cb244-8" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb244-9"><a href="stats_validation.html#cb244-9" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb244-10"><a href="stats_validation.html#cb244-10" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb244-11"><a href="stats_validation.html#cb244-11" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;summary statistics: F-score by dense cloud quality, filtering mode, and software&quot;</span></span>
<span id="cb244-12"><a href="stats_validation.html#cb244-12" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb244-13"><a href="stats_validation.html#cb244-13" tabindex="-1"></a>      <span class="st">&quot;quality&quot;</span></span>
<span id="cb244-14"><a href="stats_validation.html#cb244-14" tabindex="-1"></a>      , <span class="st">&quot;filtering mode&quot;</span></span>
<span id="cb244-15"><a href="stats_validation.html#cb244-15" tabindex="-1"></a>      , <span class="st">&quot;software&quot;</span></span>
<span id="cb244-16"><a href="stats_validation.html#cb244-16" tabindex="-1"></a>      , <span class="st">&quot;mean F-score&quot;</span></span>
<span id="cb244-17"><a href="stats_validation.html#cb244-17" tabindex="-1"></a>      , <span class="st">&quot;sd&quot;</span></span>
<span id="cb244-18"><a href="stats_validation.html#cb244-18" tabindex="-1"></a>      , <span class="st">&quot;n&quot;</span></span>
<span id="cb244-19"><a href="stats_validation.html#cb244-19" tabindex="-1"></a>    )</span>
<span id="cb244-20"><a href="stats_validation.html#cb244-20" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb244-21"><a href="stats_validation.html#cb244-21" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb244-22"><a href="stats_validation.html#cb244-22" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;8in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:8in; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-172">Table 6.9: </span>summary statistics: F-score by dense cloud quality, filtering mode, and software
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
quality
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
filtering mode
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
software
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mean F-score
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
sd
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.48
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
medium
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
medium
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
medium
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
medium
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
medium
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
medium
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
medium
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
medium
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
medium
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.57
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
medium
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
medium
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.49
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.48
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
lowest
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
lowest
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
lowest
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
lowest
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
lowest
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
lowest
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
lowest
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
lowest
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
5
</td>
</tr>
</tbody>
</table>
</div>
<p>we can view this data by using <code>ggplot2::geom_tile</code></p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="stats_validation.html#cb245-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb245-2"><a href="stats_validation.html#cb245-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(software, depth_maps_generation_quality, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span></span>
<span id="cb245-3"><a href="stats_validation.html#cb245-3" tabindex="-1"></a>  <span class="co"># collapse across study site</span></span>
<span id="cb245-4"><a href="stats_validation.html#cb245-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb245-5"><a href="stats_validation.html#cb245-5" tabindex="-1"></a>    <span class="at">mean_f_score =</span> <span class="fu">mean</span>(f_score, <span class="at">na.rm =</span> T)</span>
<span id="cb245-6"><a href="stats_validation.html#cb245-6" tabindex="-1"></a>    <span class="co"># , med_f_score = median(f_score, na.rm = T)</span></span>
<span id="cb245-7"><a href="stats_validation.html#cb245-7" tabindex="-1"></a>    , <span class="at">sd_f_score =</span> <span class="fu">sd</span>(f_score, <span class="at">na.rm =</span> T)</span>
<span id="cb245-8"><a href="stats_validation.html#cb245-8" tabindex="-1"></a>    , <span class="at">n =</span> dplyr<span class="sc">::</span><span class="fu">n</span>()</span>
<span id="cb245-9"><a href="stats_validation.html#cb245-9" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb245-10"><a href="stats_validation.html#cb245-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb245-11"><a href="stats_validation.html#cb245-11" tabindex="-1"></a>    <span class="at">y =</span> depth_maps_generation_quality</span>
<span id="cb245-12"><a href="stats_validation.html#cb245-12" tabindex="-1"></a>    , <span class="at">x =</span> depth_maps_generation_filtering_mode</span>
<span id="cb245-13"><a href="stats_validation.html#cb245-13" tabindex="-1"></a>    , <span class="at">fill =</span> mean_f_score</span>
<span id="cb245-14"><a href="stats_validation.html#cb245-14" tabindex="-1"></a>    , <span class="at">label =</span> <span class="fu">paste0</span>(scales<span class="sc">::</span><span class="fu">comma</span>(mean_f_score,<span class="at">accuracy =</span> <span class="fl">0.01</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">(n=&quot;</span>, n,<span class="st">&quot;)&quot;</span>)</span>
<span id="cb245-15"><a href="stats_validation.html#cb245-15" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb245-16"><a href="stats_validation.html#cb245-16" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb245-17"><a href="stats_validation.html#cb245-17" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb245-18"><a href="stats_validation.html#cb245-18" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(software)) <span class="sc">+</span> </span>
<span id="cb245-19"><a href="stats_validation.html#cb245-19" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb245-20"><a href="stats_validation.html#cb245-20" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb245-21"><a href="stats_validation.html#cb245-21" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;cividis&quot;</span>, <span class="at">begin =</span> <span class="fl">0.3</span>, <span class="at">end =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb245-22"><a href="stats_validation.html#cb245-22" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb245-23"><a href="stats_validation.html#cb245-23" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;filtering mode&quot;</span></span>
<span id="cb245-24"><a href="stats_validation.html#cb245-24" tabindex="-1"></a>    , <span class="at">y =</span> <span class="st">&quot;quality&quot;</span></span>
<span id="cb245-25"><a href="stats_validation.html#cb245-25" tabindex="-1"></a>    , <span class="at">fill =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb245-26"><a href="stats_validation.html#cb245-26" tabindex="-1"></a>    , <span class="at">subtitle =</span> <span class="st">&quot;mean F-score and # of study sites&quot;</span></span>
<span id="cb245-27"><a href="stats_validation.html#cb245-27" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb245-28"><a href="stats_validation.html#cb245-28" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> </span>
<span id="cb245-29"><a href="stats_validation.html#cb245-29" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb245-30"><a href="stats_validation.html#cb245-30" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb245-31"><a href="stats_validation.html#cb245-31" tabindex="-1"></a>    , <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb245-32"><a href="stats_validation.html#cb245-32" tabindex="-1"></a>    , <span class="at">panel.background =</span> <span class="fu">element_blank</span>()</span>
<span id="cb245-33"><a href="stats_validation.html#cb245-33" tabindex="-1"></a>    , <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb245-34"><a href="stats_validation.html#cb245-34" tabindex="-1"></a>    , <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb245-35"><a href="stats_validation.html#cb245-35" tabindex="-1"></a>    , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb245-36"><a href="stats_validation.html#cb245-36" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-173-1.png" width="1008" /></p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="stats_validation.html#cb246-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="st">&quot;../data/fscore_comp_quick.png&quot;</span>, <span class="at">height =</span> <span class="dv">9</span>, <span class="at">width =</span> <span class="dv">8</span>)</span></code></pre></div>
</div>
<div id="f_three_pred_mod_bays" class="section level3 hasAnchor" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Bayesian<a href="stats_validation.html#f_three_pred_mod_bays" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://sites.google.com/site/doingbayesiandataanalysis/">Kruschke (2015)</a> describes the Hierarchical Bayesian approach to extend our two nominal predictor model to include another nominal predictor (referred to as “subject” here but the methodology applies for other nominal variables):</p>
<blockquote>
<p>When every subject contributes many measurements to every cell, then the model of the situation is a straight-forward extension of the models we have already considered. We merely add “subject” as another nominal predictor in the model, with each individual subject being a level of the predictor. If there is one predictor other than subject, the model becomes</p>
<p><span class="math display">\[ y = \beta_0 + \overrightarrow \beta_1 \overrightarrow x_1 + \overrightarrow \beta_S \overrightarrow x_S + \overrightarrow \beta_{1 \times S} \overrightarrow x_{1 \times S} \]</span></p>
<p>This is exactly the two-predictor model we have already considered, with the second predictor being subject. When there are two predictors other than subject, the model becomes</p>
<p><span class="math display">\[\begin{align*}
y = &amp; \; \beta_0 &amp; \text{baseline} \\
&amp; + \overrightarrow \beta_1 \overrightarrow x_1 + \overrightarrow \beta_2 \overrightarrow x_2 + \overrightarrow \beta_S \overrightarrow x_S  &amp; \text{main effects} \\
&amp; + \overrightarrow \beta_{1 \times 2} \overrightarrow x_{1 \times 2} + \overrightarrow \beta_{1 \times S} \overrightarrow x_{1 \times S} + \overrightarrow \beta_{2 \times S} \overrightarrow x_{2 \times S} &amp; \text{two-way interactions} \\
&amp; + \overrightarrow \beta_{1 \times 2 \times S} \overrightarrow x_{1 \times 2 \times S} &amp; \text{three-way interactions}
\end{align*}\]</span></p>
<p>This model includes all the two-way interactions of the factors, plus the three-way interaction. (p. 607)</p>
</blockquote>
<p>The metric predicted variable with three nominal predictor variables model has the form:</p>
<p><span class="math display">\[\begin{align*}
y_{i} \sim &amp; {\sf Normal} \bigl(\mu_{i}, \sigma_{y} \bigr) \\
\mu_{i} = &amp; \beta_0 \\
&amp; + \sum_{j} \beta_{1[j]} x_{1[j]} + \sum_{k} \beta_{2[k]} x_{2[k]} + \sum_{f} \beta_{3[f]} x_{3[f]}  \\
&amp; + \sum_{j,k} \beta_{1\times2[j,k]} x_{1\times2[j,k]} + \sum_{j,f} \beta_{1\times3[j,f]} x_{1\times3[j,f]} + \sum_{k,f} \beta_{2\times3[k,f]} x_{2\times3[k,f]} \\
&amp; + \sum_{j,k,f} \beta_{1\times2\times3[j,k,f]} x_{1\times2\times3[j,k,f]} \\
\beta_{0}  \sim &amp; {\sf Normal} (0,100) \\
\beta_{1[j]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{1}}) \\
\beta_{2[k]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{2}}) \\
\beta_{3[f]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{3}}) \\
\beta_{1\times2[j,k]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{1\times2}}) \\
\beta_{1\times3[j,f]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{1\times3}}) \\
\beta_{2\times3[k,f]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{2\times3}}) \\
\sigma_{\beta_{1}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{2}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{3}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{1\times2}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{1\times3}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{2\times3}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{y} \sim &amp; {\sf Cauchy} (0,109) \\
\end{align*}\]</span></p>
<p>, where <span class="math inline">\(j\)</span> is the depth map generation quality setting corresponding to observation <span class="math inline">\(i\)</span>, <span class="math inline">\(k\)</span> is the depth map filtering mode setting corresponding to observation <span class="math inline">\(i\)</span>, and <span class="math inline">\(f\)</span> is the processing software corresponding to observation <span class="math inline">\(i\)</span></p>
<p><em>for this model, we’ll define the priors following <a href="https://bookdown.org/content/3686/metric-predicted-variable-with-multiple-nominal-predictors.html#implementation-in-jags-brms.-1">Kurz</a></em> who notes that:</p>
<blockquote>
<p>The noise standard deviation <span class="math inline">\(\sigma_y\)</span> is depicted in the prior statement including the argument <code>class = sigma</code>…in order to be weakly informative, we will use the half-Cauchy. Recall that since the brms default is to set the lower bound for any variance parameter to 0, there’s no need to worry about doing so ourselves. So even though the syntax only indicates <code>cauchy</code>, it’s understood to mean Cauchy with a lower bound at zero; since the mean is usually 0, that makes this a half-Cauchy…The tails of the half-Cauchy are sufficiently fat that, in practice, I’ve found it doesn’t matter much what you set the <span class="math inline">\(SD\)</span> of its prior to.</p>
</blockquote>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="stats_validation.html#cb247-1" tabindex="-1"></a><span class="co"># from Kurz: </span></span>
<span id="cb247-2"><a href="stats_validation.html#cb247-2" tabindex="-1"></a>gamma_a_b_from_omega_sigma <span class="ot">=</span> <span class="cf">function</span>(mode, sd) {</span>
<span id="cb247-3"><a href="stats_validation.html#cb247-3" tabindex="-1"></a>  <span class="cf">if</span> (mode <span class="sc">&lt;=</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">&quot;mode must be &gt; 0&quot;</span>)</span>
<span id="cb247-4"><a href="stats_validation.html#cb247-4" tabindex="-1"></a>  <span class="cf">if</span> (sd   <span class="sc">&lt;=</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">&quot;sd must be &gt; 0&quot;</span>)</span>
<span id="cb247-5"><a href="stats_validation.html#cb247-5" tabindex="-1"></a>  rate <span class="ot">=</span> (mode <span class="sc">+</span> <span class="fu">sqrt</span>(mode<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sd<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sd<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb247-6"><a href="stats_validation.html#cb247-6" tabindex="-1"></a>  shape <span class="ot">=</span> <span class="dv">1</span> <span class="sc">+</span> mode <span class="sc">*</span> rate</span>
<span id="cb247-7"><a href="stats_validation.html#cb247-7" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">shape =</span> shape, <span class="at">rate =</span> rate))</span>
<span id="cb247-8"><a href="stats_validation.html#cb247-8" tabindex="-1"></a>}</span>
<span id="cb247-9"><a href="stats_validation.html#cb247-9" tabindex="-1"></a></span>
<span id="cb247-10"><a href="stats_validation.html#cb247-10" tabindex="-1"></a>mean_y_temp <span class="ot">=</span> <span class="fu">mean</span>(ptcld_validation_data<span class="sc">$</span>f_score)</span>
<span id="cb247-11"><a href="stats_validation.html#cb247-11" tabindex="-1"></a>sd_y_temp   <span class="ot">=</span> <span class="fu">sd</span>(ptcld_validation_data<span class="sc">$</span>f_score)</span>
<span id="cb247-12"><a href="stats_validation.html#cb247-12" tabindex="-1"></a></span>
<span id="cb247-13"><a href="stats_validation.html#cb247-13" tabindex="-1"></a>omega_temp <span class="ot">=</span> sd_y_temp <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb247-14"><a href="stats_validation.html#cb247-14" tabindex="-1"></a>sigma_temp <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> sd_y_temp</span>
<span id="cb247-15"><a href="stats_validation.html#cb247-15" tabindex="-1"></a></span>
<span id="cb247-16"><a href="stats_validation.html#cb247-16" tabindex="-1"></a>s_r_temp <span class="ot">=</span> <span class="fu">gamma_a_b_from_omega_sigma</span>(<span class="at">mode =</span> omega_temp, <span class="at">sd =</span> sigma_temp)</span>
<span id="cb247-17"><a href="stats_validation.html#cb247-17" tabindex="-1"></a></span>
<span id="cb247-18"><a href="stats_validation.html#cb247-18" tabindex="-1"></a>stanvars_temp <span class="ot">=</span> </span>
<span id="cb247-19"><a href="stats_validation.html#cb247-19" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">stanvar</span>(mean_y_temp,    <span class="at">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="sc">+</span> </span>
<span id="cb247-20"><a href="stats_validation.html#cb247-20" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">stanvar</span>(sd_y_temp,      <span class="at">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb247-21"><a href="stats_validation.html#cb247-21" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">stanvar</span>(s_r_temp<span class="sc">$</span>shape, <span class="at">name =</span> <span class="st">&quot;alpha&quot;</span>) <span class="sc">+</span></span>
<span id="cb247-22"><a href="stats_validation.html#cb247-22" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">stanvar</span>(s_r_temp<span class="sc">$</span>rate,  <span class="at">name =</span> <span class="st">&quot;beta&quot;</span>)</span></code></pre></div>
<p>Now fit the model.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="stats_validation.html#cb248-1" tabindex="-1"></a>brms_f_mod3 <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb248-2"><a href="stats_validation.html#cb248-2" tabindex="-1"></a>  <span class="at">formula =</span> f_score <span class="sc">~</span> </span>
<span id="cb248-3"><a href="stats_validation.html#cb248-3" tabindex="-1"></a>    <span class="co"># baseline</span></span>
<span id="cb248-4"><a href="stats_validation.html#cb248-4" tabindex="-1"></a>    <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb248-5"><a href="stats_validation.html#cb248-5" tabindex="-1"></a>    <span class="co"># main effects</span></span>
<span id="cb248-6"><a href="stats_validation.html#cb248-6" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span></span>
<span id="cb248-7"><a href="stats_validation.html#cb248-7" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode) <span class="sc">+</span> </span>
<span id="cb248-8"><a href="stats_validation.html#cb248-8" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> software) <span class="sc">+</span></span>
<span id="cb248-9"><a href="stats_validation.html#cb248-9" tabindex="-1"></a>    <span class="co"># two-way interactions</span></span>
<span id="cb248-10"><a href="stats_validation.html#cb248-10" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode) <span class="sc">+</span></span>
<span id="cb248-11"><a href="stats_validation.html#cb248-11" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>software) <span class="sc">+</span></span>
<span id="cb248-12"><a href="stats_validation.html#cb248-12" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode<span class="sc">:</span>software) <span class="sc">+</span></span>
<span id="cb248-13"><a href="stats_validation.html#cb248-13" tabindex="-1"></a>    <span class="co"># three-way interactions</span></span>
<span id="cb248-14"><a href="stats_validation.html#cb248-14" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode<span class="sc">:</span>software)</span>
<span id="cb248-15"><a href="stats_validation.html#cb248-15" tabindex="-1"></a>  , <span class="at">data =</span> ptcld_validation_data</span>
<span id="cb248-16"><a href="stats_validation.html#cb248-16" tabindex="-1"></a>  , <span class="at">family =</span> brms<span class="sc">::</span><span class="fu">brmsfamily</span>(<span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>)</span>
<span id="cb248-17"><a href="stats_validation.html#cb248-17" tabindex="-1"></a>  , <span class="at">iter =</span> <span class="dv">20000</span>, <span class="at">warmup =</span> <span class="dv">10000</span>, <span class="at">chains =</span> <span class="dv">4</span></span>
<span id="cb248-18"><a href="stats_validation.html#cb248-18" tabindex="-1"></a>  , <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>, <span class="at">max_treedepth =</span> <span class="dv">13</span>)</span>
<span id="cb248-19"><a href="stats_validation.html#cb248-19" tabindex="-1"></a>  , <span class="at">cores =</span> <span class="fu">round</span>(parallel<span class="sc">::</span><span class="fu">detectCores</span>()<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb248-20"><a href="stats_validation.html#cb248-20" tabindex="-1"></a>  , <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb248-21"><a href="stats_validation.html#cb248-21" tabindex="-1"></a>    brms<span class="sc">::</span><span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">5</span>), <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>)</span>
<span id="cb248-22"><a href="stats_validation.html#cb248-22" tabindex="-1"></a>    , brms<span class="sc">::</span><span class="fu">prior</span>(<span class="fu">gamma</span>(alpha, beta), <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>)</span>
<span id="cb248-23"><a href="stats_validation.html#cb248-23" tabindex="-1"></a>    , brms<span class="sc">::</span><span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>)</span>
<span id="cb248-24"><a href="stats_validation.html#cb248-24" tabindex="-1"></a>  )</span>
<span id="cb248-25"><a href="stats_validation.html#cb248-25" tabindex="-1"></a>  , <span class="at">stanvars =</span> stanvars_temp</span>
<span id="cb248-26"><a href="stats_validation.html#cb248-26" tabindex="-1"></a>  , <span class="at">file =</span> <span class="fu">paste0</span>(rootdir, <span class="st">&quot;/fits/brms_f_mod3&quot;</span>)</span>
<span id="cb248-27"><a href="stats_validation.html#cb248-27" tabindex="-1"></a>)</span>
<span id="cb248-28"><a href="stats_validation.html#cb248-28" tabindex="-1"></a><span class="co"># https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</span></span>
<span id="cb248-29"><a href="stats_validation.html#cb248-29" tabindex="-1"></a><span class="co"># https://mc-stan.org/misc/warnings.html#bulk-ess</span></span>
<span id="cb248-30"><a href="stats_validation.html#cb248-30" tabindex="-1"></a><span class="co"># https://mc-stan.org/misc/warnings.html#tail-ess </span></span></code></pre></div>
<p>check the trace plots for problems with convergence of the Markov chains</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="stats_validation.html#cb249-1" tabindex="-1"></a><span class="fu">plot</span>(brms_f_mod3)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-176-1.png" width="1008" /><img src="metashape_testing_files/figure-html/unnamed-chunk-176-2.png" width="1008" /></p>
<p>check the prior distributions</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="stats_validation.html#cb250-1" tabindex="-1"></a><span class="co"># check priors</span></span>
<span id="cb250-2"><a href="stats_validation.html#cb250-2" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">prior_summary</span>(brms_f_mod3) <span class="sc">%&gt;%</span> </span>
<span id="cb250-3"><a href="stats_validation.html#cb250-3" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb250-4"><a href="stats_validation.html#cb250-4" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
prior
</th>
<th style="text-align:left;">
class
</th>
<th style="text-align:left;">
coef
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
resp
</th>
<th style="text-align:left;">
dpar
</th>
<th style="text-align:left;">
nlpar
</th>
<th style="text-align:left;">
lb
</th>
<th style="text-align:left;">
ub
</th>
<th style="text-align:left;">
source
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
normal(mean_y, sd_y * 5)
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
user
</td>
</tr>
<tr>
<td style="text-align:left;">
gamma(alpha, beta)
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
user
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_filtering_mode
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_filtering_mode
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_filtering_mode:software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_filtering_mode:software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_quality
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_quality
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_quality:depth_maps_generation_filtering_mode
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_quality:depth_maps_generation_filtering_mode
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_quality:depth_maps_generation_filtering_mode:software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_quality:depth_maps_generation_filtering_mode:software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_quality:software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_quality:software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
cauchy(0, sd_y)
</td>
<td style="text-align:left;">
sigma
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
user
</td>
</tr>
</tbody>
</table>
<p>The <code>brms::brm</code> model summary</p>
<p>We won’t clutter the output here but this can be run if you are following along on your own</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="stats_validation.html#cb251-1" tabindex="-1"></a>brms_f_mod3 <span class="sc">%&gt;%</span> </span>
<span id="cb251-2"><a href="stats_validation.html#cb251-2" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">posterior_summary</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb251-3"><a href="stats_validation.html#cb251-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb251-4"><a href="stats_validation.html#cb251-4" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameter&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb251-5"><a href="stats_validation.html#cb251-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(tolower) <span class="sc">%&gt;%</span> </span>
<span id="cb251-6"><a href="stats_validation.html#cb251-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb251-7"><a href="stats_validation.html#cb251-7" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_starts</span>(parameter, <span class="st">&quot;b_&quot;</span>) </span>
<span id="cb251-8"><a href="stats_validation.html#cb251-8" tabindex="-1"></a>    <span class="sc">|</span> stringr<span class="sc">::</span><span class="fu">str_starts</span>(parameter, <span class="st">&quot;r_&quot;</span>) </span>
<span id="cb251-9"><a href="stats_validation.html#cb251-9" tabindex="-1"></a>    <span class="sc">|</span> stringr<span class="sc">::</span><span class="fu">str_starts</span>(parameter, <span class="st">&quot;sd_&quot;</span>) </span>
<span id="cb251-10"><a href="stats_validation.html#cb251-10" tabindex="-1"></a>    <span class="sc">|</span> parameter <span class="sc">==</span> <span class="st">&quot;sigma&quot;</span></span>
<span id="cb251-11"><a href="stats_validation.html#cb251-11" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb251-12"><a href="stats_validation.html#cb251-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb251-13"><a href="stats_validation.html#cb251-13" tabindex="-1"></a>    <span class="at">parameter =</span> parameter <span class="sc">%&gt;%</span> </span>
<span id="cb251-14"><a href="stats_validation.html#cb251-14" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_quality&quot;</span>, <span class="st">&quot;quality&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb251-15"><a href="stats_validation.html#cb251-15" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span>, <span class="st">&quot;filtering&quot;</span>)</span>
<span id="cb251-16"><a href="stats_validation.html#cb251-16" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb251-17"><a href="stats_validation.html#cb251-17" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">2</span>, <span class="at">caption =</span> <span class="st">&quot;Bayesian 3 nominal predictors for F-score&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb251-18"><a href="stats_validation.html#cb251-18" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb251-19"><a href="stats_validation.html#cb251-19" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;8in&quot;</span>)</span></code></pre></div>
<p>We can look at the model noise standard deviation <span class="math inline">\(\sigma_y\)</span></p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="stats_validation.html#cb252-1" tabindex="-1"></a><span class="co"># get formula</span></span>
<span id="cb252-2"><a href="stats_validation.html#cb252-2" tabindex="-1"></a>form_temp <span class="ot">=</span> brms_f_mod3<span class="sc">$</span>formula<span class="sc">$</span>formula[<span class="dv">3</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb252-3"><a href="stats_validation.html#cb252-3" tabindex="-1"></a>  <span class="fu">as.character</span>() <span class="sc">%&gt;%</span> <span class="fu">get_frmla_text</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb252-4"><a href="stats_validation.html#cb252-4" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_quality&quot;</span>, <span class="st">&quot;quality&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb252-5"><a href="stats_validation.html#cb252-5" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span>, <span class="st">&quot;filtering&quot;</span>)</span>
<span id="cb252-6"><a href="stats_validation.html#cb252-6" tabindex="-1"></a><span class="co"># extract the posterior draws</span></span>
<span id="cb252-7"><a href="stats_validation.html#cb252-7" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod3) <span class="sc">%&gt;%</span> </span>
<span id="cb252-8"><a href="stats_validation.html#cb252-8" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb252-9"><a href="stats_validation.html#cb252-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sigma, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb252-10"><a href="stats_validation.html#cb252-10" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_dotsinterval</span>(</span>
<span id="cb252-11"><a href="stats_validation.html#cb252-11" tabindex="-1"></a>    <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb252-12"><a href="stats_validation.html#cb252-12" tabindex="-1"></a>    , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.04</span></span>
<span id="cb252-13"><a href="stats_validation.html#cb252-13" tabindex="-1"></a>    , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_size =</span> <span class="dv">3</span></span>
<span id="cb252-14"><a href="stats_validation.html#cb252-14" tabindex="-1"></a>    , <span class="at">quantiles =</span> <span class="dv">100</span></span>
<span id="cb252-15"><a href="stats_validation.html#cb252-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb252-16"><a href="stats_validation.html#cb252-16" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb252-17"><a href="stats_validation.html#cb252-17" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb252-18"><a href="stats_validation.html#cb252-18" tabindex="-1"></a>    <span class="at">x =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">sigma_y$&quot;</span>)</span>
<span id="cb252-19"><a href="stats_validation.html#cb252-19" tabindex="-1"></a>    , <span class="at">caption =</span> form_temp</span>
<span id="cb252-20"><a href="stats_validation.html#cb252-20" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb252-21"><a href="stats_validation.html#cb252-21" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-179-1.png" width="1008" /></p>
<p>how is it compared to our other models?</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="stats_validation.html#cb253-1" tabindex="-1"></a><span class="co"># how is it compared to our other models?</span></span>
<span id="cb253-2"><a href="stats_validation.html#cb253-2" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb253-3"><a href="stats_validation.html#cb253-3" tabindex="-1"></a>    brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod1) <span class="sc">%&gt;%</span> tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(sigma) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;one nominal predictor&quot;</span>)</span>
<span id="cb253-4"><a href="stats_validation.html#cb253-4" tabindex="-1"></a>    , brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod2) <span class="sc">%&gt;%</span> tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(sigma) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;two nominal predictor&quot;</span>)</span>
<span id="cb253-5"><a href="stats_validation.html#cb253-5" tabindex="-1"></a>    , brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod3) <span class="sc">%&gt;%</span> tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(sigma) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;three nominal predictor&quot;</span>)</span>
<span id="cb253-6"><a href="stats_validation.html#cb253-6" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb253-7"><a href="stats_validation.html#cb253-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb253-8"><a href="stats_validation.html#cb253-8" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">2</span>, <span class="at">caption =</span> <span class="st">&quot;brms::brm model noise standard deviation comparison&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb253-9"><a href="stats_validation.html#cb253-9" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-180">Table 6.10: </span>brms::brm model noise standard deviation comparison
</caption>
<thead>
<tr>
<th style="text-align:left;">
model
</th>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
.lower
</th>
<th style="text-align:right;">
.upper
</th>
<th style="text-align:right;">
.width
</th>
<th style="text-align:left;">
.point
</th>
<th style="text-align:left;">
.interval
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
one nominal predictor
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:left;">
median
</td>
<td style="text-align:left;">
hdi
</td>
</tr>
<tr>
<td style="text-align:left;">
two nominal predictor
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:left;">
median
</td>
<td style="text-align:left;">
hdi
</td>
</tr>
<tr>
<td style="text-align:left;">
three nominal predictor
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:left;">
median
</td>
<td style="text-align:left;">
hdi
</td>
</tr>
</tbody>
</table>
<p>plot the posterior predictive distributions of the conditional means with the median F-score and the 95% highest posterior density interval (HDI)</p>
<p>Note that how within <code>tidybayes::add_epred_draws</code>, we used the <code>re_formula</code> argument to average over the random effects of <code>software</code>. For this model we have to collapse across the software effects to compare the dense cloud quality and filtering mode setting effects.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="stats_validation.html#cb254-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb254-2"><a href="stats_validation.html#cb254-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb254-3"><a href="stats_validation.html#cb254-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb254-4"><a href="stats_validation.html#cb254-4" tabindex="-1"></a>    brms_f_mod3, <span class="at">allow_new_levels =</span> T</span>
<span id="cb254-5"><a href="stats_validation.html#cb254-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb254-6"><a href="stats_validation.html#cb254-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span></span>
<span id="cb254-7"><a href="stats_validation.html#cb254-7" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode) <span class="sc">+</span> </span>
<span id="cb254-8"><a href="stats_validation.html#cb254-8" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode)</span>
<span id="cb254-9"><a href="stats_validation.html#cb254-9" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb254-10"><a href="stats_validation.html#cb254-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb254-11"><a href="stats_validation.html#cb254-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">depth_maps_generation_quality =</span> depth_maps_generation_quality <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb254-12"><a href="stats_validation.html#cb254-12" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb254-13"><a href="stats_validation.html#cb254-13" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb254-14"><a href="stats_validation.html#cb254-14" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb254-15"><a href="stats_validation.html#cb254-15" tabindex="-1"></a>      <span class="at">y =</span> value, <span class="at">x =</span> depth_maps_generation_filtering_mode</span>
<span id="cb254-16"><a href="stats_validation.html#cb254-16" tabindex="-1"></a>      , <span class="at">fill =</span> depth_maps_generation_filtering_mode</span>
<span id="cb254-17"><a href="stats_validation.html#cb254-17" tabindex="-1"></a>    )</span>
<span id="cb254-18"><a href="stats_validation.html#cb254-18" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb254-19"><a href="stats_validation.html#cb254-19" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_eye</span>(</span>
<span id="cb254-20"><a href="stats_validation.html#cb254-20" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb254-21"><a href="stats_validation.html#cb254-21" tabindex="-1"></a>      , <span class="at">slab_alpha =</span> <span class="fl">0.8</span></span>
<span id="cb254-22"><a href="stats_validation.html#cb254-22" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb254-23"><a href="stats_validation.html#cb254-23" tabindex="-1"></a>      , <span class="at">point_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_size =</span> <span class="dv">1</span></span>
<span id="cb254-24"><a href="stats_validation.html#cb254-24" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb254-25"><a href="stats_validation.html#cb254-25" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb254-26"><a href="stats_validation.html#cb254-26" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb254-27"><a href="stats_validation.html#cb254-27" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(depth_maps_generation_quality)) <span class="sc">+</span></span>
<span id="cb254-28"><a href="stats_validation.html#cb254-28" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb254-29"><a href="stats_validation.html#cb254-29" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">&quot;filtering mode&quot;</span>, <span class="at">y =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb254-30"><a href="stats_validation.html#cb254-30" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI</span><span class="sc">\n</span><span class="st">by dense cloud quality&quot;</span></span>
<span id="cb254-31"><a href="stats_validation.html#cb254-31" tabindex="-1"></a>      , <span class="at">fill =</span> <span class="st">&quot;Filtering Mode&quot;</span></span>
<span id="cb254-32"><a href="stats_validation.html#cb254-32" tabindex="-1"></a>      , <span class="at">caption =</span> form_temp</span>
<span id="cb254-33"><a href="stats_validation.html#cb254-33" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb254-34"><a href="stats_validation.html#cb254-34" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb254-35"><a href="stats_validation.html#cb254-35" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb254-36"><a href="stats_validation.html#cb254-36" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb254-37"><a href="stats_validation.html#cb254-37" tabindex="-1"></a>      , <span class="at">legend.direction  =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb254-38"><a href="stats_validation.html#cb254-38" tabindex="-1"></a>      , <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb254-39"><a href="stats_validation.html#cb254-39" tabindex="-1"></a>      , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb254-40"><a href="stats_validation.html#cb254-40" tabindex="-1"></a>    ) </span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-181-1.png" width="1008" /></p>
<p>we can also make pairwise comparisons so long as we continue using <code>tidybayes::add_epred_draws</code> with the <code>re_formula</code> argument</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="stats_validation.html#cb255-1" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span></span>
<span id="cb255-2"><a href="stats_validation.html#cb255-2" tabindex="-1"></a>  ptcld_validation_data <span class="sc">%&gt;%</span></span>
<span id="cb255-3"><a href="stats_validation.html#cb255-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb255-4"><a href="stats_validation.html#cb255-4" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb255-5"><a href="stats_validation.html#cb255-5" tabindex="-1"></a>      brms_f_mod3, <span class="at">allow_new_levels =</span> T</span>
<span id="cb255-6"><a href="stats_validation.html#cb255-6" tabindex="-1"></a>      <span class="co"># this part is crucial</span></span>
<span id="cb255-7"><a href="stats_validation.html#cb255-7" tabindex="-1"></a>      , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span></span>
<span id="cb255-8"><a href="stats_validation.html#cb255-8" tabindex="-1"></a>        (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode) <span class="sc">+</span> </span>
<span id="cb255-9"><a href="stats_validation.html#cb255-9" tabindex="-1"></a>        (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode)</span>
<span id="cb255-10"><a href="stats_validation.html#cb255-10" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb255-11"><a href="stats_validation.html#cb255-11" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb255-12"><a href="stats_validation.html#cb255-12" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb255-13"><a href="stats_validation.html#cb255-13" tabindex="-1"></a>      value</span>
<span id="cb255-14"><a href="stats_validation.html#cb255-14" tabindex="-1"></a>      , <span class="at">by =</span> depth_maps_generation_quality</span>
<span id="cb255-15"><a href="stats_validation.html#cb255-15" tabindex="-1"></a>      , <span class="at">comparison =</span> </span>
<span id="cb255-16"><a href="stats_validation.html#cb255-16" tabindex="-1"></a>        contrast_list</span>
<span id="cb255-17"><a href="stats_validation.html#cb255-17" tabindex="-1"></a>        <span class="co"># tidybayes::emmeans_comparison(&quot;revpairwise&quot;) </span></span>
<span id="cb255-18"><a href="stats_validation.html#cb255-18" tabindex="-1"></a>        <span class="co">#&quot;pairwise&quot;</span></span>
<span id="cb255-19"><a href="stats_validation.html#cb255-19" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb255-20"><a href="stats_validation.html#cb255-20" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> depth_maps_generation_quality)</span>
<span id="cb255-21"><a href="stats_validation.html#cb255-21" tabindex="-1"></a></span>
<span id="cb255-22"><a href="stats_validation.html#cb255-22" tabindex="-1"></a><span class="co"># separate contrast</span></span>
<span id="cb255-23"><a href="stats_validation.html#cb255-23" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb255-24"><a href="stats_validation.html#cb255-24" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb255-25"><a href="stats_validation.html#cb255-25" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(</span>
<span id="cb255-26"><a href="stats_validation.html#cb255-26" tabindex="-1"></a>    <span class="at">cols =</span> contrast</span>
<span id="cb255-27"><a href="stats_validation.html#cb255-27" tabindex="-1"></a>    , <span class="at">delim =</span> <span class="st">&quot; - &quot;</span></span>
<span id="cb255-28"><a href="stats_validation.html#cb255-28" tabindex="-1"></a>    , <span class="at">names =</span> <span class="fu">paste0</span>(</span>
<span id="cb255-29"><a href="stats_validation.html#cb255-29" tabindex="-1"></a>        <span class="st">&quot;sorter&quot;</span></span>
<span id="cb255-30"><a href="stats_validation.html#cb255-30" tabindex="-1"></a>        , <span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(stringr<span class="sc">::</span><span class="fu">str_count</span>(brms_contrast_temp<span class="sc">$</span>contrast, <span class="st">&quot;-&quot;</span>))<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb255-31"><a href="stats_validation.html#cb255-31" tabindex="-1"></a>      )</span>
<span id="cb255-32"><a href="stats_validation.html#cb255-32" tabindex="-1"></a>    , <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span></span>
<span id="cb255-33"><a href="stats_validation.html#cb255-33" tabindex="-1"></a>    , <span class="at">cols_remove =</span> F</span>
<span id="cb255-34"><a href="stats_validation.html#cb255-34" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb255-35"><a href="stats_validation.html#cb255-35" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sorter1<span class="sc">!=</span>sorter2) <span class="sc">%&gt;%</span> </span>
<span id="cb255-36"><a href="stats_validation.html#cb255-36" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb255-37"><a href="stats_validation.html#cb255-37" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb255-38"><a href="stats_validation.html#cb255-38" tabindex="-1"></a>      tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sorter&quot;</span>)</span>
<span id="cb255-39"><a href="stats_validation.html#cb255-39" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="cf">function</span>(x){<span class="fu">factor</span>(</span>
<span id="cb255-40"><a href="stats_validation.html#cb255-40" tabindex="-1"></a>        x, <span class="at">ordered =</span> T</span>
<span id="cb255-41"><a href="stats_validation.html#cb255-41" tabindex="-1"></a>        , <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_quality)</span>
<span id="cb255-42"><a href="stats_validation.html#cb255-42" tabindex="-1"></a>      )}</span>
<span id="cb255-43"><a href="stats_validation.html#cb255-43" tabindex="-1"></a>    )</span>
<span id="cb255-44"><a href="stats_validation.html#cb255-44" tabindex="-1"></a>    , <span class="at">contrast =</span> contrast <span class="sc">%&gt;%</span> </span>
<span id="cb255-45"><a href="stats_validation.html#cb255-45" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb255-46"><a href="stats_validation.html#cb255-46" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="fu">as.numeric</span>(sorter1), <span class="fu">as.numeric</span>(sorter2)) <span class="sc">%&gt;%</span> </span>
<span id="cb255-47"><a href="stats_validation.html#cb255-47" tabindex="-1"></a>        <span class="fu">as.numeric</span>()</span>
<span id="cb255-48"><a href="stats_validation.html#cb255-48" tabindex="-1"></a>      )</span>
<span id="cb255-49"><a href="stats_validation.html#cb255-49" tabindex="-1"></a>    , <span class="at">depth_maps_generation_filtering_mode =</span> depth_maps_generation_filtering_mode <span class="sc">%&gt;%</span> </span>
<span id="cb255-50"><a href="stats_validation.html#cb255-50" tabindex="-1"></a>      <span class="fu">factor</span>(</span>
<span id="cb255-51"><a href="stats_validation.html#cb255-51" tabindex="-1"></a>        <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_filtering_mode)</span>
<span id="cb255-52"><a href="stats_validation.html#cb255-52" tabindex="-1"></a>        , <span class="at">ordered =</span> T</span>
<span id="cb255-53"><a href="stats_validation.html#cb255-53" tabindex="-1"></a>      )</span>
<span id="cb255-54"><a href="stats_validation.html#cb255-54" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb255-55"><a href="stats_validation.html#cb255-55" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb255-56"><a href="stats_validation.html#cb255-56" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb255-57"><a href="stats_validation.html#cb255-57" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb255-58"><a href="stats_validation.html#cb255-58" tabindex="-1"></a></span>
<span id="cb255-59"><a href="stats_validation.html#cb255-59" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb255-60"><a href="stats_validation.html#cb255-60" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 1,600,000
## Columns: 17
## Groups: contrast, depth_maps_generation_filtering_mode [40]
## $ depth_maps_generation_filtering_mode &lt;ord&gt; aggressive, aggressive, aggressiv…
## $ .chain                               &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ .iteration                           &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ .draw                                &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11…
## $ sorter1                              &lt;ord&gt; ultra high, ultra high, ultra hig…
## $ sorter2                              &lt;ord&gt; high, high, high, high, high, hig…
## $ contrast                             &lt;fct&gt; ultra high - high, ultra high - h…
## $ value                                &lt;dbl&gt; -0.087610941, 0.085047329, -0.131…
## $ median_hdi_est                       &lt;dbl&gt; 0.03005148, 0.03005148, 0.0300514…
## $ median_hdi_lower                     &lt;dbl&gt; -0.1129854, -0.1129854, -0.112985…
## $ median_hdi_upper                     &lt;dbl&gt; 0.1723716, 0.1723716, 0.1723716, …
## $ is_gt_zero                           &lt;lgl&gt; FALSE, TRUE, FALSE, TRUE, TRUE, F…
## $ pct_gt_zero                          &lt;dbl&gt; 0.674575, 0.674575, 0.674575, 0.6…
## $ pct_gt_zero_lab                      &lt;chr&gt; &quot;Pr(ultra high&gt;high)=67%&quot;, &quot;Pr(ul…
## $ pct_gt_zero_lab_sm                   &lt;chr&gt; &quot;Pr(&gt;0)=67%&quot;, &quot;Pr(&gt;0)=67%&quot;, &quot;Pr(&gt;…
## $ pct_gt_zero_lab_pos                  &lt;dbl&gt; 0.1852995, 0.1852995, 0.1852995, …
## $ sig_level                            &lt;ord&gt; &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80…</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="stats_validation.html#cb257-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb257-2"><a href="stats_validation.html#cb257-2" tabindex="-1"></a>  brms_contrast_temp, <span class="at">caption_text =</span> form_temp</span>
<span id="cb257-3"><a href="stats_validation.html#cb257-3" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;quality&quot;</span></span>
<span id="cb257-4"><a href="stats_validation.html#cb257-4" tabindex="-1"></a>  , <span class="at">facet =</span> <span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span></span>
<span id="cb257-5"><a href="stats_validation.html#cb257-5" tabindex="-1"></a>  , <span class="at">label_size =</span> <span class="fl">2.1</span></span>
<span id="cb257-6"><a href="stats_validation.html#cb257-6" tabindex="-1"></a>  , <span class="at">x_expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>)</span>
<span id="cb257-7"><a href="stats_validation.html#cb257-7" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb257-8"><a href="stats_validation.html#cb257-8" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb257-9"><a href="stats_validation.html#cb257-9" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of group constrasts with 95% &amp; 50% HDI</span><span class="sc">\n</span><span class="st">by filtering mode&quot;</span></span>
<span id="cb257-10"><a href="stats_validation.html#cb257-10" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-183-1.png" width="1008" /></p>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="stats_validation.html#cb258-1" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb258-2"><a href="stats_validation.html#cb258-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb258-3"><a href="stats_validation.html#cb258-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb258-4"><a href="stats_validation.html#cb258-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb258-5"><a href="stats_validation.html#cb258-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, depth_maps_generation_filtering_mode, value, .lower, .upper) <span class="sc">%&gt;%</span> </span>
<span id="cb258-6"><a href="stats_validation.html#cb258-6" tabindex="-1"></a>   </span>
<span id="cb258-7"><a href="stats_validation.html#cb258-7" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb258-8"><a href="stats_validation.html#cb258-8" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb258-9"><a href="stats_validation.html#cb258-9" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb258-10"><a href="stats_validation.html#cb258-10" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb258-11"><a href="stats_validation.html#cb258-11" tabindex="-1"></a>      <span class="st">&quot;quality contrast&quot;</span></span>
<span id="cb258-12"><a href="stats_validation.html#cb258-12" tabindex="-1"></a>      , <span class="st">&quot;filtering mode&quot;</span></span>
<span id="cb258-13"><a href="stats_validation.html#cb258-13" tabindex="-1"></a>      , <span class="st">&quot;difference (F-score)&quot;</span></span>
<span id="cb258-14"><a href="stats_validation.html#cb258-14" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb258-15"><a href="stats_validation.html#cb258-15" tabindex="-1"></a>    )</span>
<span id="cb258-16"><a href="stats_validation.html#cb258-16" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb258-17"><a href="stats_validation.html#cb258-17" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb258-18"><a href="stats_validation.html#cb258-18" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;6in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:6in; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-184">Table 6.11: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
quality contrast
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
filtering mode
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
difference (F-score)
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI low
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.29
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.28
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.27
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.27
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - lowest
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.40
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - lowest
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.40
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - lowest
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.40
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - lowest
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.39
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.20
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.20
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.26
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.24
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.24
</td>
</tr>
<tr>
<td style="text-align:left;">
high - lowest
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.36
</td>
</tr>
<tr>
<td style="text-align:left;">
high - lowest
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.36
</td>
</tr>
<tr>
<td style="text-align:left;">
high - lowest
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.36
</td>
</tr>
<tr>
<td style="text-align:left;">
high - lowest
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.36
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.20
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.20
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.31
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.31
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.31
</td>
</tr>
<tr>
<td style="text-align:left;">
low - lowest
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;">
low - lowest
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;">
low - lowest
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;">
low - lowest
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
</tbody>
</table>
</div>
<p>It might be more important to understand the difference in F-score by dense cloud quality and software rather than filtering mode since filtering mode had such a small effect on the SfM predictive ability</p>
<p>Note that how within <code>tidybayes::add_epred_draws</code>, we used the <code>re_formula</code> argument to average over the random effects of <code>depth_maps_generation_filtering_mode</code>. For this model we have to collapse across the filtering mode effects to compare the dense cloud quality and software setting effects.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="stats_validation.html#cb259-1" tabindex="-1"></a>qlty_sftwr_draws_temp <span class="ot">=</span> ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb259-2"><a href="stats_validation.html#cb259-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality, software) <span class="sc">%&gt;%</span> </span>
<span id="cb259-3"><a href="stats_validation.html#cb259-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb259-4"><a href="stats_validation.html#cb259-4" tabindex="-1"></a>    brms_f_mod3, <span class="at">allow_new_levels =</span> T</span>
<span id="cb259-5"><a href="stats_validation.html#cb259-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb259-6"><a href="stats_validation.html#cb259-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span></span>
<span id="cb259-7"><a href="stats_validation.html#cb259-7" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> software) <span class="sc">+</span> </span>
<span id="cb259-8"><a href="stats_validation.html#cb259-8" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>software)</span>
<span id="cb259-9"><a href="stats_validation.html#cb259-9" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb259-10"><a href="stats_validation.html#cb259-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) </span>
<span id="cb259-11"><a href="stats_validation.html#cb259-11" tabindex="-1"></a><span class="co"># plot it</span></span>
<span id="cb259-12"><a href="stats_validation.html#cb259-12" tabindex="-1"></a>qlty_sftwr_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb259-13"><a href="stats_validation.html#cb259-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">depth_maps_generation_quality =</span> depth_maps_generation_quality <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb259-14"><a href="stats_validation.html#cb259-14" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb259-15"><a href="stats_validation.html#cb259-15" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb259-16"><a href="stats_validation.html#cb259-16" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb259-17"><a href="stats_validation.html#cb259-17" tabindex="-1"></a>      <span class="at">y =</span> value, <span class="at">x =</span> software</span>
<span id="cb259-18"><a href="stats_validation.html#cb259-18" tabindex="-1"></a>      , <span class="at">fill =</span> software</span>
<span id="cb259-19"><a href="stats_validation.html#cb259-19" tabindex="-1"></a>    )</span>
<span id="cb259-20"><a href="stats_validation.html#cb259-20" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb259-21"><a href="stats_validation.html#cb259-21" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_eye</span>(</span>
<span id="cb259-22"><a href="stats_validation.html#cb259-22" tabindex="-1"></a>    <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb259-23"><a href="stats_validation.html#cb259-23" tabindex="-1"></a>    , <span class="at">slab_alpha =</span> <span class="fl">0.8</span></span>
<span id="cb259-24"><a href="stats_validation.html#cb259-24" tabindex="-1"></a>    , <span class="at">interval_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb259-25"><a href="stats_validation.html#cb259-25" tabindex="-1"></a>    , <span class="at">point_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_size =</span> <span class="dv">1</span></span>
<span id="cb259-26"><a href="stats_validation.html#cb259-26" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb259-27"><a href="stats_validation.html#cb259-27" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;rocket&quot;</span>, <span class="at">begin =</span> <span class="fl">0.3</span>, <span class="at">end =</span> <span class="fl">0.9</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb259-28"><a href="stats_validation.html#cb259-28" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb259-29"><a href="stats_validation.html#cb259-29" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(depth_maps_generation_quality)) <span class="sc">+</span></span>
<span id="cb259-30"><a href="stats_validation.html#cb259-30" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb259-31"><a href="stats_validation.html#cb259-31" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;software&quot;</span>, <span class="at">y =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb259-32"><a href="stats_validation.html#cb259-32" tabindex="-1"></a>    , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI</span><span class="sc">\n</span><span class="st">by dense cloud quality&quot;</span></span>
<span id="cb259-33"><a href="stats_validation.html#cb259-33" tabindex="-1"></a>    , <span class="at">caption =</span> form_temp</span>
<span id="cb259-34"><a href="stats_validation.html#cb259-34" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb259-35"><a href="stats_validation.html#cb259-35" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb259-36"><a href="stats_validation.html#cb259-36" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb259-37"><a href="stats_validation.html#cb259-37" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb259-38"><a href="stats_validation.html#cb259-38" tabindex="-1"></a>    , <span class="at">legend.direction  =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb259-39"><a href="stats_validation.html#cb259-39" tabindex="-1"></a>    , <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb259-40"><a href="stats_validation.html#cb259-40" tabindex="-1"></a>    , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb259-41"><a href="stats_validation.html#cb259-41" tabindex="-1"></a>  ) </span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-185-1.png" width="1008" /></p>
<p>we can also make pairwise comparisons so long as we continue using <code>tidybayes::add_epred_draws</code> with the <code>re_formula</code> argument</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="stats_validation.html#cb260-1" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> qlty_sftwr_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb260-2"><a href="stats_validation.html#cb260-2" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb260-3"><a href="stats_validation.html#cb260-3" tabindex="-1"></a>    value</span>
<span id="cb260-4"><a href="stats_validation.html#cb260-4" tabindex="-1"></a>    , <span class="at">by =</span> depth_maps_generation_quality</span>
<span id="cb260-5"><a href="stats_validation.html#cb260-5" tabindex="-1"></a>    , <span class="at">comparison =</span> </span>
<span id="cb260-6"><a href="stats_validation.html#cb260-6" tabindex="-1"></a>      contrast_list[<span class="sc">!</span>stringr<span class="sc">::</span><span class="fu">str_detect</span>(contrast_list, <span class="st">&quot;lowest&quot;</span>)]</span>
<span id="cb260-7"><a href="stats_validation.html#cb260-7" tabindex="-1"></a>      <span class="co"># contrast_list</span></span>
<span id="cb260-8"><a href="stats_validation.html#cb260-8" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb260-9"><a href="stats_validation.html#cb260-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> depth_maps_generation_quality)</span>
<span id="cb260-10"><a href="stats_validation.html#cb260-10" tabindex="-1"></a></span>
<span id="cb260-11"><a href="stats_validation.html#cb260-11" tabindex="-1"></a><span class="co"># separate contrast</span></span>
<span id="cb260-12"><a href="stats_validation.html#cb260-12" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb260-13"><a href="stats_validation.html#cb260-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb260-14"><a href="stats_validation.html#cb260-14" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(</span>
<span id="cb260-15"><a href="stats_validation.html#cb260-15" tabindex="-1"></a>    <span class="at">cols =</span> contrast</span>
<span id="cb260-16"><a href="stats_validation.html#cb260-16" tabindex="-1"></a>    , <span class="at">delim =</span> <span class="st">&quot; - &quot;</span></span>
<span id="cb260-17"><a href="stats_validation.html#cb260-17" tabindex="-1"></a>    , <span class="at">names =</span> <span class="fu">paste0</span>(</span>
<span id="cb260-18"><a href="stats_validation.html#cb260-18" tabindex="-1"></a>      <span class="st">&quot;sorter&quot;</span></span>
<span id="cb260-19"><a href="stats_validation.html#cb260-19" tabindex="-1"></a>      , <span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(stringr<span class="sc">::</span><span class="fu">str_count</span>(brms_contrast_temp<span class="sc">$</span>contrast, <span class="st">&quot;-&quot;</span>))<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb260-20"><a href="stats_validation.html#cb260-20" tabindex="-1"></a>    )</span>
<span id="cb260-21"><a href="stats_validation.html#cb260-21" tabindex="-1"></a>    , <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span></span>
<span id="cb260-22"><a href="stats_validation.html#cb260-22" tabindex="-1"></a>    , <span class="at">cols_remove =</span> F</span>
<span id="cb260-23"><a href="stats_validation.html#cb260-23" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb260-24"><a href="stats_validation.html#cb260-24" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sorter1<span class="sc">!=</span>sorter2) <span class="sc">%&gt;%</span> </span>
<span id="cb260-25"><a href="stats_validation.html#cb260-25" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb260-26"><a href="stats_validation.html#cb260-26" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb260-27"><a href="stats_validation.html#cb260-27" tabindex="-1"></a>      tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sorter&quot;</span>)</span>
<span id="cb260-28"><a href="stats_validation.html#cb260-28" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="cf">function</span>(x){<span class="fu">factor</span>(</span>
<span id="cb260-29"><a href="stats_validation.html#cb260-29" tabindex="-1"></a>        x, <span class="at">ordered =</span> T</span>
<span id="cb260-30"><a href="stats_validation.html#cb260-30" tabindex="-1"></a>        , <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_quality)</span>
<span id="cb260-31"><a href="stats_validation.html#cb260-31" tabindex="-1"></a>      )}</span>
<span id="cb260-32"><a href="stats_validation.html#cb260-32" tabindex="-1"></a>    )</span>
<span id="cb260-33"><a href="stats_validation.html#cb260-33" tabindex="-1"></a>    , <span class="at">contrast =</span> contrast <span class="sc">%&gt;%</span> </span>
<span id="cb260-34"><a href="stats_validation.html#cb260-34" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb260-35"><a href="stats_validation.html#cb260-35" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="fu">as.numeric</span>(sorter1), <span class="fu">as.numeric</span>(sorter2)) <span class="sc">%&gt;%</span> </span>
<span id="cb260-36"><a href="stats_validation.html#cb260-36" tabindex="-1"></a>          <span class="fu">as.numeric</span>()</span>
<span id="cb260-37"><a href="stats_validation.html#cb260-37" tabindex="-1"></a>      )</span>
<span id="cb260-38"><a href="stats_validation.html#cb260-38" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb260-39"><a href="stats_validation.html#cb260-39" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb260-40"><a href="stats_validation.html#cb260-40" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, software) <span class="sc">%&gt;%</span> </span>
<span id="cb260-41"><a href="stats_validation.html#cb260-41" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb260-42"><a href="stats_validation.html#cb260-42" tabindex="-1"></a></span>
<span id="cb260-43"><a href="stats_validation.html#cb260-43" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb260-44"><a href="stats_validation.html#cb260-44" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 720,000
## Columns: 17
## Groups: contrast, software [18]
## $ software            &lt;chr&gt; &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;METASHAPE&quot;…
## $ .chain              &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .iteration          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .draw               &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,…
## $ sorter1             &lt;ord&gt; ultra high, ultra high, ultra high, ultra high, ul…
## $ sorter2             &lt;ord&gt; high, high, high, high, high, high, high, high, hi…
## $ contrast            &lt;fct&gt; ultra high - high, ultra high - high, ultra high -…
## $ value               &lt;dbl&gt; 0.003195116, -0.019219782, 0.166484207, 0.10992287…
## $ median_hdi_est      &lt;dbl&gt; 0.02226909, 0.02226909, 0.02226909, 0.02226909, 0.…
## $ median_hdi_lower    &lt;dbl&gt; -0.09312331, -0.09312331, -0.09312331, -0.09312331…
## $ median_hdi_upper    &lt;dbl&gt; 0.138316, 0.138316, 0.138316, 0.138316, 0.138316, …
## $ is_gt_zero          &lt;lgl&gt; TRUE, FALSE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, T…
## $ pct_gt_zero         &lt;dbl&gt; 0.646325, 0.646325, 0.646325, 0.646325, 0.646325, …
## $ pct_gt_zero_lab     &lt;chr&gt; &quot;Pr(ultra high&gt;high)=65%&quot;, &quot;Pr(ultra high&gt;high)=65…
## $ pct_gt_zero_lab_sm  &lt;chr&gt; &quot;Pr(&gt;0)=65%&quot;, &quot;Pr(&gt;0)=65%&quot;, &quot;Pr(&gt;0)=65%&quot;, &quot;Pr(&gt;0)=…
## $ pct_gt_zero_lab_pos &lt;dbl&gt; 0.1486897, 0.1486897, 0.1486897, 0.1486897, 0.1486…
## $ sig_level           &lt;ord&gt; &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;8…</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="stats_validation.html#cb262-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb262-2"><a href="stats_validation.html#cb262-2" tabindex="-1"></a>  brms_contrast_temp, <span class="at">caption_text =</span> form_temp</span>
<span id="cb262-3"><a href="stats_validation.html#cb262-3" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;quality&quot;</span></span>
<span id="cb262-4"><a href="stats_validation.html#cb262-4" tabindex="-1"></a>  , <span class="at">facet =</span> <span class="st">&quot;software&quot;</span></span>
<span id="cb262-5"><a href="stats_validation.html#cb262-5" tabindex="-1"></a>  , <span class="at">label_size =</span> <span class="fl">2.2</span></span>
<span id="cb262-6"><a href="stats_validation.html#cb262-6" tabindex="-1"></a>  , <span class="at">x_expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>)</span>
<span id="cb262-7"><a href="stats_validation.html#cb262-7" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb262-8"><a href="stats_validation.html#cb262-8" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb262-9"><a href="stats_validation.html#cb262-9" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of group constrasts with 95% &amp; 50% HDI</span><span class="sc">\n</span><span class="st">by software&quot;</span></span>
<span id="cb262-10"><a href="stats_validation.html#cb262-10" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-187-1.png" width="1008" /></p>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="stats_validation.html#cb263-1" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb263-2"><a href="stats_validation.html#cb263-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, software) <span class="sc">%&gt;%</span> </span>
<span id="cb263-3"><a href="stats_validation.html#cb263-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb263-4"><a href="stats_validation.html#cb263-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast, software) <span class="sc">%&gt;%</span> </span>
<span id="cb263-5"><a href="stats_validation.html#cb263-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, software, value, .lower, .upper) <span class="sc">%&gt;%</span> </span>
<span id="cb263-6"><a href="stats_validation.html#cb263-6" tabindex="-1"></a>   </span>
<span id="cb263-7"><a href="stats_validation.html#cb263-7" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb263-8"><a href="stats_validation.html#cb263-8" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb263-9"><a href="stats_validation.html#cb263-9" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb263-10"><a href="stats_validation.html#cb263-10" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb263-11"><a href="stats_validation.html#cb263-11" tabindex="-1"></a>      <span class="st">&quot;quality contrast&quot;</span></span>
<span id="cb263-12"><a href="stats_validation.html#cb263-12" tabindex="-1"></a>      , <span class="st">&quot;software&quot;</span></span>
<span id="cb263-13"><a href="stats_validation.html#cb263-13" tabindex="-1"></a>      , <span class="st">&quot;difference (F-score)&quot;</span></span>
<span id="cb263-14"><a href="stats_validation.html#cb263-14" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb263-15"><a href="stats_validation.html#cb263-15" tabindex="-1"></a>    )</span>
<span id="cb263-16"><a href="stats_validation.html#cb263-16" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb263-17"><a href="stats_validation.html#cb263-17" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb263-18"><a href="stats_validation.html#cb263-18" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;6in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:6in; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-188">Table 6.12: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
quality contrast
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
software
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
difference (F-score)
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI low
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.14
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.14
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.31
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.29
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.32
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.15
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.27
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.21
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.13
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
</tbody>
</table>
</div>
<p>let’s collapse across the filtering mode and software to compare the dense cloud quality setting effect.
In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="stats_validation.html#cb264-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb264-2"><a href="stats_validation.html#cb264-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb264-3"><a href="stats_validation.html#cb264-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb264-4"><a href="stats_validation.html#cb264-4" tabindex="-1"></a>    brms_f_mod3</span>
<span id="cb264-5"><a href="stats_validation.html#cb264-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb264-6"><a href="stats_validation.html#cb264-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality)</span>
<span id="cb264-7"><a href="stats_validation.html#cb264-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb264-8"><a href="stats_validation.html#cb264-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb264-9"><a href="stats_validation.html#cb264-9" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb264-10"><a href="stats_validation.html#cb264-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb264-11"><a href="stats_validation.html#cb264-11" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb264-12"><a href="stats_validation.html#cb264-12" tabindex="-1"></a>      <span class="at">x =</span> value, <span class="at">y =</span> depth_maps_generation_quality</span>
<span id="cb264-13"><a href="stats_validation.html#cb264-13" tabindex="-1"></a>      , <span class="at">fill =</span> depth_maps_generation_quality</span>
<span id="cb264-14"><a href="stats_validation.html#cb264-14" tabindex="-1"></a>    )</span>
<span id="cb264-15"><a href="stats_validation.html#cb264-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb264-16"><a href="stats_validation.html#cb264-16" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb264-17"><a href="stats_validation.html#cb264-17" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb264-18"><a href="stats_validation.html#cb264-18" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;gray66&quot;</span></span>
<span id="cb264-19"><a href="stats_validation.html#cb264-19" tabindex="-1"></a>      , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_color =</span> <span class="st">&quot;gray66&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb264-20"><a href="stats_validation.html#cb264-20" tabindex="-1"></a>      , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb264-21"><a href="stats_validation.html#cb264-21" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb264-22"><a href="stats_validation.html#cb264-22" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;inferno&quot;</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb264-23"><a href="stats_validation.html#cb264-23" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb264-24"><a href="stats_validation.html#cb264-24" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb264-25"><a href="stats_validation.html#cb264-25" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;quality&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb264-26"><a href="stats_validation.html#cb264-26" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI&quot;</span></span>
<span id="cb264-27"><a href="stats_validation.html#cb264-27" tabindex="-1"></a>      , <span class="at">caption =</span> form_temp</span>
<span id="cb264-28"><a href="stats_validation.html#cb264-28" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb264-29"><a href="stats_validation.html#cb264-29" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb264-30"><a href="stats_validation.html#cb264-30" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-189-1.png" width="1008" /></p>
<p>let’s compare these results to the results from our <a href="stats_validation.html#f_one_pred_mod_bays">one nominal predictor model above</a> and <a href="stats_validation.html#f_two_pred_mod_bays">two nominal predictor model</a></p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="stats_validation.html#cb265-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb265-2"><a href="stats_validation.html#cb265-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb265-3"><a href="stats_validation.html#cb265-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb265-4"><a href="stats_validation.html#cb265-4" tabindex="-1"></a>    brms_f_mod3</span>
<span id="cb265-5"><a href="stats_validation.html#cb265-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb265-6"><a href="stats_validation.html#cb265-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality)</span>
<span id="cb265-7"><a href="stats_validation.html#cb265-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb265-8"><a href="stats_validation.html#cb265-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod3&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb265-9"><a href="stats_validation.html#cb265-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb265-10"><a href="stats_validation.html#cb265-10" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb265-11"><a href="stats_validation.html#cb265-11" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb265-12"><a href="stats_validation.html#cb265-12" tabindex="-1"></a>      tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb265-13"><a href="stats_validation.html#cb265-13" tabindex="-1"></a>        brms_f_mod2</span>
<span id="cb265-14"><a href="stats_validation.html#cb265-14" tabindex="-1"></a>        <span class="co"># this part is crucial</span></span>
<span id="cb265-15"><a href="stats_validation.html#cb265-15" tabindex="-1"></a>        , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality)</span>
<span id="cb265-16"><a href="stats_validation.html#cb265-16" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb265-17"><a href="stats_validation.html#cb265-17" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod2&quot;</span>)</span>
<span id="cb265-18"><a href="stats_validation.html#cb265-18" tabindex="-1"></a>    , ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb265-19"><a href="stats_validation.html#cb265-19" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb265-20"><a href="stats_validation.html#cb265-20" tabindex="-1"></a>      tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(brms_f_mod1) <span class="sc">%&gt;%</span> </span>
<span id="cb265-21"><a href="stats_validation.html#cb265-21" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod1&quot;</span>)</span>
<span id="cb265-22"><a href="stats_validation.html#cb265-22" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb265-23"><a href="stats_validation.html#cb265-23" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> src, <span class="at">x =</span> value, <span class="at">color =</span> src, <span class="at">group =</span> src)) <span class="sc">+</span></span>
<span id="cb265-24"><a href="stats_validation.html#cb265-24" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_pointinterval</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb265-25"><a href="stats_validation.html#cb265-25" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(depth_maps_generation_quality), <span class="at">switch =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb265-26"><a href="stats_validation.html#cb265-26" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb265-27"><a href="stats_validation.html#cb265-27" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> viridis<span class="sc">::</span><span class="fu">turbo</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb265-28"><a href="stats_validation.html#cb265-28" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb265-29"><a href="stats_validation.html#cb265-29" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb265-30"><a href="stats_validation.html#cb265-30" tabindex="-1"></a>    , <span class="at">color =</span> <span class="st">&quot;model&quot;</span></span>
<span id="cb265-31"><a href="stats_validation.html#cb265-31" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb265-32"><a href="stats_validation.html#cb265-32" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb265-33"><a href="stats_validation.html#cb265-33" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-190-1.png" width="1008" /></p>
<p>let’s also collapse across the dense cloud quality and software to compare the filtering mode setting effect.
In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="stats_validation.html#cb266-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb266-2"><a href="stats_validation.html#cb266-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb266-3"><a href="stats_validation.html#cb266-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb266-4"><a href="stats_validation.html#cb266-4" tabindex="-1"></a>    brms_f_mod3</span>
<span id="cb266-5"><a href="stats_validation.html#cb266-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb266-6"><a href="stats_validation.html#cb266-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode)</span>
<span id="cb266-7"><a href="stats_validation.html#cb266-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb266-8"><a href="stats_validation.html#cb266-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb266-9"><a href="stats_validation.html#cb266-9" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb266-10"><a href="stats_validation.html#cb266-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb266-11"><a href="stats_validation.html#cb266-11" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb266-12"><a href="stats_validation.html#cb266-12" tabindex="-1"></a>      <span class="at">x =</span> value, <span class="at">y =</span> depth_maps_generation_filtering_mode</span>
<span id="cb266-13"><a href="stats_validation.html#cb266-13" tabindex="-1"></a>      , <span class="at">fill =</span> depth_maps_generation_filtering_mode</span>
<span id="cb266-14"><a href="stats_validation.html#cb266-14" tabindex="-1"></a>    )</span>
<span id="cb266-15"><a href="stats_validation.html#cb266-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb266-16"><a href="stats_validation.html#cb266-16" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb266-17"><a href="stats_validation.html#cb266-17" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb266-18"><a href="stats_validation.html#cb266-18" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;gray66&quot;</span></span>
<span id="cb266-19"><a href="stats_validation.html#cb266-19" tabindex="-1"></a>      , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_color =</span> <span class="st">&quot;gray66&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb266-20"><a href="stats_validation.html#cb266-20" tabindex="-1"></a>      , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb266-21"><a href="stats_validation.html#cb266-21" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb266-22"><a href="stats_validation.html#cb266-22" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb266-23"><a href="stats_validation.html#cb266-23" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb266-24"><a href="stats_validation.html#cb266-24" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb266-25"><a href="stats_validation.html#cb266-25" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;filtering mode&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb266-26"><a href="stats_validation.html#cb266-26" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI&quot;</span></span>
<span id="cb266-27"><a href="stats_validation.html#cb266-27" tabindex="-1"></a>      , <span class="at">caption =</span> form_temp</span>
<span id="cb266-28"><a href="stats_validation.html#cb266-28" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb266-29"><a href="stats_validation.html#cb266-29" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb266-30"><a href="stats_validation.html#cb266-30" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-191-1.png" width="1008" /></p>
<p>let’s compare these results to the results from our <a href="stats_validation.html#f_two_pred_mod_bays">two nominal predictor model above</a></p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="stats_validation.html#cb267-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb267-2"><a href="stats_validation.html#cb267-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb267-3"><a href="stats_validation.html#cb267-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb267-4"><a href="stats_validation.html#cb267-4" tabindex="-1"></a>    brms_f_mod3</span>
<span id="cb267-5"><a href="stats_validation.html#cb267-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb267-6"><a href="stats_validation.html#cb267-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode)</span>
<span id="cb267-7"><a href="stats_validation.html#cb267-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb267-8"><a href="stats_validation.html#cb267-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod3&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb267-9"><a href="stats_validation.html#cb267-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb267-10"><a href="stats_validation.html#cb267-10" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb267-11"><a href="stats_validation.html#cb267-11" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb267-12"><a href="stats_validation.html#cb267-12" tabindex="-1"></a>      tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb267-13"><a href="stats_validation.html#cb267-13" tabindex="-1"></a>        brms_f_mod2</span>
<span id="cb267-14"><a href="stats_validation.html#cb267-14" tabindex="-1"></a>        <span class="co"># this part is crucial</span></span>
<span id="cb267-15"><a href="stats_validation.html#cb267-15" tabindex="-1"></a>        , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode)</span>
<span id="cb267-16"><a href="stats_validation.html#cb267-16" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb267-17"><a href="stats_validation.html#cb267-17" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod2&quot;</span>)</span>
<span id="cb267-18"><a href="stats_validation.html#cb267-18" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb267-19"><a href="stats_validation.html#cb267-19" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> src, <span class="at">x =</span> value, <span class="at">color =</span> src, <span class="at">group =</span> src)) <span class="sc">+</span></span>
<span id="cb267-20"><a href="stats_validation.html#cb267-20" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_pointinterval</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-21"><a href="stats_validation.html#cb267-21" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(depth_maps_generation_filtering_mode), <span class="at">switch =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb267-22"><a href="stats_validation.html#cb267-22" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb267-23"><a href="stats_validation.html#cb267-23" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> viridis<span class="sc">::</span><span class="fu">turbo</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb267-24"><a href="stats_validation.html#cb267-24" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb267-25"><a href="stats_validation.html#cb267-25" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;filtering mode&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb267-26"><a href="stats_validation.html#cb267-26" tabindex="-1"></a>    , <span class="at">color =</span> <span class="st">&quot;model&quot;</span></span>
<span id="cb267-27"><a href="stats_validation.html#cb267-27" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb267-28"><a href="stats_validation.html#cb267-28" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb267-29"><a href="stats_validation.html#cb267-29" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-192-1.png" width="1008" /></p>
<p>to address one of our main questions, let’s also collapse across the dense cloud quality and filtering mode setting to compare the software effect.
In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="stats_validation.html#cb268-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb268-2"><a href="stats_validation.html#cb268-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(software) <span class="sc">%&gt;%</span> </span>
<span id="cb268-3"><a href="stats_validation.html#cb268-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb268-4"><a href="stats_validation.html#cb268-4" tabindex="-1"></a>    brms_f_mod3</span>
<span id="cb268-5"><a href="stats_validation.html#cb268-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb268-6"><a href="stats_validation.html#cb268-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> software)</span>
<span id="cb268-7"><a href="stats_validation.html#cb268-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb268-8"><a href="stats_validation.html#cb268-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb268-9"><a href="stats_validation.html#cb268-9" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb268-10"><a href="stats_validation.html#cb268-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb268-11"><a href="stats_validation.html#cb268-11" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb268-12"><a href="stats_validation.html#cb268-12" tabindex="-1"></a>      <span class="at">x =</span> value, <span class="at">y =</span> software</span>
<span id="cb268-13"><a href="stats_validation.html#cb268-13" tabindex="-1"></a>      , <span class="at">fill =</span> software</span>
<span id="cb268-14"><a href="stats_validation.html#cb268-14" tabindex="-1"></a>    )</span>
<span id="cb268-15"><a href="stats_validation.html#cb268-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb268-16"><a href="stats_validation.html#cb268-16" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb268-17"><a href="stats_validation.html#cb268-17" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb268-18"><a href="stats_validation.html#cb268-18" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;gray66&quot;</span></span>
<span id="cb268-19"><a href="stats_validation.html#cb268-19" tabindex="-1"></a>      , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_color =</span> <span class="st">&quot;gray66&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb268-20"><a href="stats_validation.html#cb268-20" tabindex="-1"></a>      , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb268-21"><a href="stats_validation.html#cb268-21" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb268-22"><a href="stats_validation.html#cb268-22" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;rocket&quot;</span>, <span class="at">begin =</span> <span class="fl">0.3</span>, <span class="at">end =</span> <span class="fl">0.9</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb268-23"><a href="stats_validation.html#cb268-23" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb268-24"><a href="stats_validation.html#cb268-24" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb268-25"><a href="stats_validation.html#cb268-25" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;software&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb268-26"><a href="stats_validation.html#cb268-26" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI&quot;</span></span>
<span id="cb268-27"><a href="stats_validation.html#cb268-27" tabindex="-1"></a>      , <span class="at">caption =</span> form_temp</span>
<span id="cb268-28"><a href="stats_validation.html#cb268-28" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb268-29"><a href="stats_validation.html#cb268-29" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb268-30"><a href="stats_validation.html#cb268-30" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-193-1.png" width="1008" /></p>
<p>Finally, we can quantify the variation in F-score by comparing the <span class="math inline">\(\sigma\)</span> posteriors.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="stats_validation.html#cb269-1" tabindex="-1"></a><span class="co"># extract the posterior draws</span></span>
<span id="cb269-2"><a href="stats_validation.html#cb269-2" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod3) <span class="sc">%&gt;%</span> </span>
<span id="cb269-3"><a href="stats_validation.html#cb269-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(sigma,tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sd_&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb269-4"><a href="stats_validation.html#cb269-4" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(dplyr<span class="sc">::</span><span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb269-5"><a href="stats_validation.html#cb269-5" tabindex="-1"></a>  <span class="co"># dplyr::group_by(name) %&gt;% </span></span>
<span id="cb269-6"><a href="stats_validation.html#cb269-6" tabindex="-1"></a>  <span class="co"># tidybayes::median_hdi(value) %&gt;% </span></span>
<span id="cb269-7"><a href="stats_validation.html#cb269-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb269-8"><a href="stats_validation.html#cb269-8" tabindex="-1"></a>    <span class="at">name =</span> name <span class="sc">%&gt;%</span> </span>
<span id="cb269-9"><a href="stats_validation.html#cb269-9" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_quality&quot;</span>, <span class="st">&quot;quality&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb269-10"><a href="stats_validation.html#cb269-10" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span>, <span class="st">&quot;filtering&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb269-11"><a href="stats_validation.html#cb269-11" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(value)</span>
<span id="cb269-12"><a href="stats_validation.html#cb269-12" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb269-13"><a href="stats_validation.html#cb269-13" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb269-14"><a href="stats_validation.html#cb269-14" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> name)) <span class="sc">+</span></span>
<span id="cb269-15"><a href="stats_validation.html#cb269-15" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_dotsinterval</span>(</span>
<span id="cb269-16"><a href="stats_validation.html#cb269-16" tabindex="-1"></a>    <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb269-17"><a href="stats_validation.html#cb269-17" tabindex="-1"></a>    , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.04</span></span>
<span id="cb269-18"><a href="stats_validation.html#cb269-18" tabindex="-1"></a>    , <span class="at">shape =</span> <span class="dv">21</span> <span class="co">#, point_size = 3</span></span>
<span id="cb269-19"><a href="stats_validation.html#cb269-19" tabindex="-1"></a>    , <span class="at">quantiles =</span> <span class="dv">100</span></span>
<span id="cb269-20"><a href="stats_validation.html#cb269-20" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb269-21"><a href="stats_validation.html#cb269-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">caption =</span> form_temp) <span class="sc">+</span></span>
<span id="cb269-22"><a href="stats_validation.html#cb269-22" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-194-1.png" width="1008" /></p>
<p>and perform model selection via information criteria with the <code>brms::loo_compare()</code> function</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="stats_validation.html#cb270-1" tabindex="-1"></a>brms_f_mod3 <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">add_criterion</span>(brms_f_mod3, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</span>
<span id="cb270-2"><a href="stats_validation.html#cb270-2" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">loo_compare</span>(brms_f_mod1, brms_f_mod2, brms_f_mod3, <span class="at">criterion =</span> <span class="st">&quot;loo&quot;</span>)</span></code></pre></div>
<pre><code>##             elpd_diff se_diff
## brms_f_mod3  0.0       0.0   
## brms_f_mod1 -0.3       3.8   
## brms_f_mod2 -2.0       3.6</code></pre>
</div>
</div>
<div id="three-nominal-predictors-site-effects" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Three Nominal Predictors + site effects<a href="stats_validation.html#three-nominal-predictors-site-effects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now, we’ll add the average deflection from the baseline (i.e. the “grand mean”) due to study site (i.e. the “subjects” in our data). The main effect for the study site will be added to our model with the combined influence of the depth map generation quality, the depth map filtering, and the software on the F-score.</p>
<p>In the model we use below, the study site is modeled as a “random effect.” <a href="https://esajournals.onlinelibrary.wiley.com/doi/abs/10.1002/ecm.1598">Hobbs et al. (2024)</a> describe a similar model:</p>
<blockquote>
<p>It is important to understand that fitting treatment intercepts and slopes as random rather than fixed means that our inference applied to all possible sites suitable for [inclusion in the study]. In contrast, assuming fixed effects of treatment would dramatically reduce the uncertainty about those effects, but would constrain inference to the four sites that we studied. (p. 13)</p>
</blockquote>
<div id="summary-statistics-8" class="section level3 hasAnchor" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> Summary Statistics<a href="stats_validation.html#summary-statistics-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Each study site contributes one observation per dense cloud quality, filtering mode, and software. That is, a row in the underlying data is unique by study site, software, dense cloud quality, and filtering mode.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="stats_validation.html#cb272-1" tabindex="-1"></a><span class="fu">identical</span>(</span>
<span id="cb272-2"><a href="stats_validation.html#cb272-2" tabindex="-1"></a>  <span class="co"># base data</span></span>
<span id="cb272-3"><a href="stats_validation.html#cb272-3" tabindex="-1"></a>  <span class="fu">nrow</span>(ptcld_validation_data)</span>
<span id="cb272-4"><a href="stats_validation.html#cb272-4" tabindex="-1"></a>  <span class="co"># distinct group</span></span>
<span id="cb272-5"><a href="stats_validation.html#cb272-5" tabindex="-1"></a>  , ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb272-6"><a href="stats_validation.html#cb272-6" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(</span>
<span id="cb272-7"><a href="stats_validation.html#cb272-7" tabindex="-1"></a>      study_site</span>
<span id="cb272-8"><a href="stats_validation.html#cb272-8" tabindex="-1"></a>      , software</span>
<span id="cb272-9"><a href="stats_validation.html#cb272-9" tabindex="-1"></a>      , depth_maps_generation_quality</span>
<span id="cb272-10"><a href="stats_validation.html#cb272-10" tabindex="-1"></a>      , depth_maps_generation_filtering_mode</span>
<span id="cb272-11"><a href="stats_validation.html#cb272-11" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb272-12"><a href="stats_validation.html#cb272-12" tabindex="-1"></a>    <span class="fu">nrow</span>()</span>
<span id="cb272-13"><a href="stats_validation.html#cb272-13" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="f_4_pred_mod_bays" class="section level3 hasAnchor" number="6.6.2">
<h3><span class="header-section-number">6.6.2</span> Bayesian<a href="stats_validation.html#f_4_pred_mod_bays" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://sites.google.com/site/doingbayesiandataanalysis/">Kruschke (2015)</a> describes the Hierarchical Bayesian approach to describe groups of metric data with multiple nominal predictors when every subject (“study site” in our research) only contributes one observation per cell/condition:</p>
<blockquote>
<p><span class="math display">\[\begin{align*}
y = &amp; \; \beta_0 \\
&amp; + \overrightarrow \beta_1 \overrightarrow x_1 + \overrightarrow \beta_2 \overrightarrow x_2 + \overrightarrow \beta_{1 \times 2} \overrightarrow x_{1 \times 2} \\
&amp; + \overrightarrow \beta_S \overrightarrow x_S
\end{align*}\]</span></p>
</blockquote>
<blockquote>
<p>In other words, we assume a main effect of subject, but no interaction of subject with other predictors. In this model, the subject effect (deflection) is constant across treatments, and the treatment effects (deflections) are constant across subjects. Notice that the model makes no requirement that every subject contributes a datum to every condition. Indeed, the model allows zero or multiple data per subject per condition. Bayesian estimation makes no assumptions or requirements that the design is balanced (i.e., has equal numbers of measurement in each cell). (p. 608)</p>
</blockquote>
<p>and see section 20 from <a href="https://bookdown.org/content/3686/metric-predicted-variable-with-multiple-nominal-predictors.html">Kurz’s ebook supplement</a></p>
<p>The metric predicted variable with three nominal predictor variables and subject-level effects model has the form:</p>
<p><span class="math display">\[\begin{align*}
y_{i} \sim &amp; {\sf Normal} \bigl(\mu_{i}, \sigma_{y} \bigr) \\
\mu_{i} = &amp; \beta_0 \\
&amp; + \sum_{j} \beta_{1[j]} x_{1[j]} + \sum_{k} \beta_{2[k]} x_{2[k]} + \sum_{f} \beta_{3[f]} x_{3[f]} + \sum_{s} \beta_{4[s]} x_{4[s]}  \\
&amp; + \sum_{j,k} \beta_{1\times2[j,k]} x_{1\times2[j,k]} + \sum_{j,f} \beta_{1\times3[j,f]} x_{1\times3[j,f]} + \sum_{k,f} \beta_{2\times3[k,f]} x_{2\times3[k,f]} \\
&amp; + \sum_{j,k,f} \beta_{1\times2\times3[j,k,f]} x_{1\times2\times3[j,k,f]} \\
\beta_{0}  \sim &amp; {\sf Normal} (0,100) \\
\beta_{1[j]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{1}}) \\
\beta_{2[k]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{2}}) \\
\beta_{3[f]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{3}}) \\
\beta_{4[s]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{4}}) \\
\beta_{1\times2[j,k]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{1\times2}}) \\
\beta_{1\times3[j,f]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{1\times3}}) \\
\beta_{2\times3[k,f]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{2\times3}}) \\
\sigma_{\beta_{1}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{2}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{3}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{4}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{1\times2}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{1\times3}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{2\times3}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{y} \sim &amp; {\sf Cauchy} (0,109) \\
\end{align*}\]</span></p>
<p>, where <span class="math inline">\(j\)</span> is the depth map generation quality setting corresponding to observation <span class="math inline">\(i\)</span>, <span class="math inline">\(k\)</span> is the depth map filtering mode setting corresponding to observation <span class="math inline">\(i\)</span>, <span class="math inline">\(f\)</span> is the processing software corresponding to observation <span class="math inline">\(i\)</span>, and <span class="math inline">\(s\)</span> is the study site corresponding to observation <span class="math inline">\(i\)</span></p>
<p><em>for this model, we’ll define the priors following <a href="https://bookdown.org/content/3686/metric-predicted-variable-with-multiple-nominal-predictors.html#implementation-in-jags-brms.-1">Kurz</a></em>:</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="stats_validation.html#cb274-1" tabindex="-1"></a><span class="co"># from Kurz: </span></span>
<span id="cb274-2"><a href="stats_validation.html#cb274-2" tabindex="-1"></a>gamma_a_b_from_omega_sigma <span class="ot">=</span> <span class="cf">function</span>(mode, sd) {</span>
<span id="cb274-3"><a href="stats_validation.html#cb274-3" tabindex="-1"></a>  <span class="cf">if</span> (mode <span class="sc">&lt;=</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">&quot;mode must be &gt; 0&quot;</span>)</span>
<span id="cb274-4"><a href="stats_validation.html#cb274-4" tabindex="-1"></a>  <span class="cf">if</span> (sd   <span class="sc">&lt;=</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">&quot;sd must be &gt; 0&quot;</span>)</span>
<span id="cb274-5"><a href="stats_validation.html#cb274-5" tabindex="-1"></a>  rate <span class="ot">=</span> (mode <span class="sc">+</span> <span class="fu">sqrt</span>(mode<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sd<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sd<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb274-6"><a href="stats_validation.html#cb274-6" tabindex="-1"></a>  shape <span class="ot">=</span> <span class="dv">1</span> <span class="sc">+</span> mode <span class="sc">*</span> rate</span>
<span id="cb274-7"><a href="stats_validation.html#cb274-7" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">shape =</span> shape, <span class="at">rate =</span> rate))</span>
<span id="cb274-8"><a href="stats_validation.html#cb274-8" tabindex="-1"></a>}</span>
<span id="cb274-9"><a href="stats_validation.html#cb274-9" tabindex="-1"></a></span>
<span id="cb274-10"><a href="stats_validation.html#cb274-10" tabindex="-1"></a>mean_y_temp <span class="ot">=</span> <span class="fu">mean</span>(ptcld_validation_data<span class="sc">$</span>f_score)</span>
<span id="cb274-11"><a href="stats_validation.html#cb274-11" tabindex="-1"></a>sd_y_temp   <span class="ot">=</span> <span class="fu">sd</span>(ptcld_validation_data<span class="sc">$</span>f_score)</span>
<span id="cb274-12"><a href="stats_validation.html#cb274-12" tabindex="-1"></a></span>
<span id="cb274-13"><a href="stats_validation.html#cb274-13" tabindex="-1"></a>omega_temp <span class="ot">=</span> sd_y_temp <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb274-14"><a href="stats_validation.html#cb274-14" tabindex="-1"></a>sigma_temp <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> sd_y_temp</span>
<span id="cb274-15"><a href="stats_validation.html#cb274-15" tabindex="-1"></a></span>
<span id="cb274-16"><a href="stats_validation.html#cb274-16" tabindex="-1"></a>s_r_temp <span class="ot">=</span> <span class="fu">gamma_a_b_from_omega_sigma</span>(<span class="at">mode =</span> omega_temp, <span class="at">sd =</span> sigma_temp)</span>
<span id="cb274-17"><a href="stats_validation.html#cb274-17" tabindex="-1"></a></span>
<span id="cb274-18"><a href="stats_validation.html#cb274-18" tabindex="-1"></a>stanvars_temp <span class="ot">=</span> </span>
<span id="cb274-19"><a href="stats_validation.html#cb274-19" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">stanvar</span>(mean_y_temp,    <span class="at">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="sc">+</span> </span>
<span id="cb274-20"><a href="stats_validation.html#cb274-20" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">stanvar</span>(sd_y_temp,      <span class="at">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb274-21"><a href="stats_validation.html#cb274-21" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">stanvar</span>(s_r_temp<span class="sc">$</span>shape, <span class="at">name =</span> <span class="st">&quot;alpha&quot;</span>) <span class="sc">+</span></span>
<span id="cb274-22"><a href="stats_validation.html#cb274-22" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">stanvar</span>(s_r_temp<span class="sc">$</span>rate,  <span class="at">name =</span> <span class="st">&quot;beta&quot;</span>)</span></code></pre></div>
<p>Now fit the model.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="stats_validation.html#cb275-1" tabindex="-1"></a>brms_f_mod4 <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb275-2"><a href="stats_validation.html#cb275-2" tabindex="-1"></a>  <span class="at">formula =</span> f_score <span class="sc">~</span> </span>
<span id="cb275-3"><a href="stats_validation.html#cb275-3" tabindex="-1"></a>    <span class="co"># baseline</span></span>
<span id="cb275-4"><a href="stats_validation.html#cb275-4" tabindex="-1"></a>    <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb275-5"><a href="stats_validation.html#cb275-5" tabindex="-1"></a>    <span class="co"># main effects</span></span>
<span id="cb275-6"><a href="stats_validation.html#cb275-6" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span></span>
<span id="cb275-7"><a href="stats_validation.html#cb275-7" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode) <span class="sc">+</span> </span>
<span id="cb275-8"><a href="stats_validation.html#cb275-8" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> software) <span class="sc">+</span></span>
<span id="cb275-9"><a href="stats_validation.html#cb275-9" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> study_site) <span class="sc">+</span> <span class="co"># only fitting main effects of site and not interactions</span></span>
<span id="cb275-10"><a href="stats_validation.html#cb275-10" tabindex="-1"></a>    <span class="co"># two-way interactions</span></span>
<span id="cb275-11"><a href="stats_validation.html#cb275-11" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode) <span class="sc">+</span></span>
<span id="cb275-12"><a href="stats_validation.html#cb275-12" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>software) <span class="sc">+</span></span>
<span id="cb275-13"><a href="stats_validation.html#cb275-13" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode<span class="sc">:</span>software) <span class="sc">+</span></span>
<span id="cb275-14"><a href="stats_validation.html#cb275-14" tabindex="-1"></a>    <span class="co"># three-way interactions</span></span>
<span id="cb275-15"><a href="stats_validation.html#cb275-15" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode<span class="sc">:</span>software)</span>
<span id="cb275-16"><a href="stats_validation.html#cb275-16" tabindex="-1"></a>  , <span class="at">data =</span> ptcld_validation_data</span>
<span id="cb275-17"><a href="stats_validation.html#cb275-17" tabindex="-1"></a>  , <span class="at">family =</span> brms<span class="sc">::</span><span class="fu">brmsfamily</span>(<span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>)</span>
<span id="cb275-18"><a href="stats_validation.html#cb275-18" tabindex="-1"></a>  , <span class="at">iter =</span> <span class="dv">20000</span>, <span class="at">warmup =</span> <span class="dv">10000</span>, <span class="at">chains =</span> <span class="dv">4</span></span>
<span id="cb275-19"><a href="stats_validation.html#cb275-19" tabindex="-1"></a>  , <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>, <span class="at">max_treedepth =</span> <span class="dv">13</span>)</span>
<span id="cb275-20"><a href="stats_validation.html#cb275-20" tabindex="-1"></a>  , <span class="at">cores =</span> <span class="fu">round</span>(parallel<span class="sc">::</span><span class="fu">detectCores</span>()<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb275-21"><a href="stats_validation.html#cb275-21" tabindex="-1"></a>  , <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb275-22"><a href="stats_validation.html#cb275-22" tabindex="-1"></a>    brms<span class="sc">::</span><span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">5</span>), <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>)</span>
<span id="cb275-23"><a href="stats_validation.html#cb275-23" tabindex="-1"></a>    , brms<span class="sc">::</span><span class="fu">prior</span>(<span class="fu">gamma</span>(alpha, beta), <span class="at">class =</span> <span class="st">&quot;sd&quot;</span>)</span>
<span id="cb275-24"><a href="stats_validation.html#cb275-24" tabindex="-1"></a>    , brms<span class="sc">::</span><span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>)</span>
<span id="cb275-25"><a href="stats_validation.html#cb275-25" tabindex="-1"></a>  )</span>
<span id="cb275-26"><a href="stats_validation.html#cb275-26" tabindex="-1"></a>  , <span class="at">stanvars =</span> stanvars_temp</span>
<span id="cb275-27"><a href="stats_validation.html#cb275-27" tabindex="-1"></a>  , <span class="at">file =</span> <span class="fu">paste0</span>(rootdir, <span class="st">&quot;/fits/brms_f_mod4&quot;</span>)</span>
<span id="cb275-28"><a href="stats_validation.html#cb275-28" tabindex="-1"></a>)</span></code></pre></div>
<p>check the trace plots for problems with convergence of the Markov chains</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="stats_validation.html#cb276-1" tabindex="-1"></a><span class="fu">plot</span>(brms_f_mod4)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-200-1.png" width="1008" /><img src="metashape_testing_files/figure-html/unnamed-chunk-200-2.png" width="1008" /></p>
<p>check the prior distributions</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="stats_validation.html#cb277-1" tabindex="-1"></a><span class="co"># check priors</span></span>
<span id="cb277-2"><a href="stats_validation.html#cb277-2" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">prior_summary</span>(brms_f_mod4) <span class="sc">%&gt;%</span> </span>
<span id="cb277-3"><a href="stats_validation.html#cb277-3" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb277-4"><a href="stats_validation.html#cb277-4" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
prior
</th>
<th style="text-align:left;">
class
</th>
<th style="text-align:left;">
coef
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
resp
</th>
<th style="text-align:left;">
dpar
</th>
<th style="text-align:left;">
nlpar
</th>
<th style="text-align:left;">
lb
</th>
<th style="text-align:left;">
ub
</th>
<th style="text-align:left;">
source
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
normal(mean_y, sd_y * 5)
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
user
</td>
</tr>
<tr>
<td style="text-align:left;">
gamma(alpha, beta)
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
user
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_filtering_mode
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_filtering_mode
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_filtering_mode:software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_filtering_mode:software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_quality
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_quality
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_quality:depth_maps_generation_filtering_mode
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_quality:depth_maps_generation_filtering_mode
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_quality:depth_maps_generation_filtering_mode:software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_quality:depth_maps_generation_filtering_mode:software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_quality:software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_quality:software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
study_site
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
study_site
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
cauchy(0, sd_y)
</td>
<td style="text-align:left;">
sigma
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
user
</td>
</tr>
</tbody>
</table>
<p>The <code>brms::brm</code> model summary</p>
<p>We won’t clutter the output here but this can be run if you are following along on your own</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="stats_validation.html#cb278-1" tabindex="-1"></a>brms_f_mod4 <span class="sc">%&gt;%</span> </span>
<span id="cb278-2"><a href="stats_validation.html#cb278-2" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">posterior_summary</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb278-3"><a href="stats_validation.html#cb278-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb278-4"><a href="stats_validation.html#cb278-4" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameter&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb278-5"><a href="stats_validation.html#cb278-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(tolower) <span class="sc">%&gt;%</span> </span>
<span id="cb278-6"><a href="stats_validation.html#cb278-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb278-7"><a href="stats_validation.html#cb278-7" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_starts</span>(parameter, <span class="st">&quot;b_&quot;</span>) </span>
<span id="cb278-8"><a href="stats_validation.html#cb278-8" tabindex="-1"></a>    <span class="sc">|</span> stringr<span class="sc">::</span><span class="fu">str_starts</span>(parameter, <span class="st">&quot;r_&quot;</span>) </span>
<span id="cb278-9"><a href="stats_validation.html#cb278-9" tabindex="-1"></a>    <span class="sc">|</span> stringr<span class="sc">::</span><span class="fu">str_starts</span>(parameter, <span class="st">&quot;sd_&quot;</span>) </span>
<span id="cb278-10"><a href="stats_validation.html#cb278-10" tabindex="-1"></a>    <span class="sc">|</span> parameter <span class="sc">==</span> <span class="st">&quot;sigma&quot;</span></span>
<span id="cb278-11"><a href="stats_validation.html#cb278-11" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb278-12"><a href="stats_validation.html#cb278-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb278-13"><a href="stats_validation.html#cb278-13" tabindex="-1"></a>    <span class="at">parameter =</span> parameter <span class="sc">%&gt;%</span> </span>
<span id="cb278-14"><a href="stats_validation.html#cb278-14" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_quality&quot;</span>, <span class="st">&quot;quality&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb278-15"><a href="stats_validation.html#cb278-15" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span>, <span class="st">&quot;filtering&quot;</span>)</span>
<span id="cb278-16"><a href="stats_validation.html#cb278-16" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb278-17"><a href="stats_validation.html#cb278-17" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">2</span>, <span class="at">caption =</span> <span class="st">&quot;Bayesian 3 nominal predictors + study site effects for F-score&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb278-18"><a href="stats_validation.html#cb278-18" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb278-19"><a href="stats_validation.html#cb278-19" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;6in&quot;</span>)</span></code></pre></div>
<p>We can look at the model noise standard deviation <span class="math inline">\(\sigma_y\)</span></p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="stats_validation.html#cb279-1" tabindex="-1"></a><span class="co"># get formula</span></span>
<span id="cb279-2"><a href="stats_validation.html#cb279-2" tabindex="-1"></a>form_temp <span class="ot">=</span> brms_f_mod4<span class="sc">$</span>formula<span class="sc">$</span>formula[<span class="dv">3</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb279-3"><a href="stats_validation.html#cb279-3" tabindex="-1"></a>  <span class="fu">as.character</span>() <span class="sc">%&gt;%</span> <span class="fu">get_frmla_text</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb279-4"><a href="stats_validation.html#cb279-4" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_quality&quot;</span>, <span class="st">&quot;quality&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb279-5"><a href="stats_validation.html#cb279-5" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span>, <span class="st">&quot;filtering&quot;</span>)</span>
<span id="cb279-6"><a href="stats_validation.html#cb279-6" tabindex="-1"></a><span class="co"># extract the posterior draws</span></span>
<span id="cb279-7"><a href="stats_validation.html#cb279-7" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod4) <span class="sc">%&gt;%</span> </span>
<span id="cb279-8"><a href="stats_validation.html#cb279-8" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb279-9"><a href="stats_validation.html#cb279-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sigma, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb279-10"><a href="stats_validation.html#cb279-10" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_dotsinterval</span>(</span>
<span id="cb279-11"><a href="stats_validation.html#cb279-11" tabindex="-1"></a>    <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb279-12"><a href="stats_validation.html#cb279-12" tabindex="-1"></a>    , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.04</span></span>
<span id="cb279-13"><a href="stats_validation.html#cb279-13" tabindex="-1"></a>    , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_size =</span> <span class="dv">3</span></span>
<span id="cb279-14"><a href="stats_validation.html#cb279-14" tabindex="-1"></a>    , <span class="at">quantiles =</span> <span class="dv">100</span></span>
<span id="cb279-15"><a href="stats_validation.html#cb279-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb279-16"><a href="stats_validation.html#cb279-16" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb279-17"><a href="stats_validation.html#cb279-17" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb279-18"><a href="stats_validation.html#cb279-18" tabindex="-1"></a>    <span class="at">x =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">sigma_y$&quot;</span>)</span>
<span id="cb279-19"><a href="stats_validation.html#cb279-19" tabindex="-1"></a>    , <span class="at">caption =</span> form_temp</span>
<span id="cb279-20"><a href="stats_validation.html#cb279-20" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb279-21"><a href="stats_validation.html#cb279-21" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-203-1.png" width="1008" /></p>
<p>how is it compared to our other models?</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="stats_validation.html#cb280-1" tabindex="-1"></a><span class="co"># how is it compared to our other models?</span></span>
<span id="cb280-2"><a href="stats_validation.html#cb280-2" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb280-3"><a href="stats_validation.html#cb280-3" tabindex="-1"></a>    brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod1) <span class="sc">%&gt;%</span> tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(sigma) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;one nominal predictor&quot;</span>)</span>
<span id="cb280-4"><a href="stats_validation.html#cb280-4" tabindex="-1"></a>    , brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod2) <span class="sc">%&gt;%</span> tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(sigma) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;two nominal predictor&quot;</span>)</span>
<span id="cb280-5"><a href="stats_validation.html#cb280-5" tabindex="-1"></a>    , brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod3) <span class="sc">%&gt;%</span> tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(sigma) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;three nominal predictor&quot;</span>)</span>
<span id="cb280-6"><a href="stats_validation.html#cb280-6" tabindex="-1"></a>    , brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod4) <span class="sc">%&gt;%</span> tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(sigma) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;three+site nominal predictor&quot;</span>)</span>
<span id="cb280-7"><a href="stats_validation.html#cb280-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb280-8"><a href="stats_validation.html#cb280-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb280-9"><a href="stats_validation.html#cb280-9" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">2</span>, <span class="at">caption =</span> <span class="st">&quot;brms::brm model noise standard deviation comparison&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb280-10"><a href="stats_validation.html#cb280-10" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-204">Table 6.13: </span>brms::brm model noise standard deviation comparison
</caption>
<thead>
<tr>
<th style="text-align:left;">
model
</th>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
.lower
</th>
<th style="text-align:right;">
.upper
</th>
<th style="text-align:right;">
.width
</th>
<th style="text-align:left;">
.point
</th>
<th style="text-align:left;">
.interval
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
one nominal predictor
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:left;">
median
</td>
<td style="text-align:left;">
hdi
</td>
</tr>
<tr>
<td style="text-align:left;">
two nominal predictor
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:left;">
median
</td>
<td style="text-align:left;">
hdi
</td>
</tr>
<tr>
<td style="text-align:left;">
three nominal predictor
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:left;">
median
</td>
<td style="text-align:left;">
hdi
</td>
</tr>
<tr>
<td style="text-align:left;">
three+site nominal predictor
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:left;">
median
</td>
<td style="text-align:left;">
hdi
</td>
</tr>
</tbody>
</table>
<p>plot the posterior predictive distributions of the conditional means with the median F-score and the 95% highest posterior density interval (HDI)</p>
<p>Note that how within <code>tidybayes::add_epred_draws</code>, we used the <code>re_formula</code> argument to average over the random effects of <code>study_site</code> (i.e., we left <code>(1 | study_site)</code> out of the formula) and <code>software</code> (i.e., we left <code>(1 | software)</code> and its interactions out of the formula).</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="stats_validation.html#cb281-1" tabindex="-1"></a>qlty_filter_draws_temp <span class="ot">=</span> </span>
<span id="cb281-2"><a href="stats_validation.html#cb281-2" tabindex="-1"></a>  ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb281-3"><a href="stats_validation.html#cb281-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb281-4"><a href="stats_validation.html#cb281-4" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb281-5"><a href="stats_validation.html#cb281-5" tabindex="-1"></a>      brms_f_mod4, <span class="at">allow_new_levels =</span> T</span>
<span id="cb281-6"><a href="stats_validation.html#cb281-6" tabindex="-1"></a>      <span class="co"># this part is crucial</span></span>
<span id="cb281-7"><a href="stats_validation.html#cb281-7" tabindex="-1"></a>      , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span></span>
<span id="cb281-8"><a href="stats_validation.html#cb281-8" tabindex="-1"></a>        (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode) <span class="sc">+</span> </span>
<span id="cb281-9"><a href="stats_validation.html#cb281-9" tabindex="-1"></a>        (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode)</span>
<span id="cb281-10"><a href="stats_validation.html#cb281-10" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb281-11"><a href="stats_validation.html#cb281-11" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) </span>
<span id="cb281-12"><a href="stats_validation.html#cb281-12" tabindex="-1"></a><span class="co"># hey plot</span></span>
<span id="cb281-13"><a href="stats_validation.html#cb281-13" tabindex="-1"></a>qlty_filter_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb281-14"><a href="stats_validation.html#cb281-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">depth_maps_generation_quality =</span> depth_maps_generation_quality <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb281-15"><a href="stats_validation.html#cb281-15" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb281-16"><a href="stats_validation.html#cb281-16" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb281-17"><a href="stats_validation.html#cb281-17" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb281-18"><a href="stats_validation.html#cb281-18" tabindex="-1"></a>      <span class="at">y =</span> value, <span class="at">x =</span> depth_maps_generation_filtering_mode</span>
<span id="cb281-19"><a href="stats_validation.html#cb281-19" tabindex="-1"></a>      , <span class="at">fill =</span> depth_maps_generation_filtering_mode</span>
<span id="cb281-20"><a href="stats_validation.html#cb281-20" tabindex="-1"></a>    )</span>
<span id="cb281-21"><a href="stats_validation.html#cb281-21" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb281-22"><a href="stats_validation.html#cb281-22" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_eye</span>(</span>
<span id="cb281-23"><a href="stats_validation.html#cb281-23" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb281-24"><a href="stats_validation.html#cb281-24" tabindex="-1"></a>      , <span class="at">slab_alpha =</span> <span class="fl">0.8</span></span>
<span id="cb281-25"><a href="stats_validation.html#cb281-25" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb281-26"><a href="stats_validation.html#cb281-26" tabindex="-1"></a>      , <span class="at">point_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_size =</span> <span class="dv">1</span></span>
<span id="cb281-27"><a href="stats_validation.html#cb281-27" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb281-28"><a href="stats_validation.html#cb281-28" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb281-29"><a href="stats_validation.html#cb281-29" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb281-30"><a href="stats_validation.html#cb281-30" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(depth_maps_generation_quality)) <span class="sc">+</span></span>
<span id="cb281-31"><a href="stats_validation.html#cb281-31" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb281-32"><a href="stats_validation.html#cb281-32" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">&quot;filtering mode&quot;</span>, <span class="at">y =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb281-33"><a href="stats_validation.html#cb281-33" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI</span><span class="sc">\n</span><span class="st">by dense cloud quality&quot;</span></span>
<span id="cb281-34"><a href="stats_validation.html#cb281-34" tabindex="-1"></a>      , <span class="at">fill =</span> <span class="st">&quot;Filtering Mode&quot;</span></span>
<span id="cb281-35"><a href="stats_validation.html#cb281-35" tabindex="-1"></a>      , <span class="at">caption =</span> form_temp</span>
<span id="cb281-36"><a href="stats_validation.html#cb281-36" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb281-37"><a href="stats_validation.html#cb281-37" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb281-38"><a href="stats_validation.html#cb281-38" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb281-39"><a href="stats_validation.html#cb281-39" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb281-40"><a href="stats_validation.html#cb281-40" tabindex="-1"></a>      , <span class="at">legend.direction  =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb281-41"><a href="stats_validation.html#cb281-41" tabindex="-1"></a>      , <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb281-42"><a href="stats_validation.html#cb281-42" tabindex="-1"></a>      , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb281-43"><a href="stats_validation.html#cb281-43" tabindex="-1"></a>    ) </span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-205-1.png" width="1008" /></p>
<p>we can also make pairwise comparisons so long as we continue using <code>tidybayes::add_epred_draws</code> with the <code>re_formula</code> argument</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="stats_validation.html#cb282-1" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> qlty_filter_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb282-2"><a href="stats_validation.html#cb282-2" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb282-3"><a href="stats_validation.html#cb282-3" tabindex="-1"></a>      value</span>
<span id="cb282-4"><a href="stats_validation.html#cb282-4" tabindex="-1"></a>      , <span class="at">by =</span> depth_maps_generation_quality</span>
<span id="cb282-5"><a href="stats_validation.html#cb282-5" tabindex="-1"></a>      , <span class="at">comparison =</span> </span>
<span id="cb282-6"><a href="stats_validation.html#cb282-6" tabindex="-1"></a>        contrast_list</span>
<span id="cb282-7"><a href="stats_validation.html#cb282-7" tabindex="-1"></a>        <span class="co"># tidybayes::emmeans_comparison(&quot;revpairwise&quot;) </span></span>
<span id="cb282-8"><a href="stats_validation.html#cb282-8" tabindex="-1"></a>        <span class="co">#&quot;pairwise&quot;</span></span>
<span id="cb282-9"><a href="stats_validation.html#cb282-9" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb282-10"><a href="stats_validation.html#cb282-10" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> depth_maps_generation_quality)</span>
<span id="cb282-11"><a href="stats_validation.html#cb282-11" tabindex="-1"></a></span>
<span id="cb282-12"><a href="stats_validation.html#cb282-12" tabindex="-1"></a><span class="co"># separate contrast</span></span>
<span id="cb282-13"><a href="stats_validation.html#cb282-13" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb282-14"><a href="stats_validation.html#cb282-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb282-15"><a href="stats_validation.html#cb282-15" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(</span>
<span id="cb282-16"><a href="stats_validation.html#cb282-16" tabindex="-1"></a>    <span class="at">cols =</span> contrast</span>
<span id="cb282-17"><a href="stats_validation.html#cb282-17" tabindex="-1"></a>    , <span class="at">delim =</span> <span class="st">&quot; - &quot;</span></span>
<span id="cb282-18"><a href="stats_validation.html#cb282-18" tabindex="-1"></a>    , <span class="at">names =</span> <span class="fu">paste0</span>(</span>
<span id="cb282-19"><a href="stats_validation.html#cb282-19" tabindex="-1"></a>        <span class="st">&quot;sorter&quot;</span></span>
<span id="cb282-20"><a href="stats_validation.html#cb282-20" tabindex="-1"></a>        , <span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(stringr<span class="sc">::</span><span class="fu">str_count</span>(brms_contrast_temp<span class="sc">$</span>contrast, <span class="st">&quot;-&quot;</span>))<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb282-21"><a href="stats_validation.html#cb282-21" tabindex="-1"></a>      )</span>
<span id="cb282-22"><a href="stats_validation.html#cb282-22" tabindex="-1"></a>    , <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span></span>
<span id="cb282-23"><a href="stats_validation.html#cb282-23" tabindex="-1"></a>    , <span class="at">cols_remove =</span> F</span>
<span id="cb282-24"><a href="stats_validation.html#cb282-24" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb282-25"><a href="stats_validation.html#cb282-25" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sorter1<span class="sc">!=</span>sorter2) <span class="sc">%&gt;%</span> </span>
<span id="cb282-26"><a href="stats_validation.html#cb282-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb282-27"><a href="stats_validation.html#cb282-27" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb282-28"><a href="stats_validation.html#cb282-28" tabindex="-1"></a>      tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sorter&quot;</span>)</span>
<span id="cb282-29"><a href="stats_validation.html#cb282-29" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="cf">function</span>(x){<span class="fu">factor</span>(</span>
<span id="cb282-30"><a href="stats_validation.html#cb282-30" tabindex="-1"></a>        x, <span class="at">ordered =</span> T</span>
<span id="cb282-31"><a href="stats_validation.html#cb282-31" tabindex="-1"></a>        , <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_quality)</span>
<span id="cb282-32"><a href="stats_validation.html#cb282-32" tabindex="-1"></a>      )}</span>
<span id="cb282-33"><a href="stats_validation.html#cb282-33" tabindex="-1"></a>    )</span>
<span id="cb282-34"><a href="stats_validation.html#cb282-34" tabindex="-1"></a>    , <span class="at">contrast =</span> contrast <span class="sc">%&gt;%</span> </span>
<span id="cb282-35"><a href="stats_validation.html#cb282-35" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb282-36"><a href="stats_validation.html#cb282-36" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="fu">as.numeric</span>(sorter1), <span class="fu">as.numeric</span>(sorter2)) <span class="sc">%&gt;%</span> </span>
<span id="cb282-37"><a href="stats_validation.html#cb282-37" tabindex="-1"></a>        <span class="fu">as.numeric</span>()</span>
<span id="cb282-38"><a href="stats_validation.html#cb282-38" tabindex="-1"></a>      )</span>
<span id="cb282-39"><a href="stats_validation.html#cb282-39" tabindex="-1"></a>    , <span class="at">depth_maps_generation_filtering_mode =</span> depth_maps_generation_filtering_mode <span class="sc">%&gt;%</span> </span>
<span id="cb282-40"><a href="stats_validation.html#cb282-40" tabindex="-1"></a>      <span class="fu">factor</span>(</span>
<span id="cb282-41"><a href="stats_validation.html#cb282-41" tabindex="-1"></a>        <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_filtering_mode)</span>
<span id="cb282-42"><a href="stats_validation.html#cb282-42" tabindex="-1"></a>        , <span class="at">ordered =</span> T</span>
<span id="cb282-43"><a href="stats_validation.html#cb282-43" tabindex="-1"></a>      )</span>
<span id="cb282-44"><a href="stats_validation.html#cb282-44" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb282-45"><a href="stats_validation.html#cb282-45" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb282-46"><a href="stats_validation.html#cb282-46" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast,depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb282-47"><a href="stats_validation.html#cb282-47" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb282-48"><a href="stats_validation.html#cb282-48" tabindex="-1"></a></span>
<span id="cb282-49"><a href="stats_validation.html#cb282-49" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb282-50"><a href="stats_validation.html#cb282-50" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 1,600,000
## Columns: 17
## Groups: contrast, depth_maps_generation_filtering_mode [40]
## $ depth_maps_generation_filtering_mode &lt;ord&gt; aggressive, aggressive, aggressiv…
## $ .chain                               &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ .iteration                           &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ .draw                                &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11…
## $ sorter1                              &lt;ord&gt; ultra high, ultra high, ultra hig…
## $ sorter2                              &lt;ord&gt; high, high, high, high, high, hig…
## $ contrast                             &lt;fct&gt; ultra high - high, ultra high - h…
## $ value                                &lt;dbl&gt; 0.117091583, 0.258056922, -0.0900…
## $ median_hdi_est                       &lt;dbl&gt; 0.02936285, 0.02936285, 0.0293628…
## $ median_hdi_lower                     &lt;dbl&gt; -0.1084457, -0.1084457, -0.108445…
## $ median_hdi_upper                     &lt;dbl&gt; 0.174886, 0.174886, 0.174886, 0.1…
## $ is_gt_zero                           &lt;lgl&gt; TRUE, TRUE, FALSE, TRUE, TRUE, FA…
## $ pct_gt_zero                          &lt;dbl&gt; 0.6761, 0.6761, 0.6761, 0.6761, 0…
## $ pct_gt_zero_lab                      &lt;chr&gt; &quot;Pr(ultra high&gt;high)=68%&quot;, &quot;Pr(ul…
## $ pct_gt_zero_lab_sm                   &lt;chr&gt; &quot;Pr(&gt;0)=68%&quot;, &quot;Pr(&gt;0)=68%&quot;, &quot;Pr(&gt;…
## $ pct_gt_zero_lab_pos                  &lt;dbl&gt; 0.1880025, 0.1880025, 0.1880025, …
## $ sig_level                            &lt;ord&gt; &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80…</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="stats_validation.html#cb284-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb284-2"><a href="stats_validation.html#cb284-2" tabindex="-1"></a>  brms_contrast_temp, <span class="at">caption_text =</span> form_temp</span>
<span id="cb284-3"><a href="stats_validation.html#cb284-3" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;quality&quot;</span></span>
<span id="cb284-4"><a href="stats_validation.html#cb284-4" tabindex="-1"></a>  , <span class="at">facet =</span> <span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span></span>
<span id="cb284-5"><a href="stats_validation.html#cb284-5" tabindex="-1"></a>  , <span class="at">label_size =</span> <span class="fl">2.2</span></span>
<span id="cb284-6"><a href="stats_validation.html#cb284-6" tabindex="-1"></a>  , <span class="at">x_expand =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>,<span class="fl">0.43</span>)</span>
<span id="cb284-7"><a href="stats_validation.html#cb284-7" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb284-8"><a href="stats_validation.html#cb284-8" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb284-9"><a href="stats_validation.html#cb284-9" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of group constrasts with 95% &amp; 50% HDI</span><span class="sc">\n</span><span class="st">by filtering mode&quot;</span></span>
<span id="cb284-10"><a href="stats_validation.html#cb284-10" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-207-1.png" width="1008" /></p>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="stats_validation.html#cb285-1" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb285-2"><a href="stats_validation.html#cb285-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb285-3"><a href="stats_validation.html#cb285-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb285-4"><a href="stats_validation.html#cb285-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb285-5"><a href="stats_validation.html#cb285-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, depth_maps_generation_filtering_mode, value, .lower, .upper) <span class="sc">%&gt;%</span> </span>
<span id="cb285-6"><a href="stats_validation.html#cb285-6" tabindex="-1"></a>   </span>
<span id="cb285-7"><a href="stats_validation.html#cb285-7" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb285-8"><a href="stats_validation.html#cb285-8" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb285-9"><a href="stats_validation.html#cb285-9" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb285-10"><a href="stats_validation.html#cb285-10" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb285-11"><a href="stats_validation.html#cb285-11" tabindex="-1"></a>      <span class="st">&quot;quality contrast&quot;</span></span>
<span id="cb285-12"><a href="stats_validation.html#cb285-12" tabindex="-1"></a>      , <span class="st">&quot;filtering mode&quot;</span></span>
<span id="cb285-13"><a href="stats_validation.html#cb285-13" tabindex="-1"></a>      , <span class="st">&quot;difference (F-score)&quot;</span></span>
<span id="cb285-14"><a href="stats_validation.html#cb285-14" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb285-15"><a href="stats_validation.html#cb285-15" tabindex="-1"></a>    )</span>
<span id="cb285-16"><a href="stats_validation.html#cb285-16" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb285-17"><a href="stats_validation.html#cb285-17" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb285-18"><a href="stats_validation.html#cb285-18" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;8in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:8in; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-208">Table 6.14: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
quality contrast
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
filtering mode
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
difference (F-score)
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI low
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.29
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.28
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.27
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.27
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - lowest
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.40
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - lowest
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.39
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - lowest
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.39
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - lowest
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.39
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.20
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.18
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.24
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.24
</td>
</tr>
<tr>
<td style="text-align:left;">
high - lowest
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.36
</td>
</tr>
<tr>
<td style="text-align:left;">
high - lowest
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.36
</td>
</tr>
<tr>
<td style="text-align:left;">
high - lowest
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.35
</td>
</tr>
<tr>
<td style="text-align:left;">
high - lowest
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.35
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.20
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.18
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.18
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.29
</td>
</tr>
<tr>
<td style="text-align:left;">
low - lowest
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.24
</td>
</tr>
<tr>
<td style="text-align:left;">
low - lowest
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.24
</td>
</tr>
<tr>
<td style="text-align:left;">
low - lowest
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;">
low - lowest
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
</tbody>
</table>
</div>
<p>It might be more important to understand the difference in F-score by dense cloud quality and software rather than filtering mode since filtering mode had such a small effect on the SfM predictive ability</p>
<p>Note that how within <code>tidybayes::add_epred_draws</code>, we used the <code>re_formula</code> argument to average over the random effects of <code>depth_maps_generation_filtering_mode</code>. For this model we have to collapse across the filtering mode effects to compare the dense cloud quality and software setting effects.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="stats_validation.html#cb286-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb286-2"><a href="stats_validation.html#cb286-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality, software) <span class="sc">%&gt;%</span> </span>
<span id="cb286-3"><a href="stats_validation.html#cb286-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb286-4"><a href="stats_validation.html#cb286-4" tabindex="-1"></a>    brms_f_mod4, <span class="at">allow_new_levels =</span> T</span>
<span id="cb286-5"><a href="stats_validation.html#cb286-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb286-6"><a href="stats_validation.html#cb286-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span></span>
<span id="cb286-7"><a href="stats_validation.html#cb286-7" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> software) <span class="sc">+</span> </span>
<span id="cb286-8"><a href="stats_validation.html#cb286-8" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>software)</span>
<span id="cb286-9"><a href="stats_validation.html#cb286-9" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb286-10"><a href="stats_validation.html#cb286-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb286-11"><a href="stats_validation.html#cb286-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">depth_maps_generation_quality =</span> depth_maps_generation_quality <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb286-12"><a href="stats_validation.html#cb286-12" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb286-13"><a href="stats_validation.html#cb286-13" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb286-14"><a href="stats_validation.html#cb286-14" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb286-15"><a href="stats_validation.html#cb286-15" tabindex="-1"></a>      <span class="at">y =</span> value, <span class="at">x =</span> software</span>
<span id="cb286-16"><a href="stats_validation.html#cb286-16" tabindex="-1"></a>      , <span class="at">fill =</span> software</span>
<span id="cb286-17"><a href="stats_validation.html#cb286-17" tabindex="-1"></a>    )</span>
<span id="cb286-18"><a href="stats_validation.html#cb286-18" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb286-19"><a href="stats_validation.html#cb286-19" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_eye</span>(</span>
<span id="cb286-20"><a href="stats_validation.html#cb286-20" tabindex="-1"></a>    <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb286-21"><a href="stats_validation.html#cb286-21" tabindex="-1"></a>    , <span class="at">slab_alpha =</span> <span class="fl">0.8</span></span>
<span id="cb286-22"><a href="stats_validation.html#cb286-22" tabindex="-1"></a>    , <span class="at">interval_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb286-23"><a href="stats_validation.html#cb286-23" tabindex="-1"></a>    , <span class="at">point_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_size =</span> <span class="dv">1</span></span>
<span id="cb286-24"><a href="stats_validation.html#cb286-24" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb286-25"><a href="stats_validation.html#cb286-25" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;rocket&quot;</span>, <span class="at">begin =</span> <span class="fl">0.3</span>, <span class="at">end =</span> <span class="fl">0.9</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb286-26"><a href="stats_validation.html#cb286-26" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb286-27"><a href="stats_validation.html#cb286-27" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(depth_maps_generation_quality)) <span class="sc">+</span></span>
<span id="cb286-28"><a href="stats_validation.html#cb286-28" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb286-29"><a href="stats_validation.html#cb286-29" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;software&quot;</span>, <span class="at">y =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb286-30"><a href="stats_validation.html#cb286-30" tabindex="-1"></a>    , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI</span><span class="sc">\n</span><span class="st">by dense cloud quality&quot;</span></span>
<span id="cb286-31"><a href="stats_validation.html#cb286-31" tabindex="-1"></a>    , <span class="at">caption =</span> form_temp</span>
<span id="cb286-32"><a href="stats_validation.html#cb286-32" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb286-33"><a href="stats_validation.html#cb286-33" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb286-34"><a href="stats_validation.html#cb286-34" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb286-35"><a href="stats_validation.html#cb286-35" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb286-36"><a href="stats_validation.html#cb286-36" tabindex="-1"></a>    , <span class="at">legend.direction  =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb286-37"><a href="stats_validation.html#cb286-37" tabindex="-1"></a>    , <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb286-38"><a href="stats_validation.html#cb286-38" tabindex="-1"></a>    , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb286-39"><a href="stats_validation.html#cb286-39" tabindex="-1"></a>  ) </span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-209-1.png" width="1008" /></p>
<p>we can also make pairwise comparisons so long as we continue using <code>tidybayes::add_epred_draws</code> with the <code>re_formula</code> argument</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="stats_validation.html#cb287-1" tabindex="-1"></a><span class="co"># get draws</span></span>
<span id="cb287-2"><a href="stats_validation.html#cb287-2" tabindex="-1"></a>qlty_sftwr_draws_temp <span class="ot">=</span> ptcld_validation_data <span class="sc">%&gt;%</span></span>
<span id="cb287-3"><a href="stats_validation.html#cb287-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality, software) <span class="sc">%&gt;%</span> </span>
<span id="cb287-4"><a href="stats_validation.html#cb287-4" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb287-5"><a href="stats_validation.html#cb287-5" tabindex="-1"></a>    brms_f_mod4, <span class="at">allow_new_levels =</span> T</span>
<span id="cb287-6"><a href="stats_validation.html#cb287-6" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb287-7"><a href="stats_validation.html#cb287-7" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span></span>
<span id="cb287-8"><a href="stats_validation.html#cb287-8" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> software) <span class="sc">+</span> </span>
<span id="cb287-9"><a href="stats_validation.html#cb287-9" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>software)</span>
<span id="cb287-10"><a href="stats_validation.html#cb287-10" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb287-11"><a href="stats_validation.html#cb287-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred)</span>
<span id="cb287-12"><a href="stats_validation.html#cb287-12" tabindex="-1"></a></span>
<span id="cb287-13"><a href="stats_validation.html#cb287-13" tabindex="-1"></a><span class="co"># calculate contrast</span></span>
<span id="cb287-14"><a href="stats_validation.html#cb287-14" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> qlty_sftwr_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb287-15"><a href="stats_validation.html#cb287-15" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb287-16"><a href="stats_validation.html#cb287-16" tabindex="-1"></a>    value</span>
<span id="cb287-17"><a href="stats_validation.html#cb287-17" tabindex="-1"></a>    , <span class="at">by =</span> depth_maps_generation_quality</span>
<span id="cb287-18"><a href="stats_validation.html#cb287-18" tabindex="-1"></a>    , <span class="at">comparison =</span> </span>
<span id="cb287-19"><a href="stats_validation.html#cb287-19" tabindex="-1"></a>      contrast_list[<span class="sc">!</span>stringr<span class="sc">::</span><span class="fu">str_detect</span>(contrast_list, <span class="st">&quot;lowest&quot;</span>)]</span>
<span id="cb287-20"><a href="stats_validation.html#cb287-20" tabindex="-1"></a>      <span class="co"># contrast_list</span></span>
<span id="cb287-21"><a href="stats_validation.html#cb287-21" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb287-22"><a href="stats_validation.html#cb287-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> depth_maps_generation_quality)</span>
<span id="cb287-23"><a href="stats_validation.html#cb287-23" tabindex="-1"></a></span>
<span id="cb287-24"><a href="stats_validation.html#cb287-24" tabindex="-1"></a><span class="co"># separate contrast</span></span>
<span id="cb287-25"><a href="stats_validation.html#cb287-25" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb287-26"><a href="stats_validation.html#cb287-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb287-27"><a href="stats_validation.html#cb287-27" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(</span>
<span id="cb287-28"><a href="stats_validation.html#cb287-28" tabindex="-1"></a>    <span class="at">cols =</span> contrast</span>
<span id="cb287-29"><a href="stats_validation.html#cb287-29" tabindex="-1"></a>    , <span class="at">delim =</span> <span class="st">&quot; - &quot;</span></span>
<span id="cb287-30"><a href="stats_validation.html#cb287-30" tabindex="-1"></a>    , <span class="at">names =</span> <span class="fu">paste0</span>(</span>
<span id="cb287-31"><a href="stats_validation.html#cb287-31" tabindex="-1"></a>      <span class="st">&quot;sorter&quot;</span></span>
<span id="cb287-32"><a href="stats_validation.html#cb287-32" tabindex="-1"></a>      , <span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(stringr<span class="sc">::</span><span class="fu">str_count</span>(brms_contrast_temp<span class="sc">$</span>contrast, <span class="st">&quot;-&quot;</span>))<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb287-33"><a href="stats_validation.html#cb287-33" tabindex="-1"></a>    )</span>
<span id="cb287-34"><a href="stats_validation.html#cb287-34" tabindex="-1"></a>    , <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span></span>
<span id="cb287-35"><a href="stats_validation.html#cb287-35" tabindex="-1"></a>    , <span class="at">cols_remove =</span> F</span>
<span id="cb287-36"><a href="stats_validation.html#cb287-36" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb287-37"><a href="stats_validation.html#cb287-37" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sorter1<span class="sc">!=</span>sorter2) <span class="sc">%&gt;%</span> </span>
<span id="cb287-38"><a href="stats_validation.html#cb287-38" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb287-39"><a href="stats_validation.html#cb287-39" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb287-40"><a href="stats_validation.html#cb287-40" tabindex="-1"></a>      tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sorter&quot;</span>)</span>
<span id="cb287-41"><a href="stats_validation.html#cb287-41" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="cf">function</span>(x){<span class="fu">factor</span>(</span>
<span id="cb287-42"><a href="stats_validation.html#cb287-42" tabindex="-1"></a>        x, <span class="at">ordered =</span> T</span>
<span id="cb287-43"><a href="stats_validation.html#cb287-43" tabindex="-1"></a>        , <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_quality)</span>
<span id="cb287-44"><a href="stats_validation.html#cb287-44" tabindex="-1"></a>      )}</span>
<span id="cb287-45"><a href="stats_validation.html#cb287-45" tabindex="-1"></a>    )</span>
<span id="cb287-46"><a href="stats_validation.html#cb287-46" tabindex="-1"></a>    , <span class="at">contrast =</span> contrast <span class="sc">%&gt;%</span> </span>
<span id="cb287-47"><a href="stats_validation.html#cb287-47" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb287-48"><a href="stats_validation.html#cb287-48" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="fu">as.numeric</span>(sorter1), <span class="fu">as.numeric</span>(sorter2)) <span class="sc">%&gt;%</span> </span>
<span id="cb287-49"><a href="stats_validation.html#cb287-49" tabindex="-1"></a>          <span class="fu">as.numeric</span>()</span>
<span id="cb287-50"><a href="stats_validation.html#cb287-50" tabindex="-1"></a>      )</span>
<span id="cb287-51"><a href="stats_validation.html#cb287-51" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb287-52"><a href="stats_validation.html#cb287-52" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb287-53"><a href="stats_validation.html#cb287-53" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, software) <span class="sc">%&gt;%</span> </span>
<span id="cb287-54"><a href="stats_validation.html#cb287-54" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb287-55"><a href="stats_validation.html#cb287-55" tabindex="-1"></a></span>
<span id="cb287-56"><a href="stats_validation.html#cb287-56" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb287-57"><a href="stats_validation.html#cb287-57" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 720,000
## Columns: 17
## Groups: contrast, software [18]
## $ software            &lt;chr&gt; &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;METASHAPE&quot;…
## $ .chain              &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .iteration          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .draw               &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,…
## $ sorter1             &lt;ord&gt; ultra high, ultra high, ultra high, ultra high, ul…
## $ sorter2             &lt;ord&gt; high, high, high, high, high, high, high, high, hi…
## $ contrast            &lt;fct&gt; ultra high - high, ultra high - high, ultra high -…
## $ value               &lt;dbl&gt; 0.011002873, 0.016403992, 0.036585434, -0.00796592…
## $ median_hdi_est      &lt;dbl&gt; 0.01895816, 0.01895816, 0.01895816, 0.01895816, 0.…
## $ median_hdi_lower    &lt;dbl&gt; -0.07011604, -0.07011604, -0.07011604, -0.07011604…
## $ median_hdi_upper    &lt;dbl&gt; 0.1084027, 0.1084027, 0.1084027, 0.1084027, 0.1084…
## $ is_gt_zero          &lt;lgl&gt; TRUE, TRUE, TRUE, FALSE, FALSE, TRUE, FALSE, TRUE,…
## $ pct_gt_zero         &lt;dbl&gt; 0.662975, 0.662975, 0.662975, 0.662975, 0.662975, …
## $ pct_gt_zero_lab     &lt;chr&gt; &quot;Pr(ultra high&gt;high)=66%&quot;, &quot;Pr(ultra high&gt;high)=66…
## $ pct_gt_zero_lab_sm  &lt;chr&gt; &quot;Pr(&gt;0)=66%&quot;, &quot;Pr(&gt;0)=66%&quot;, &quot;Pr(&gt;0)=66%&quot;, &quot;Pr(&gt;0)=…
## $ pct_gt_zero_lab_pos &lt;dbl&gt; 0.1165329, 0.1165329, 0.1165329, 0.1165329, 0.1165…
## $ sig_level           &lt;ord&gt; &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;8…</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="stats_validation.html#cb289-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb289-2"><a href="stats_validation.html#cb289-2" tabindex="-1"></a>  brms_contrast_temp, <span class="at">caption_text =</span> form_temp</span>
<span id="cb289-3"><a href="stats_validation.html#cb289-3" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;quality&quot;</span></span>
<span id="cb289-4"><a href="stats_validation.html#cb289-4" tabindex="-1"></a>  , <span class="at">facet =</span> <span class="st">&quot;software&quot;</span></span>
<span id="cb289-5"><a href="stats_validation.html#cb289-5" tabindex="-1"></a>  , <span class="at">label_size =</span> <span class="fl">2.1</span></span>
<span id="cb289-6"><a href="stats_validation.html#cb289-6" tabindex="-1"></a>  , <span class="at">x_expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>)</span>
<span id="cb289-7"><a href="stats_validation.html#cb289-7" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb289-8"><a href="stats_validation.html#cb289-8" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb289-9"><a href="stats_validation.html#cb289-9" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of group constrasts with 95% &amp; 50% HDI</span><span class="sc">\n</span><span class="st">by software&quot;</span></span>
<span id="cb289-10"><a href="stats_validation.html#cb289-10" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-211-1.png" width="1008" /></p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="stats_validation.html#cb290-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb290-2"><a href="stats_validation.html#cb290-2" tabindex="-1"></a>  <span class="st">&quot;../data/qlty_sftwr_comp_mod4.png&quot;</span></span>
<span id="cb290-3"><a href="stats_validation.html#cb290-3" tabindex="-1"></a>  , <span class="at">plot =</span> ggplot2<span class="sc">::</span><span class="fu">last_plot</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb290-4"><a href="stats_validation.html#cb290-4" tabindex="-1"></a>  , <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span></span>
<span id="cb290-5"><a href="stats_validation.html#cb290-5" tabindex="-1"></a>)</span></code></pre></div>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="stats_validation.html#cb291-1" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb291-2"><a href="stats_validation.html#cb291-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, software) <span class="sc">%&gt;%</span> </span>
<span id="cb291-3"><a href="stats_validation.html#cb291-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb291-4"><a href="stats_validation.html#cb291-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast, software) <span class="sc">%&gt;%</span> </span>
<span id="cb291-5"><a href="stats_validation.html#cb291-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, software, value, .lower, .upper) <span class="sc">%&gt;%</span> </span>
<span id="cb291-6"><a href="stats_validation.html#cb291-6" tabindex="-1"></a>   </span>
<span id="cb291-7"><a href="stats_validation.html#cb291-7" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb291-8"><a href="stats_validation.html#cb291-8" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb291-9"><a href="stats_validation.html#cb291-9" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb291-10"><a href="stats_validation.html#cb291-10" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb291-11"><a href="stats_validation.html#cb291-11" tabindex="-1"></a>      <span class="st">&quot;quality contrast&quot;</span></span>
<span id="cb291-12"><a href="stats_validation.html#cb291-12" tabindex="-1"></a>      , <span class="st">&quot;software&quot;</span></span>
<span id="cb291-13"><a href="stats_validation.html#cb291-13" tabindex="-1"></a>      , <span class="st">&quot;difference (F-score)&quot;</span></span>
<span id="cb291-14"><a href="stats_validation.html#cb291-14" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb291-15"><a href="stats_validation.html#cb291-15" tabindex="-1"></a>    )</span>
<span id="cb291-16"><a href="stats_validation.html#cb291-16" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb291-17"><a href="stats_validation.html#cb291-17" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb291-18"><a href="stats_validation.html#cb291-18" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;6in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:6in; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-212">Table 6.15: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
quality contrast
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
software
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
difference (F-score)
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI low
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.16
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.27
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.31
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.18
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.14
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.10
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.26
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.20
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.10
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.16
</td>
</tr>
</tbody>
</table>
</div>
<p>The contrasts above address the question “are there differences in F-score based on dense point cloud generation quality within each software?”.</p>
<p>To address the different question of “are there differences in F-score based on the processing software used at a given dense point cloud generation quality?” we need to utilize a different formulation of the <code>comparison</code> parameter within our call to the <code>tidybayes::compare_levels</code> function and calculate the contrast by <code>software</code> instead</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="stats_validation.html#cb292-1" tabindex="-1"></a><span class="co"># calculate contrast</span></span>
<span id="cb292-2"><a href="stats_validation.html#cb292-2" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> qlty_sftwr_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb292-3"><a href="stats_validation.html#cb292-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb292-4"><a href="stats_validation.html#cb292-4" tabindex="-1"></a>    value</span>
<span id="cb292-5"><a href="stats_validation.html#cb292-5" tabindex="-1"></a>    , <span class="at">by =</span> software</span>
<span id="cb292-6"><a href="stats_validation.html#cb292-6" tabindex="-1"></a>    , <span class="at">comparison =</span> <span class="st">&quot;pairwise&quot;</span></span>
<span id="cb292-7"><a href="stats_validation.html#cb292-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb292-8"><a href="stats_validation.html#cb292-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> software) <span class="sc">%&gt;%</span> </span>
<span id="cb292-9"><a href="stats_validation.html#cb292-9" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb292-10"><a href="stats_validation.html#cb292-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb292-11"><a href="stats_validation.html#cb292-11" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb292-12"><a href="stats_validation.html#cb292-12" tabindex="-1"></a></span>
<span id="cb292-13"><a href="stats_validation.html#cb292-13" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb292-14"><a href="stats_validation.html#cb292-14" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 520,000
## Columns: 15
## Groups: contrast, depth_maps_generation_quality [13]
## $ depth_maps_generation_quality &lt;ord&gt; ultra high, ultra high, ultra high, ultr…
## $ .chain                        &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ .iteration                    &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ .draw                         &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1…
## $ contrast                      &lt;chr&gt; &quot;OPENDRONEMAP - METASHAPE&quot;, &quot;OPENDRONEMA…
## $ value                         &lt;dbl&gt; -0.041567216, -0.044398847, 0.038336862,…
## $ median_hdi_est                &lt;dbl&gt; -0.02216649, -0.02216649, -0.02216649, -…
## $ median_hdi_lower              &lt;dbl&gt; -0.1270756, -0.1270756, -0.1270756, -0.1…
## $ median_hdi_upper              &lt;dbl&gt; 0.0801044, 0.0801044, 0.0801044, 0.08010…
## $ is_gt_zero                    &lt;lgl&gt; TRUE, TRUE, FALSE, TRUE, TRUE, TRUE, TRU…
## $ pct_gt_zero                   &lt;dbl&gt; 0.6705, 0.6705, 0.6705, 0.6705, 0.6705, …
## $ pct_gt_zero_lab               &lt;chr&gt; &quot;Pr(MtaShp&gt;ODM)=67%&quot;, &quot;Pr(MtaShp&gt;ODM)=67…
## $ pct_gt_zero_lab_sm            &lt;chr&gt; &quot;Pr(&lt;0)=67%&quot;, &quot;Pr(&lt;0)=67%&quot;, &quot;Pr(&lt;0)=67%&quot;…
## $ pct_gt_zero_lab_pos           &lt;dbl&gt; -0.1366063, -0.1366063, -0.1366063, -0.1…
## $ sig_level                     &lt;ord&gt; &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%…</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="stats_validation.html#cb294-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb294-2"><a href="stats_validation.html#cb294-2" tabindex="-1"></a>  brms_contrast_temp, <span class="at">caption_text =</span> form_temp</span>
<span id="cb294-3"><a href="stats_validation.html#cb294-3" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;software&quot;</span></span>
<span id="cb294-4"><a href="stats_validation.html#cb294-4" tabindex="-1"></a>  , <span class="at">facet =</span> <span class="st">&quot;depth_maps_generation_quality&quot;</span></span>
<span id="cb294-5"><a href="stats_validation.html#cb294-5" tabindex="-1"></a>  , <span class="at">label_size =</span> <span class="fl">2.0</span></span>
<span id="cb294-6"><a href="stats_validation.html#cb294-6" tabindex="-1"></a>  , <span class="at">x_expand =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>)</span>
<span id="cb294-7"><a href="stats_validation.html#cb294-7" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb294-8"><a href="stats_validation.html#cb294-8" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(depth_maps_generation_quality), <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb294-9"><a href="stats_validation.html#cb294-9" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb294-10"><a href="stats_validation.html#cb294-10" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of group constrasts with 95% &amp; 50% HDI</span><span class="sc">\n</span><span class="st">by dense cloud quality&quot;</span></span>
<span id="cb294-11"><a href="stats_validation.html#cb294-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb294-12"><a href="stats_validation.html#cb294-12" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb294-13"><a href="stats_validation.html#cb294-13" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">75</span>, .<span class="dv">13</span>)</span>
<span id="cb294-14"><a href="stats_validation.html#cb294-14" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb294-15"><a href="stats_validation.html#cb294-15" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb294-16"><a href="stats_validation.html#cb294-16" tabindex="-1"></a>    <span class="at">legend.key.width  =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;lines&quot;</span>),</span>
<span id="cb294-17"><a href="stats_validation.html#cb294-17" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">7</span>, <span class="st">&quot;lines&quot;</span>)</span>
<span id="cb294-18"><a href="stats_validation.html#cb294-18" tabindex="-1"></a>  )))</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-214-1.png" width="1008" /></p>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="stats_validation.html#cb295-1" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb295-2"><a href="stats_validation.html#cb295-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb295-3"><a href="stats_validation.html#cb295-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb295-4"><a href="stats_validation.html#cb295-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast, depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb295-5"><a href="stats_validation.html#cb295-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, depth_maps_generation_quality, value, .lower, .upper) <span class="sc">%&gt;%</span> </span>
<span id="cb295-6"><a href="stats_validation.html#cb295-6" tabindex="-1"></a>   </span>
<span id="cb295-7"><a href="stats_validation.html#cb295-7" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb295-8"><a href="stats_validation.html#cb295-8" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb295-9"><a href="stats_validation.html#cb295-9" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb295-10"><a href="stats_validation.html#cb295-10" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb295-11"><a href="stats_validation.html#cb295-11" tabindex="-1"></a>      <span class="st">&quot;software contrast&quot;</span></span>
<span id="cb295-12"><a href="stats_validation.html#cb295-12" tabindex="-1"></a>      , <span class="st">&quot;quality&quot;</span></span>
<span id="cb295-13"><a href="stats_validation.html#cb295-13" tabindex="-1"></a>      , <span class="st">&quot;difference (F-score)&quot;</span></span>
<span id="cb295-14"><a href="stats_validation.html#cb295-14" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb295-15"><a href="stats_validation.html#cb295-15" tabindex="-1"></a>    )</span>
<span id="cb295-16"><a href="stats_validation.html#cb295-16" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb295-17"><a href="stats_validation.html#cb295-17" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb295-18"><a href="stats_validation.html#cb295-18" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;8in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:8in; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-216">Table 6.16: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
software contrast
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
quality
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
difference (F-score)
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI low
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
OPENDRONEMAP - METASHAPE
</td>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
-0.13
</td>
<td style="text-align:right;">
0.08
</td>
</tr>
<tr>
<td style="text-align:left;">
OPENDRONEMAP - METASHAPE
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.02
</td>
</tr>
<tr>
<td style="text-align:left;">
OPENDRONEMAP - METASHAPE
</td>
<td style="text-align:left;">
medium
</td>
<td style="text-align:right;">
-0.16
</td>
<td style="text-align:right;">
-0.27
</td>
<td style="text-align:right;">
-0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
OPENDRONEMAP - METASHAPE
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
-0.16
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
OPENDRONEMAP - METASHAPE
</td>
<td style="text-align:left;">
lowest
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - METASHAPE
</td>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
-0.16
</td>
<td style="text-align:right;">
0.06
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - METASHAPE
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
-0.15
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - METASHAPE
</td>
<td style="text-align:left;">
medium
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - METASHAPE
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - OPENDRONEMAP
</td>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
0.08
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - OPENDRONEMAP
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.15
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - OPENDRONEMAP
</td>
<td style="text-align:left;">
medium
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.29
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - OPENDRONEMAP
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
</tbody>
</table>
</div>
<p>let’s collapse across the filtering mode, software, and study site to compare the dense cloud quality setting effect.
In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="stats_validation.html#cb296-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb296-2"><a href="stats_validation.html#cb296-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb296-3"><a href="stats_validation.html#cb296-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb296-4"><a href="stats_validation.html#cb296-4" tabindex="-1"></a>    brms_f_mod4</span>
<span id="cb296-5"><a href="stats_validation.html#cb296-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb296-6"><a href="stats_validation.html#cb296-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality)</span>
<span id="cb296-7"><a href="stats_validation.html#cb296-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb296-8"><a href="stats_validation.html#cb296-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb296-9"><a href="stats_validation.html#cb296-9" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb296-10"><a href="stats_validation.html#cb296-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb296-11"><a href="stats_validation.html#cb296-11" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb296-12"><a href="stats_validation.html#cb296-12" tabindex="-1"></a>      <span class="at">x =</span> value, <span class="at">y =</span> depth_maps_generation_quality</span>
<span id="cb296-13"><a href="stats_validation.html#cb296-13" tabindex="-1"></a>      , <span class="at">fill =</span> depth_maps_generation_quality</span>
<span id="cb296-14"><a href="stats_validation.html#cb296-14" tabindex="-1"></a>    )</span>
<span id="cb296-15"><a href="stats_validation.html#cb296-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb296-16"><a href="stats_validation.html#cb296-16" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb296-17"><a href="stats_validation.html#cb296-17" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb296-18"><a href="stats_validation.html#cb296-18" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;gray66&quot;</span></span>
<span id="cb296-19"><a href="stats_validation.html#cb296-19" tabindex="-1"></a>      , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_color =</span> <span class="st">&quot;gray66&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb296-20"><a href="stats_validation.html#cb296-20" tabindex="-1"></a>      , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb296-21"><a href="stats_validation.html#cb296-21" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb296-22"><a href="stats_validation.html#cb296-22" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;inferno&quot;</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb296-23"><a href="stats_validation.html#cb296-23" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb296-24"><a href="stats_validation.html#cb296-24" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb296-25"><a href="stats_validation.html#cb296-25" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;quality&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb296-26"><a href="stats_validation.html#cb296-26" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI&quot;</span></span>
<span id="cb296-27"><a href="stats_validation.html#cb296-27" tabindex="-1"></a>      , <span class="at">caption =</span> form_temp</span>
<span id="cb296-28"><a href="stats_validation.html#cb296-28" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb296-29"><a href="stats_validation.html#cb296-29" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb296-30"><a href="stats_validation.html#cb296-30" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-217-1.png" width="1008" /></p>
<p>let’s compare these results to the results from our <a href="stats_validation.html#f_one_pred_mod_bays">one nominal predictor model above</a>, <a href="stats_validation.html#f_two_pred_mod_bays">two nominal predictor model above</a>, and <a href="stats_validation.html#f_three_pred_mod_bays">three nominal predictor model above</a></p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="stats_validation.html#cb297-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb297-2"><a href="stats_validation.html#cb297-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb297-3"><a href="stats_validation.html#cb297-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb297-4"><a href="stats_validation.html#cb297-4" tabindex="-1"></a>    brms_f_mod4</span>
<span id="cb297-5"><a href="stats_validation.html#cb297-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb297-6"><a href="stats_validation.html#cb297-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality)</span>
<span id="cb297-7"><a href="stats_validation.html#cb297-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb297-8"><a href="stats_validation.html#cb297-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod4&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb297-9"><a href="stats_validation.html#cb297-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb297-10"><a href="stats_validation.html#cb297-10" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb297-11"><a href="stats_validation.html#cb297-11" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb297-12"><a href="stats_validation.html#cb297-12" tabindex="-1"></a>      tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb297-13"><a href="stats_validation.html#cb297-13" tabindex="-1"></a>        brms_f_mod3</span>
<span id="cb297-14"><a href="stats_validation.html#cb297-14" tabindex="-1"></a>        <span class="co"># this part is crucial</span></span>
<span id="cb297-15"><a href="stats_validation.html#cb297-15" tabindex="-1"></a>        , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality)</span>
<span id="cb297-16"><a href="stats_validation.html#cb297-16" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb297-17"><a href="stats_validation.html#cb297-17" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod3&quot;</span>)</span>
<span id="cb297-18"><a href="stats_validation.html#cb297-18" tabindex="-1"></a>    , ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb297-19"><a href="stats_validation.html#cb297-19" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb297-20"><a href="stats_validation.html#cb297-20" tabindex="-1"></a>      tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb297-21"><a href="stats_validation.html#cb297-21" tabindex="-1"></a>        brms_f_mod2</span>
<span id="cb297-22"><a href="stats_validation.html#cb297-22" tabindex="-1"></a>        <span class="co"># this part is crucial</span></span>
<span id="cb297-23"><a href="stats_validation.html#cb297-23" tabindex="-1"></a>        , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality)</span>
<span id="cb297-24"><a href="stats_validation.html#cb297-24" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb297-25"><a href="stats_validation.html#cb297-25" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod2&quot;</span>)</span>
<span id="cb297-26"><a href="stats_validation.html#cb297-26" tabindex="-1"></a>    , ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb297-27"><a href="stats_validation.html#cb297-27" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb297-28"><a href="stats_validation.html#cb297-28" tabindex="-1"></a>      tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(brms_f_mod1) <span class="sc">%&gt;%</span> </span>
<span id="cb297-29"><a href="stats_validation.html#cb297-29" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod1&quot;</span>)</span>
<span id="cb297-30"><a href="stats_validation.html#cb297-30" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb297-31"><a href="stats_validation.html#cb297-31" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> src, <span class="at">x =</span> value, <span class="at">color =</span> src, <span class="at">group =</span> src)) <span class="sc">+</span></span>
<span id="cb297-32"><a href="stats_validation.html#cb297-32" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_pointinterval</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb297-33"><a href="stats_validation.html#cb297-33" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(depth_maps_generation_quality), <span class="at">switch =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb297-34"><a href="stats_validation.html#cb297-34" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb297-35"><a href="stats_validation.html#cb297-35" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> viridis<span class="sc">::</span><span class="fu">turbo</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb297-36"><a href="stats_validation.html#cb297-36" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb297-37"><a href="stats_validation.html#cb297-37" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb297-38"><a href="stats_validation.html#cb297-38" tabindex="-1"></a>    , <span class="at">color =</span> <span class="st">&quot;model&quot;</span></span>
<span id="cb297-39"><a href="stats_validation.html#cb297-39" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb297-40"><a href="stats_validation.html#cb297-40" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb297-41"><a href="stats_validation.html#cb297-41" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-218-1.png" width="1008" /></p>
<p>let’s also collapse across the dense cloud quality, software, and study site to compare the filtering mode setting effect.
In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="stats_validation.html#cb298-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb298-2"><a href="stats_validation.html#cb298-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb298-3"><a href="stats_validation.html#cb298-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb298-4"><a href="stats_validation.html#cb298-4" tabindex="-1"></a>    brms_f_mod4</span>
<span id="cb298-5"><a href="stats_validation.html#cb298-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb298-6"><a href="stats_validation.html#cb298-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode)</span>
<span id="cb298-7"><a href="stats_validation.html#cb298-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb298-8"><a href="stats_validation.html#cb298-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb298-9"><a href="stats_validation.html#cb298-9" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb298-10"><a href="stats_validation.html#cb298-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb298-11"><a href="stats_validation.html#cb298-11" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb298-12"><a href="stats_validation.html#cb298-12" tabindex="-1"></a>      <span class="at">x =</span> value, <span class="at">y =</span> depth_maps_generation_filtering_mode</span>
<span id="cb298-13"><a href="stats_validation.html#cb298-13" tabindex="-1"></a>      , <span class="at">fill =</span> depth_maps_generation_filtering_mode</span>
<span id="cb298-14"><a href="stats_validation.html#cb298-14" tabindex="-1"></a>    )</span>
<span id="cb298-15"><a href="stats_validation.html#cb298-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb298-16"><a href="stats_validation.html#cb298-16" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb298-17"><a href="stats_validation.html#cb298-17" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb298-18"><a href="stats_validation.html#cb298-18" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;gray66&quot;</span></span>
<span id="cb298-19"><a href="stats_validation.html#cb298-19" tabindex="-1"></a>      , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_color =</span> <span class="st">&quot;gray66&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb298-20"><a href="stats_validation.html#cb298-20" tabindex="-1"></a>      , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb298-21"><a href="stats_validation.html#cb298-21" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb298-22"><a href="stats_validation.html#cb298-22" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb298-23"><a href="stats_validation.html#cb298-23" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb298-24"><a href="stats_validation.html#cb298-24" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb298-25"><a href="stats_validation.html#cb298-25" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;filtering mode&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb298-26"><a href="stats_validation.html#cb298-26" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI&quot;</span></span>
<span id="cb298-27"><a href="stats_validation.html#cb298-27" tabindex="-1"></a>      , <span class="at">caption =</span> form_temp</span>
<span id="cb298-28"><a href="stats_validation.html#cb298-28" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb298-29"><a href="stats_validation.html#cb298-29" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb298-30"><a href="stats_validation.html#cb298-30" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-219-1.png" width="1008" /></p>
<p>let’s compare these results to the results from <a href="stats_validation.html#f_two_pred_mod_bays">two nominal predictor model above</a> and <a href="stats_validation.html#f_three_pred_mod_bays">three nominal predictor model above</a></p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="stats_validation.html#cb299-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb299-2"><a href="stats_validation.html#cb299-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb299-3"><a href="stats_validation.html#cb299-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb299-4"><a href="stats_validation.html#cb299-4" tabindex="-1"></a>    brms_f_mod4</span>
<span id="cb299-5"><a href="stats_validation.html#cb299-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb299-6"><a href="stats_validation.html#cb299-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode)</span>
<span id="cb299-7"><a href="stats_validation.html#cb299-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb299-8"><a href="stats_validation.html#cb299-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod4&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb299-9"><a href="stats_validation.html#cb299-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb299-10"><a href="stats_validation.html#cb299-10" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb299-11"><a href="stats_validation.html#cb299-11" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb299-12"><a href="stats_validation.html#cb299-12" tabindex="-1"></a>      tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb299-13"><a href="stats_validation.html#cb299-13" tabindex="-1"></a>        brms_f_mod3</span>
<span id="cb299-14"><a href="stats_validation.html#cb299-14" tabindex="-1"></a>        <span class="co"># this part is crucial</span></span>
<span id="cb299-15"><a href="stats_validation.html#cb299-15" tabindex="-1"></a>        , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode)</span>
<span id="cb299-16"><a href="stats_validation.html#cb299-16" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb299-17"><a href="stats_validation.html#cb299-17" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod3&quot;</span>)</span>
<span id="cb299-18"><a href="stats_validation.html#cb299-18" tabindex="-1"></a>    , ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb299-19"><a href="stats_validation.html#cb299-19" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb299-20"><a href="stats_validation.html#cb299-20" tabindex="-1"></a>      tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb299-21"><a href="stats_validation.html#cb299-21" tabindex="-1"></a>        brms_f_mod2</span>
<span id="cb299-22"><a href="stats_validation.html#cb299-22" tabindex="-1"></a>        <span class="co"># this part is crucial</span></span>
<span id="cb299-23"><a href="stats_validation.html#cb299-23" tabindex="-1"></a>        , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode)</span>
<span id="cb299-24"><a href="stats_validation.html#cb299-24" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb299-25"><a href="stats_validation.html#cb299-25" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod2&quot;</span>)</span>
<span id="cb299-26"><a href="stats_validation.html#cb299-26" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb299-27"><a href="stats_validation.html#cb299-27" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> src, <span class="at">x =</span> value, <span class="at">color =</span> src, <span class="at">group =</span> src)) <span class="sc">+</span></span>
<span id="cb299-28"><a href="stats_validation.html#cb299-28" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_pointinterval</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb299-29"><a href="stats_validation.html#cb299-29" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(depth_maps_generation_filtering_mode), <span class="at">switch =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb299-30"><a href="stats_validation.html#cb299-30" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb299-31"><a href="stats_validation.html#cb299-31" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> viridis<span class="sc">::</span><span class="fu">turbo</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb299-32"><a href="stats_validation.html#cb299-32" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb299-33"><a href="stats_validation.html#cb299-33" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;filtering mode&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb299-34"><a href="stats_validation.html#cb299-34" tabindex="-1"></a>    , <span class="at">color =</span> <span class="st">&quot;model&quot;</span></span>
<span id="cb299-35"><a href="stats_validation.html#cb299-35" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb299-36"><a href="stats_validation.html#cb299-36" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb299-37"><a href="stats_validation.html#cb299-37" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-220-1.png" width="1008" /></p>
<p>to address one of our main questions, let’s also collapse across the study site, dense cloud quality, and filtering mode setting to compare the software effect.
In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="stats_validation.html#cb300-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb300-2"><a href="stats_validation.html#cb300-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(software) <span class="sc">%&gt;%</span> </span>
<span id="cb300-3"><a href="stats_validation.html#cb300-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb300-4"><a href="stats_validation.html#cb300-4" tabindex="-1"></a>    brms_f_mod4</span>
<span id="cb300-5"><a href="stats_validation.html#cb300-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb300-6"><a href="stats_validation.html#cb300-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> software)</span>
<span id="cb300-7"><a href="stats_validation.html#cb300-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb300-8"><a href="stats_validation.html#cb300-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb300-9"><a href="stats_validation.html#cb300-9" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb300-10"><a href="stats_validation.html#cb300-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb300-11"><a href="stats_validation.html#cb300-11" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb300-12"><a href="stats_validation.html#cb300-12" tabindex="-1"></a>      <span class="at">x =</span> value, <span class="at">y =</span> software</span>
<span id="cb300-13"><a href="stats_validation.html#cb300-13" tabindex="-1"></a>      , <span class="at">fill =</span> software</span>
<span id="cb300-14"><a href="stats_validation.html#cb300-14" tabindex="-1"></a>    )</span>
<span id="cb300-15"><a href="stats_validation.html#cb300-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb300-16"><a href="stats_validation.html#cb300-16" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb300-17"><a href="stats_validation.html#cb300-17" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb300-18"><a href="stats_validation.html#cb300-18" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;gray66&quot;</span></span>
<span id="cb300-19"><a href="stats_validation.html#cb300-19" tabindex="-1"></a>      , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_color =</span> <span class="st">&quot;gray66&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb300-20"><a href="stats_validation.html#cb300-20" tabindex="-1"></a>      , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb300-21"><a href="stats_validation.html#cb300-21" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb300-22"><a href="stats_validation.html#cb300-22" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;rocket&quot;</span>, <span class="at">begin =</span> <span class="fl">0.3</span>, <span class="at">end =</span> <span class="fl">0.9</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb300-23"><a href="stats_validation.html#cb300-23" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb300-24"><a href="stats_validation.html#cb300-24" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb300-25"><a href="stats_validation.html#cb300-25" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;software&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb300-26"><a href="stats_validation.html#cb300-26" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI&quot;</span></span>
<span id="cb300-27"><a href="stats_validation.html#cb300-27" tabindex="-1"></a>      , <span class="at">caption =</span> form_temp</span>
<span id="cb300-28"><a href="stats_validation.html#cb300-28" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb300-29"><a href="stats_validation.html#cb300-29" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb300-30"><a href="stats_validation.html#cb300-30" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-221-1.png" width="1008" /></p>
<p>let’s compare these results to the results from our <a href="stats_validation.html#f_three_pred_mod_bays">three nominal predictor model above</a></p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="stats_validation.html#cb301-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb301-2"><a href="stats_validation.html#cb301-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(software) <span class="sc">%&gt;%</span> </span>
<span id="cb301-3"><a href="stats_validation.html#cb301-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb301-4"><a href="stats_validation.html#cb301-4" tabindex="-1"></a>    brms_f_mod4</span>
<span id="cb301-5"><a href="stats_validation.html#cb301-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb301-6"><a href="stats_validation.html#cb301-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> software)</span>
<span id="cb301-7"><a href="stats_validation.html#cb301-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb301-8"><a href="stats_validation.html#cb301-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod4&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb301-9"><a href="stats_validation.html#cb301-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb301-10"><a href="stats_validation.html#cb301-10" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb301-11"><a href="stats_validation.html#cb301-11" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">distinct</span>(software) <span class="sc">%&gt;%</span> </span>
<span id="cb301-12"><a href="stats_validation.html#cb301-12" tabindex="-1"></a>      tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb301-13"><a href="stats_validation.html#cb301-13" tabindex="-1"></a>        brms_f_mod3</span>
<span id="cb301-14"><a href="stats_validation.html#cb301-14" tabindex="-1"></a>        <span class="co"># this part is crucial</span></span>
<span id="cb301-15"><a href="stats_validation.html#cb301-15" tabindex="-1"></a>        , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> software)</span>
<span id="cb301-16"><a href="stats_validation.html#cb301-16" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb301-17"><a href="stats_validation.html#cb301-17" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod3&quot;</span>)</span>
<span id="cb301-18"><a href="stats_validation.html#cb301-18" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb301-19"><a href="stats_validation.html#cb301-19" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> src, <span class="at">x =</span> value, <span class="at">color =</span> src, <span class="at">group =</span> src)) <span class="sc">+</span></span>
<span id="cb301-20"><a href="stats_validation.html#cb301-20" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_pointinterval</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb301-21"><a href="stats_validation.html#cb301-21" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(software), <span class="at">switch =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb301-22"><a href="stats_validation.html#cb301-22" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb301-23"><a href="stats_validation.html#cb301-23" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> viridis<span class="sc">::</span><span class="fu">turbo</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb301-24"><a href="stats_validation.html#cb301-24" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb301-25"><a href="stats_validation.html#cb301-25" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb301-26"><a href="stats_validation.html#cb301-26" tabindex="-1"></a>    , <span class="at">color =</span> <span class="st">&quot;model&quot;</span></span>
<span id="cb301-27"><a href="stats_validation.html#cb301-27" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb301-28"><a href="stats_validation.html#cb301-28" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb301-29"><a href="stats_validation.html#cb301-29" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-222-1.png" width="1008" /></p>
<p>Finally, we can quantify the variation in F-score by comparing the <span class="math inline">\(\sigma\)</span> posteriors.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="stats_validation.html#cb302-1" tabindex="-1"></a><span class="co"># extract the posterior draws</span></span>
<span id="cb302-2"><a href="stats_validation.html#cb302-2" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod4) <span class="sc">%&gt;%</span> </span>
<span id="cb302-3"><a href="stats_validation.html#cb302-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(sigma,tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sd_&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb302-4"><a href="stats_validation.html#cb302-4" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(dplyr<span class="sc">::</span><span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb302-5"><a href="stats_validation.html#cb302-5" tabindex="-1"></a>  <span class="co"># dplyr::group_by(name) %&gt;% </span></span>
<span id="cb302-6"><a href="stats_validation.html#cb302-6" tabindex="-1"></a>  <span class="co"># tidybayes::median_hdi(value) %&gt;% </span></span>
<span id="cb302-7"><a href="stats_validation.html#cb302-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb302-8"><a href="stats_validation.html#cb302-8" tabindex="-1"></a>    <span class="at">name =</span> name <span class="sc">%&gt;%</span> </span>
<span id="cb302-9"><a href="stats_validation.html#cb302-9" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_quality&quot;</span>, <span class="st">&quot;quality&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb302-10"><a href="stats_validation.html#cb302-10" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span>, <span class="st">&quot;filtering&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb302-11"><a href="stats_validation.html#cb302-11" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(value)</span>
<span id="cb302-12"><a href="stats_validation.html#cb302-12" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb302-13"><a href="stats_validation.html#cb302-13" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb302-14"><a href="stats_validation.html#cb302-14" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> name)) <span class="sc">+</span></span>
<span id="cb302-15"><a href="stats_validation.html#cb302-15" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_dotsinterval</span>(</span>
<span id="cb302-16"><a href="stats_validation.html#cb302-16" tabindex="-1"></a>    <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb302-17"><a href="stats_validation.html#cb302-17" tabindex="-1"></a>    , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.04</span></span>
<span id="cb302-18"><a href="stats_validation.html#cb302-18" tabindex="-1"></a>    , <span class="at">shape =</span> <span class="dv">21</span> <span class="co">#, point_size = 3</span></span>
<span id="cb302-19"><a href="stats_validation.html#cb302-19" tabindex="-1"></a>    , <span class="at">quantiles =</span> <span class="dv">100</span></span>
<span id="cb302-20"><a href="stats_validation.html#cb302-20" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb302-21"><a href="stats_validation.html#cb302-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">caption =</span> form_temp) <span class="sc">+</span></span>
<span id="cb302-22"><a href="stats_validation.html#cb302-22" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-223-1.png" width="1008" /></p>
<p>and perform model selection via information criteria with the <code>brms::loo_compare()</code> function</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="stats_validation.html#cb303-1" tabindex="-1"></a>brms_f_mod4 <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">add_criterion</span>(brms_f_mod4, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</span>
<span id="cb303-2"><a href="stats_validation.html#cb303-2" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">loo_compare</span>(brms_f_mod1, brms_f_mod2, brms_f_mod3, brms_f_mod4, <span class="at">criterion =</span> <span class="st">&quot;loo&quot;</span>)</span></code></pre></div>
<pre><code>##             elpd_diff se_diff
## brms_f_mod4   0.0       0.0  
## brms_f_mod3 -91.0      11.6  
## brms_f_mod1 -91.3      11.0  
## brms_f_mod2 -93.0      11.0</code></pre>
</div>
</div>
<div id="beta_mod" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> The beta: Three Nominal Predictors + site effects<a href="stats_validation.html#beta_mod" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To this point, we have been modelling F-score presuming a Gaussian likelihood. However, the beta likelihood more accurately represents the F-score data which is continuous and restricted within the range of <span class="math inline">\((0,1)\)</span>.</p>
<p>We borrow here from the excellent series on causal inference by <a href="https://solomonkurz.netlify.app/blog/2023-06-25-causal-inference-with-beta-regression/">A. Solomon Kurz</a>. We also utilize the guide to Bayesian beta models by <a href="https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/#b-beta-regression-bayesian-style">Andrew Heiss</a> while <a href="https://rpubs.com/nicoleknight/936037">Nicole Knight</a> posted about the Beta for ecological data.</p>
<div id="summary-statistics-9" class="section level3 hasAnchor" number="6.7.1">
<h3><span class="header-section-number">6.7.1</span> Summary Statistics<a href="stats_validation.html#summary-statistics-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>let’s check our underlying data for F-score (our dependent or <span class="math inline">\(y\)</span> variable)</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="stats_validation.html#cb305-1" tabindex="-1"></a><span class="co"># distribution</span></span>
<span id="cb305-2"><a href="stats_validation.html#cb305-2" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb305-3"><a href="stats_validation.html#cb305-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> f_score)) <span class="sc">+</span> </span>
<span id="cb305-4"><a href="stats_validation.html#cb305-4" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb305-5"><a href="stats_validation.html#cb305-5" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb305-6"><a href="stats_validation.html#cb305-6" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb305-7"><a href="stats_validation.html#cb305-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;&quot;</span>,<span class="at">x=</span><span class="st">&quot;F-score&quot;</span>) <span class="sc">+</span></span>
<span id="cb305-8"><a href="stats_validation.html#cb305-8" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb305-9"><a href="stats_validation.html#cb305-9" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb305-10"><a href="stats_validation.html#cb305-10" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb305-11"><a href="stats_validation.html#cb305-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-226-1.png" width="1008" /></p>
<p>and the summary statistics</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="stats_validation.html#cb306-1" tabindex="-1"></a>ptcld_validation_data<span class="sc">$</span>f_score <span class="sc">%&gt;%</span> </span>
<span id="cb306-2"><a href="stats_validation.html#cb306-2" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.0001  0.2983  0.4425  0.4611  0.6222  0.8997</code></pre>
</div>
<div id="f_5_pred_mod_bays" class="section level3 hasAnchor" number="6.7.2">
<h3><span class="header-section-number">6.7.2</span> Bayesian<a href="stats_validation.html#f_5_pred_mod_bays" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With the beta likelihood our model with three nominal predictor variables and subject-level effects the model becomes:</p>
<p><span class="math display">\[\begin{align*}
y_{i} \sim &amp; {\sf Beta} \bigl(\mu_{i}, , \phi \bigr) \\
\operatorname{logit}(\mu_{i}) = &amp; \beta_0 \\
&amp; + \sum_{j} \beta_{1[j]} x_{1[j]} + \sum_{k} \beta_{2[k]} x_{2[k]} + \sum_{f} \beta_{3[f]} x_{3[f]} + \sum_{s} \beta_{4[s]} x_{4[s]}  \\
&amp; + \sum_{j,k} \beta_{1\times2[j,k]} x_{1\times2[j,k]} + \sum_{j,f} \beta_{1\times3[j,f]} x_{1\times3[j,f]} + \sum_{k,f} \beta_{2\times3[k,f]} x_{2\times3[k,f]} \\
&amp; + \sum_{j,k,f} \beta_{1\times2\times3[j,k,f]} x_{1\times2\times3[j,k,f]} \\
\beta_{0}  \sim &amp; {\sf Normal} (0,1) \\
\beta_{1[j]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{1}}) \\
\beta_{2[k]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{2}}) \\
\beta_{3[f]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{3}}) \\
\beta_{4[s]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{4}}) \\
\beta_{1\times2[j,k]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{1\times2}}) \\
\beta_{1\times3[j,f]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{1\times3}}) \\
\beta_{2\times3[k,f]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{2\times3}}) \\
\sigma_{\beta_{1}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{2}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{3}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{4}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{1\times2}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{1\times3}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{2\times3}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\phi \sim &amp; {\sf Gamma} (4,0.1) \\
\end{align*}\]</span></p>
<p>, where <span class="math inline">\(j\)</span> is the depth map generation quality setting corresponding to observation <span class="math inline">\(i\)</span>, <span class="math inline">\(k\)</span> is the depth map filtering mode setting corresponding to observation <span class="math inline">\(i\)</span>, <span class="math inline">\(f\)</span> is the processing software corresponding to observation <span class="math inline">\(i\)</span>, and <span class="math inline">\(s\)</span> is the study site corresponding to observation <span class="math inline">\(i\)</span></p>
<p>Per <a href="https://cran.r-project.org/web/packages/brms/vignettes/brms_families.html"><code>brms</code></a>, our <span class="math inline">\(y\)</span> is <span class="math inline">\({\sf Beta}\)</span> distributed with the mean as <span class="math inline">\(\mu\)</span> and the concentration as <span class="math inline">\(\phi\)</span> which is sometimes called the <em>concentration</em>, <em>sample size</em> or <em>precision</em>. We can think of mean (<span class="math inline">\(\mu\)</span>) and precision (<span class="math inline">\(\phi\)</span>) just like with a normal distribution and its mean and standard deviation.</p>
<p><code>brms</code> allows us to model the precision (<span class="math inline">\(\phi\)</span>) but it is not required. If <span class="math inline">\(\phi\)</span> is not modeled, you still get a precision component, but it is universal across all the different coefficients (it doesn’t vary across any variables in the model). <a href="https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/#b-beta-regression-bayesian-style">Heiss</a> explains that:</p>
<blockquote>
<p>for whatever mathy reasons, when you don’t explicitly model the precision, the resulting coefficient in the table isn’t on the log scale—it’s a regular non-logged number, so there’s no need to exponentiate.</p>
</blockquote>
<p>in thie <code>brms</code> <a href="https://discourse.mc-stan.org/t/understanding-parameters-of-beta-family-in-brms/21640/8">community post</a> it is similarly noted that:</p>
<blockquote>
<p>If you don’t predict the parameters, you give priors for them on non-transformed scale. When you predict them, the predictors become linear coefficients as any other and work on the transformed scale - the transformations are specified by the link_XX parameters of the families (and you can change them if you need).</p>
</blockquote>
<p><em>Need to check our prior selection…just go with <code>brms</code> defaults for now</em></p>
<p>Now fit the model.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="stats_validation.html#cb308-1" tabindex="-1"></a>brms_f_mod5 <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb308-2"><a href="stats_validation.html#cb308-2" tabindex="-1"></a>  <span class="at">formula =</span> f_score <span class="sc">~</span> </span>
<span id="cb308-3"><a href="stats_validation.html#cb308-3" tabindex="-1"></a>    <span class="co"># baseline</span></span>
<span id="cb308-4"><a href="stats_validation.html#cb308-4" tabindex="-1"></a>    <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb308-5"><a href="stats_validation.html#cb308-5" tabindex="-1"></a>    <span class="co"># main effects</span></span>
<span id="cb308-6"><a href="stats_validation.html#cb308-6" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span></span>
<span id="cb308-7"><a href="stats_validation.html#cb308-7" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode) <span class="sc">+</span> </span>
<span id="cb308-8"><a href="stats_validation.html#cb308-8" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> software) <span class="sc">+</span></span>
<span id="cb308-9"><a href="stats_validation.html#cb308-9" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> study_site) <span class="sc">+</span> <span class="co"># only fitting main effects of site and not interactions</span></span>
<span id="cb308-10"><a href="stats_validation.html#cb308-10" tabindex="-1"></a>    <span class="co"># two-way interactions</span></span>
<span id="cb308-11"><a href="stats_validation.html#cb308-11" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode) <span class="sc">+</span></span>
<span id="cb308-12"><a href="stats_validation.html#cb308-12" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>software) <span class="sc">+</span></span>
<span id="cb308-13"><a href="stats_validation.html#cb308-13" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode<span class="sc">:</span>software) <span class="sc">+</span></span>
<span id="cb308-14"><a href="stats_validation.html#cb308-14" tabindex="-1"></a>    <span class="co"># three-way interactions</span></span>
<span id="cb308-15"><a href="stats_validation.html#cb308-15" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode<span class="sc">:</span>software)</span>
<span id="cb308-16"><a href="stats_validation.html#cb308-16" tabindex="-1"></a>  , <span class="at">data =</span> ptcld_validation_data</span>
<span id="cb308-17"><a href="stats_validation.html#cb308-17" tabindex="-1"></a>  , <span class="at">family =</span> <span class="fu">Beta</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)</span>
<span id="cb308-18"><a href="stats_validation.html#cb308-18" tabindex="-1"></a>  , <span class="at">iter =</span> <span class="dv">20000</span>, <span class="at">warmup =</span> <span class="dv">10000</span>, <span class="at">chains =</span> <span class="dv">4</span></span>
<span id="cb308-19"><a href="stats_validation.html#cb308-19" tabindex="-1"></a>  , <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>, <span class="at">max_treedepth =</span> <span class="dv">13</span>)</span>
<span id="cb308-20"><a href="stats_validation.html#cb308-20" tabindex="-1"></a>  , <span class="at">cores =</span> <span class="fu">round</span>(parallel<span class="sc">::</span><span class="fu">detectCores</span>()<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb308-21"><a href="stats_validation.html#cb308-21" tabindex="-1"></a>  , <span class="at">file =</span> <span class="fu">paste0</span>(rootdir, <span class="st">&quot;/fits/brms_f_mod5&quot;</span>)</span>
<span id="cb308-22"><a href="stats_validation.html#cb308-22" tabindex="-1"></a>)</span>
<span id="cb308-23"><a href="stats_validation.html#cb308-23" tabindex="-1"></a><span class="co"># brms::make_stancode(brms_f_mod5)</span></span>
<span id="cb308-24"><a href="stats_validation.html#cb308-24" tabindex="-1"></a><span class="co"># print(brms_f_mod5)</span></span></code></pre></div>
<div id="ppcheck_mod5" class="section level4 hasAnchor" number="6.7.2.1">
<h4><span class="header-section-number">6.7.2.1</span> Posterior Predictive Checks<a href="stats_validation.html#ppcheck_mod5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Markov chain Monte Carlo (MCMC) simulations were conducted using the <code>brms</code> package (Bürkner 2017) to estimate posterior predictive distributions of the parameters of interest. We ran three chains of 100,000 iterations with the first 50,000 discarded as burn-in. Trace-plots were utilized to visually assess model convergence and sufficient convergence was checked with <span class="math inline">\(\hat{R}\)</span> values near 1 (<a href="https://scholar.google.com/scholar?cluster=14209404114665352991&amp;hl=en&amp;as_sdt=0,6">Brooks &amp; Gelman, 1998</a>). Posterior predictive checks were used to evaluate model goodness-of-fit by comparing data simulated from the model with the observed data used to estimate the model parameters (<a href="https://scholar.google.com/scholar?cluster=9228589188684720156&amp;hl=en&amp;as_sdt=0,6">Hobbs &amp; Hooten, 2015</a>). Calculating the proportion of MCMC iterations in which the test statistic (i.e., mean and sum of squares) from the simulated data and observed data are more extreme than one another provides the Bayesian P-value. Lack of fit is indicated by a value close to 0 or 1 while a value of 0.5 indicates perfect fit (<a href="https://scholar.google.com/scholar?cluster=9228589188684720156&amp;hl=en&amp;as_sdt=0,6">Hobbs &amp; Hooten, 2015</a>).</p>
<p>To learn more about this approach to posterior predictive checks, check out Gabry’s (2022) vignette, <a href="https://cran.r-project.org/web/packages/bayesplot/vignettes/graphical-ppcs.html">Graphical posterior predictive checks using the bayesplot package</a>.</p>
<p>check the trace plots for problems with convergence of the Markov chains</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="stats_validation.html#cb309-1" tabindex="-1"></a><span class="fu">plot</span>(brms_f_mod5)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-229-1.png" width="1008" /><img src="metashape_testing_files/figure-html/unnamed-chunk-229-2.png" width="1008" /></p>
<p>and check our <span class="math inline">\(\hat{R}\)</span> values</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="stats_validation.html#cb310-1" tabindex="-1"></a>brms_f_mod5 <span class="sc">%&gt;%</span> </span>
<span id="cb310-2"><a href="stats_validation.html#cb310-2" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">rhat</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb310-3"><a href="stats_validation.html#cb310-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb310-4"><a href="stats_validation.html#cb310-4" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameter&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb310-5"><a href="stats_validation.html#cb310-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(tolower) <span class="sc">%&gt;%</span> </span>
<span id="cb310-6"><a href="stats_validation.html#cb310-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">rhat =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb310-7"><a href="stats_validation.html#cb310-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb310-8"><a href="stats_validation.html#cb310-8" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_starts</span>(parameter, <span class="st">&quot;b_&quot;</span>) </span>
<span id="cb310-9"><a href="stats_validation.html#cb310-9" tabindex="-1"></a>    <span class="sc">|</span> stringr<span class="sc">::</span><span class="fu">str_starts</span>(parameter, <span class="st">&quot;r_&quot;</span>) </span>
<span id="cb310-10"><a href="stats_validation.html#cb310-10" tabindex="-1"></a>    <span class="sc">|</span> stringr<span class="sc">::</span><span class="fu">str_starts</span>(parameter, <span class="st">&quot;sd_&quot;</span>) </span>
<span id="cb310-11"><a href="stats_validation.html#cb310-11" tabindex="-1"></a>    <span class="sc">|</span> parameter <span class="sc">==</span> <span class="st">&quot;phi&quot;</span></span>
<span id="cb310-12"><a href="stats_validation.html#cb310-12" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb310-13"><a href="stats_validation.html#cb310-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb310-14"><a href="stats_validation.html#cb310-14" tabindex="-1"></a>    <span class="at">parameter =</span> parameter <span class="sc">%&gt;%</span> </span>
<span id="cb310-15"><a href="stats_validation.html#cb310-15" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_quality&quot;</span>, <span class="st">&quot;quality&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb310-16"><a href="stats_validation.html#cb310-16" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span>, <span class="st">&quot;filtering&quot;</span>)</span>
<span id="cb310-17"><a href="stats_validation.html#cb310-17" tabindex="-1"></a>    , <span class="at">chk =</span> (rhat <span class="sc">&lt;=</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">0.998</span> <span class="sc">|</span> rhat <span class="sc">&gt;=</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">1.002</span>)</span>
<span id="cb310-18"><a href="stats_validation.html#cb310-18" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb310-19"><a href="stats_validation.html#cb310-19" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> rhat, <span class="at">y =</span> parameter, <span class="at">color =</span> chk, <span class="at">fill =</span> chk)) <span class="sc">+</span></span>
<span id="cb310-20"><a href="stats_validation.html#cb310-20" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray44&quot;</span>, <span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb310-21"><a href="stats_validation.html#cb310-21" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">0.998</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb310-22"><a href="stats_validation.html#cb310-22" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">1.002</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb310-23"><a href="stats_validation.html#cb310-23" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">0.999</span>, <span class="at">lwd =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="st">&quot;gray33&quot;</span>) <span class="sc">+</span></span>
<span id="cb310-24"><a href="stats_validation.html#cb310-24" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">1.001</span>, <span class="at">lwd =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="st">&quot;gray33&quot;</span>) <span class="sc">+</span></span>
<span id="cb310-25"><a href="stats_validation.html#cb310-25" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb310-26"><a href="stats_validation.html#cb310-26" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;firebrick&quot;</span>)) <span class="sc">+</span></span>
<span id="cb310-27"><a href="stats_validation.html#cb310-27" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;firebrick&quot;</span>)) <span class="sc">+</span></span>
<span id="cb310-28"><a href="stats_validation.html#cb310-28" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb310-29"><a href="stats_validation.html#cb310-29" tabindex="-1"></a>    <span class="at">x =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">hat{R}$&quot;</span>)</span>
<span id="cb310-30"><a href="stats_validation.html#cb310-30" tabindex="-1"></a>    , <span class="at">subtitle =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">&quot;posterior-predictive check for parameter $</span><span class="sc">\\</span><span class="st">hat{R}$ estimates&quot;</span>)</span>
<span id="cb310-31"><a href="stats_validation.html#cb310-31" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb310-32"><a href="stats_validation.html#cb310-32" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb310-33"><a href="stats_validation.html#cb310-33" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb310-34"><a href="stats_validation.html#cb310-34" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb310-35"><a href="stats_validation.html#cb310-35" tabindex="-1"></a>    , <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">4</span>)</span>
<span id="cb310-36"><a href="stats_validation.html#cb310-36" tabindex="-1"></a>    , <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb310-37"><a href="stats_validation.html#cb310-37" tabindex="-1"></a>    , <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb310-38"><a href="stats_validation.html#cb310-38" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-230-1.png" width="1008" /></p>
<p>posterior-predictive check to make sure the model does an okay job simulating data that resemble the sample data</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="stats_validation.html#cb311-1" tabindex="-1"></a><span class="co"># posterior predictive check</span></span>
<span id="cb311-2"><a href="stats_validation.html#cb311-2" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">pp_check</span>(</span>
<span id="cb311-3"><a href="stats_validation.html#cb311-3" tabindex="-1"></a>    brms_f_mod5</span>
<span id="cb311-4"><a href="stats_validation.html#cb311-4" tabindex="-1"></a>    , <span class="at">type =</span> <span class="st">&quot;dens_overlay&quot;</span></span>
<span id="cb311-5"><a href="stats_validation.html#cb311-5" tabindex="-1"></a>    , <span class="at">ndraws =</span> <span class="dv">100</span></span>
<span id="cb311-6"><a href="stats_validation.html#cb311-6" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb311-7"><a href="stats_validation.html#cb311-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;posterior-predictive check (overlaid densities)&quot;</span>) <span class="sc">+</span></span>
<span id="cb311-8"><a href="stats_validation.html#cb311-8" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb311-9"><a href="stats_validation.html#cb311-9" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb311-10"><a href="stats_validation.html#cb311-10" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb311-11"><a href="stats_validation.html#cb311-11" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb311-12"><a href="stats_validation.html#cb311-12" tabindex="-1"></a>    , <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb311-13"><a href="stats_validation.html#cb311-13" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-231-1.png" width="1008" /></p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="stats_validation.html#cb312-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="st">&quot;../data/ppchk_ovrll_mod5.png&quot;</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span>)</span></code></pre></div>
<p>another way</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="stats_validation.html#cb313-1" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">pp_check</span>(brms_f_mod5, <span class="at">type =</span> <span class="st">&quot;ecdf_overlay&quot;</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb313-2"><a href="stats_validation.html#cb313-2" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;posterior-predictive check (ECDF: empirical cumulative distribution function)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb313-3"><a href="stats_validation.html#cb313-3" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb313-4"><a href="stats_validation.html#cb313-4" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb313-5"><a href="stats_validation.html#cb313-5" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb313-6"><a href="stats_validation.html#cb313-6" tabindex="-1"></a>    , <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb313-7"><a href="stats_validation.html#cb313-7" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-232-1.png" width="1008" /></p>
<p>and another posterior predictive check for the overall model</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="stats_validation.html#cb314-1" tabindex="-1"></a><span class="co"># means</span></span>
<span id="cb314-2"><a href="stats_validation.html#cb314-2" tabindex="-1"></a>p1_temp <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(</span>
<span id="cb314-3"><a href="stats_validation.html#cb314-3" tabindex="-1"></a>    brms_f_mod5</span>
<span id="cb314-4"><a href="stats_validation.html#cb314-4" tabindex="-1"></a>    , <span class="at">type =</span> <span class="st">&quot;stat&quot;</span></span>
<span id="cb314-5"><a href="stats_validation.html#cb314-5" tabindex="-1"></a>    , <span class="at">stat =</span> <span class="st">&quot;mean&quot;</span></span>
<span id="cb314-6"><a href="stats_validation.html#cb314-6" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb314-7"><a href="stats_validation.html#cb314-7" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="cn">NULL</span>)) <span class="sc">+</span></span>
<span id="cb314-8"><a href="stats_validation.html#cb314-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;means&quot;</span>) <span class="sc">+</span></span>
<span id="cb314-9"><a href="stats_validation.html#cb314-9" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb314-10"><a href="stats_validation.html#cb314-10" tabindex="-1"></a><span class="co"># sds</span></span>
<span id="cb314-11"><a href="stats_validation.html#cb314-11" tabindex="-1"></a>p2_temp <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(</span>
<span id="cb314-12"><a href="stats_validation.html#cb314-12" tabindex="-1"></a>    brms_f_mod5</span>
<span id="cb314-13"><a href="stats_validation.html#cb314-13" tabindex="-1"></a>    , <span class="at">type =</span> <span class="st">&quot;stat&quot;</span></span>
<span id="cb314-14"><a href="stats_validation.html#cb314-14" tabindex="-1"></a>    , <span class="at">stat =</span> <span class="st">&quot;sd&quot;</span></span>
<span id="cb314-15"><a href="stats_validation.html#cb314-15" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb314-16"><a href="stats_validation.html#cb314-16" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="cn">NULL</span>)) <span class="sc">+</span></span>
<span id="cb314-17"><a href="stats_validation.html#cb314-17" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;sd&#39;s&quot;</span>) <span class="sc">+</span></span>
<span id="cb314-18"><a href="stats_validation.html#cb314-18" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb314-19"><a href="stats_validation.html#cb314-19" tabindex="-1"></a></span>
<span id="cb314-20"><a href="stats_validation.html#cb314-20" tabindex="-1"></a><span class="co"># combine </span></span>
<span id="cb314-21"><a href="stats_validation.html#cb314-21" tabindex="-1"></a>(p1_temp <span class="sc">+</span> p2_temp) <span class="sc">&amp;</span></span>
<span id="cb314-22"><a href="stats_validation.html#cb314-22" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb314-23"><a href="stats_validation.html#cb314-23" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb314-24"><a href="stats_validation.html#cb314-24" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Posterior-predictive statistical checks</span><span class="sc">\n</span><span class="st">overall model&quot;</span></span>
<span id="cb314-25"><a href="stats_validation.html#cb314-25" tabindex="-1"></a>    , <span class="at">subtitle =</span> <span class="fu">expression</span>(</span>
<span id="cb314-26"><a href="stats_validation.html#cb314-26" tabindex="-1"></a>      <span class="st">&quot;The dark blue lines are &quot;</span><span class="sc">*</span><span class="fu">italic</span>(<span class="fu">T</span>(y))<span class="sc">*</span><span class="st">&quot;, and the light blue bars are for &quot;</span><span class="sc">*</span><span class="fu">italic</span>(T)(<span class="fu">italic</span>(y)[rep])<span class="sc">*</span><span class="st">&quot;.&quot;</span>)</span>
<span id="cb314-27"><a href="stats_validation.html#cb314-27" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-233-1.png" width="1008" /></p>
<p>and another posterior predictive check for the overall model combining mean and sd</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="stats_validation.html#cb315-1" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">pp_check</span>(brms_f_mod5, <span class="at">type =</span> <span class="st">&quot;stat_2d&quot;</span>) <span class="sc">+</span></span>
<span id="cb315-2"><a href="stats_validation.html#cb315-2" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb315-3"><a href="stats_validation.html#cb315-3" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb315-4"><a href="stats_validation.html#cb315-4" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb315-5"><a href="stats_validation.html#cb315-5" tabindex="-1"></a>    , <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb315-6"><a href="stats_validation.html#cb315-6" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-234-1.png" width="1008" /></p>
<p>How’d we do capturing the conditional means and standard deviations by depth map generation quality?</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="stats_validation.html#cb316-1" tabindex="-1"></a><span class="co"># means</span></span>
<span id="cb316-2"><a href="stats_validation.html#cb316-2" tabindex="-1"></a>p1_temp <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(</span>
<span id="cb316-3"><a href="stats_validation.html#cb316-3" tabindex="-1"></a>    brms_f_mod5</span>
<span id="cb316-4"><a href="stats_validation.html#cb316-4" tabindex="-1"></a>    , <span class="at">type =</span> <span class="st">&quot;stat_grouped&quot;</span> <span class="co"># &quot;dens_overlay_grouped&quot;</span></span>
<span id="cb316-5"><a href="stats_validation.html#cb316-5" tabindex="-1"></a>    , <span class="at">stat =</span> <span class="st">&quot;mean&quot;</span></span>
<span id="cb316-6"><a href="stats_validation.html#cb316-6" tabindex="-1"></a>    , <span class="at">group =</span> <span class="st">&quot;depth_maps_generation_quality&quot;</span></span>
<span id="cb316-7"><a href="stats_validation.html#cb316-7" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb316-8"><a href="stats_validation.html#cb316-8" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="cn">NULL</span>)) <span class="sc">+</span></span>
<span id="cb316-9"><a href="stats_validation.html#cb316-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;means&quot;</span>) <span class="sc">+</span></span>
<span id="cb316-10"><a href="stats_validation.html#cb316-10" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(group), <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb316-11"><a href="stats_validation.html#cb316-11" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb316-12"><a href="stats_validation.html#cb316-12" tabindex="-1"></a><span class="co"># sds</span></span>
<span id="cb316-13"><a href="stats_validation.html#cb316-13" tabindex="-1"></a>p2_temp <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(</span>
<span id="cb316-14"><a href="stats_validation.html#cb316-14" tabindex="-1"></a>    brms_f_mod5</span>
<span id="cb316-15"><a href="stats_validation.html#cb316-15" tabindex="-1"></a>    , <span class="at">type =</span> <span class="st">&quot;stat_grouped&quot;</span> <span class="co"># &quot;dens_overlay_grouped&quot;</span></span>
<span id="cb316-16"><a href="stats_validation.html#cb316-16" tabindex="-1"></a>    , <span class="at">stat =</span> <span class="st">&quot;sd&quot;</span></span>
<span id="cb316-17"><a href="stats_validation.html#cb316-17" tabindex="-1"></a>    , <span class="at">group =</span> <span class="st">&quot;depth_maps_generation_quality&quot;</span></span>
<span id="cb316-18"><a href="stats_validation.html#cb316-18" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb316-19"><a href="stats_validation.html#cb316-19" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="cn">NULL</span>)) <span class="sc">+</span></span>
<span id="cb316-20"><a href="stats_validation.html#cb316-20" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;sd&#39;s&quot;</span>) <span class="sc">+</span></span>
<span id="cb316-21"><a href="stats_validation.html#cb316-21" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(group), <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb316-22"><a href="stats_validation.html#cb316-22" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb316-23"><a href="stats_validation.html#cb316-23" tabindex="-1"></a><span class="co"># combine </span></span>
<span id="cb316-24"><a href="stats_validation.html#cb316-24" tabindex="-1"></a>(p1_temp <span class="sc">/</span> p2_temp) <span class="sc">&amp;</span></span>
<span id="cb316-25"><a href="stats_validation.html#cb316-25" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb316-26"><a href="stats_validation.html#cb316-26" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb316-27"><a href="stats_validation.html#cb316-27" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Posterior-predictive statistical checks</span><span class="sc">\n</span><span class="st">by dense cloud quality&quot;</span></span>
<span id="cb316-28"><a href="stats_validation.html#cb316-28" tabindex="-1"></a>    , <span class="at">subtitle =</span> <span class="fu">expression</span>(</span>
<span id="cb316-29"><a href="stats_validation.html#cb316-29" tabindex="-1"></a>      <span class="st">&quot;The dark blue lines are &quot;</span><span class="sc">*</span><span class="fu">italic</span>(<span class="fu">T</span>(y))<span class="sc">*</span><span class="st">&quot;, and the light blue bars are for &quot;</span><span class="sc">*</span><span class="fu">italic</span>(T)(<span class="fu">italic</span>(y)[rep])<span class="sc">*</span><span class="st">&quot;.&quot;</span>)</span>
<span id="cb316-30"><a href="stats_validation.html#cb316-30" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-235-1.png" width="1008" /></p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="stats_validation.html#cb317-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="st">&quot;../data/ppchk_qlty_mod5.png&quot;</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span>)</span></code></pre></div>
<p>Both the means and sd’s of the F-score are well represented across the different levels of dense cloud quality</p>
<p>What about for the software?</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="stats_validation.html#cb318-1" tabindex="-1"></a><span class="fu">pp_check</span>(brms_f_mod5, <span class="st">&quot;dens_overlay_grouped&quot;</span>, <span class="at">group =</span> <span class="st">&quot;software&quot;</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb318-2"><a href="stats_validation.html#cb318-2" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;posterior-predictive check (overlaid densities)</span><span class="sc">\n</span><span class="st">by software&quot;</span>) <span class="sc">+</span></span>
<span id="cb318-3"><a href="stats_validation.html#cb318-3" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb318-4"><a href="stats_validation.html#cb318-4" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb318-5"><a href="stats_validation.html#cb318-5" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb318-6"><a href="stats_validation.html#cb318-6" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb318-7"><a href="stats_validation.html#cb318-7" tabindex="-1"></a>    , <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb318-8"><a href="stats_validation.html#cb318-8" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-236-1.png" width="1008" /></p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="stats_validation.html#cb319-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="st">&quot;../data/ppchk_sftwr_mod5.png&quot;</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span>)</span></code></pre></div>
<p>and what about for the filtering mode?</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="stats_validation.html#cb320-1" tabindex="-1"></a><span class="fu">pp_check</span>(brms_f_mod5, <span class="st">&quot;dens_overlay_grouped&quot;</span>, <span class="at">group =</span> <span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb320-2"><a href="stats_validation.html#cb320-2" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;posterior-predictive check (overlaid densities)</span><span class="sc">\n</span><span class="st">by filtering mode&quot;</span>) <span class="sc">+</span></span>
<span id="cb320-3"><a href="stats_validation.html#cb320-3" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb320-4"><a href="stats_validation.html#cb320-4" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb320-5"><a href="stats_validation.html#cb320-5" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb320-6"><a href="stats_validation.html#cb320-6" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb320-7"><a href="stats_validation.html#cb320-7" tabindex="-1"></a>    , <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb320-8"><a href="stats_validation.html#cb320-8" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-237-1.png" width="1008" /></p>
<p>It looks like our model is making predictions that are consistent with our original data, which is what we want.</p>
<p>check the prior distributions</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="stats_validation.html#cb321-1" tabindex="-1"></a><span class="co"># check priors</span></span>
<span id="cb321-2"><a href="stats_validation.html#cb321-2" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">prior_summary</span>(brms_f_mod5) <span class="sc">%&gt;%</span> </span>
<span id="cb321-3"><a href="stats_validation.html#cb321-3" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb321-4"><a href="stats_validation.html#cb321-4" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
prior
</th>
<th style="text-align:left;">
class
</th>
<th style="text-align:left;">
coef
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
resp
</th>
<th style="text-align:left;">
dpar
</th>
<th style="text-align:left;">
nlpar
</th>
<th style="text-align:left;">
lb
</th>
<th style="text-align:left;">
ub
</th>
<th style="text-align:left;">
source
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
student_t(3, 0, 2.5)
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
gamma(0.01, 0.01)
</td>
<td style="text-align:left;">
phi
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
student_t(3, 0, 2.5)
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_filtering_mode
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_filtering_mode
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_filtering_mode:software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_filtering_mode:software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_quality
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_quality
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_quality:depth_maps_generation_filtering_mode
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_quality:depth_maps_generation_filtering_mode
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_quality:depth_maps_generation_filtering_mode:software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_quality:depth_maps_generation_filtering_mode:software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
depth_maps_generation_quality:software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
depth_maps_generation_quality:software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
software
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
study_site
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
study_site
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
default
</td>
</tr>
</tbody>
</table>
<p>The <code>brms::brm</code> model summary</p>
<p>We won’t clutter the output here but this can be run if you are following along on your own</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="stats_validation.html#cb322-1" tabindex="-1"></a>brms_f_mod5 <span class="sc">%&gt;%</span> </span>
<span id="cb322-2"><a href="stats_validation.html#cb322-2" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">%&gt;%</span> <span class="fu">str</span>()</span>
<span id="cb322-3"><a href="stats_validation.html#cb322-3" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">posterior_summary</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb322-4"><a href="stats_validation.html#cb322-4" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb322-5"><a href="stats_validation.html#cb322-5" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameter&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb322-6"><a href="stats_validation.html#cb322-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(tolower) <span class="sc">%&gt;%</span> </span>
<span id="cb322-7"><a href="stats_validation.html#cb322-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb322-8"><a href="stats_validation.html#cb322-8" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_starts</span>(parameter, <span class="st">&quot;b_&quot;</span>) </span>
<span id="cb322-9"><a href="stats_validation.html#cb322-9" tabindex="-1"></a>    <span class="sc">|</span> stringr<span class="sc">::</span><span class="fu">str_starts</span>(parameter, <span class="st">&quot;r_&quot;</span>) </span>
<span id="cb322-10"><a href="stats_validation.html#cb322-10" tabindex="-1"></a>    <span class="sc">|</span> stringr<span class="sc">::</span><span class="fu">str_starts</span>(parameter, <span class="st">&quot;sd_&quot;</span>) </span>
<span id="cb322-11"><a href="stats_validation.html#cb322-11" tabindex="-1"></a>    <span class="sc">|</span> parameter <span class="sc">==</span> <span class="st">&quot;phi&quot;</span></span>
<span id="cb322-12"><a href="stats_validation.html#cb322-12" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb322-13"><a href="stats_validation.html#cb322-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb322-14"><a href="stats_validation.html#cb322-14" tabindex="-1"></a>    <span class="at">parameter =</span> parameter <span class="sc">%&gt;%</span> </span>
<span id="cb322-15"><a href="stats_validation.html#cb322-15" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_quality&quot;</span>, <span class="st">&quot;quality&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb322-16"><a href="stats_validation.html#cb322-16" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span>, <span class="st">&quot;filtering&quot;</span>)</span>
<span id="cb322-17"><a href="stats_validation.html#cb322-17" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb322-18"><a href="stats_validation.html#cb322-18" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">2</span>, <span class="at">caption =</span> <span class="st">&quot;Bayesian final model for F-score&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb322-19"><a href="stats_validation.html#cb322-19" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb322-20"><a href="stats_validation.html#cb322-20" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;8in&quot;</span>)</span></code></pre></div>
<p>We can look at the model noise standard deviation (concentration) <span class="math inline">\(\phi\)</span> and the intercept</p>
<p>We can think of mean (<span class="math inline">\(\mu\)</span>) and precision (<span class="math inline">\(\phi\)</span>) just like with a normal distribution and its mean and standard deviation.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="stats_validation.html#cb323-1" tabindex="-1"></a><span class="co"># get formula</span></span>
<span id="cb323-2"><a href="stats_validation.html#cb323-2" tabindex="-1"></a>form_temp <span class="ot">=</span> brms_f_mod5<span class="sc">$</span>formula<span class="sc">$</span>formula[<span class="dv">3</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb323-3"><a href="stats_validation.html#cb323-3" tabindex="-1"></a>  <span class="fu">as.character</span>() <span class="sc">%&gt;%</span> <span class="fu">get_frmla_text</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb323-4"><a href="stats_validation.html#cb323-4" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_quality&quot;</span>, <span class="st">&quot;quality&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb323-5"><a href="stats_validation.html#cb323-5" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span>, <span class="st">&quot;filtering&quot;</span>)</span>
<span id="cb323-6"><a href="stats_validation.html#cb323-6" tabindex="-1"></a><span class="co"># extract the posterior draws</span></span>
<span id="cb323-7"><a href="stats_validation.html#cb323-7" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod5) <span class="sc">%&gt;%</span> </span>
<span id="cb323-8"><a href="stats_validation.html#cb323-8" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb323-9"><a href="stats_validation.html#cb323-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> phi, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb323-10"><a href="stats_validation.html#cb323-10" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_dotsinterval</span>(</span>
<span id="cb323-11"><a href="stats_validation.html#cb323-11" tabindex="-1"></a>    <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb323-12"><a href="stats_validation.html#cb323-12" tabindex="-1"></a>    , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.04</span></span>
<span id="cb323-13"><a href="stats_validation.html#cb323-13" tabindex="-1"></a>    , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_size =</span> <span class="dv">3</span></span>
<span id="cb323-14"><a href="stats_validation.html#cb323-14" tabindex="-1"></a>    , <span class="at">quantiles =</span> <span class="dv">100</span></span>
<span id="cb323-15"><a href="stats_validation.html#cb323-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb323-16"><a href="stats_validation.html#cb323-16" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb323-17"><a href="stats_validation.html#cb323-17" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb323-18"><a href="stats_validation.html#cb323-18" tabindex="-1"></a>    <span class="at">x =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">phi$&quot;</span>)</span>
<span id="cb323-19"><a href="stats_validation.html#cb323-19" tabindex="-1"></a>    <span class="co"># , caption = form_temp</span></span>
<span id="cb323-20"><a href="stats_validation.html#cb323-20" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb323-21"><a href="stats_validation.html#cb323-21" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-240-1.png" width="1008" /></p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="stats_validation.html#cb324-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="st">&quot;../data/phi_posterior_mod5.png&quot;</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span>)</span></code></pre></div>
</div>
<div id="qualityfiltering---interaction" class="section level4 hasAnchor" number="6.7.2.2">
<h4><span class="header-section-number">6.7.2.2</span> Quality:Filtering - interaction<a href="stats_validation.html#qualityfiltering---interaction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Are there differences in F-score based on dense point cloud generation quality within each level of filtering mode?</p>
<p>Here, we collapse across the study site and software to compare the combined dense cloud quality and filtering mode effect.</p>
<p>In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="stats_validation.html#cb325-1" tabindex="-1"></a>qlty_filter_draws_temp <span class="ot">=</span> </span>
<span id="cb325-2"><a href="stats_validation.html#cb325-2" tabindex="-1"></a>  ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb325-3"><a href="stats_validation.html#cb325-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb325-4"><a href="stats_validation.html#cb325-4" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb325-5"><a href="stats_validation.html#cb325-5" tabindex="-1"></a>      brms_f_mod5, <span class="at">allow_new_levels =</span> T</span>
<span id="cb325-6"><a href="stats_validation.html#cb325-6" tabindex="-1"></a>      <span class="co"># this part is crucial</span></span>
<span id="cb325-7"><a href="stats_validation.html#cb325-7" tabindex="-1"></a>      , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span></span>
<span id="cb325-8"><a href="stats_validation.html#cb325-8" tabindex="-1"></a>        (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode) <span class="sc">+</span> </span>
<span id="cb325-9"><a href="stats_validation.html#cb325-9" tabindex="-1"></a>        (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode)</span>
<span id="cb325-10"><a href="stats_validation.html#cb325-10" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb325-11"><a href="stats_validation.html#cb325-11" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb325-12"><a href="stats_validation.html#cb325-12" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">med =</span> tidybayes<span class="sc">::</span><span class="fu">median_hdci</span>(value)<span class="sc">$</span>y)</span>
<span id="cb325-13"><a href="stats_validation.html#cb325-13" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb325-14"><a href="stats_validation.html#cb325-14" tabindex="-1"></a>  qlty_filter_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb325-15"><a href="stats_validation.html#cb325-15" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">depth_maps_generation_quality =</span> depth_maps_generation_quality <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb325-16"><a href="stats_validation.html#cb325-16" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb325-17"><a href="stats_validation.html#cb325-17" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb325-18"><a href="stats_validation.html#cb325-18" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb325-19"><a href="stats_validation.html#cb325-19" tabindex="-1"></a>      <span class="at">y =</span> value, <span class="at">x =</span> depth_maps_generation_filtering_mode</span>
<span id="cb325-20"><a href="stats_validation.html#cb325-20" tabindex="-1"></a>      <span class="co"># , fill = depth_maps_generation_filtering_mode</span></span>
<span id="cb325-21"><a href="stats_validation.html#cb325-21" tabindex="-1"></a>      , <span class="at">fill =</span> med</span>
<span id="cb325-22"><a href="stats_validation.html#cb325-22" tabindex="-1"></a>    )</span>
<span id="cb325-23"><a href="stats_validation.html#cb325-23" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb325-24"><a href="stats_validation.html#cb325-24" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_eye</span>(</span>
<span id="cb325-25"><a href="stats_validation.html#cb325-25" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb325-26"><a href="stats_validation.html#cb325-26" tabindex="-1"></a>      , <span class="at">slab_alpha =</span> <span class="fl">0.95</span></span>
<span id="cb325-27"><a href="stats_validation.html#cb325-27" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb325-28"><a href="stats_validation.html#cb325-28" tabindex="-1"></a>      , <span class="at">point_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_size =</span> <span class="dv">1</span></span>
<span id="cb325-29"><a href="stats_validation.html#cb325-29" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb325-30"><a href="stats_validation.html#cb325-30" tabindex="-1"></a>    <span class="co"># scale_fill_viridis_d(option = &quot;plasma&quot;, drop = F) +</span></span>
<span id="cb325-31"><a href="stats_validation.html#cb325-31" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;mako&quot;</span>, <span class="at">direction=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb325-32"><a href="stats_validation.html#cb325-32" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb325-33"><a href="stats_validation.html#cb325-33" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(depth_maps_generation_quality)) <span class="sc">+</span></span>
<span id="cb325-34"><a href="stats_validation.html#cb325-34" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb325-35"><a href="stats_validation.html#cb325-35" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">&quot;filtering mode&quot;</span>, <span class="at">y =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb325-36"><a href="stats_validation.html#cb325-36" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI</span><span class="sc">\n</span><span class="st">by dense cloud quality&quot;</span></span>
<span id="cb325-37"><a href="stats_validation.html#cb325-37" tabindex="-1"></a>      , <span class="at">fill =</span> <span class="st">&quot;Filtering Mode&quot;</span></span>
<span id="cb325-38"><a href="stats_validation.html#cb325-38" tabindex="-1"></a>      <span class="co"># , caption = form_temp</span></span>
<span id="cb325-39"><a href="stats_validation.html#cb325-39" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb325-40"><a href="stats_validation.html#cb325-40" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb325-41"><a href="stats_validation.html#cb325-41" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb325-42"><a href="stats_validation.html#cb325-42" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb325-43"><a href="stats_validation.html#cb325-43" tabindex="-1"></a>      , <span class="at">legend.direction  =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb325-44"><a href="stats_validation.html#cb325-44" tabindex="-1"></a>      , <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb325-45"><a href="stats_validation.html#cb325-45" tabindex="-1"></a>      , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb325-46"><a href="stats_validation.html#cb325-46" tabindex="-1"></a>    ) </span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-241-1.png" width="1008" /></p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="stats_validation.html#cb326-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb326-2"><a href="stats_validation.html#cb326-2" tabindex="-1"></a>  <span class="st">&quot;../data/qlty_fltr_mod5.png&quot;</span></span>
<span id="cb326-3"><a href="stats_validation.html#cb326-3" tabindex="-1"></a>  , <span class="at">plot =</span> ggplot2<span class="sc">::</span><span class="fu">last_plot</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb326-4"><a href="stats_validation.html#cb326-4" tabindex="-1"></a>  , <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span></span>
<span id="cb326-5"><a href="stats_validation.html#cb326-5" tabindex="-1"></a>)</span></code></pre></div>
<p>and a table of these 95% HDI values</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="stats_validation.html#cb327-1" tabindex="-1"></a>table_temp <span class="ot">=</span></span>
<span id="cb327-2"><a href="stats_validation.html#cb327-2" tabindex="-1"></a>  qlty_filter_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb327-3"><a href="stats_validation.html#cb327-3" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb327-4"><a href="stats_validation.html#cb327-4" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(.point,.interval, .width,.row)) <span class="sc">%&gt;%</span> </span>
<span id="cb327-5"><a href="stats_validation.html#cb327-5" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(depth_maps_generation_quality, depth_maps_generation_filtering_mode)</span>
<span id="cb327-6"><a href="stats_validation.html#cb327-6" tabindex="-1"></a></span>
<span id="cb327-7"><a href="stats_validation.html#cb327-7" tabindex="-1"></a>table_temp <span class="sc">%&gt;%</span></span>
<span id="cb327-8"><a href="stats_validation.html#cb327-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(depth_maps_generation_quality)) <span class="sc">%&gt;%</span> </span>
<span id="cb327-9"><a href="stats_validation.html#cb327-9" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb327-10"><a href="stats_validation.html#cb327-10" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb327-11"><a href="stats_validation.html#cb327-11" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;F-score&lt;br&gt;95% HDI of the posterior predictive distribution&quot;</span></span>
<span id="cb327-12"><a href="stats_validation.html#cb327-12" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb327-13"><a href="stats_validation.html#cb327-13" tabindex="-1"></a>      <span class="st">&quot;filtering mode&quot;</span></span>
<span id="cb327-14"><a href="stats_validation.html#cb327-14" tabindex="-1"></a>      , <span class="st">&quot;F-score&lt;br&gt;median&quot;</span></span>
<span id="cb327-15"><a href="stats_validation.html#cb327-15" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb327-16"><a href="stats_validation.html#cb327-16" tabindex="-1"></a>    )</span>
<span id="cb327-17"><a href="stats_validation.html#cb327-17" tabindex="-1"></a>    , <span class="at">escape =</span> F</span>
<span id="cb327-18"><a href="stats_validation.html#cb327-18" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb327-19"><a href="stats_validation.html#cb327-19" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb327-20"><a href="stats_validation.html#cb327-20" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">pack_rows</span>(<span class="at">index =</span> <span class="fu">table</span>(forcats<span class="sc">::</span><span class="fu">fct_inorder</span>(table_temp<span class="sc">$</span>depth_maps_generation_quality))) <span class="sc">%&gt;%</span> </span>
<span id="cb327-21"><a href="stats_validation.html#cb327-21" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;8in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:8in; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-242">Table 6.17: </span>F-score<br>95% HDI of the posterior predictive distribution
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
filtering mode
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
F-score<br>median
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI low
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>ultra high</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
aggressive
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.82
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
moderate
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.83
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.84
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
0.85
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>high</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
aggressive
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.81
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
moderate
</td>
<td style="text-align:right;">
0.52
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
0.81
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.83
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.83
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>medium</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
aggressive
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.74
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
moderate
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.76
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.77
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>low</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
aggressive
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.69
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
moderate
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.70
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild
</td>
<td style="text-align:right;">
0.43
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.73
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled
</td>
<td style="text-align:right;">
0.42
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.73
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>lowest</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
aggressive
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.56
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
moderate
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.59
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.61
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.62
</td>
</tr>
</tbody>
</table>
</div>
<p>we can also make pairwise comparisons so long as we continue using <code>tidybayes::add_epred_draws</code> with the <code>re_formula</code> argument</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="stats_validation.html#cb328-1" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> qlty_filter_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb328-2"><a href="stats_validation.html#cb328-2" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb328-3"><a href="stats_validation.html#cb328-3" tabindex="-1"></a>      value</span>
<span id="cb328-4"><a href="stats_validation.html#cb328-4" tabindex="-1"></a>      , <span class="at">by =</span> depth_maps_generation_quality</span>
<span id="cb328-5"><a href="stats_validation.html#cb328-5" tabindex="-1"></a>      , <span class="at">comparison =</span> </span>
<span id="cb328-6"><a href="stats_validation.html#cb328-6" tabindex="-1"></a>        contrast_list</span>
<span id="cb328-7"><a href="stats_validation.html#cb328-7" tabindex="-1"></a>        <span class="co"># tidybayes::emmeans_comparison(&quot;revpairwise&quot;) </span></span>
<span id="cb328-8"><a href="stats_validation.html#cb328-8" tabindex="-1"></a>        <span class="co">#&quot;pairwise&quot;</span></span>
<span id="cb328-9"><a href="stats_validation.html#cb328-9" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb328-10"><a href="stats_validation.html#cb328-10" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> depth_maps_generation_quality)</span>
<span id="cb328-11"><a href="stats_validation.html#cb328-11" tabindex="-1"></a></span>
<span id="cb328-12"><a href="stats_validation.html#cb328-12" tabindex="-1"></a><span class="co"># separate contrast</span></span>
<span id="cb328-13"><a href="stats_validation.html#cb328-13" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb328-14"><a href="stats_validation.html#cb328-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb328-15"><a href="stats_validation.html#cb328-15" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(</span>
<span id="cb328-16"><a href="stats_validation.html#cb328-16" tabindex="-1"></a>    <span class="at">cols =</span> contrast</span>
<span id="cb328-17"><a href="stats_validation.html#cb328-17" tabindex="-1"></a>    , <span class="at">delim =</span> <span class="st">&quot; - &quot;</span></span>
<span id="cb328-18"><a href="stats_validation.html#cb328-18" tabindex="-1"></a>    , <span class="at">names =</span> <span class="fu">paste0</span>(</span>
<span id="cb328-19"><a href="stats_validation.html#cb328-19" tabindex="-1"></a>        <span class="st">&quot;sorter&quot;</span></span>
<span id="cb328-20"><a href="stats_validation.html#cb328-20" tabindex="-1"></a>        , <span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(stringr<span class="sc">::</span><span class="fu">str_count</span>(brms_contrast_temp<span class="sc">$</span>contrast, <span class="st">&quot;-&quot;</span>))<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb328-21"><a href="stats_validation.html#cb328-21" tabindex="-1"></a>      )</span>
<span id="cb328-22"><a href="stats_validation.html#cb328-22" tabindex="-1"></a>    , <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span></span>
<span id="cb328-23"><a href="stats_validation.html#cb328-23" tabindex="-1"></a>    , <span class="at">cols_remove =</span> F</span>
<span id="cb328-24"><a href="stats_validation.html#cb328-24" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb328-25"><a href="stats_validation.html#cb328-25" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sorter1<span class="sc">!=</span>sorter2) <span class="sc">%&gt;%</span> </span>
<span id="cb328-26"><a href="stats_validation.html#cb328-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb328-27"><a href="stats_validation.html#cb328-27" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb328-28"><a href="stats_validation.html#cb328-28" tabindex="-1"></a>      tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sorter&quot;</span>)</span>
<span id="cb328-29"><a href="stats_validation.html#cb328-29" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="cf">function</span>(x){<span class="fu">factor</span>(</span>
<span id="cb328-30"><a href="stats_validation.html#cb328-30" tabindex="-1"></a>        x, <span class="at">ordered =</span> T</span>
<span id="cb328-31"><a href="stats_validation.html#cb328-31" tabindex="-1"></a>        , <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_quality)</span>
<span id="cb328-32"><a href="stats_validation.html#cb328-32" tabindex="-1"></a>      )}</span>
<span id="cb328-33"><a href="stats_validation.html#cb328-33" tabindex="-1"></a>    )</span>
<span id="cb328-34"><a href="stats_validation.html#cb328-34" tabindex="-1"></a>    , <span class="at">contrast =</span> contrast <span class="sc">%&gt;%</span> </span>
<span id="cb328-35"><a href="stats_validation.html#cb328-35" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb328-36"><a href="stats_validation.html#cb328-36" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="fu">as.numeric</span>(sorter1), <span class="fu">as.numeric</span>(sorter2)) <span class="sc">%&gt;%</span> </span>
<span id="cb328-37"><a href="stats_validation.html#cb328-37" tabindex="-1"></a>        <span class="fu">as.numeric</span>()</span>
<span id="cb328-38"><a href="stats_validation.html#cb328-38" tabindex="-1"></a>      )</span>
<span id="cb328-39"><a href="stats_validation.html#cb328-39" tabindex="-1"></a>    , <span class="at">depth_maps_generation_filtering_mode =</span> depth_maps_generation_filtering_mode <span class="sc">%&gt;%</span> </span>
<span id="cb328-40"><a href="stats_validation.html#cb328-40" tabindex="-1"></a>      <span class="fu">factor</span>(</span>
<span id="cb328-41"><a href="stats_validation.html#cb328-41" tabindex="-1"></a>        <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_filtering_mode)</span>
<span id="cb328-42"><a href="stats_validation.html#cb328-42" tabindex="-1"></a>        , <span class="at">ordered =</span> T</span>
<span id="cb328-43"><a href="stats_validation.html#cb328-43" tabindex="-1"></a>      )</span>
<span id="cb328-44"><a href="stats_validation.html#cb328-44" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb328-45"><a href="stats_validation.html#cb328-45" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb328-46"><a href="stats_validation.html#cb328-46" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast,depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb328-47"><a href="stats_validation.html#cb328-47" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb328-48"><a href="stats_validation.html#cb328-48" tabindex="-1"></a></span>
<span id="cb328-49"><a href="stats_validation.html#cb328-49" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb328-50"><a href="stats_validation.html#cb328-50" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 1,600,000
## Columns: 17
## Groups: contrast, depth_maps_generation_filtering_mode [40]
## $ depth_maps_generation_filtering_mode &lt;ord&gt; aggressive, aggressive, aggressiv…
## $ .chain                               &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ .iteration                           &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ .draw                                &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11…
## $ sorter1                              &lt;ord&gt; ultra high, ultra high, ultra hig…
## $ sorter2                              &lt;ord&gt; high, high, high, high, high, hig…
## $ contrast                             &lt;fct&gt; ultra high - high, ultra high - h…
## $ value                                &lt;dbl&gt; 0.049303207, -0.029648846, -0.017…
## $ median_hdi_est                       &lt;dbl&gt; 0.02311279, 0.02311279, 0.0231127…
## $ median_hdi_lower                     &lt;dbl&gt; -0.1429223, -0.1429223, -0.142922…
## $ median_hdi_upper                     &lt;dbl&gt; 0.2134092, 0.2134092, 0.2134092, …
## $ is_gt_zero                           &lt;lgl&gt; TRUE, FALSE, FALSE, TRUE, TRUE, F…
## $ pct_gt_zero                          &lt;dbl&gt; 0.6232, 0.6232, 0.6232, 0.6232, 0…
## $ pct_gt_zero_lab                      &lt;chr&gt; &quot;Pr(ultra high&gt;high)=62%&quot;, &quot;Pr(ul…
## $ pct_gt_zero_lab_sm                   &lt;chr&gt; &quot;Pr(&gt;0)=62%&quot;, &quot;Pr(&gt;0)=62%&quot;, &quot;Pr(&gt;…
## $ pct_gt_zero_lab_pos                  &lt;dbl&gt; 0.2294149, 0.2294149, 0.2294149, …
## $ sig_level                            &lt;ord&gt; &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80…</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="stats_validation.html#cb330-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb330-2"><a href="stats_validation.html#cb330-2" tabindex="-1"></a>  brms_contrast_temp</span>
<span id="cb330-3"><a href="stats_validation.html#cb330-3" tabindex="-1"></a>  <span class="co"># , caption_text = form_temp</span></span>
<span id="cb330-4"><a href="stats_validation.html#cb330-4" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;quality&quot;</span></span>
<span id="cb330-5"><a href="stats_validation.html#cb330-5" tabindex="-1"></a>  , <span class="at">facet =</span> <span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span></span>
<span id="cb330-6"><a href="stats_validation.html#cb330-6" tabindex="-1"></a>  , <span class="at">label_size =</span> <span class="fl">2.0</span></span>
<span id="cb330-7"><a href="stats_validation.html#cb330-7" tabindex="-1"></a>  , <span class="at">x_expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>)</span>
<span id="cb330-8"><a href="stats_validation.html#cb330-8" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb330-9"><a href="stats_validation.html#cb330-9" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb330-10"><a href="stats_validation.html#cb330-10" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of group constrasts with 95% &amp; 50% HDI</span><span class="sc">\n</span><span class="st">by filtering mode&quot;</span></span>
<span id="cb330-11"><a href="stats_validation.html#cb330-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb330-12"><a href="stats_validation.html#cb330-12" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb330-13"><a href="stats_validation.html#cb330-13" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>)</span>
<span id="cb330-14"><a href="stats_validation.html#cb330-14" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-244-1.png" width="1008" /></p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="stats_validation.html#cb331-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb331-2"><a href="stats_validation.html#cb331-2" tabindex="-1"></a>  <span class="st">&quot;../data/qlty_fltr_comp_mod5.png&quot;</span></span>
<span id="cb331-3"><a href="stats_validation.html#cb331-3" tabindex="-1"></a>  , <span class="at">plot =</span> ggplot2<span class="sc">::</span><span class="fu">last_plot</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb331-4"><a href="stats_validation.html#cb331-4" tabindex="-1"></a>  , <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span></span>
<span id="cb331-5"><a href="stats_validation.html#cb331-5" tabindex="-1"></a>)</span></code></pre></div>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="stats_validation.html#cb332-1" tabindex="-1"></a>table_temp <span class="ot">=</span> </span>
<span id="cb332-2"><a href="stats_validation.html#cb332-2" tabindex="-1"></a>  brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb332-3"><a href="stats_validation.html#cb332-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb332-4"><a href="stats_validation.html#cb332-4" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb332-5"><a href="stats_validation.html#cb332-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb332-6"><a href="stats_validation.html#cb332-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, depth_maps_generation_filtering_mode, value, .lower, .upper) <span class="sc">%&gt;%</span> </span>
<span id="cb332-7"><a href="stats_validation.html#cb332-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast, depth_maps_generation_filtering_mode)</span>
<span id="cb332-8"><a href="stats_validation.html#cb332-8" tabindex="-1"></a></span>
<span id="cb332-9"><a href="stats_validation.html#cb332-9" tabindex="-1"></a>table_temp <span class="sc">%&gt;%</span> </span>
<span id="cb332-10"><a href="stats_validation.html#cb332-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(contrast)) <span class="sc">%&gt;%</span> </span>
<span id="cb332-11"><a href="stats_validation.html#cb332-11" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb332-12"><a href="stats_validation.html#cb332-12" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb332-13"><a href="stats_validation.html#cb332-13" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb332-14"><a href="stats_validation.html#cb332-14" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb332-15"><a href="stats_validation.html#cb332-15" tabindex="-1"></a>      <span class="st">&quot;filtering mode&quot;</span></span>
<span id="cb332-16"><a href="stats_validation.html#cb332-16" tabindex="-1"></a>      , <span class="st">&quot;median difference&lt;br&gt;F-score&quot;</span></span>
<span id="cb332-17"><a href="stats_validation.html#cb332-17" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb332-18"><a href="stats_validation.html#cb332-18" tabindex="-1"></a>    )</span>
<span id="cb332-19"><a href="stats_validation.html#cb332-19" tabindex="-1"></a>    , <span class="at">escape =</span> F</span>
<span id="cb332-20"><a href="stats_validation.html#cb332-20" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb332-21"><a href="stats_validation.html#cb332-21" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb332-22"><a href="stats_validation.html#cb332-22" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">pack_rows</span>(<span class="at">index =</span> <span class="fu">table</span>(forcats<span class="sc">::</span><span class="fu">fct_inorder</span>(table_temp<span class="sc">$</span>contrast))) <span class="sc">%&gt;%</span> </span>
<span id="cb332-23"><a href="stats_validation.html#cb332-23" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;8in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:8in; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-245">Table 6.18: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
filtering mode
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
median difference<br>F-score
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI low
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>ultra high - high</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
aggressive
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
0.21
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
moderate
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
0.21
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.15
</td>
<td style="text-align:right;">
0.20
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.15
</td>
<td style="text-align:right;">
0.20
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>ultra high - medium</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
aggressive
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.27
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
moderate
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.27
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.26
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.26
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>ultra high - low</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
aggressive
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.33
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
moderate
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.32
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.31
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.31
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>ultra high - lowest</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
aggressive
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.46
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
moderate
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.47
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.46
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.46
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>high - medium</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
aggressive
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.24
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
moderate
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.24
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.24
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>high - low</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
aggressive
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
moderate
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.28
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.28
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>high - lowest</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
aggressive
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.43
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
moderate
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.44
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.43
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.43
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>medium - low</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
aggressive
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
moderate
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
-0.13
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
-0.13
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>medium - lowest</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
aggressive
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.37
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
moderate
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.37
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.37
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.37
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>low - lowest</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
aggressive
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.31
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
moderate
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.32
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.32
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.32
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="softwarequality---interaction" class="section level4 hasAnchor" number="6.7.2.3">
<h4><span class="header-section-number">6.7.2.3</span> Software:Quality - interaction<a href="stats_validation.html#softwarequality---interaction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>It might be more important to understand the difference in F-score by dense cloud quality and software rather than filtering mode since filtering mode had such a small effect on the SfM predictive ability</p>
<p>Are there differences in F-score based on dense point cloud generation quality within each different processing software? We will also address the similar but slightly different question of “are there differences in F-score based on the processing software used at a given dense point cloud generation quality?”</p>
<p>Here, we collapse across the study site and filtering mode to compare the combined dense cloud quality and software effect.</p>
<p>In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="stats_validation.html#cb333-1" tabindex="-1"></a><span class="co"># get draws</span></span>
<span id="cb333-2"><a href="stats_validation.html#cb333-2" tabindex="-1"></a>qlty_sftwr_draws_temp <span class="ot">=</span> </span>
<span id="cb333-3"><a href="stats_validation.html#cb333-3" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">crossing</span>(</span>
<span id="cb333-4"><a href="stats_validation.html#cb333-4" tabindex="-1"></a>    <span class="at">depth_maps_generation_quality =</span> <span class="fu">unique</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_quality)</span>
<span id="cb333-5"><a href="stats_validation.html#cb333-5" tabindex="-1"></a>    , <span class="at">software =</span> <span class="fu">unique</span>(ptcld_validation_data<span class="sc">$</span>software)</span>
<span id="cb333-6"><a href="stats_validation.html#cb333-6" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb333-7"><a href="stats_validation.html#cb333-7" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb333-8"><a href="stats_validation.html#cb333-8" tabindex="-1"></a>    brms_f_mod5, <span class="at">allow_new_levels =</span> T</span>
<span id="cb333-9"><a href="stats_validation.html#cb333-9" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb333-10"><a href="stats_validation.html#cb333-10" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span></span>
<span id="cb333-11"><a href="stats_validation.html#cb333-11" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> software) <span class="sc">+</span> </span>
<span id="cb333-12"><a href="stats_validation.html#cb333-12" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>software)</span>
<span id="cb333-13"><a href="stats_validation.html#cb333-13" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb333-14"><a href="stats_validation.html#cb333-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb333-15"><a href="stats_validation.html#cb333-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb333-16"><a href="stats_validation.html#cb333-16" tabindex="-1"></a>    <span class="at">med =</span> tidybayes<span class="sc">::</span><span class="fu">median_hdci</span>(value)<span class="sc">$</span>y</span>
<span id="cb333-17"><a href="stats_validation.html#cb333-17" tabindex="-1"></a>  ) </span>
<span id="cb333-18"><a href="stats_validation.html#cb333-18" tabindex="-1"></a></span>
<span id="cb333-19"><a href="stats_validation.html#cb333-19" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb333-20"><a href="stats_validation.html#cb333-20" tabindex="-1"></a>qlty_sftwr_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb333-21"><a href="stats_validation.html#cb333-21" tabindex="-1"></a>  <span class="co"># remove out-of-sample obs</span></span>
<span id="cb333-22"><a href="stats_validation.html#cb333-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb333-23"><a href="stats_validation.html#cb333-23" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality, software)</span>
<span id="cb333-24"><a href="stats_validation.html#cb333-24" tabindex="-1"></a>    , <span class="at">by =</span> dplyr<span class="sc">::</span><span class="fu">join_by</span>(depth_maps_generation_quality, software)</span>
<span id="cb333-25"><a href="stats_validation.html#cb333-25" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb333-26"><a href="stats_validation.html#cb333-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb333-27"><a href="stats_validation.html#cb333-27" tabindex="-1"></a>    <span class="at">depth_maps_generation_quality =</span> depth_maps_generation_quality <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>()</span>
<span id="cb333-28"><a href="stats_validation.html#cb333-28" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb333-29"><a href="stats_validation.html#cb333-29" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb333-30"><a href="stats_validation.html#cb333-30" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb333-31"><a href="stats_validation.html#cb333-31" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb333-32"><a href="stats_validation.html#cb333-32" tabindex="-1"></a>      <span class="at">y =</span> value, <span class="at">x =</span> software</span>
<span id="cb333-33"><a href="stats_validation.html#cb333-33" tabindex="-1"></a>      <span class="co"># , fill = software</span></span>
<span id="cb333-34"><a href="stats_validation.html#cb333-34" tabindex="-1"></a>      , <span class="at">fill =</span> med</span>
<span id="cb333-35"><a href="stats_validation.html#cb333-35" tabindex="-1"></a>    )</span>
<span id="cb333-36"><a href="stats_validation.html#cb333-36" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb333-37"><a href="stats_validation.html#cb333-37" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_eye</span>(</span>
<span id="cb333-38"><a href="stats_validation.html#cb333-38" tabindex="-1"></a>    <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb333-39"><a href="stats_validation.html#cb333-39" tabindex="-1"></a>    , <span class="at">slab_alpha =</span> <span class="fl">0.95</span></span>
<span id="cb333-40"><a href="stats_validation.html#cb333-40" tabindex="-1"></a>    , <span class="at">interval_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb333-41"><a href="stats_validation.html#cb333-41" tabindex="-1"></a>    , <span class="at">point_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_size =</span> <span class="dv">1</span></span>
<span id="cb333-42"><a href="stats_validation.html#cb333-42" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb333-43"><a href="stats_validation.html#cb333-43" tabindex="-1"></a>  <span class="co"># scale_fill_viridis_d(option = &quot;rocket&quot;, begin = 0.3, end = 0.9, drop = F) +</span></span>
<span id="cb333-44"><a href="stats_validation.html#cb333-44" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;mako&quot;</span>, <span class="at">direction=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb333-45"><a href="stats_validation.html#cb333-45" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb333-46"><a href="stats_validation.html#cb333-46" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(depth_maps_generation_quality)) <span class="sc">+</span></span>
<span id="cb333-47"><a href="stats_validation.html#cb333-47" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb333-48"><a href="stats_validation.html#cb333-48" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;software&quot;</span>, <span class="at">y =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb333-49"><a href="stats_validation.html#cb333-49" tabindex="-1"></a>    , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI</span><span class="sc">\n</span><span class="st">by dense cloud quality&quot;</span></span>
<span id="cb333-50"><a href="stats_validation.html#cb333-50" tabindex="-1"></a>    <span class="co"># , caption = form_temp</span></span>
<span id="cb333-51"><a href="stats_validation.html#cb333-51" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb333-52"><a href="stats_validation.html#cb333-52" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb333-53"><a href="stats_validation.html#cb333-53" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb333-54"><a href="stats_validation.html#cb333-54" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb333-55"><a href="stats_validation.html#cb333-55" tabindex="-1"></a>    , <span class="at">legend.direction  =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb333-56"><a href="stats_validation.html#cb333-56" tabindex="-1"></a>    , <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb333-57"><a href="stats_validation.html#cb333-57" tabindex="-1"></a>    , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb333-58"><a href="stats_validation.html#cb333-58" tabindex="-1"></a>  ) </span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-246-1.png" width="1008" /></p>
<p>and a table of these 95% HDI values</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="stats_validation.html#cb334-1" tabindex="-1"></a>table_temp <span class="ot">=</span> </span>
<span id="cb334-2"><a href="stats_validation.html#cb334-2" tabindex="-1"></a>  qlty_sftwr_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb334-3"><a href="stats_validation.html#cb334-3" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb334-4"><a href="stats_validation.html#cb334-4" tabindex="-1"></a>    <span class="co"># remove out-of-sample obs</span></span>
<span id="cb334-5"><a href="stats_validation.html#cb334-5" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb334-6"><a href="stats_validation.html#cb334-6" tabindex="-1"></a>      ptcld_validation_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality, software)</span>
<span id="cb334-7"><a href="stats_validation.html#cb334-7" tabindex="-1"></a>      , <span class="at">by =</span> dplyr<span class="sc">::</span><span class="fu">join_by</span>(depth_maps_generation_quality, software)</span>
<span id="cb334-8"><a href="stats_validation.html#cb334-8" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb334-9"><a href="stats_validation.html#cb334-9" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(.point,.interval, .width,.row)) <span class="sc">%&gt;%</span> </span>
<span id="cb334-10"><a href="stats_validation.html#cb334-10" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(software,depth_maps_generation_quality)</span>
<span id="cb334-11"><a href="stats_validation.html#cb334-11" tabindex="-1"></a>  </span>
<span id="cb334-12"><a href="stats_validation.html#cb334-12" tabindex="-1"></a>table_temp <span class="sc">%&gt;%</span> </span>
<span id="cb334-13"><a href="stats_validation.html#cb334-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(software)) <span class="sc">%&gt;%</span> </span>
<span id="cb334-14"><a href="stats_validation.html#cb334-14" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb334-15"><a href="stats_validation.html#cb334-15" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb334-16"><a href="stats_validation.html#cb334-16" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;F-score&lt;br&gt;95% HDI of the posterior predictive distribution&quot;</span></span>
<span id="cb334-17"><a href="stats_validation.html#cb334-17" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb334-18"><a href="stats_validation.html#cb334-18" tabindex="-1"></a>      <span class="st">&quot;quality&quot;</span></span>
<span id="cb334-19"><a href="stats_validation.html#cb334-19" tabindex="-1"></a>      , <span class="st">&quot;F-score&lt;br&gt;median&quot;</span></span>
<span id="cb334-20"><a href="stats_validation.html#cb334-20" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb334-21"><a href="stats_validation.html#cb334-21" tabindex="-1"></a>    )</span>
<span id="cb334-22"><a href="stats_validation.html#cb334-22" tabindex="-1"></a>    , <span class="at">escape =</span> F</span>
<span id="cb334-23"><a href="stats_validation.html#cb334-23" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb334-24"><a href="stats_validation.html#cb334-24" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb334-25"><a href="stats_validation.html#cb334-25" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">pack_rows</span>(<span class="at">index =</span> <span class="fu">table</span>(forcats<span class="sc">::</span><span class="fu">fct_inorder</span>(table_temp<span class="sc">$</span>software))) <span class="sc">%&gt;%</span> </span>
<span id="cb334-26"><a href="stats_validation.html#cb334-26" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;8in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:8in; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-247">Table 6.19: </span>F-score<br>95% HDI of the posterior predictive distribution
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
quality
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
F-score<br>median
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI low
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr grouplength="5">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>METASHAPE</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
ultra high
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
0.83
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
high
</td>
<td style="text-align:right;">
0.59
</td>
<td style="text-align:right;">
0.35
</td>
<td style="text-align:right;">
0.82
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
medium
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
0.28
</td>
<td style="text-align:right;">
0.77
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
low
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.64
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
lowest
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
<tr grouplength="5">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>OPENDRONEMAP</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
ultra high
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.81
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
high
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
0.75
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
medium
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.57
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
low
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.57
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
lowest
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.55
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>PIX4D</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
ultra high
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
high
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
medium
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
0.28
</td>
<td style="text-align:right;">
0.77
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
low
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
0.72
</td>
</tr>
</tbody>
</table>
</div>
<p>we can also make pairwise comparisons so long as we continue using <code>tidybayes::add_epred_draws</code> with the <code>re_formula</code> argument</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="stats_validation.html#cb335-1" tabindex="-1"></a><span class="co"># calculate contrast</span></span>
<span id="cb335-2"><a href="stats_validation.html#cb335-2" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> qlty_sftwr_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb335-3"><a href="stats_validation.html#cb335-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb335-4"><a href="stats_validation.html#cb335-4" tabindex="-1"></a>    value</span>
<span id="cb335-5"><a href="stats_validation.html#cb335-5" tabindex="-1"></a>    , <span class="at">by =</span> depth_maps_generation_quality</span>
<span id="cb335-6"><a href="stats_validation.html#cb335-6" tabindex="-1"></a>    , <span class="at">comparison =</span> contrast_list</span>
<span id="cb335-7"><a href="stats_validation.html#cb335-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb335-8"><a href="stats_validation.html#cb335-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> depth_maps_generation_quality)</span>
<span id="cb335-9"><a href="stats_validation.html#cb335-9" tabindex="-1"></a></span>
<span id="cb335-10"><a href="stats_validation.html#cb335-10" tabindex="-1"></a><span class="co"># separate contrast</span></span>
<span id="cb335-11"><a href="stats_validation.html#cb335-11" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb335-12"><a href="stats_validation.html#cb335-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb335-13"><a href="stats_validation.html#cb335-13" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(</span>
<span id="cb335-14"><a href="stats_validation.html#cb335-14" tabindex="-1"></a>    <span class="at">cols =</span> contrast</span>
<span id="cb335-15"><a href="stats_validation.html#cb335-15" tabindex="-1"></a>    , <span class="at">delim =</span> <span class="st">&quot; - &quot;</span></span>
<span id="cb335-16"><a href="stats_validation.html#cb335-16" tabindex="-1"></a>    , <span class="at">names =</span> <span class="fu">paste0</span>(</span>
<span id="cb335-17"><a href="stats_validation.html#cb335-17" tabindex="-1"></a>      <span class="st">&quot;sorter&quot;</span></span>
<span id="cb335-18"><a href="stats_validation.html#cb335-18" tabindex="-1"></a>      , <span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(stringr<span class="sc">::</span><span class="fu">str_count</span>(brms_contrast_temp<span class="sc">$</span>contrast, <span class="st">&quot;-&quot;</span>))<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb335-19"><a href="stats_validation.html#cb335-19" tabindex="-1"></a>    )</span>
<span id="cb335-20"><a href="stats_validation.html#cb335-20" tabindex="-1"></a>    , <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span></span>
<span id="cb335-21"><a href="stats_validation.html#cb335-21" tabindex="-1"></a>    , <span class="at">cols_remove =</span> F</span>
<span id="cb335-22"><a href="stats_validation.html#cb335-22" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb335-23"><a href="stats_validation.html#cb335-23" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sorter1<span class="sc">!=</span>sorter2) <span class="sc">%&gt;%</span> </span>
<span id="cb335-24"><a href="stats_validation.html#cb335-24" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb335-25"><a href="stats_validation.html#cb335-25" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb335-26"><a href="stats_validation.html#cb335-26" tabindex="-1"></a>      tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sorter&quot;</span>)</span>
<span id="cb335-27"><a href="stats_validation.html#cb335-27" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="cf">function</span>(x){<span class="fu">factor</span>(</span>
<span id="cb335-28"><a href="stats_validation.html#cb335-28" tabindex="-1"></a>        x, <span class="at">ordered =</span> T</span>
<span id="cb335-29"><a href="stats_validation.html#cb335-29" tabindex="-1"></a>        , <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_quality)</span>
<span id="cb335-30"><a href="stats_validation.html#cb335-30" tabindex="-1"></a>      )}</span>
<span id="cb335-31"><a href="stats_validation.html#cb335-31" tabindex="-1"></a>    )</span>
<span id="cb335-32"><a href="stats_validation.html#cb335-32" tabindex="-1"></a>    , <span class="at">contrast =</span> contrast <span class="sc">%&gt;%</span> </span>
<span id="cb335-33"><a href="stats_validation.html#cb335-33" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb335-34"><a href="stats_validation.html#cb335-34" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="fu">as.numeric</span>(sorter1), <span class="fu">as.numeric</span>(sorter2)) <span class="sc">%&gt;%</span> </span>
<span id="cb335-35"><a href="stats_validation.html#cb335-35" tabindex="-1"></a>          <span class="fu">as.numeric</span>()</span>
<span id="cb335-36"><a href="stats_validation.html#cb335-36" tabindex="-1"></a>      )</span>
<span id="cb335-37"><a href="stats_validation.html#cb335-37" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb335-38"><a href="stats_validation.html#cb335-38" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb335-39"><a href="stats_validation.html#cb335-39" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, software) <span class="sc">%&gt;%</span> </span>
<span id="cb335-40"><a href="stats_validation.html#cb335-40" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb335-41"><a href="stats_validation.html#cb335-41" tabindex="-1"></a></span>
<span id="cb335-42"><a href="stats_validation.html#cb335-42" tabindex="-1"></a><span class="co"># remove out-of-sample obs</span></span>
<span id="cb335-43"><a href="stats_validation.html#cb335-43" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb335-44"><a href="stats_validation.html#cb335-44" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb335-45"><a href="stats_validation.html#cb335-45" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(software, depth_maps_generation_quality)</span>
<span id="cb335-46"><a href="stats_validation.html#cb335-46" tabindex="-1"></a>    , <span class="at">by =</span> dplyr<span class="sc">::</span><span class="fu">join_by</span>(software, sorter1 <span class="sc">==</span> depth_maps_generation_quality)</span>
<span id="cb335-47"><a href="stats_validation.html#cb335-47" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb335-48"><a href="stats_validation.html#cb335-48" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb335-49"><a href="stats_validation.html#cb335-49" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(software, depth_maps_generation_quality)</span>
<span id="cb335-50"><a href="stats_validation.html#cb335-50" tabindex="-1"></a>    , <span class="at">by =</span> dplyr<span class="sc">::</span><span class="fu">join_by</span>(software, sorter2 <span class="sc">==</span> depth_maps_generation_quality)</span>
<span id="cb335-51"><a href="stats_validation.html#cb335-51" tabindex="-1"></a>  )</span>
<span id="cb335-52"><a href="stats_validation.html#cb335-52" tabindex="-1"></a>  </span>
<span id="cb335-53"><a href="stats_validation.html#cb335-53" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb335-54"><a href="stats_validation.html#cb335-54" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 1,040,000
## Columns: 17
## Groups: contrast, software [26]
## $ software            &lt;chr&gt; &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;METASHAPE&quot;…
## $ .chain              &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .iteration          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .draw               &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,…
## $ sorter1             &lt;ord&gt; ultra high, ultra high, ultra high, ultra high, ul…
## $ sorter2             &lt;ord&gt; high, high, high, high, high, high, high, high, hi…
## $ contrast            &lt;fct&gt; ultra high - high, ultra high - high, ultra high -…
## $ value               &lt;dbl&gt; 0.026323093, -0.095230614, -0.051189096, 0.0088212…
## $ median_hdi_est      &lt;dbl&gt; 0.01614509, 0.01614509, 0.01614509, 0.01614509, 0.…
## $ median_hdi_lower    &lt;dbl&gt; -0.08239217, -0.08239217, -0.08239217, -0.08239217…
## $ median_hdi_upper    &lt;dbl&gt; 0.112807, 0.112807, 0.112807, 0.112807, 0.112807, …
## $ is_gt_zero          &lt;lgl&gt; TRUE, FALSE, FALSE, TRUE, TRUE, FALSE, FALSE, TRUE…
## $ pct_gt_zero         &lt;dbl&gt; 0.632275, 0.632275, 0.632275, 0.632275, 0.632275, …
## $ pct_gt_zero_lab     &lt;chr&gt; &quot;Pr(ultra high&gt;high)=63%&quot;, &quot;Pr(ultra high&gt;high)=63…
## $ pct_gt_zero_lab_sm  &lt;chr&gt; &quot;Pr(&gt;0)=63%&quot;, &quot;Pr(&gt;0)=63%&quot;, &quot;Pr(&gt;0)=63%&quot;, &quot;Pr(&gt;0)=…
## $ pct_gt_zero_lab_pos &lt;dbl&gt; 0.1212675, 0.1212675, 0.1212675, 0.1212675, 0.1212…
## $ sig_level           &lt;ord&gt; &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;8…</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="stats_validation.html#cb337-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb337-2"><a href="stats_validation.html#cb337-2" tabindex="-1"></a>  brms_contrast_temp</span>
<span id="cb337-3"><a href="stats_validation.html#cb337-3" tabindex="-1"></a>  <span class="co"># , caption_text = form_temp</span></span>
<span id="cb337-4"><a href="stats_validation.html#cb337-4" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;quality&quot;</span></span>
<span id="cb337-5"><a href="stats_validation.html#cb337-5" tabindex="-1"></a>  , <span class="at">facet =</span> <span class="st">&quot;software&quot;</span></span>
<span id="cb337-6"><a href="stats_validation.html#cb337-6" tabindex="-1"></a>  , <span class="at">label_size =</span> <span class="fl">2.0</span></span>
<span id="cb337-7"><a href="stats_validation.html#cb337-7" tabindex="-1"></a>  , <span class="at">x_expand =</span> <span class="fu">c</span>(<span class="fl">0.56</span>,<span class="fl">0.9</span>) <span class="co"># c(0,0.7)</span></span>
<span id="cb337-8"><a href="stats_validation.html#cb337-8" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb337-9"><a href="stats_validation.html#cb337-9" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb337-10"><a href="stats_validation.html#cb337-10" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of group constrasts with 95% &amp; 50% HDI</span><span class="sc">\n</span><span class="st">by software&quot;</span></span>
<span id="cb337-11"><a href="stats_validation.html#cb337-11" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-249-1.png" width="1008" /></p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="stats_validation.html#cb338-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb338-2"><a href="stats_validation.html#cb338-2" tabindex="-1"></a>  <span class="st">&quot;../data/qlty_sftwr_comp_mod5.png&quot;</span></span>
<span id="cb338-3"><a href="stats_validation.html#cb338-3" tabindex="-1"></a>  , <span class="at">plot =</span> ggplot2<span class="sc">::</span><span class="fu">last_plot</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb338-4"><a href="stats_validation.html#cb338-4" tabindex="-1"></a>  , <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span></span>
<span id="cb338-5"><a href="stats_validation.html#cb338-5" tabindex="-1"></a>)</span></code></pre></div>
<p>create plot for combining with other contrasts for publication</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="stats_validation.html#cb339-1" tabindex="-1"></a>ptchwrk_qlty_sftwr_comp <span class="ot">=</span></span>
<span id="cb339-2"><a href="stats_validation.html#cb339-2" tabindex="-1"></a>  <span class="fu">plt_contrast</span>(</span>
<span id="cb339-3"><a href="stats_validation.html#cb339-3" tabindex="-1"></a>    brms_contrast_temp</span>
<span id="cb339-4"><a href="stats_validation.html#cb339-4" tabindex="-1"></a>    , <span class="at">y_axis_title =</span> <span class="st">&quot;quality contrast&quot;</span></span>
<span id="cb339-5"><a href="stats_validation.html#cb339-5" tabindex="-1"></a>    , <span class="at">facet =</span> <span class="st">&quot;software&quot;</span></span>
<span id="cb339-6"><a href="stats_validation.html#cb339-6" tabindex="-1"></a>    , <span class="at">label_size =</span> <span class="fl">1.35</span></span>
<span id="cb339-7"><a href="stats_validation.html#cb339-7" tabindex="-1"></a>    , <span class="at">label =</span> <span class="st">&quot;pct_gt_zero_lab_sm&quot;</span></span>
<span id="cb339-8"><a href="stats_validation.html#cb339-8" tabindex="-1"></a>    , <span class="at">annotate_size =</span> <span class="fl">1.75</span></span>
<span id="cb339-9"><a href="stats_validation.html#cb339-9" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb339-10"><a href="stats_validation.html#cb339-10" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb339-11"><a href="stats_validation.html#cb339-11" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb339-12"><a href="stats_validation.html#cb339-12" tabindex="-1"></a>      , <span class="at">x =</span> <span class="st">&quot;F-score contrast&quot;</span></span>
<span id="cb339-13"><a href="stats_validation.html#cb339-13" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb339-14"><a href="stats_validation.html#cb339-14" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb339-15"><a href="stats_validation.html#cb339-15" tabindex="-1"></a>      <span class="at">legend.position=</span><span class="st">&quot;none&quot;</span></span>
<span id="cb339-16"><a href="stats_validation.html#cb339-16" tabindex="-1"></a>      , <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb339-17"><a href="stats_validation.html#cb339-17" tabindex="-1"></a>      , <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb339-18"><a href="stats_validation.html#cb339-18" tabindex="-1"></a>    ) </span>
<span id="cb339-19"><a href="stats_validation.html#cb339-19" tabindex="-1"></a><span class="co"># ptchwrk_qlty_sftwr_comp</span></span></code></pre></div>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="stats_validation.html#cb340-1" tabindex="-1"></a>table_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb340-2"><a href="stats_validation.html#cb340-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, software) <span class="sc">%&gt;%</span> </span>
<span id="cb340-3"><a href="stats_validation.html#cb340-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb340-4"><a href="stats_validation.html#cb340-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast, software) <span class="sc">%&gt;%</span> </span>
<span id="cb340-5"><a href="stats_validation.html#cb340-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, software, value, .lower, .upper) <span class="sc">%&gt;%</span> </span>
<span id="cb340-6"><a href="stats_validation.html#cb340-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(software, contrast)</span>
<span id="cb340-7"><a href="stats_validation.html#cb340-7" tabindex="-1"></a></span>
<span id="cb340-8"><a href="stats_validation.html#cb340-8" tabindex="-1"></a>table_temp <span class="sc">%&gt;%</span> </span>
<span id="cb340-9"><a href="stats_validation.html#cb340-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(software)) <span class="sc">%&gt;%</span> </span>
<span id="cb340-10"><a href="stats_validation.html#cb340-10" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb340-11"><a href="stats_validation.html#cb340-11" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb340-12"><a href="stats_validation.html#cb340-12" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb340-13"><a href="stats_validation.html#cb340-13" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb340-14"><a href="stats_validation.html#cb340-14" tabindex="-1"></a>      <span class="st">&quot;quality contrast&quot;</span></span>
<span id="cb340-15"><a href="stats_validation.html#cb340-15" tabindex="-1"></a>      , <span class="st">&quot;median difference&lt;br&gt;F-score&quot;</span></span>
<span id="cb340-16"><a href="stats_validation.html#cb340-16" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb340-17"><a href="stats_validation.html#cb340-17" tabindex="-1"></a>    )</span>
<span id="cb340-18"><a href="stats_validation.html#cb340-18" tabindex="-1"></a>    , <span class="at">escape =</span> F</span>
<span id="cb340-19"><a href="stats_validation.html#cb340-19" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb340-20"><a href="stats_validation.html#cb340-20" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb340-21"><a href="stats_validation.html#cb340-21" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">pack_rows</span>(<span class="at">index =</span> <span class="fu">table</span>(forcats<span class="sc">::</span><span class="fu">fct_inorder</span>(table_temp<span class="sc">$</span>software))) <span class="sc">%&gt;%</span> </span>
<span id="cb340-22"><a href="stats_validation.html#cb340-22" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;8in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:8in; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-252">Table 6.20: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
quality contrast
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
median difference<br>F-score
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI low
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr grouplength="10">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>METASHAPE</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
ultra high - high
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
ultra high - medium
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
ultra high - low
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
ultra high - lowest
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.57
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
high - medium
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.16
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
high - low
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.28
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
high - lowest
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.56
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
medium - low
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
medium - lowest
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.51
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
low - lowest
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.38
</td>
</tr>
<tr grouplength="10">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>OPENDRONEMAP</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
ultra high - high
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.18
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
ultra high - medium
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.34
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
ultra high - low
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.34
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
ultra high - lowest
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.36
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
high - medium
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.26
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
high - low
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.26
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
high - lowest
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.28
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
medium - low
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.09
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
medium - lowest
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
low - lowest
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr grouplength="6">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>PIX4D</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
ultra high - high
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
ultra high - medium
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
ultra high - low
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
high - medium
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
high - low
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.18
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
medium - low
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.18
</td>
</tr>
</tbody>
</table>
</div>
<p>The contrasts above address the question “are there differences in F-score based on dense point cloud generation quality within each software?”.</p>
<p>To address the different question of “are there differences in F-score based on the processing software used at a given dense point cloud generation quality?” we need to utilize a different formulation of the <code>comparison</code> parameter within our call to the <code>tidybayes::compare_levels</code> function and calculate the contrast by <code>software</code> instead</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="stats_validation.html#cb341-1" tabindex="-1"></a><span class="co"># calculate contrast</span></span>
<span id="cb341-2"><a href="stats_validation.html#cb341-2" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> qlty_sftwr_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb341-3"><a href="stats_validation.html#cb341-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb341-4"><a href="stats_validation.html#cb341-4" tabindex="-1"></a>    value</span>
<span id="cb341-5"><a href="stats_validation.html#cb341-5" tabindex="-1"></a>    , <span class="at">by =</span> software</span>
<span id="cb341-6"><a href="stats_validation.html#cb341-6" tabindex="-1"></a>    , <span class="at">comparison =</span> <span class="st">&quot;pairwise&quot;</span></span>
<span id="cb341-7"><a href="stats_validation.html#cb341-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb341-8"><a href="stats_validation.html#cb341-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> software) <span class="sc">%&gt;%</span> </span>
<span id="cb341-9"><a href="stats_validation.html#cb341-9" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb341-10"><a href="stats_validation.html#cb341-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb341-11"><a href="stats_validation.html#cb341-11" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb341-12"><a href="stats_validation.html#cb341-12" tabindex="-1"></a></span>
<span id="cb341-13"><a href="stats_validation.html#cb341-13" tabindex="-1"></a><span class="co"># remove out-of-sample obs</span></span>
<span id="cb341-14"><a href="stats_validation.html#cb341-14" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb341-15"><a href="stats_validation.html#cb341-15" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(</span>
<span id="cb341-16"><a href="stats_validation.html#cb341-16" tabindex="-1"></a>    <span class="at">cols =</span> contrast</span>
<span id="cb341-17"><a href="stats_validation.html#cb341-17" tabindex="-1"></a>    , <span class="at">delim =</span> <span class="st">&quot; - &quot;</span></span>
<span id="cb341-18"><a href="stats_validation.html#cb341-18" tabindex="-1"></a>    , <span class="at">names =</span> <span class="fu">paste0</span>(</span>
<span id="cb341-19"><a href="stats_validation.html#cb341-19" tabindex="-1"></a>      <span class="st">&quot;sorter&quot;</span></span>
<span id="cb341-20"><a href="stats_validation.html#cb341-20" tabindex="-1"></a>      , <span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(stringr<span class="sc">::</span><span class="fu">str_count</span>(brms_contrast_temp<span class="sc">$</span>contrast, <span class="st">&quot;-&quot;</span>))<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb341-21"><a href="stats_validation.html#cb341-21" tabindex="-1"></a>    )</span>
<span id="cb341-22"><a href="stats_validation.html#cb341-22" tabindex="-1"></a>    , <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span></span>
<span id="cb341-23"><a href="stats_validation.html#cb341-23" tabindex="-1"></a>    , <span class="at">cols_remove =</span> F</span>
<span id="cb341-24"><a href="stats_validation.html#cb341-24" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb341-25"><a href="stats_validation.html#cb341-25" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sorter1<span class="sc">!=</span>sorter2) <span class="sc">%&gt;%</span> </span>
<span id="cb341-26"><a href="stats_validation.html#cb341-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb341-27"><a href="stats_validation.html#cb341-27" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(software, depth_maps_generation_quality)</span>
<span id="cb341-28"><a href="stats_validation.html#cb341-28" tabindex="-1"></a>    , <span class="at">by =</span> dplyr<span class="sc">::</span><span class="fu">join_by</span>(sorter1 <span class="sc">==</span> software, depth_maps_generation_quality)</span>
<span id="cb341-29"><a href="stats_validation.html#cb341-29" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb341-30"><a href="stats_validation.html#cb341-30" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb341-31"><a href="stats_validation.html#cb341-31" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(software, depth_maps_generation_quality)</span>
<span id="cb341-32"><a href="stats_validation.html#cb341-32" tabindex="-1"></a>    , <span class="at">by =</span> dplyr<span class="sc">::</span><span class="fu">join_by</span>(sorter2 <span class="sc">==</span> software, depth_maps_generation_quality)</span>
<span id="cb341-33"><a href="stats_validation.html#cb341-33" tabindex="-1"></a>  )</span>
<span id="cb341-34"><a href="stats_validation.html#cb341-34" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb341-35"><a href="stats_validation.html#cb341-35" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 520,000
## Columns: 17
## Groups: contrast, depth_maps_generation_quality [13]
## $ depth_maps_generation_quality &lt;ord&gt; ultra high, ultra high, ultra high, ultr…
## $ .chain                        &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ .iteration                    &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ .draw                         &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1…
## $ sorter1                       &lt;chr&gt; &quot;OPENDRONEMAP&quot;, &quot;OPENDRONEMAP&quot;, &quot;OPENDRO…
## $ sorter2                       &lt;chr&gt; &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;…
## $ contrast                      &lt;chr&gt; &quot;OPENDRONEMAP - METASHAPE&quot;, &quot;OPENDRONEMA…
## $ value                         &lt;dbl&gt; 0.030404447, 0.056927680, 0.086077930, 0…
## $ median_hdi_est                &lt;dbl&gt; -0.02373952, -0.02373952, -0.02373952, -…
## $ median_hdi_lower              &lt;dbl&gt; -0.1471563, -0.1471563, -0.1471563, -0.1…
## $ median_hdi_upper              &lt;dbl&gt; 0.09663396, 0.09663396, 0.09663396, 0.09…
## $ is_gt_zero                    &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, TRUE, FALSE,…
## $ pct_gt_zero                   &lt;dbl&gt; 0.658475, 0.658475, 0.658475, 0.658475, …
## $ pct_gt_zero_lab               &lt;chr&gt; &quot;Pr(MtaShp&gt;ODM)=66%&quot;, &quot;Pr(MtaShp&gt;ODM)=66…
## $ pct_gt_zero_lab_sm            &lt;chr&gt; &quot;Pr(&lt;0)=66%&quot;, &quot;Pr(&lt;0)=66%&quot;, &quot;Pr(&lt;0)=66%&quot;…
## $ pct_gt_zero_lab_pos           &lt;dbl&gt; -0.158193, -0.158193, -0.158193, -0.1581…
## $ sig_level                     &lt;ord&gt; &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%…</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="stats_validation.html#cb343-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb343-2"><a href="stats_validation.html#cb343-2" tabindex="-1"></a>  brms_contrast_temp</span>
<span id="cb343-3"><a href="stats_validation.html#cb343-3" tabindex="-1"></a>  <span class="co"># , caption_text = form_temp</span></span>
<span id="cb343-4"><a href="stats_validation.html#cb343-4" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;software&quot;</span></span>
<span id="cb343-5"><a href="stats_validation.html#cb343-5" tabindex="-1"></a>  , <span class="at">facet =</span> <span class="st">&quot;depth_maps_generation_quality&quot;</span></span>
<span id="cb343-6"><a href="stats_validation.html#cb343-6" tabindex="-1"></a>  , <span class="at">label_size =</span> <span class="fl">2.0</span></span>
<span id="cb343-7"><a href="stats_validation.html#cb343-7" tabindex="-1"></a>  , <span class="at">x_expand =</span> <span class="fu">c</span>(<span class="fl">0.17</span>,<span class="fl">0.14</span>)</span>
<span id="cb343-8"><a href="stats_validation.html#cb343-8" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb343-9"><a href="stats_validation.html#cb343-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(depth_maps_generation_quality), <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb343-10"><a href="stats_validation.html#cb343-10" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb343-11"><a href="stats_validation.html#cb343-11" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of group constrasts with 95% &amp; 50% HDI</span><span class="sc">\n</span><span class="st">by dense cloud quality&quot;</span></span>
<span id="cb343-12"><a href="stats_validation.html#cb343-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb343-13"><a href="stats_validation.html#cb343-13" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb343-14"><a href="stats_validation.html#cb343-14" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">75</span>, .<span class="dv">13</span>)</span>
<span id="cb343-15"><a href="stats_validation.html#cb343-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb343-16"><a href="stats_validation.html#cb343-16" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb343-17"><a href="stats_validation.html#cb343-17" tabindex="-1"></a>    <span class="at">legend.key.width  =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;lines&quot;</span>),</span>
<span id="cb343-18"><a href="stats_validation.html#cb343-18" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">7</span>, <span class="st">&quot;lines&quot;</span>)</span>
<span id="cb343-19"><a href="stats_validation.html#cb343-19" tabindex="-1"></a>  )))</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-254-1.png" width="1008" /></p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="stats_validation.html#cb344-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb344-2"><a href="stats_validation.html#cb344-2" tabindex="-1"></a>  <span class="st">&quot;../data/sftwr_qlty_comp_mod5.png&quot;</span></span>
<span id="cb344-3"><a href="stats_validation.html#cb344-3" tabindex="-1"></a>  , <span class="at">plot =</span> ggplot2<span class="sc">::</span><span class="fu">last_plot</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb344-4"><a href="stats_validation.html#cb344-4" tabindex="-1"></a>  , <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span></span>
<span id="cb344-5"><a href="stats_validation.html#cb344-5" tabindex="-1"></a>)</span></code></pre></div>
<p>create plot for combining with other contrasts for publication</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="stats_validation.html#cb345-1" tabindex="-1"></a>ptchwrk_sftwr_qlty_comp <span class="ot">=</span></span>
<span id="cb345-2"><a href="stats_validation.html#cb345-2" tabindex="-1"></a>  <span class="fu">plt_contrast</span>(</span>
<span id="cb345-3"><a href="stats_validation.html#cb345-3" tabindex="-1"></a>    brms_contrast_temp</span>
<span id="cb345-4"><a href="stats_validation.html#cb345-4" tabindex="-1"></a>    , <span class="at">y_axis_title =</span> <span class="st">&quot;software contrast&quot;</span></span>
<span id="cb345-5"><a href="stats_validation.html#cb345-5" tabindex="-1"></a>    , <span class="at">facet =</span> <span class="st">&quot;depth_maps_generation_quality&quot;</span></span>
<span id="cb345-6"><a href="stats_validation.html#cb345-6" tabindex="-1"></a>    , <span class="at">label_size =</span> <span class="fl">1.7</span></span>
<span id="cb345-7"><a href="stats_validation.html#cb345-7" tabindex="-1"></a>    , <span class="at">label =</span> <span class="st">&quot;pct_gt_zero_lab_sm&quot;</span></span>
<span id="cb345-8"><a href="stats_validation.html#cb345-8" tabindex="-1"></a>    , <span class="at">annotate_size =</span> <span class="fl">1.8</span></span>
<span id="cb345-9"><a href="stats_validation.html#cb345-9" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb345-10"><a href="stats_validation.html#cb345-10" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(depth_maps_generation_quality), <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb345-11"><a href="stats_validation.html#cb345-11" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb345-12"><a href="stats_validation.html#cb345-12" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb345-13"><a href="stats_validation.html#cb345-13" tabindex="-1"></a>      , <span class="at">x =</span> <span class="st">&quot;F-score constrast&quot;</span></span>
<span id="cb345-14"><a href="stats_validation.html#cb345-14" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb345-15"><a href="stats_validation.html#cb345-15" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb345-16"><a href="stats_validation.html#cb345-16" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">&quot;inside&quot;</span></span>
<span id="cb345-17"><a href="stats_validation.html#cb345-17" tabindex="-1"></a>      , <span class="at">legend.position.inside =</span> <span class="fu">c</span>(.<span class="dv">8</span>, .<span class="dv">11</span>)</span>
<span id="cb345-18"><a href="stats_validation.html#cb345-18" tabindex="-1"></a>      , <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb345-19"><a href="stats_validation.html#cb345-19" tabindex="-1"></a>      , <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb345-20"><a href="stats_validation.html#cb345-20" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb345-21"><a href="stats_validation.html#cb345-21" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb345-22"><a href="stats_validation.html#cb345-22" tabindex="-1"></a>      <span class="at">legend.key.width  =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;lines&quot;</span>),</span>
<span id="cb345-23"><a href="stats_validation.html#cb345-23" tabindex="-1"></a>      <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">7</span>, <span class="st">&quot;lines&quot;</span>)</span>
<span id="cb345-24"><a href="stats_validation.html#cb345-24" tabindex="-1"></a>    )))</span>
<span id="cb345-25"><a href="stats_validation.html#cb345-25" tabindex="-1"></a><span class="co"># ptchwrk_sftwr_qlty_comp</span></span></code></pre></div>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="stats_validation.html#cb346-1" tabindex="-1"></a>table_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb346-2"><a href="stats_validation.html#cb346-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb346-3"><a href="stats_validation.html#cb346-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb346-4"><a href="stats_validation.html#cb346-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast, depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb346-5"><a href="stats_validation.html#cb346-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, depth_maps_generation_quality, value, .lower, .upper)</span>
<span id="cb346-6"><a href="stats_validation.html#cb346-6" tabindex="-1"></a>   </span>
<span id="cb346-7"><a href="stats_validation.html#cb346-7" tabindex="-1"></a>table_temp <span class="sc">%&gt;%</span> </span>
<span id="cb346-8"><a href="stats_validation.html#cb346-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(contrast)) <span class="sc">%&gt;%</span> </span>
<span id="cb346-9"><a href="stats_validation.html#cb346-9" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb346-10"><a href="stats_validation.html#cb346-10" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb346-11"><a href="stats_validation.html#cb346-11" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb346-12"><a href="stats_validation.html#cb346-12" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb346-13"><a href="stats_validation.html#cb346-13" tabindex="-1"></a>      <span class="st">&quot;quality&quot;</span></span>
<span id="cb346-14"><a href="stats_validation.html#cb346-14" tabindex="-1"></a>      , <span class="st">&quot;median difference&lt;br&gt;F-score&quot;</span></span>
<span id="cb346-15"><a href="stats_validation.html#cb346-15" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb346-16"><a href="stats_validation.html#cb346-16" tabindex="-1"></a>    )</span>
<span id="cb346-17"><a href="stats_validation.html#cb346-17" tabindex="-1"></a>    , <span class="at">escape =</span> F</span>
<span id="cb346-18"><a href="stats_validation.html#cb346-18" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb346-19"><a href="stats_validation.html#cb346-19" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb346-20"><a href="stats_validation.html#cb346-20" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">pack_rows</span>(<span class="at">index =</span> <span class="fu">table</span>(forcats<span class="sc">::</span><span class="fu">fct_inorder</span>(table_temp<span class="sc">$</span>contrast))) <span class="sc">%&gt;%</span> </span>
<span id="cb346-21"><a href="stats_validation.html#cb346-21" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;8in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:8in; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-257">Table 6.21: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
quality
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
median difference<br>F-score
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI low
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr grouplength="5">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>OPENDRONEMAP - METASHAPE</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
ultra high
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
-0.15
</td>
<td style="text-align:right;">
0.10
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
high
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
-0.21
</td>
<td style="text-align:right;">
0.04
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
medium
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
-0.32
</td>
<td style="text-align:right;">
-0.07
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
low
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.06
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
lowest
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.29
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>PIX4D - METASHAPE</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
ultra high
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
-0.20
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
high
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.08
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
medium
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
0.13
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
low
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.20
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>PIX4D - OPENDRONEMAP</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
ultra high
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
-0.18
</td>
<td style="text-align:right;">
0.09
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
high
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
medium
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.33
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
low
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.27
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="softwarefiltering---interaction" class="section level4 hasAnchor" number="6.7.2.4">
<h4><span class="header-section-number">6.7.2.4</span> Software:Filtering - interaction<a href="stats_validation.html#softwarefiltering---interaction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Are there differences in F-score based on dense point cloud filtering mode within each processing software?</p>
<p>Here, we collapse across the study site and depth map generation quality to compare the combined filtering mode and software effect.</p>
<p>In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<p>Even though filtering mode had a small effect on the SfM predictive ability when averaging across all softwares, there might still be differences in filtering mode within software when we average across all depth map generation quality settings. Let’s check the difference in F-score by depth map filtering mode and software.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="stats_validation.html#cb347-1" tabindex="-1"></a><span class="co"># get draws</span></span>
<span id="cb347-2"><a href="stats_validation.html#cb347-2" tabindex="-1"></a>fltr_sftwr_draws_temp <span class="ot">=</span> ptcld_validation_data <span class="sc">%&gt;%</span></span>
<span id="cb347-3"><a href="stats_validation.html#cb347-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_filtering_mode, software) <span class="sc">%&gt;%</span> </span>
<span id="cb347-4"><a href="stats_validation.html#cb347-4" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb347-5"><a href="stats_validation.html#cb347-5" tabindex="-1"></a>    brms_f_mod5, <span class="at">allow_new_levels =</span> T</span>
<span id="cb347-6"><a href="stats_validation.html#cb347-6" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb347-7"><a href="stats_validation.html#cb347-7" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode) <span class="sc">+</span></span>
<span id="cb347-8"><a href="stats_validation.html#cb347-8" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> software) <span class="sc">+</span> </span>
<span id="cb347-9"><a href="stats_validation.html#cb347-9" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode<span class="sc">:</span>software)</span>
<span id="cb347-10"><a href="stats_validation.html#cb347-10" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb347-11"><a href="stats_validation.html#cb347-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb347-12"><a href="stats_validation.html#cb347-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">med =</span> tidybayes<span class="sc">::</span><span class="fu">median_hdci</span>(value)<span class="sc">$</span>y)</span>
<span id="cb347-13"><a href="stats_validation.html#cb347-13" tabindex="-1"></a></span>
<span id="cb347-14"><a href="stats_validation.html#cb347-14" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb347-15"><a href="stats_validation.html#cb347-15" tabindex="-1"></a>fltr_sftwr_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb347-16"><a href="stats_validation.html#cb347-16" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb347-17"><a href="stats_validation.html#cb347-17" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb347-18"><a href="stats_validation.html#cb347-18" tabindex="-1"></a>      <span class="at">y =</span> value, <span class="at">x =</span> software</span>
<span id="cb347-19"><a href="stats_validation.html#cb347-19" tabindex="-1"></a>      <span class="co"># , fill = software</span></span>
<span id="cb347-20"><a href="stats_validation.html#cb347-20" tabindex="-1"></a>      , <span class="at">fill =</span> med</span>
<span id="cb347-21"><a href="stats_validation.html#cb347-21" tabindex="-1"></a>    )</span>
<span id="cb347-22"><a href="stats_validation.html#cb347-22" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb347-23"><a href="stats_validation.html#cb347-23" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_eye</span>(</span>
<span id="cb347-24"><a href="stats_validation.html#cb347-24" tabindex="-1"></a>    <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb347-25"><a href="stats_validation.html#cb347-25" tabindex="-1"></a>    , <span class="at">slab_alpha =</span> <span class="fl">0.95</span></span>
<span id="cb347-26"><a href="stats_validation.html#cb347-26" tabindex="-1"></a>    , <span class="at">interval_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb347-27"><a href="stats_validation.html#cb347-27" tabindex="-1"></a>    , <span class="at">point_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_size =</span> <span class="dv">1</span></span>
<span id="cb347-28"><a href="stats_validation.html#cb347-28" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb347-29"><a href="stats_validation.html#cb347-29" tabindex="-1"></a>  <span class="co"># scale_fill_viridis_d(option = &quot;rocket&quot;, begin = 0.3, end = 0.9, drop = F) +</span></span>
<span id="cb347-30"><a href="stats_validation.html#cb347-30" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;mako&quot;</span>, <span class="at">direction=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb347-31"><a href="stats_validation.html#cb347-31" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb347-32"><a href="stats_validation.html#cb347-32" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(depth_maps_generation_filtering_mode)) <span class="sc">+</span></span>
<span id="cb347-33"><a href="stats_validation.html#cb347-33" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb347-34"><a href="stats_validation.html#cb347-34" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;software&quot;</span>, <span class="at">y =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb347-35"><a href="stats_validation.html#cb347-35" tabindex="-1"></a>    , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI</span><span class="sc">\n</span><span class="st">by filtering mode&quot;</span></span>
<span id="cb347-36"><a href="stats_validation.html#cb347-36" tabindex="-1"></a>    <span class="co"># , caption = form_temp</span></span>
<span id="cb347-37"><a href="stats_validation.html#cb347-37" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb347-38"><a href="stats_validation.html#cb347-38" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb347-39"><a href="stats_validation.html#cb347-39" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb347-40"><a href="stats_validation.html#cb347-40" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb347-41"><a href="stats_validation.html#cb347-41" tabindex="-1"></a>    , <span class="at">legend.direction  =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb347-42"><a href="stats_validation.html#cb347-42" tabindex="-1"></a>    , <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb347-43"><a href="stats_validation.html#cb347-43" tabindex="-1"></a>    , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb347-44"><a href="stats_validation.html#cb347-44" tabindex="-1"></a>  ) </span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-258-1.png" width="1008" /></p>
<p>and a table of these 95% HDI values</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="stats_validation.html#cb348-1" tabindex="-1"></a>table_temp <span class="ot">=</span> </span>
<span id="cb348-2"><a href="stats_validation.html#cb348-2" tabindex="-1"></a>  fltr_sftwr_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb348-3"><a href="stats_validation.html#cb348-3" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb348-4"><a href="stats_validation.html#cb348-4" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(.point,.interval, .width,.row)) <span class="sc">%&gt;%</span> </span>
<span id="cb348-5"><a href="stats_validation.html#cb348-5" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(software,depth_maps_generation_filtering_mode)</span>
<span id="cb348-6"><a href="stats_validation.html#cb348-6" tabindex="-1"></a></span>
<span id="cb348-7"><a href="stats_validation.html#cb348-7" tabindex="-1"></a>table_temp <span class="sc">%&gt;%</span> </span>
<span id="cb348-8"><a href="stats_validation.html#cb348-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(software)) <span class="sc">%&gt;%</span> </span>
<span id="cb348-9"><a href="stats_validation.html#cb348-9" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb348-10"><a href="stats_validation.html#cb348-10" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb348-11"><a href="stats_validation.html#cb348-11" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;F-score&lt;br&gt;95% HDI of the posterior predictive distribution&quot;</span></span>
<span id="cb348-12"><a href="stats_validation.html#cb348-12" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb348-13"><a href="stats_validation.html#cb348-13" tabindex="-1"></a>      <span class="st">&quot;filtering mode&quot;</span></span>
<span id="cb348-14"><a href="stats_validation.html#cb348-14" tabindex="-1"></a>      , <span class="st">&quot;F-score&lt;br&gt;median&quot;</span></span>
<span id="cb348-15"><a href="stats_validation.html#cb348-15" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb348-16"><a href="stats_validation.html#cb348-16" tabindex="-1"></a>    )</span>
<span id="cb348-17"><a href="stats_validation.html#cb348-17" tabindex="-1"></a>    , <span class="at">escape =</span> F</span>
<span id="cb348-18"><a href="stats_validation.html#cb348-18" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb348-19"><a href="stats_validation.html#cb348-19" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb348-20"><a href="stats_validation.html#cb348-20" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">pack_rows</span>(<span class="at">index =</span> <span class="fu">table</span>(forcats<span class="sc">::</span><span class="fu">fct_inorder</span>(table_temp<span class="sc">$</span>software))) <span class="sc">%&gt;%</span> </span>
<span id="cb348-21"><a href="stats_validation.html#cb348-21" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;8in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:8in; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-259">Table 6.22: </span>F-score<br>95% HDI of the posterior predictive distribution
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
filtering mode
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
F-score<br>median
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI low
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>METASHAPE</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
aggressive
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.61
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
moderate
</td>
<td style="text-align:right;">
0.42
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.71
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
0.79
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled
</td>
<td style="text-align:right;">
0.49
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>OPENDRONEMAP</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
aggressive
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.72
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
moderate
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.70
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.71
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.70
</td>
</tr>
<tr grouplength="3">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>PIX4D</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
moderate
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.75
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild
</td>
<td style="text-align:right;">
0.49
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled
</td>
<td style="text-align:right;">
0.49
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
</tbody>
</table>
</div>
<p>we can also make pairwise comparisons so long as we continue using <code>tidybayes::add_epred_draws</code> with the <code>re_formula</code> argument</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="stats_validation.html#cb349-1" tabindex="-1"></a><span class="co"># calculate contrast</span></span>
<span id="cb349-2"><a href="stats_validation.html#cb349-2" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> fltr_sftwr_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb349-3"><a href="stats_validation.html#cb349-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb349-4"><a href="stats_validation.html#cb349-4" tabindex="-1"></a>    value</span>
<span id="cb349-5"><a href="stats_validation.html#cb349-5" tabindex="-1"></a>    , <span class="at">by =</span> depth_maps_generation_filtering_mode</span>
<span id="cb349-6"><a href="stats_validation.html#cb349-6" tabindex="-1"></a>    , <span class="at">comparison =</span> <span class="st">&quot;pairwise&quot;</span></span>
<span id="cb349-7"><a href="stats_validation.html#cb349-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb349-8"><a href="stats_validation.html#cb349-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> depth_maps_generation_filtering_mode)</span>
<span id="cb349-9"><a href="stats_validation.html#cb349-9" tabindex="-1"></a></span>
<span id="cb349-10"><a href="stats_validation.html#cb349-10" tabindex="-1"></a><span class="co"># separate contrast</span></span>
<span id="cb349-11"><a href="stats_validation.html#cb349-11" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb349-12"><a href="stats_validation.html#cb349-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb349-13"><a href="stats_validation.html#cb349-13" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(</span>
<span id="cb349-14"><a href="stats_validation.html#cb349-14" tabindex="-1"></a>    <span class="at">cols =</span> contrast</span>
<span id="cb349-15"><a href="stats_validation.html#cb349-15" tabindex="-1"></a>    , <span class="at">delim =</span> <span class="st">&quot; - &quot;</span></span>
<span id="cb349-16"><a href="stats_validation.html#cb349-16" tabindex="-1"></a>    , <span class="at">names =</span> <span class="fu">paste0</span>(</span>
<span id="cb349-17"><a href="stats_validation.html#cb349-17" tabindex="-1"></a>      <span class="st">&quot;sorter&quot;</span></span>
<span id="cb349-18"><a href="stats_validation.html#cb349-18" tabindex="-1"></a>      , <span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(stringr<span class="sc">::</span><span class="fu">str_count</span>(brms_contrast_temp<span class="sc">$</span>contrast, <span class="st">&quot;-&quot;</span>))<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb349-19"><a href="stats_validation.html#cb349-19" tabindex="-1"></a>    )</span>
<span id="cb349-20"><a href="stats_validation.html#cb349-20" tabindex="-1"></a>    , <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span></span>
<span id="cb349-21"><a href="stats_validation.html#cb349-21" tabindex="-1"></a>    , <span class="at">cols_remove =</span> F</span>
<span id="cb349-22"><a href="stats_validation.html#cb349-22" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb349-23"><a href="stats_validation.html#cb349-23" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sorter1<span class="sc">!=</span>sorter2) <span class="sc">%&gt;%</span> </span>
<span id="cb349-24"><a href="stats_validation.html#cb349-24" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb349-25"><a href="stats_validation.html#cb349-25" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb349-26"><a href="stats_validation.html#cb349-26" tabindex="-1"></a>      tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sorter&quot;</span>)</span>
<span id="cb349-27"><a href="stats_validation.html#cb349-27" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="cf">function</span>(x){<span class="fu">factor</span>(</span>
<span id="cb349-28"><a href="stats_validation.html#cb349-28" tabindex="-1"></a>        x, <span class="at">ordered =</span> T</span>
<span id="cb349-29"><a href="stats_validation.html#cb349-29" tabindex="-1"></a>        , <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_filtering_mode)</span>
<span id="cb349-30"><a href="stats_validation.html#cb349-30" tabindex="-1"></a>      )}</span>
<span id="cb349-31"><a href="stats_validation.html#cb349-31" tabindex="-1"></a>    )</span>
<span id="cb349-32"><a href="stats_validation.html#cb349-32" tabindex="-1"></a>    , <span class="at">contrast =</span> contrast <span class="sc">%&gt;%</span> </span>
<span id="cb349-33"><a href="stats_validation.html#cb349-33" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb349-34"><a href="stats_validation.html#cb349-34" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="fu">as.numeric</span>(sorter1), <span class="fu">as.numeric</span>(sorter2)) <span class="sc">%&gt;%</span> </span>
<span id="cb349-35"><a href="stats_validation.html#cb349-35" tabindex="-1"></a>          <span class="fu">as.numeric</span>()</span>
<span id="cb349-36"><a href="stats_validation.html#cb349-36" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb349-37"><a href="stats_validation.html#cb349-37" tabindex="-1"></a>      <span class="co"># re order for filtering mode</span></span>
<span id="cb349-38"><a href="stats_validation.html#cb349-38" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_rev</span>()</span>
<span id="cb349-39"><a href="stats_validation.html#cb349-39" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb349-40"><a href="stats_validation.html#cb349-40" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb349-41"><a href="stats_validation.html#cb349-41" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, software) <span class="sc">%&gt;%</span> </span>
<span id="cb349-42"><a href="stats_validation.html#cb349-42" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb349-43"><a href="stats_validation.html#cb349-43" tabindex="-1"></a></span>
<span id="cb349-44"><a href="stats_validation.html#cb349-44" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb349-45"><a href="stats_validation.html#cb349-45" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 600,000
## Columns: 17
## Groups: contrast, software [15]
## $ software            &lt;chr&gt; &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;METASHAPE&quot;…
## $ .chain              &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .iteration          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .draw               &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,…
## $ sorter1             &lt;ord&gt; moderate, moderate, moderate, moderate, moderate, …
## $ sorter2             &lt;ord&gt; aggressive, aggressive, aggressive, aggressive, ag…
## $ contrast            &lt;fct&gt; moderate - aggressive, moderate - aggressive, mode…
## $ value               &lt;dbl&gt; 0.07830629, 0.13611251, 0.06914711, 0.01112865, 0.…
## $ median_hdi_est      &lt;dbl&gt; 0.07787187, 0.07787187, 0.07787187, 0.07787187, 0.…
## $ median_hdi_lower    &lt;dbl&gt; -0.004760904, -0.004760904, -0.004760904, -0.00476…
## $ median_hdi_upper    &lt;dbl&gt; 0.165582, 0.165582, 0.165582, 0.165582, 0.165582, …
## $ is_gt_zero          &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TR…
## $ pct_gt_zero         &lt;dbl&gt; 0.97305, 0.97305, 0.97305, 0.97305, 0.97305, 0.973…
## $ pct_gt_zero_lab     &lt;chr&gt; &quot;Pr(moderate&gt;aggressive)=97%&quot;, &quot;Pr(moderate&gt;aggres…
## $ pct_gt_zero_lab_sm  &lt;chr&gt; &quot;Pr(&gt;0)=97%&quot;, &quot;Pr(&gt;0)=97%&quot;, &quot;Pr(&gt;0)=97%&quot;, &quot;Pr(&gt;0)=…
## $ pct_gt_zero_lab_pos &lt;dbl&gt; 0.1780006, 0.1780006, 0.1780006, 0.1780006, 0.1780…
## $ sig_level           &lt;ord&gt; 95%, 95%, 95%, 95%, 95%, 95%, 95%, 95%, 95%, 95%, …</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="stats_validation.html#cb351-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb351-2"><a href="stats_validation.html#cb351-2" tabindex="-1"></a>  brms_contrast_temp</span>
<span id="cb351-3"><a href="stats_validation.html#cb351-3" tabindex="-1"></a>  <span class="co"># , caption_text = form_temp</span></span>
<span id="cb351-4"><a href="stats_validation.html#cb351-4" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;filtering mode&quot;</span></span>
<span id="cb351-5"><a href="stats_validation.html#cb351-5" tabindex="-1"></a>  , <span class="at">facet =</span> <span class="st">&quot;software&quot;</span></span>
<span id="cb351-6"><a href="stats_validation.html#cb351-6" tabindex="-1"></a>  , <span class="at">label_size =</span> <span class="fl">2.0</span></span>
<span id="cb351-7"><a href="stats_validation.html#cb351-7" tabindex="-1"></a>  , <span class="at">x_expand =</span> <span class="fu">c</span>(<span class="fl">1.8</span>,<span class="fl">1.8</span>) <span class="co"># c(1,1.4)</span></span>
<span id="cb351-8"><a href="stats_validation.html#cb351-8" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb351-9"><a href="stats_validation.html#cb351-9" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb351-10"><a href="stats_validation.html#cb351-10" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of group constrasts with 95% &amp; 50% HDI</span><span class="sc">\n</span><span class="st">by software&quot;</span></span>
<span id="cb351-11"><a href="stats_validation.html#cb351-11" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-261-1.png" width="1008" /></p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="stats_validation.html#cb352-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb352-2"><a href="stats_validation.html#cb352-2" tabindex="-1"></a>  <span class="st">&quot;../data/fltr_sftwr_comp_mod5.png&quot;</span></span>
<span id="cb352-3"><a href="stats_validation.html#cb352-3" tabindex="-1"></a>  , <span class="at">plot =</span> ggplot2<span class="sc">::</span><span class="fu">last_plot</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb352-4"><a href="stats_validation.html#cb352-4" tabindex="-1"></a>  , <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span></span>
<span id="cb352-5"><a href="stats_validation.html#cb352-5" tabindex="-1"></a>)</span></code></pre></div>
<p>create plot for combining with other RMSE contrasts for publication</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="stats_validation.html#cb353-1" tabindex="-1"></a>ptchwrk_fltr_sftwr_comp <span class="ot">=</span></span>
<span id="cb353-2"><a href="stats_validation.html#cb353-2" tabindex="-1"></a>  <span class="fu">plt_contrast</span>(</span>
<span id="cb353-3"><a href="stats_validation.html#cb353-3" tabindex="-1"></a>    brms_contrast_temp</span>
<span id="cb353-4"><a href="stats_validation.html#cb353-4" tabindex="-1"></a>    , <span class="at">y_axis_title =</span> <span class="st">&quot;filtering mode contrast&quot;</span></span>
<span id="cb353-5"><a href="stats_validation.html#cb353-5" tabindex="-1"></a>    , <span class="at">facet =</span> <span class="st">&quot;software&quot;</span></span>
<span id="cb353-6"><a href="stats_validation.html#cb353-6" tabindex="-1"></a>    , <span class="at">label_size =</span> <span class="fl">1.7</span></span>
<span id="cb353-7"><a href="stats_validation.html#cb353-7" tabindex="-1"></a>    , <span class="at">label =</span> <span class="st">&quot;pct_gt_zero_lab_sm&quot;</span></span>
<span id="cb353-8"><a href="stats_validation.html#cb353-8" tabindex="-1"></a>    , <span class="at">annotate_size =</span> <span class="fl">1.8</span></span>
<span id="cb353-9"><a href="stats_validation.html#cb353-9" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb353-10"><a href="stats_validation.html#cb353-10" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb353-11"><a href="stats_validation.html#cb353-11" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">&quot;&quot;</span> <span class="co"># &quot;constrast Height RMSE (m)&quot;</span></span>
<span id="cb353-12"><a href="stats_validation.html#cb353-12" tabindex="-1"></a>      , <span class="at">x =</span> <span class="st">&quot;F-score constrast&quot;</span></span>
<span id="cb353-13"><a href="stats_validation.html#cb353-13" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb353-14"><a href="stats_validation.html#cb353-14" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb353-15"><a href="stats_validation.html#cb353-15" tabindex="-1"></a>      <span class="at">legend.position=</span><span class="st">&quot;none&quot;</span></span>
<span id="cb353-16"><a href="stats_validation.html#cb353-16" tabindex="-1"></a>      , <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb353-17"><a href="stats_validation.html#cb353-17" tabindex="-1"></a>      , <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb353-18"><a href="stats_validation.html#cb353-18" tabindex="-1"></a>    ) </span>
<span id="cb353-19"><a href="stats_validation.html#cb353-19" tabindex="-1"></a><span class="co"># ptchwrk_fltr_sftwr_comp</span></span></code></pre></div>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="stats_validation.html#cb354-1" tabindex="-1"></a>table_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb354-2"><a href="stats_validation.html#cb354-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, software) <span class="sc">%&gt;%</span> </span>
<span id="cb354-3"><a href="stats_validation.html#cb354-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb354-4"><a href="stats_validation.html#cb354-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast, software) <span class="sc">%&gt;%</span> </span>
<span id="cb354-5"><a href="stats_validation.html#cb354-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, software, value, .lower, .upper) <span class="sc">%&gt;%</span> </span>
<span id="cb354-6"><a href="stats_validation.html#cb354-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(software, contrast)</span>
<span id="cb354-7"><a href="stats_validation.html#cb354-7" tabindex="-1"></a></span>
<span id="cb354-8"><a href="stats_validation.html#cb354-8" tabindex="-1"></a>table_temp <span class="sc">%&gt;%</span> </span>
<span id="cb354-9"><a href="stats_validation.html#cb354-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(software)) <span class="sc">%&gt;%</span> </span>
<span id="cb354-10"><a href="stats_validation.html#cb354-10" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb354-11"><a href="stats_validation.html#cb354-11" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb354-12"><a href="stats_validation.html#cb354-12" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb354-13"><a href="stats_validation.html#cb354-13" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb354-14"><a href="stats_validation.html#cb354-14" tabindex="-1"></a>      <span class="st">&quot;filtering contrast&quot;</span></span>
<span id="cb354-15"><a href="stats_validation.html#cb354-15" tabindex="-1"></a>      , <span class="st">&quot;median difference&lt;br&gt;F-score&quot;</span></span>
<span id="cb354-16"><a href="stats_validation.html#cb354-16" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb354-17"><a href="stats_validation.html#cb354-17" tabindex="-1"></a>    )</span>
<span id="cb354-18"><a href="stats_validation.html#cb354-18" tabindex="-1"></a>    , <span class="at">escape =</span> F</span>
<span id="cb354-19"><a href="stats_validation.html#cb354-19" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb354-20"><a href="stats_validation.html#cb354-20" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb354-21"><a href="stats_validation.html#cb354-21" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">pack_rows</span>(<span class="at">index =</span> <span class="fu">table</span>(forcats<span class="sc">::</span><span class="fu">fct_inorder</span>(table_temp<span class="sc">$</span>software))) <span class="sc">%&gt;%</span> </span>
<span id="cb354-22"><a href="stats_validation.html#cb354-22" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;8in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:8in; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-264">Table 6.23: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
filtering contrast
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
median difference<br>F-score
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI low
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr grouplength="6">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>METASHAPE</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled - mild
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.08
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled - moderate
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.15
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled - aggressive
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.24
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild - moderate
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.16
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild - aggressive
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
moderate - aggressive
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr grouplength="6">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>OPENDRONEMAP</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled - mild
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled - moderate
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled - aggressive
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.06
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild - moderate
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.08
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild - aggressive
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
moderate - aggressive
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.06
</td>
</tr>
<tr grouplength="3">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>PIX4D</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled - mild
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.09
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
disabled - moderate
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
mild - moderate
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="softwarequalityfiltering---interaction" class="section level4 hasAnchor" number="6.7.2.5">
<h4><span class="header-section-number">6.7.2.5</span> Software:Quality:Filtering - interaction<a href="stats_validation.html#softwarequalityfiltering---interaction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The contrasts immediately above address the question “are there differences in F-score based on dense point cloud filtering mode within each software?”. Although the impact of filtering mode is small, it is highly probable when averaging across all quality settings. What if we don’t average out the impact of quality and instead get the full, three-way interaction between software, quality, and filtering mode?</p>
<p>Let’s get the model’s answer to the question “For each software, are there differences in F-score based on dense point cloud filtering mode within each point cloud generation quality?”.</p>
<p>Here, we collapse across the study site to compare the dense cloud quality, filtering mode, and software effect.</p>
<p>In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="stats_validation.html#cb355-1" tabindex="-1"></a><span class="co"># get draws</span></span>
<span id="cb355-2"><a href="stats_validation.html#cb355-2" tabindex="-1"></a>fltr_sftwr_draws_temp <span class="ot">=</span></span>
<span id="cb355-3"><a href="stats_validation.html#cb355-3" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">crossing</span>(</span>
<span id="cb355-4"><a href="stats_validation.html#cb355-4" tabindex="-1"></a>    <span class="at">depth_maps_generation_quality =</span> <span class="fu">unique</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_quality)</span>
<span id="cb355-5"><a href="stats_validation.html#cb355-5" tabindex="-1"></a>    , <span class="at">depth_maps_generation_filtering_mode =</span> <span class="fu">unique</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_filtering_mode)</span>
<span id="cb355-6"><a href="stats_validation.html#cb355-6" tabindex="-1"></a>    , <span class="at">software =</span> <span class="fu">unique</span>(ptcld_validation_data<span class="sc">$</span>software)</span>
<span id="cb355-7"><a href="stats_validation.html#cb355-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb355-8"><a href="stats_validation.html#cb355-8" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb355-9"><a href="stats_validation.html#cb355-9" tabindex="-1"></a>    brms_f_mod5, <span class="at">allow_new_levels =</span> T</span>
<span id="cb355-10"><a href="stats_validation.html#cb355-10" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb355-11"><a href="stats_validation.html#cb355-11" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span> <span class="co"># main effects</span></span>
<span id="cb355-12"><a href="stats_validation.html#cb355-12" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span></span>
<span id="cb355-13"><a href="stats_validation.html#cb355-13" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode) <span class="sc">+</span> </span>
<span id="cb355-14"><a href="stats_validation.html#cb355-14" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> software) <span class="sc">+</span></span>
<span id="cb355-15"><a href="stats_validation.html#cb355-15" tabindex="-1"></a>    <span class="co"># two-way interactions</span></span>
<span id="cb355-16"><a href="stats_validation.html#cb355-16" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode) <span class="sc">+</span></span>
<span id="cb355-17"><a href="stats_validation.html#cb355-17" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>software) <span class="sc">+</span></span>
<span id="cb355-18"><a href="stats_validation.html#cb355-18" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode<span class="sc">:</span>software) <span class="sc">+</span></span>
<span id="cb355-19"><a href="stats_validation.html#cb355-19" tabindex="-1"></a>    <span class="co"># three-way interactions</span></span>
<span id="cb355-20"><a href="stats_validation.html#cb355-20" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode<span class="sc">:</span>software)</span>
<span id="cb355-21"><a href="stats_validation.html#cb355-21" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb355-22"><a href="stats_validation.html#cb355-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb355-23"><a href="stats_validation.html#cb355-23" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">med =</span> tidybayes<span class="sc">::</span><span class="fu">median_hdci</span>(value)<span class="sc">$</span>y)</span>
<span id="cb355-24"><a href="stats_validation.html#cb355-24" tabindex="-1"></a><span class="co"># let&#39;s add the grand mean to the plot for reference</span></span>
<span id="cb355-25"><a href="stats_validation.html#cb355-25" tabindex="-1"></a>grand_mean_temp <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">posterior_summary</span>(brms_f_mod5) <span class="sc">%&gt;%</span> </span>
<span id="cb355-26"><a href="stats_validation.html#cb355-26" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb355-27"><a href="stats_validation.html#cb355-27" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameter&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb355-28"><a href="stats_validation.html#cb355-28" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(tolower) <span class="sc">%&gt;%</span> </span>
<span id="cb355-29"><a href="stats_validation.html#cb355-29" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb355-30"><a href="stats_validation.html#cb355-30" tabindex="-1"></a>    parameter <span class="sc">==</span> <span class="st">&quot;Intercept&quot;</span></span>
<span id="cb355-31"><a href="stats_validation.html#cb355-31" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb355-32"><a href="stats_validation.html#cb355-32" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(dplyr<span class="sc">::</span><span class="fu">across</span>(<span class="sc">-</span><span class="fu">c</span>(parameter), <span class="sc">~</span><span class="fu">plogis</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb355-33"><a href="stats_validation.html#cb355-33" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(estimate)</span>
<span id="cb355-34"><a href="stats_validation.html#cb355-34" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb355-35"><a href="stats_validation.html#cb355-35" tabindex="-1"></a>fltr_sftwr_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb355-36"><a href="stats_validation.html#cb355-36" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb355-37"><a href="stats_validation.html#cb355-37" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(software, depth_maps_generation_quality, depth_maps_generation_filtering_mode)</span>
<span id="cb355-38"><a href="stats_validation.html#cb355-38" tabindex="-1"></a>    , <span class="at">by =</span> dplyr<span class="sc">::</span><span class="fu">join_by</span>(software, depth_maps_generation_quality, depth_maps_generation_filtering_mode)</span>
<span id="cb355-39"><a href="stats_validation.html#cb355-39" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb355-40"><a href="stats_validation.html#cb355-40" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">depth_maps_generation_quality =</span> depth_maps_generation_quality <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb355-41"><a href="stats_validation.html#cb355-41" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb355-42"><a href="stats_validation.html#cb355-42" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb355-43"><a href="stats_validation.html#cb355-43" tabindex="-1"></a>      <span class="at">y =</span> value</span>
<span id="cb355-44"><a href="stats_validation.html#cb355-44" tabindex="-1"></a>      , <span class="at">x =</span> depth_maps_generation_filtering_mode</span>
<span id="cb355-45"><a href="stats_validation.html#cb355-45" tabindex="-1"></a>      <span class="co"># , fill = depth_maps_generation_filtering_mode</span></span>
<span id="cb355-46"><a href="stats_validation.html#cb355-46" tabindex="-1"></a>      , <span class="at">fill =</span> med</span>
<span id="cb355-47"><a href="stats_validation.html#cb355-47" tabindex="-1"></a>    )</span>
<span id="cb355-48"><a href="stats_validation.html#cb355-48" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb355-49"><a href="stats_validation.html#cb355-49" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> grand_mean_temp, <span class="at">color =</span> <span class="st">&quot;gray33&quot;</span>) <span class="sc">+</span></span>
<span id="cb355-50"><a href="stats_validation.html#cb355-50" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_eye</span>(</span>
<span id="cb355-51"><a href="stats_validation.html#cb355-51" tabindex="-1"></a>    <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb355-52"><a href="stats_validation.html#cb355-52" tabindex="-1"></a>    , <span class="at">slab_alpha =</span> <span class="fl">0.95</span></span>
<span id="cb355-53"><a href="stats_validation.html#cb355-53" tabindex="-1"></a>    , <span class="at">interval_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb355-54"><a href="stats_validation.html#cb355-54" tabindex="-1"></a>    , <span class="at">point_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_size =</span> <span class="dv">1</span></span>
<span id="cb355-55"><a href="stats_validation.html#cb355-55" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb355-56"><a href="stats_validation.html#cb355-56" tabindex="-1"></a>  <span class="co"># scale_fill_viridis_d(option = &quot;plasma&quot;, drop = F) +</span></span>
<span id="cb355-57"><a href="stats_validation.html#cb355-57" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;mako&quot;</span>, <span class="at">direction=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb355-58"><a href="stats_validation.html#cb355-58" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb355-59"><a href="stats_validation.html#cb355-59" tabindex="-1"></a>  <span class="fu">facet_grid</span>(</span>
<span id="cb355-60"><a href="stats_validation.html#cb355-60" tabindex="-1"></a>    <span class="at">rows =</span> <span class="fu">vars</span>(software)</span>
<span id="cb355-61"><a href="stats_validation.html#cb355-61" tabindex="-1"></a>    , <span class="at">cols =</span> <span class="fu">vars</span>(depth_maps_generation_quality)</span>
<span id="cb355-62"><a href="stats_validation.html#cb355-62" tabindex="-1"></a>    <span class="co"># , switch = &quot;y&quot;</span></span>
<span id="cb355-63"><a href="stats_validation.html#cb355-63" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb355-64"><a href="stats_validation.html#cb355-64" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb355-65"><a href="stats_validation.html#cb355-65" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb355-66"><a href="stats_validation.html#cb355-66" tabindex="-1"></a>    , <span class="at">x =</span> <span class="st">&quot;filtering mode&quot;</span>, <span class="at">y =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb355-67"><a href="stats_validation.html#cb355-67" tabindex="-1"></a>    <span class="co"># , subtitle = &quot;posterior predictive distribution of F-score with 95% HDI\nby dense cloud quality and software&quot;</span></span>
<span id="cb355-68"><a href="stats_validation.html#cb355-68" tabindex="-1"></a>    , <span class="at">subtitle =</span> <span class="st">&quot;quality&quot;</span></span>
<span id="cb355-69"><a href="stats_validation.html#cb355-69" tabindex="-1"></a>    <span class="co"># , caption = form_temp</span></span>
<span id="cb355-70"><a href="stats_validation.html#cb355-70" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb355-71"><a href="stats_validation.html#cb355-71" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb355-72"><a href="stats_validation.html#cb355-72" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb355-73"><a href="stats_validation.html#cb355-73" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb355-74"><a href="stats_validation.html#cb355-74" tabindex="-1"></a>    , <span class="at">legend.direction  =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb355-75"><a href="stats_validation.html#cb355-75" tabindex="-1"></a>    , <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb355-76"><a href="stats_validation.html#cb355-76" tabindex="-1"></a>    , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb355-77"><a href="stats_validation.html#cb355-77" tabindex="-1"></a>    , <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb355-78"><a href="stats_validation.html#cb355-78" tabindex="-1"></a>    , <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb355-79"><a href="stats_validation.html#cb355-79" tabindex="-1"></a>    <span class="co"># , strip.placement = &quot;outside&quot;</span></span>
<span id="cb355-80"><a href="stats_validation.html#cb355-80" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb355-81"><a href="stats_validation.html#cb355-81" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb355-82"><a href="stats_validation.html#cb355-82" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">lwd =</span> <span class="cn">NA</span>))</span>
<span id="cb355-83"><a href="stats_validation.html#cb355-83" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-265-1.png" width="1008" /></p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="stats_validation.html#cb356-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb356-2"><a href="stats_validation.html#cb356-2" tabindex="-1"></a>  <span class="st">&quot;../data/qlty_fltr_sftwr_mod5.png&quot;</span></span>
<span id="cb356-3"><a href="stats_validation.html#cb356-3" tabindex="-1"></a>  , <span class="at">plot =</span> ggplot2<span class="sc">::</span><span class="fu">last_plot</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb356-4"><a href="stats_validation.html#cb356-4" tabindex="-1"></a>  , <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span></span>
<span id="cb356-5"><a href="stats_validation.html#cb356-5" tabindex="-1"></a>)</span></code></pre></div>
<p>let’s add a table of the results</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="stats_validation.html#cb357-1" tabindex="-1"></a>table_temp <span class="ot">=</span></span>
<span id="cb357-2"><a href="stats_validation.html#cb357-2" tabindex="-1"></a>  fltr_sftwr_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb357-3"><a href="stats_validation.html#cb357-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span></span>
<span id="cb357-4"><a href="stats_validation.html#cb357-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb357-5"><a href="stats_validation.html#cb357-5" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(software, depth_maps_generation_quality, depth_maps_generation_filtering_mode)</span>
<span id="cb357-6"><a href="stats_validation.html#cb357-6" tabindex="-1"></a>    , <span class="at">by =</span> dplyr<span class="sc">::</span><span class="fu">join_by</span>(software, depth_maps_generation_quality, depth_maps_generation_filtering_mode)</span>
<span id="cb357-7"><a href="stats_validation.html#cb357-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb357-8"><a href="stats_validation.html#cb357-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">depth_maps_generation_quality =</span> depth_maps_generation_quality <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb357-9"><a href="stats_validation.html#cb357-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(</span>
<span id="cb357-10"><a href="stats_validation.html#cb357-10" tabindex="-1"></a>    software, depth_maps_generation_quality, depth_maps_generation_filtering_mode</span>
<span id="cb357-11"><a href="stats_validation.html#cb357-11" tabindex="-1"></a>    , value, .lower, .upper</span>
<span id="cb357-12"><a href="stats_validation.html#cb357-12" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb357-13"><a href="stats_validation.html#cb357-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb357-14"><a href="stats_validation.html#cb357-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(software, depth_maps_generation_quality, depth_maps_generation_filtering_mode)</span>
<span id="cb357-15"><a href="stats_validation.html#cb357-15" tabindex="-1"></a></span>
<span id="cb357-16"><a href="stats_validation.html#cb357-16" tabindex="-1"></a>table_temp <span class="sc">%&gt;%</span> </span>
<span id="cb357-17"><a href="stats_validation.html#cb357-17" tabindex="-1"></a>  <span class="co"># dplyr::select(-c(software)) %&gt;% </span></span>
<span id="cb357-18"><a href="stats_validation.html#cb357-18" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb357-19"><a href="stats_validation.html#cb357-19" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb357-20"><a href="stats_validation.html#cb357-20" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution&quot;</span></span>
<span id="cb357-21"><a href="stats_validation.html#cb357-21" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb357-22"><a href="stats_validation.html#cb357-22" tabindex="-1"></a>      <span class="st">&quot;software&quot;</span>, <span class="st">&quot;quality&quot;</span>, <span class="st">&quot;filtering mode&quot;</span></span>
<span id="cb357-23"><a href="stats_validation.html#cb357-23" tabindex="-1"></a>      , <span class="st">&quot;F-score&lt;br&gt;median&quot;</span></span>
<span id="cb357-24"><a href="stats_validation.html#cb357-24" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb357-25"><a href="stats_validation.html#cb357-25" tabindex="-1"></a>    )</span>
<span id="cb357-26"><a href="stats_validation.html#cb357-26" tabindex="-1"></a>    , <span class="at">escape =</span> F</span>
<span id="cb357-27"><a href="stats_validation.html#cb357-27" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb357-28"><a href="stats_validation.html#cb357-28" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb357-29"><a href="stats_validation.html#cb357-29" tabindex="-1"></a>  <span class="co"># kableExtra::pack_rows(index = table(forcats::fct_inorder(table_temp$software))) %&gt;% </span></span>
<span id="cb357-30"><a href="stats_validation.html#cb357-30" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">collapse_rows</span>(<span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">valign =</span> <span class="st">&quot;top&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb357-31"><a href="stats_validation.html#cb357-31" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;8in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:8in; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-266">Table 6.24: </span>brms::brm model: 95% HDI of the posterior predictive distribution
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
software
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
quality
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
filtering mode
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
F-score<br>median
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI low
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="20">
METASHAPE
</td>
<td style="text-align:left;vertical-align: top !important;" rowspan="4">
lowest
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
<tr>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.26
</td>
</tr>
<tr>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.36
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.35
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="4">
low
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.50
</td>
</tr>
<tr>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.61
</td>
</tr>
<tr>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.46
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.69
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.46
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.70
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="4">
medium
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.43
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.66
</td>
</tr>
<tr>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.52
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.75
</td>
</tr>
<tr>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
0.37
</td>
<td style="text-align:right;">
0.81
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.59
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
0.81
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="4">
high
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.49
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
0.73
</td>
</tr>
<tr>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
0.35
</td>
<td style="text-align:right;">
0.80
</td>
</tr>
<tr>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.64
</td>
<td style="text-align:right;">
0.43
</td>
<td style="text-align:right;">
0.85
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.64
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
0.84
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="4">
ultra high
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
0.28
</td>
<td style="text-align:right;">
0.74
</td>
</tr>
<tr>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
0.37
</td>
<td style="text-align:right;">
0.81
</td>
</tr>
<tr>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.66
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
0.86
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;">
0.43
</td>
<td style="text-align:right;">
0.85
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="20">
OPENDRONEMAP
</td>
<td style="text-align:left;vertical-align: top !important;" rowspan="4">
lowest
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.55
</td>
</tr>
<tr>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.52
</td>
</tr>
<tr>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.52
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.52
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="4">
low
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.56
</td>
</tr>
<tr>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.54
</td>
</tr>
<tr>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.54
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.54
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="4">
medium
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.57
</td>
</tr>
<tr>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.54
</td>
</tr>
<tr>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.54
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.53
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="4">
high
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.52
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.75
</td>
</tr>
<tr>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.49
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
0.72
</td>
</tr>
<tr>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.49
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
0.72
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.48
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.71
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="4">
ultra high
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
0.37
</td>
<td style="text-align:right;">
0.81
</td>
</tr>
<tr>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.79
</td>
</tr>
<tr>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.57
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.79
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.79
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="12">
PIX4D
</td>
<td style="text-align:left;vertical-align: top !important;" rowspan="3">
low
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.67
</td>
</tr>
<tr>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
0.73
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.74
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="3">
medium
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.52
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.76
</td>
</tr>
<tr>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.79
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="3">
high
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.76
</td>
</tr>
<tr>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.79
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.78
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="3">
ultra high
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.77
</td>
</tr>
<tr>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.79
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.79
</td>
</tr>
</tbody>
</table>
</div>
<p>we can also make pairwise comparisons so long as we continue using <code>tidybayes::add_epred_draws</code> with the <code>re_formula</code> argument</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="stats_validation.html#cb358-1" tabindex="-1"></a><span class="co"># calculate contrast</span></span>
<span id="cb358-2"><a href="stats_validation.html#cb358-2" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> fltr_sftwr_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb358-3"><a href="stats_validation.html#cb358-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb358-4"><a href="stats_validation.html#cb358-4" tabindex="-1"></a>    value</span>
<span id="cb358-5"><a href="stats_validation.html#cb358-5" tabindex="-1"></a>    , <span class="at">by =</span> depth_maps_generation_filtering_mode</span>
<span id="cb358-6"><a href="stats_validation.html#cb358-6" tabindex="-1"></a>    , <span class="at">comparison =</span> <span class="st">&quot;pairwise&quot;</span></span>
<span id="cb358-7"><a href="stats_validation.html#cb358-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb358-8"><a href="stats_validation.html#cb358-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> depth_maps_generation_filtering_mode)</span>
<span id="cb358-9"><a href="stats_validation.html#cb358-9" tabindex="-1"></a></span>
<span id="cb358-10"><a href="stats_validation.html#cb358-10" tabindex="-1"></a><span class="co"># separate contrast</span></span>
<span id="cb358-11"><a href="stats_validation.html#cb358-11" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb358-12"><a href="stats_validation.html#cb358-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb358-13"><a href="stats_validation.html#cb358-13" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(</span>
<span id="cb358-14"><a href="stats_validation.html#cb358-14" tabindex="-1"></a>    <span class="at">cols =</span> contrast</span>
<span id="cb358-15"><a href="stats_validation.html#cb358-15" tabindex="-1"></a>    , <span class="at">delim =</span> <span class="st">&quot; - &quot;</span></span>
<span id="cb358-16"><a href="stats_validation.html#cb358-16" tabindex="-1"></a>    , <span class="at">names =</span> <span class="fu">paste0</span>(</span>
<span id="cb358-17"><a href="stats_validation.html#cb358-17" tabindex="-1"></a>      <span class="st">&quot;sorter&quot;</span></span>
<span id="cb358-18"><a href="stats_validation.html#cb358-18" tabindex="-1"></a>      , <span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(stringr<span class="sc">::</span><span class="fu">str_count</span>(brms_contrast_temp<span class="sc">$</span>contrast, <span class="st">&quot;-&quot;</span>))<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb358-19"><a href="stats_validation.html#cb358-19" tabindex="-1"></a>    )</span>
<span id="cb358-20"><a href="stats_validation.html#cb358-20" tabindex="-1"></a>    , <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span></span>
<span id="cb358-21"><a href="stats_validation.html#cb358-21" tabindex="-1"></a>    , <span class="at">cols_remove =</span> F</span>
<span id="cb358-22"><a href="stats_validation.html#cb358-22" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb358-23"><a href="stats_validation.html#cb358-23" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sorter1<span class="sc">!=</span>sorter2) <span class="sc">%&gt;%</span> </span>
<span id="cb358-24"><a href="stats_validation.html#cb358-24" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb358-25"><a href="stats_validation.html#cb358-25" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb358-26"><a href="stats_validation.html#cb358-26" tabindex="-1"></a>      tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sorter&quot;</span>)</span>
<span id="cb358-27"><a href="stats_validation.html#cb358-27" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="cf">function</span>(x){<span class="fu">factor</span>(</span>
<span id="cb358-28"><a href="stats_validation.html#cb358-28" tabindex="-1"></a>        x, <span class="at">ordered =</span> T</span>
<span id="cb358-29"><a href="stats_validation.html#cb358-29" tabindex="-1"></a>        , <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_filtering_mode)</span>
<span id="cb358-30"><a href="stats_validation.html#cb358-30" tabindex="-1"></a>      )}</span>
<span id="cb358-31"><a href="stats_validation.html#cb358-31" tabindex="-1"></a>    )</span>
<span id="cb358-32"><a href="stats_validation.html#cb358-32" tabindex="-1"></a>    , <span class="at">contrast =</span> contrast <span class="sc">%&gt;%</span> </span>
<span id="cb358-33"><a href="stats_validation.html#cb358-33" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb358-34"><a href="stats_validation.html#cb358-34" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="fu">as.numeric</span>(sorter1), <span class="fu">as.numeric</span>(sorter2)) <span class="sc">%&gt;%</span> </span>
<span id="cb358-35"><a href="stats_validation.html#cb358-35" tabindex="-1"></a>          <span class="fu">as.numeric</span>()</span>
<span id="cb358-36"><a href="stats_validation.html#cb358-36" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb358-37"><a href="stats_validation.html#cb358-37" tabindex="-1"></a>      <span class="co"># re order for filtering mode</span></span>
<span id="cb358-38"><a href="stats_validation.html#cb358-38" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_rev</span>()</span>
<span id="cb358-39"><a href="stats_validation.html#cb358-39" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb358-40"><a href="stats_validation.html#cb358-40" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb358-41"><a href="stats_validation.html#cb358-41" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, software, depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb358-42"><a href="stats_validation.html#cb358-42" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb358-43"><a href="stats_validation.html#cb358-43" tabindex="-1"></a></span>
<span id="cb358-44"><a href="stats_validation.html#cb358-44" tabindex="-1"></a><span class="co"># remove out-of-sample obs</span></span>
<span id="cb358-45"><a href="stats_validation.html#cb358-45" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb358-46"><a href="stats_validation.html#cb358-46" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb358-47"><a href="stats_validation.html#cb358-47" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(software, depth_maps_generation_quality, depth_maps_generation_filtering_mode)</span>
<span id="cb358-48"><a href="stats_validation.html#cb358-48" tabindex="-1"></a>    , <span class="at">by =</span> dplyr<span class="sc">::</span><span class="fu">join_by</span>(software, depth_maps_generation_quality, sorter1<span class="sc">==</span>depth_maps_generation_filtering_mode)</span>
<span id="cb358-49"><a href="stats_validation.html#cb358-49" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb358-50"><a href="stats_validation.html#cb358-50" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb358-51"><a href="stats_validation.html#cb358-51" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(software, depth_maps_generation_quality, depth_maps_generation_filtering_mode)</span>
<span id="cb358-52"><a href="stats_validation.html#cb358-52" tabindex="-1"></a>    , <span class="at">by =</span> dplyr<span class="sc">::</span><span class="fu">join_by</span>(software, depth_maps_generation_quality, sorter2<span class="sc">==</span>depth_maps_generation_filtering_mode)</span>
<span id="cb358-53"><a href="stats_validation.html#cb358-53" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb358-54"><a href="stats_validation.html#cb358-54" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">depth_maps_generation_quality =</span> depth_maps_generation_quality <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>())</span>
<span id="cb358-55"><a href="stats_validation.html#cb358-55" tabindex="-1"></a></span>
<span id="cb358-56"><a href="stats_validation.html#cb358-56" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb358-57"><a href="stats_validation.html#cb358-57" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 2,880,000
## Columns: 18
## Groups: contrast, software, depth_maps_generation_quality [72]
## $ depth_maps_generation_quality &lt;ord&gt; ultra high, ultra high, ultra high, ultr…
## $ software                      &lt;chr&gt; &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;…
## $ .chain                        &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ .iteration                    &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ .draw                         &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1…
## $ sorter1                       &lt;ord&gt; moderate, moderate, moderate, moderate, …
## $ sorter2                       &lt;ord&gt; aggressive, aggressive, aggressive, aggr…
## $ contrast                      &lt;fct&gt; moderate - aggressive, moderate - aggres…
## $ value                         &lt;dbl&gt; 0.08670041, 0.11311886, 0.09062662, -0.0…
## $ median_hdi_est                &lt;dbl&gt; 0.08282442, 0.08282442, 0.08282442, 0.08…
## $ median_hdi_lower              &lt;dbl&gt; -0.01736903, -0.01736903, -0.01736903, -…
## $ median_hdi_upper              &lt;dbl&gt; 0.1882672, 0.1882672, 0.1882672, 0.18826…
## $ is_gt_zero                    &lt;lgl&gt; TRUE, TRUE, TRUE, FALSE, TRUE, TRUE, TRU…
## $ pct_gt_zero                   &lt;dbl&gt; 0.9477, 0.9477, 0.9477, 0.9477, 0.9477, …
## $ pct_gt_zero_lab               &lt;chr&gt; &quot;Pr(moderate&gt;aggressive)=95%&quot;, &quot;Pr(moder…
## $ pct_gt_zero_lab_sm            &lt;chr&gt; &quot;Pr(&gt;0)=95%&quot;, &quot;Pr(&gt;0)=95%&quot;, &quot;Pr(&gt;0)=95%&quot;…
## $ pct_gt_zero_lab_pos           &lt;dbl&gt; 0.2023873, 0.2023873, 0.2023873, 0.20238…
## $ sig_level                     &lt;ord&gt; 90%, 90%, 90%, 90%, 90%, 90%, 90%, 90%, …</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="stats_validation.html#cb360-1" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb360-2"><a href="stats_validation.html#cb360-2" tabindex="-1"></a>  <span class="fu">plt_contrast</span>(</span>
<span id="cb360-3"><a href="stats_validation.html#cb360-3" tabindex="-1"></a>    <span class="at">facet =</span> <span class="fu">c</span>(<span class="st">&quot;depth_maps_generation_quality&quot;</span>, <span class="st">&quot;software&quot;</span>)</span>
<span id="cb360-4"><a href="stats_validation.html#cb360-4" tabindex="-1"></a>    , <span class="at">y_axis_title =</span> <span class="st">&quot;filtering mode&quot;</span></span>
<span id="cb360-5"><a href="stats_validation.html#cb360-5" tabindex="-1"></a>    , <span class="at">label_size =</span> <span class="dv">0</span></span>
<span id="cb360-6"><a href="stats_validation.html#cb360-6" tabindex="-1"></a>    , <span class="at">x_expand =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>,<span class="sc">-</span><span class="fl">0.1</span>)</span>
<span id="cb360-7"><a href="stats_validation.html#cb360-7" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb360-8"><a href="stats_validation.html#cb360-8" tabindex="-1"></a>  <span class="fu">facet_grid</span>(</span>
<span id="cb360-9"><a href="stats_validation.html#cb360-9" tabindex="-1"></a>    <span class="at">rows =</span> <span class="fu">vars</span>(software)</span>
<span id="cb360-10"><a href="stats_validation.html#cb360-10" tabindex="-1"></a>    , <span class="at">cols =</span> <span class="fu">vars</span>(depth_maps_generation_quality)</span>
<span id="cb360-11"><a href="stats_validation.html#cb360-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb360-12"><a href="stats_validation.html#cb360-12" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb360-13"><a href="stats_validation.html#cb360-13" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of group constrasts with 95% &amp; 50% HDI</span><span class="sc">\n</span><span class="st">by dense cloud quality and software&quot;</span></span>
<span id="cb360-14"><a href="stats_validation.html#cb360-14" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-268-1.png" width="1008" /></p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="stats_validation.html#cb361-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb361-2"><a href="stats_validation.html#cb361-2" tabindex="-1"></a>  <span class="st">&quot;../data/qlty_fltr_sftwr_comp_mod5.png&quot;</span></span>
<span id="cb361-3"><a href="stats_validation.html#cb361-3" tabindex="-1"></a>  , <span class="at">plot =</span> ggplot2<span class="sc">::</span><span class="fu">last_plot</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb361-4"><a href="stats_validation.html#cb361-4" tabindex="-1"></a>  , <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span></span>
<span id="cb361-5"><a href="stats_validation.html#cb361-5" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="quality---main-effect" class="section level4 hasAnchor" number="6.7.2.6">
<h4><span class="header-section-number">6.7.2.6</span> Quality - main effect<a href="stats_validation.html#quality---main-effect" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>let’s collapse across the filtering mode, software, and study site to compare the dense cloud quality setting effect.
In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="stats_validation.html#cb362-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb362-2"><a href="stats_validation.html#cb362-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb362-3"><a href="stats_validation.html#cb362-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb362-4"><a href="stats_validation.html#cb362-4" tabindex="-1"></a>    brms_f_mod5</span>
<span id="cb362-5"><a href="stats_validation.html#cb362-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb362-6"><a href="stats_validation.html#cb362-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality)</span>
<span id="cb362-7"><a href="stats_validation.html#cb362-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb362-8"><a href="stats_validation.html#cb362-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb362-9"><a href="stats_validation.html#cb362-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">med =</span> tidybayes<span class="sc">::</span><span class="fu">median_hdci</span>(value)<span class="sc">$</span>y) <span class="sc">%&gt;%</span> </span>
<span id="cb362-10"><a href="stats_validation.html#cb362-10" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb362-11"><a href="stats_validation.html#cb362-11" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb362-12"><a href="stats_validation.html#cb362-12" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb362-13"><a href="stats_validation.html#cb362-13" tabindex="-1"></a>      <span class="at">x =</span> value, <span class="at">y =</span> depth_maps_generation_quality</span>
<span id="cb362-14"><a href="stats_validation.html#cb362-14" tabindex="-1"></a>      <span class="co"># , fill = depth_maps_generation_quality</span></span>
<span id="cb362-15"><a href="stats_validation.html#cb362-15" tabindex="-1"></a>      , <span class="at">fill =</span> med</span>
<span id="cb362-16"><a href="stats_validation.html#cb362-16" tabindex="-1"></a>    )</span>
<span id="cb362-17"><a href="stats_validation.html#cb362-17" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb362-18"><a href="stats_validation.html#cb362-18" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb362-19"><a href="stats_validation.html#cb362-19" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb362-20"><a href="stats_validation.html#cb362-20" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;gray66&quot;</span></span>
<span id="cb362-21"><a href="stats_validation.html#cb362-21" tabindex="-1"></a>      , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_color =</span> <span class="st">&quot;gray66&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb362-22"><a href="stats_validation.html#cb362-22" tabindex="-1"></a>      , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb362-23"><a href="stats_validation.html#cb362-23" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb362-24"><a href="stats_validation.html#cb362-24" tabindex="-1"></a>    <span class="co"># scale_fill_viridis_d(option = &quot;inferno&quot;, drop = F) +</span></span>
<span id="cb362-25"><a href="stats_validation.html#cb362-25" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;mako&quot;</span>, <span class="at">direction=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb362-26"><a href="stats_validation.html#cb362-26" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb362-27"><a href="stats_validation.html#cb362-27" tabindex="-1"></a>    <span class="co"># scale_x_continuous(breaks = scales::extended_breaks(n=8)) +</span></span>
<span id="cb362-28"><a href="stats_validation.html#cb362-28" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb362-29"><a href="stats_validation.html#cb362-29" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;quality&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb362-30"><a href="stats_validation.html#cb362-30" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI&quot;</span></span>
<span id="cb362-31"><a href="stats_validation.html#cb362-31" tabindex="-1"></a>      <span class="co"># , caption = form_temp</span></span>
<span id="cb362-32"><a href="stats_validation.html#cb362-32" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb362-33"><a href="stats_validation.html#cb362-33" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb362-34"><a href="stats_validation.html#cb362-34" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-269-1.png" width="1008" /></p>
<p>let’s compare these results to the results from our <a href="stats_validation.html#f_one_pred_mod_bays">one nominal predictor model above</a>, <a href="stats_validation.html#f_two_pred_mod_bays">two nominal predictor model above</a>, <a href="stats_validation.html#f_three_pred_mod_bays">three nominal predictor model above</a>, and <a href="stats_validation.html#f_4_pred_mod_bays">three nominal predictor + site effects model above</a></p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="stats_validation.html#cb363-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb363-2"><a href="stats_validation.html#cb363-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb363-3"><a href="stats_validation.html#cb363-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb363-4"><a href="stats_validation.html#cb363-4" tabindex="-1"></a>    brms_f_mod5</span>
<span id="cb363-5"><a href="stats_validation.html#cb363-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb363-6"><a href="stats_validation.html#cb363-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality)</span>
<span id="cb363-7"><a href="stats_validation.html#cb363-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb363-8"><a href="stats_validation.html#cb363-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod5&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb363-9"><a href="stats_validation.html#cb363-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb363-10"><a href="stats_validation.html#cb363-10" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb363-11"><a href="stats_validation.html#cb363-11" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb363-12"><a href="stats_validation.html#cb363-12" tabindex="-1"></a>      tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb363-13"><a href="stats_validation.html#cb363-13" tabindex="-1"></a>        brms_f_mod4</span>
<span id="cb363-14"><a href="stats_validation.html#cb363-14" tabindex="-1"></a>        <span class="co"># this part is crucial</span></span>
<span id="cb363-15"><a href="stats_validation.html#cb363-15" tabindex="-1"></a>        , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality)</span>
<span id="cb363-16"><a href="stats_validation.html#cb363-16" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb363-17"><a href="stats_validation.html#cb363-17" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod4&quot;</span>)</span>
<span id="cb363-18"><a href="stats_validation.html#cb363-18" tabindex="-1"></a>    , ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb363-19"><a href="stats_validation.html#cb363-19" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb363-20"><a href="stats_validation.html#cb363-20" tabindex="-1"></a>      tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb363-21"><a href="stats_validation.html#cb363-21" tabindex="-1"></a>        brms_f_mod3</span>
<span id="cb363-22"><a href="stats_validation.html#cb363-22" tabindex="-1"></a>        <span class="co"># this part is crucial</span></span>
<span id="cb363-23"><a href="stats_validation.html#cb363-23" tabindex="-1"></a>        , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality)</span>
<span id="cb363-24"><a href="stats_validation.html#cb363-24" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb363-25"><a href="stats_validation.html#cb363-25" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod3&quot;</span>)</span>
<span id="cb363-26"><a href="stats_validation.html#cb363-26" tabindex="-1"></a>    , ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb363-27"><a href="stats_validation.html#cb363-27" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb363-28"><a href="stats_validation.html#cb363-28" tabindex="-1"></a>      tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb363-29"><a href="stats_validation.html#cb363-29" tabindex="-1"></a>        brms_f_mod2</span>
<span id="cb363-30"><a href="stats_validation.html#cb363-30" tabindex="-1"></a>        <span class="co"># this part is crucial</span></span>
<span id="cb363-31"><a href="stats_validation.html#cb363-31" tabindex="-1"></a>        , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality)</span>
<span id="cb363-32"><a href="stats_validation.html#cb363-32" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb363-33"><a href="stats_validation.html#cb363-33" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod2&quot;</span>)</span>
<span id="cb363-34"><a href="stats_validation.html#cb363-34" tabindex="-1"></a>    , ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb363-35"><a href="stats_validation.html#cb363-35" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb363-36"><a href="stats_validation.html#cb363-36" tabindex="-1"></a>      tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(brms_f_mod1) <span class="sc">%&gt;%</span> </span>
<span id="cb363-37"><a href="stats_validation.html#cb363-37" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod1&quot;</span>)</span>
<span id="cb363-38"><a href="stats_validation.html#cb363-38" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb363-39"><a href="stats_validation.html#cb363-39" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> src, <span class="at">x =</span> value, <span class="at">color =</span> src, <span class="at">group =</span> src)) <span class="sc">+</span></span>
<span id="cb363-40"><a href="stats_validation.html#cb363-40" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_pointinterval</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb363-41"><a href="stats_validation.html#cb363-41" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(depth_maps_generation_quality), <span class="at">switch =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb363-42"><a href="stats_validation.html#cb363-42" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb363-43"><a href="stats_validation.html#cb363-43" tabindex="-1"></a>  <span class="co"># scale_color_viridis_d(option = &quot;turbo&quot;, begin = 0.2, end = 0.8) +</span></span>
<span id="cb363-44"><a href="stats_validation.html#cb363-44" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> viridis<span class="sc">::</span><span class="fu">turbo</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb363-45"><a href="stats_validation.html#cb363-45" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb363-46"><a href="stats_validation.html#cb363-46" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb363-47"><a href="stats_validation.html#cb363-47" tabindex="-1"></a>    , <span class="at">color =</span> <span class="st">&quot;model&quot;</span></span>
<span id="cb363-48"><a href="stats_validation.html#cb363-48" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb363-49"><a href="stats_validation.html#cb363-49" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb363-50"><a href="stats_validation.html#cb363-50" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-270-1.png" width="1008" /></p>
<p>we can also perform pairwise comparisons after collapsing across the filtering mode, software, and study site to compare the dense cloud quality setting effect</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="stats_validation.html#cb364-1" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span></span>
<span id="cb364-2"><a href="stats_validation.html#cb364-2" tabindex="-1"></a>  ptcld_validation_data <span class="sc">%&gt;%</span></span>
<span id="cb364-3"><a href="stats_validation.html#cb364-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb364-4"><a href="stats_validation.html#cb364-4" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb364-5"><a href="stats_validation.html#cb364-5" tabindex="-1"></a>      brms_f_mod5, <span class="at">allow_new_levels =</span> T</span>
<span id="cb364-6"><a href="stats_validation.html#cb364-6" tabindex="-1"></a>      <span class="co"># this part is crucial</span></span>
<span id="cb364-7"><a href="stats_validation.html#cb364-7" tabindex="-1"></a>      , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality)</span>
<span id="cb364-8"><a href="stats_validation.html#cb364-8" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb364-9"><a href="stats_validation.html#cb364-9" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb364-10"><a href="stats_validation.html#cb364-10" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb364-11"><a href="stats_validation.html#cb364-11" tabindex="-1"></a>      value</span>
<span id="cb364-12"><a href="stats_validation.html#cb364-12" tabindex="-1"></a>      , <span class="at">by =</span> depth_maps_generation_quality</span>
<span id="cb364-13"><a href="stats_validation.html#cb364-13" tabindex="-1"></a>      , <span class="at">comparison =</span> </span>
<span id="cb364-14"><a href="stats_validation.html#cb364-14" tabindex="-1"></a>        contrast_list</span>
<span id="cb364-15"><a href="stats_validation.html#cb364-15" tabindex="-1"></a>        <span class="co"># tidybayes::emmeans_comparison(&quot;revpairwise&quot;) </span></span>
<span id="cb364-16"><a href="stats_validation.html#cb364-16" tabindex="-1"></a>        <span class="co">#&quot;pairwise&quot;</span></span>
<span id="cb364-17"><a href="stats_validation.html#cb364-17" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb364-18"><a href="stats_validation.html#cb364-18" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> depth_maps_generation_quality)</span>
<span id="cb364-19"><a href="stats_validation.html#cb364-19" tabindex="-1"></a></span>
<span id="cb364-20"><a href="stats_validation.html#cb364-20" tabindex="-1"></a><span class="co"># separate contrast</span></span>
<span id="cb364-21"><a href="stats_validation.html#cb364-21" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb364-22"><a href="stats_validation.html#cb364-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb364-23"><a href="stats_validation.html#cb364-23" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(</span>
<span id="cb364-24"><a href="stats_validation.html#cb364-24" tabindex="-1"></a>    <span class="at">cols =</span> contrast</span>
<span id="cb364-25"><a href="stats_validation.html#cb364-25" tabindex="-1"></a>    , <span class="at">delim =</span> <span class="st">&quot; - &quot;</span></span>
<span id="cb364-26"><a href="stats_validation.html#cb364-26" tabindex="-1"></a>    , <span class="at">names =</span> <span class="fu">paste0</span>(</span>
<span id="cb364-27"><a href="stats_validation.html#cb364-27" tabindex="-1"></a>        <span class="st">&quot;sorter&quot;</span></span>
<span id="cb364-28"><a href="stats_validation.html#cb364-28" tabindex="-1"></a>        , <span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(stringr<span class="sc">::</span><span class="fu">str_count</span>(brms_contrast_temp<span class="sc">$</span>contrast, <span class="st">&quot;-&quot;</span>))<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb364-29"><a href="stats_validation.html#cb364-29" tabindex="-1"></a>      )</span>
<span id="cb364-30"><a href="stats_validation.html#cb364-30" tabindex="-1"></a>    , <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span></span>
<span id="cb364-31"><a href="stats_validation.html#cb364-31" tabindex="-1"></a>    , <span class="at">cols_remove =</span> F</span>
<span id="cb364-32"><a href="stats_validation.html#cb364-32" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb364-33"><a href="stats_validation.html#cb364-33" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sorter1<span class="sc">!=</span>sorter2) <span class="sc">%&gt;%</span> </span>
<span id="cb364-34"><a href="stats_validation.html#cb364-34" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb364-35"><a href="stats_validation.html#cb364-35" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb364-36"><a href="stats_validation.html#cb364-36" tabindex="-1"></a>      tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sorter&quot;</span>)</span>
<span id="cb364-37"><a href="stats_validation.html#cb364-37" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="cf">function</span>(x){<span class="fu">factor</span>(</span>
<span id="cb364-38"><a href="stats_validation.html#cb364-38" tabindex="-1"></a>        x, <span class="at">ordered =</span> T</span>
<span id="cb364-39"><a href="stats_validation.html#cb364-39" tabindex="-1"></a>        , <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_quality)</span>
<span id="cb364-40"><a href="stats_validation.html#cb364-40" tabindex="-1"></a>      )}</span>
<span id="cb364-41"><a href="stats_validation.html#cb364-41" tabindex="-1"></a>    )</span>
<span id="cb364-42"><a href="stats_validation.html#cb364-42" tabindex="-1"></a>    , <span class="at">contrast =</span> contrast <span class="sc">%&gt;%</span> </span>
<span id="cb364-43"><a href="stats_validation.html#cb364-43" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb364-44"><a href="stats_validation.html#cb364-44" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="fu">as.numeric</span>(sorter1), <span class="fu">as.numeric</span>(sorter2)) <span class="sc">%&gt;%</span> </span>
<span id="cb364-45"><a href="stats_validation.html#cb364-45" tabindex="-1"></a>        <span class="fu">as.numeric</span>()</span>
<span id="cb364-46"><a href="stats_validation.html#cb364-46" tabindex="-1"></a>      )</span>
<span id="cb364-47"><a href="stats_validation.html#cb364-47" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb364-48"><a href="stats_validation.html#cb364-48" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb364-49"><a href="stats_validation.html#cb364-49" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb364-50"><a href="stats_validation.html#cb364-50" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb364-51"><a href="stats_validation.html#cb364-51" tabindex="-1"></a></span>
<span id="cb364-52"><a href="stats_validation.html#cb364-52" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb364-53"><a href="stats_validation.html#cb364-53" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 400,000
## Columns: 16
## Groups: contrast [10]
## $ .chain              &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .iteration          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .draw               &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,…
## $ sorter1             &lt;ord&gt; ultra high, ultra high, ultra high, ultra high, ul…
## $ sorter2             &lt;ord&gt; high, high, high, high, high, high, high, high, hi…
## $ contrast            &lt;fct&gt; ultra high - high, ultra high - high, ultra high -…
## $ value               &lt;dbl&gt; 0.053864169, -0.037883065, -0.016463051, 0.2144155…
## $ median_hdi_est      &lt;dbl&gt; 0.02152888, 0.02152888, 0.02152888, 0.02152888, 0.…
## $ median_hdi_lower    &lt;dbl&gt; -0.1444545, -0.1444545, -0.1444545, -0.1444545, -0…
## $ median_hdi_upper    &lt;dbl&gt; 0.2009058, 0.2009058, 0.2009058, 0.2009058, 0.2009…
## $ is_gt_zero          &lt;lgl&gt; TRUE, FALSE, FALSE, TRUE, TRUE, FALSE, FALSE, TRUE…
## $ pct_gt_zero         &lt;dbl&gt; 0.6198, 0.6198, 0.6198, 0.6198, 0.6198, 0.6198, 0.…
## $ pct_gt_zero_lab     &lt;chr&gt; &quot;Pr(ultra high&gt;high)=62%&quot;, &quot;Pr(ultra high&gt;high)=62…
## $ pct_gt_zero_lab_sm  &lt;chr&gt; &quot;Pr(&gt;0)=62%&quot;, &quot;Pr(&gt;0)=62%&quot;, &quot;Pr(&gt;0)=62%&quot;, &quot;Pr(&gt;0)=…
## $ pct_gt_zero_lab_pos &lt;dbl&gt; 0.2159738, 0.2159738, 0.2159738, 0.2159738, 0.2159…
## $ sig_level           &lt;ord&gt; &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;8…</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="stats_validation.html#cb366-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb366-2"><a href="stats_validation.html#cb366-2" tabindex="-1"></a>  brms_contrast_temp</span>
<span id="cb366-3"><a href="stats_validation.html#cb366-3" tabindex="-1"></a>  <span class="co"># , caption_text = form_temp</span></span>
<span id="cb366-4"><a href="stats_validation.html#cb366-4" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;quality&quot;</span></span>
<span id="cb366-5"><a href="stats_validation.html#cb366-5" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-272-1.png" width="1008" /></p>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="stats_validation.html#cb367-1" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb367-2"><a href="stats_validation.html#cb367-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb367-3"><a href="stats_validation.html#cb367-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb367-4"><a href="stats_validation.html#cb367-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb367-5"><a href="stats_validation.html#cb367-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, value, .lower, .upper) <span class="sc">%&gt;%</span> </span>
<span id="cb367-6"><a href="stats_validation.html#cb367-6" tabindex="-1"></a>   </span>
<span id="cb367-7"><a href="stats_validation.html#cb367-7" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb367-8"><a href="stats_validation.html#cb367-8" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb367-9"><a href="stats_validation.html#cb367-9" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb367-10"><a href="stats_validation.html#cb367-10" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb367-11"><a href="stats_validation.html#cb367-11" tabindex="-1"></a>      <span class="st">&quot;quality contrast&quot;</span></span>
<span id="cb367-12"><a href="stats_validation.html#cb367-12" tabindex="-1"></a>      , <span class="st">&quot;difference (F-score)&quot;</span></span>
<span id="cb367-13"><a href="stats_validation.html#cb367-13" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb367-14"><a href="stats_validation.html#cb367-14" tabindex="-1"></a>    )</span>
<span id="cb367-15"><a href="stats_validation.html#cb367-15" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb367-16"><a href="stats_validation.html#cb367-16" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-273">Table 6.25: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;">
quality contrast
</th>
<th style="text-align:right;">
difference (F-score)
</th>
<th style="text-align:right;">
HDI low
</th>
<th style="text-align:right;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
0.20
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.27
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.32
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - lowest
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.46
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.29
</td>
</tr>
<tr>
<td style="text-align:left;">
high - lowest
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.43
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.36
</td>
</tr>
<tr>
<td style="text-align:left;">
low - lowest
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.31
</td>
</tr>
</tbody>
</table>
</div>
<div id="filtering---main-effect" class="section level4 hasAnchor" number="6.7.2.7">
<h4><span class="header-section-number">6.7.2.7</span> Filtering - main effect<a href="stats_validation.html#filtering---main-effect" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>let’s collapse across the dense cloud quality, software, and study site to compare the dense cloud quality setting effect.
In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="stats_validation.html#cb368-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb368-2"><a href="stats_validation.html#cb368-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb368-3"><a href="stats_validation.html#cb368-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb368-4"><a href="stats_validation.html#cb368-4" tabindex="-1"></a>    brms_f_mod5</span>
<span id="cb368-5"><a href="stats_validation.html#cb368-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb368-6"><a href="stats_validation.html#cb368-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode)</span>
<span id="cb368-7"><a href="stats_validation.html#cb368-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb368-8"><a href="stats_validation.html#cb368-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb368-9"><a href="stats_validation.html#cb368-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">med =</span> tidybayes<span class="sc">::</span><span class="fu">median_hdci</span>(value)<span class="sc">$</span>y) <span class="sc">%&gt;%</span> </span>
<span id="cb368-10"><a href="stats_validation.html#cb368-10" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb368-11"><a href="stats_validation.html#cb368-11" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb368-12"><a href="stats_validation.html#cb368-12" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb368-13"><a href="stats_validation.html#cb368-13" tabindex="-1"></a>      <span class="at">x =</span> value, <span class="at">y =</span> depth_maps_generation_filtering_mode</span>
<span id="cb368-14"><a href="stats_validation.html#cb368-14" tabindex="-1"></a>      <span class="co"># , fill = depth_maps_generation_filtering_mode</span></span>
<span id="cb368-15"><a href="stats_validation.html#cb368-15" tabindex="-1"></a>      , <span class="at">fill =</span> med</span>
<span id="cb368-16"><a href="stats_validation.html#cb368-16" tabindex="-1"></a>    )</span>
<span id="cb368-17"><a href="stats_validation.html#cb368-17" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb368-18"><a href="stats_validation.html#cb368-18" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb368-19"><a href="stats_validation.html#cb368-19" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb368-20"><a href="stats_validation.html#cb368-20" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;gray66&quot;</span></span>
<span id="cb368-21"><a href="stats_validation.html#cb368-21" tabindex="-1"></a>      , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_color =</span> <span class="st">&quot;gray66&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb368-22"><a href="stats_validation.html#cb368-22" tabindex="-1"></a>      , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb368-23"><a href="stats_validation.html#cb368-23" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb368-24"><a href="stats_validation.html#cb368-24" tabindex="-1"></a>    <span class="co"># scale_fill_viridis_d(option = &quot;plasma&quot;, drop = F) +</span></span>
<span id="cb368-25"><a href="stats_validation.html#cb368-25" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;mako&quot;</span>, <span class="at">direction=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb368-26"><a href="stats_validation.html#cb368-26" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb368-27"><a href="stats_validation.html#cb368-27" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb368-28"><a href="stats_validation.html#cb368-28" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;filtering mode&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb368-29"><a href="stats_validation.html#cb368-29" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI&quot;</span></span>
<span id="cb368-30"><a href="stats_validation.html#cb368-30" tabindex="-1"></a>      <span class="co"># , caption = form_temp</span></span>
<span id="cb368-31"><a href="stats_validation.html#cb368-31" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb368-32"><a href="stats_validation.html#cb368-32" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb368-33"><a href="stats_validation.html#cb368-33" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-274-1.png" width="1008" /></p>
<p>let’s compare these results to the results from our <a href="stats_validation.html#f_two_pred_mod_bays">two nominal predictor model above</a>, <a href="stats_validation.html#f_three_pred_mod_bays">three nominal predictor model above</a>, and <a href="stats_validation.html#f_4_pred_mod_bays">three nominal predictor + site model above</a></p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="stats_validation.html#cb369-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb369-2"><a href="stats_validation.html#cb369-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb369-3"><a href="stats_validation.html#cb369-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb369-4"><a href="stats_validation.html#cb369-4" tabindex="-1"></a>    brms_f_mod5</span>
<span id="cb369-5"><a href="stats_validation.html#cb369-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb369-6"><a href="stats_validation.html#cb369-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode)</span>
<span id="cb369-7"><a href="stats_validation.html#cb369-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb369-8"><a href="stats_validation.html#cb369-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod5&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb369-9"><a href="stats_validation.html#cb369-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb369-10"><a href="stats_validation.html#cb369-10" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb369-11"><a href="stats_validation.html#cb369-11" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb369-12"><a href="stats_validation.html#cb369-12" tabindex="-1"></a>      tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb369-13"><a href="stats_validation.html#cb369-13" tabindex="-1"></a>        brms_f_mod4</span>
<span id="cb369-14"><a href="stats_validation.html#cb369-14" tabindex="-1"></a>        <span class="co"># this part is crucial</span></span>
<span id="cb369-15"><a href="stats_validation.html#cb369-15" tabindex="-1"></a>        , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode)</span>
<span id="cb369-16"><a href="stats_validation.html#cb369-16" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb369-17"><a href="stats_validation.html#cb369-17" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod4&quot;</span>)</span>
<span id="cb369-18"><a href="stats_validation.html#cb369-18" tabindex="-1"></a>    , ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb369-19"><a href="stats_validation.html#cb369-19" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb369-20"><a href="stats_validation.html#cb369-20" tabindex="-1"></a>      tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb369-21"><a href="stats_validation.html#cb369-21" tabindex="-1"></a>        brms_f_mod3</span>
<span id="cb369-22"><a href="stats_validation.html#cb369-22" tabindex="-1"></a>        <span class="co"># this part is crucial</span></span>
<span id="cb369-23"><a href="stats_validation.html#cb369-23" tabindex="-1"></a>        , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode)</span>
<span id="cb369-24"><a href="stats_validation.html#cb369-24" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb369-25"><a href="stats_validation.html#cb369-25" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod3&quot;</span>)</span>
<span id="cb369-26"><a href="stats_validation.html#cb369-26" tabindex="-1"></a>    , ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb369-27"><a href="stats_validation.html#cb369-27" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb369-28"><a href="stats_validation.html#cb369-28" tabindex="-1"></a>      tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb369-29"><a href="stats_validation.html#cb369-29" tabindex="-1"></a>        brms_f_mod2</span>
<span id="cb369-30"><a href="stats_validation.html#cb369-30" tabindex="-1"></a>        <span class="co"># this part is crucial</span></span>
<span id="cb369-31"><a href="stats_validation.html#cb369-31" tabindex="-1"></a>        , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode)</span>
<span id="cb369-32"><a href="stats_validation.html#cb369-32" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb369-33"><a href="stats_validation.html#cb369-33" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod2&quot;</span>)</span>
<span id="cb369-34"><a href="stats_validation.html#cb369-34" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb369-35"><a href="stats_validation.html#cb369-35" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> src, <span class="at">x =</span> value, <span class="at">color =</span> src, <span class="at">group =</span> src)) <span class="sc">+</span></span>
<span id="cb369-36"><a href="stats_validation.html#cb369-36" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_pointinterval</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb369-37"><a href="stats_validation.html#cb369-37" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(depth_maps_generation_filtering_mode), <span class="at">switch =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb369-38"><a href="stats_validation.html#cb369-38" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb369-39"><a href="stats_validation.html#cb369-39" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> viridis<span class="sc">::</span><span class="fu">turbo</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]) <span class="sc">+</span></span>
<span id="cb369-40"><a href="stats_validation.html#cb369-40" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb369-41"><a href="stats_validation.html#cb369-41" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;filtering mode&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb369-42"><a href="stats_validation.html#cb369-42" tabindex="-1"></a>    , <span class="at">color =</span> <span class="st">&quot;model&quot;</span></span>
<span id="cb369-43"><a href="stats_validation.html#cb369-43" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb369-44"><a href="stats_validation.html#cb369-44" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb369-45"><a href="stats_validation.html#cb369-45" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-275-1.png" width="1008" /></p>
<p>we can also perform pairwise comparisons after collapsing across the dense cloud quality, software, and study site to compare the filtering mode setting effect.</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="stats_validation.html#cb370-1" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span></span>
<span id="cb370-2"><a href="stats_validation.html#cb370-2" tabindex="-1"></a>  ptcld_validation_data <span class="sc">%&gt;%</span></span>
<span id="cb370-3"><a href="stats_validation.html#cb370-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb370-4"><a href="stats_validation.html#cb370-4" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb370-5"><a href="stats_validation.html#cb370-5" tabindex="-1"></a>      brms_f_mod5, <span class="at">allow_new_levels =</span> T</span>
<span id="cb370-6"><a href="stats_validation.html#cb370-6" tabindex="-1"></a>      <span class="co"># this part is crucial</span></span>
<span id="cb370-7"><a href="stats_validation.html#cb370-7" tabindex="-1"></a>      , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode)</span>
<span id="cb370-8"><a href="stats_validation.html#cb370-8" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb370-9"><a href="stats_validation.html#cb370-9" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb370-10"><a href="stats_validation.html#cb370-10" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb370-11"><a href="stats_validation.html#cb370-11" tabindex="-1"></a>      value</span>
<span id="cb370-12"><a href="stats_validation.html#cb370-12" tabindex="-1"></a>      , <span class="at">by =</span> depth_maps_generation_filtering_mode</span>
<span id="cb370-13"><a href="stats_validation.html#cb370-13" tabindex="-1"></a>      , <span class="at">comparison =</span> <span class="st">&quot;pairwise&quot;</span></span>
<span id="cb370-14"><a href="stats_validation.html#cb370-14" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb370-15"><a href="stats_validation.html#cb370-15" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> depth_maps_generation_filtering_mode)</span>
<span id="cb370-16"><a href="stats_validation.html#cb370-16" tabindex="-1"></a></span>
<span id="cb370-17"><a href="stats_validation.html#cb370-17" tabindex="-1"></a><span class="co"># separate contrast</span></span>
<span id="cb370-18"><a href="stats_validation.html#cb370-18" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb370-19"><a href="stats_validation.html#cb370-19" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb370-20"><a href="stats_validation.html#cb370-20" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(</span>
<span id="cb370-21"><a href="stats_validation.html#cb370-21" tabindex="-1"></a>    <span class="at">cols =</span> contrast</span>
<span id="cb370-22"><a href="stats_validation.html#cb370-22" tabindex="-1"></a>    , <span class="at">delim =</span> <span class="st">&quot; - &quot;</span></span>
<span id="cb370-23"><a href="stats_validation.html#cb370-23" tabindex="-1"></a>    , <span class="at">names =</span> <span class="fu">paste0</span>(</span>
<span id="cb370-24"><a href="stats_validation.html#cb370-24" tabindex="-1"></a>        <span class="st">&quot;sorter&quot;</span></span>
<span id="cb370-25"><a href="stats_validation.html#cb370-25" tabindex="-1"></a>        , <span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(stringr<span class="sc">::</span><span class="fu">str_count</span>(brms_contrast_temp<span class="sc">$</span>contrast, <span class="st">&quot;-&quot;</span>))<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb370-26"><a href="stats_validation.html#cb370-26" tabindex="-1"></a>      )</span>
<span id="cb370-27"><a href="stats_validation.html#cb370-27" tabindex="-1"></a>    , <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span></span>
<span id="cb370-28"><a href="stats_validation.html#cb370-28" tabindex="-1"></a>    , <span class="at">cols_remove =</span> F</span>
<span id="cb370-29"><a href="stats_validation.html#cb370-29" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb370-30"><a href="stats_validation.html#cb370-30" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sorter1<span class="sc">!=</span>sorter2) <span class="sc">%&gt;%</span> </span>
<span id="cb370-31"><a href="stats_validation.html#cb370-31" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb370-32"><a href="stats_validation.html#cb370-32" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb370-33"><a href="stats_validation.html#cb370-33" tabindex="-1"></a>      tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sorter&quot;</span>)</span>
<span id="cb370-34"><a href="stats_validation.html#cb370-34" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="cf">function</span>(x){<span class="fu">factor</span>(</span>
<span id="cb370-35"><a href="stats_validation.html#cb370-35" tabindex="-1"></a>        x, <span class="at">ordered =</span> T</span>
<span id="cb370-36"><a href="stats_validation.html#cb370-36" tabindex="-1"></a>        , <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_filtering_mode)</span>
<span id="cb370-37"><a href="stats_validation.html#cb370-37" tabindex="-1"></a>      )}</span>
<span id="cb370-38"><a href="stats_validation.html#cb370-38" tabindex="-1"></a>    )</span>
<span id="cb370-39"><a href="stats_validation.html#cb370-39" tabindex="-1"></a>    , <span class="at">contrast =</span> contrast <span class="sc">%&gt;%</span> </span>
<span id="cb370-40"><a href="stats_validation.html#cb370-40" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb370-41"><a href="stats_validation.html#cb370-41" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="fu">as.numeric</span>(sorter1), <span class="fu">as.numeric</span>(sorter2)) <span class="sc">%&gt;%</span> </span>
<span id="cb370-42"><a href="stats_validation.html#cb370-42" tabindex="-1"></a>        <span class="fu">as.numeric</span>()</span>
<span id="cb370-43"><a href="stats_validation.html#cb370-43" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb370-44"><a href="stats_validation.html#cb370-44" tabindex="-1"></a>      <span class="co"># re order for filtering mode</span></span>
<span id="cb370-45"><a href="stats_validation.html#cb370-45" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_rev</span>()</span>
<span id="cb370-46"><a href="stats_validation.html#cb370-46" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb370-47"><a href="stats_validation.html#cb370-47" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb370-48"><a href="stats_validation.html#cb370-48" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb370-49"><a href="stats_validation.html#cb370-49" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb370-50"><a href="stats_validation.html#cb370-50" tabindex="-1"></a></span>
<span id="cb370-51"><a href="stats_validation.html#cb370-51" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb370-52"><a href="stats_validation.html#cb370-52" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 240,000
## Columns: 16
## Groups: contrast [6]
## $ .chain              &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .iteration          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .draw               &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,…
## $ sorter1             &lt;ord&gt; moderate, moderate, moderate, moderate, moderate, …
## $ sorter2             &lt;ord&gt; aggressive, aggressive, aggressive, aggressive, ag…
## $ contrast            &lt;fct&gt; moderate - aggressive, moderate - aggressive, mode…
## $ value               &lt;dbl&gt; -0.004160810, 0.035180245, -0.020259053, 0.0299755…
## $ median_hdi_est      &lt;dbl&gt; 0.007285959, 0.007285959, 0.007285959, 0.007285959…
## $ median_hdi_lower    &lt;dbl&gt; -0.07007631, -0.07007631, -0.07007631, -0.07007631…
## $ median_hdi_upper    &lt;dbl&gt; 0.113402, 0.113402, 0.113402, 0.113402, 0.113402, …
## $ is_gt_zero          &lt;lgl&gt; FALSE, TRUE, FALSE, TRUE, TRUE, FALSE, TRUE, TRUE,…
## $ pct_gt_zero         &lt;dbl&gt; 0.62895, 0.62895, 0.62895, 0.62895, 0.62895, 0.628…
## $ pct_gt_zero_lab     &lt;chr&gt; &quot;Pr(moderate&gt;aggressive)=63%&quot;, &quot;Pr(moderate&gt;aggres…
## $ pct_gt_zero_lab_sm  &lt;chr&gt; &quot;Pr(&gt;0)=63%&quot;, &quot;Pr(&gt;0)=63%&quot;, &quot;Pr(&gt;0)=63%&quot;, &quot;Pr(&gt;0)=…
## $ pct_gt_zero_lab_pos &lt;dbl&gt; 0.1219072, 0.1219072, 0.1219072, 0.1219072, 0.1219…
## $ sig_level           &lt;ord&gt; &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;8…</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="stats_validation.html#cb372-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb372-2"><a href="stats_validation.html#cb372-2" tabindex="-1"></a>  brms_contrast_temp</span>
<span id="cb372-3"><a href="stats_validation.html#cb372-3" tabindex="-1"></a>  <span class="co"># , caption_text = form_temp</span></span>
<span id="cb372-4"><a href="stats_validation.html#cb372-4" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;filtering mode&quot;</span></span>
<span id="cb372-5"><a href="stats_validation.html#cb372-5" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-277-1.png" width="1008" /></p>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="stats_validation.html#cb373-1" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb373-2"><a href="stats_validation.html#cb373-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb373-3"><a href="stats_validation.html#cb373-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb373-4"><a href="stats_validation.html#cb373-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb373-5"><a href="stats_validation.html#cb373-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, value, .lower, .upper) <span class="sc">%&gt;%</span> </span>
<span id="cb373-6"><a href="stats_validation.html#cb373-6" tabindex="-1"></a>   </span>
<span id="cb373-7"><a href="stats_validation.html#cb373-7" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb373-8"><a href="stats_validation.html#cb373-8" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb373-9"><a href="stats_validation.html#cb373-9" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb373-10"><a href="stats_validation.html#cb373-10" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb373-11"><a href="stats_validation.html#cb373-11" tabindex="-1"></a>      <span class="st">&quot;filtering mode contrast&quot;</span></span>
<span id="cb373-12"><a href="stats_validation.html#cb373-12" tabindex="-1"></a>      , <span class="st">&quot;difference (F-score)&quot;</span></span>
<span id="cb373-13"><a href="stats_validation.html#cb373-13" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb373-14"><a href="stats_validation.html#cb373-14" tabindex="-1"></a>    )</span>
<span id="cb373-15"><a href="stats_validation.html#cb373-15" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb373-16"><a href="stats_validation.html#cb373-16" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-278">Table 6.26: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;">
filtering mode contrast
</th>
<th style="text-align:right;">
difference (F-score)
</th>
<th style="text-align:right;">
HDI low
</th>
<th style="text-align:right;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
disabled - mild
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.08
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled - mild
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.08
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled - moderate
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled - aggressive
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.14
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled - aggressive
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.14
</td>
</tr>
<tr>
<td style="text-align:left;">
mild - moderate
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
mild - moderate
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
<tr>
<td style="text-align:left;">
mild - aggressive
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.14
</td>
</tr>
<tr>
<td style="text-align:left;">
moderate - aggressive
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
moderate - aggressive
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
</tbody>
</table>
</div>
<div id="software---main-effect" class="section level4 hasAnchor" number="6.7.2.8">
<h4><span class="header-section-number">6.7.2.8</span> Software - main effect<a href="stats_validation.html#software---main-effect" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>to address one of our main questions, let’s also collapse across the study site, dense cloud quality, and filtering mode setting to compare the software effect.
In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="stats_validation.html#cb374-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb374-2"><a href="stats_validation.html#cb374-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(software) <span class="sc">%&gt;%</span> </span>
<span id="cb374-3"><a href="stats_validation.html#cb374-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb374-4"><a href="stats_validation.html#cb374-4" tabindex="-1"></a>    brms_f_mod5</span>
<span id="cb374-5"><a href="stats_validation.html#cb374-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb374-6"><a href="stats_validation.html#cb374-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> software)</span>
<span id="cb374-7"><a href="stats_validation.html#cb374-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb374-8"><a href="stats_validation.html#cb374-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb374-9"><a href="stats_validation.html#cb374-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">med =</span> tidybayes<span class="sc">::</span><span class="fu">median_hdci</span>(value)<span class="sc">$</span>y) <span class="sc">%&gt;%</span> </span>
<span id="cb374-10"><a href="stats_validation.html#cb374-10" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb374-11"><a href="stats_validation.html#cb374-11" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb374-12"><a href="stats_validation.html#cb374-12" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb374-13"><a href="stats_validation.html#cb374-13" tabindex="-1"></a>      <span class="at">x =</span> value, <span class="at">y =</span> software</span>
<span id="cb374-14"><a href="stats_validation.html#cb374-14" tabindex="-1"></a>      <span class="co"># , fill = software</span></span>
<span id="cb374-15"><a href="stats_validation.html#cb374-15" tabindex="-1"></a>      , <span class="at">fill =</span> med</span>
<span id="cb374-16"><a href="stats_validation.html#cb374-16" tabindex="-1"></a>    )</span>
<span id="cb374-17"><a href="stats_validation.html#cb374-17" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb374-18"><a href="stats_validation.html#cb374-18" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb374-19"><a href="stats_validation.html#cb374-19" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb374-20"><a href="stats_validation.html#cb374-20" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;gray66&quot;</span></span>
<span id="cb374-21"><a href="stats_validation.html#cb374-21" tabindex="-1"></a>      , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_color =</span> <span class="st">&quot;gray66&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb374-22"><a href="stats_validation.html#cb374-22" tabindex="-1"></a>      , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb374-23"><a href="stats_validation.html#cb374-23" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb374-24"><a href="stats_validation.html#cb374-24" tabindex="-1"></a>    <span class="co"># scale_fill_viridis_d(option = &quot;rocket&quot;, begin = 0.3, end = 0.9, drop = F) +</span></span>
<span id="cb374-25"><a href="stats_validation.html#cb374-25" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;mako&quot;</span>, <span class="at">direction=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb374-26"><a href="stats_validation.html#cb374-26" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb374-27"><a href="stats_validation.html#cb374-27" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb374-28"><a href="stats_validation.html#cb374-28" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;software&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb374-29"><a href="stats_validation.html#cb374-29" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI&quot;</span></span>
<span id="cb374-30"><a href="stats_validation.html#cb374-30" tabindex="-1"></a>      <span class="co"># , caption = form_temp</span></span>
<span id="cb374-31"><a href="stats_validation.html#cb374-31" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb374-32"><a href="stats_validation.html#cb374-32" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb374-33"><a href="stats_validation.html#cb374-33" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-279-1.png" width="1008" /></p>
<p>let’s compare these results to the results from our <a href="stats_validation.html#f_three_pred_mod_bays">three nominal predictor model above</a> and <a href="stats_validation.html#f_4_pred_mod_bays">three nominal predictor + site effects model above</a></p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="stats_validation.html#cb375-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb375-2"><a href="stats_validation.html#cb375-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(software) <span class="sc">%&gt;%</span> </span>
<span id="cb375-3"><a href="stats_validation.html#cb375-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb375-4"><a href="stats_validation.html#cb375-4" tabindex="-1"></a>    brms_f_mod5</span>
<span id="cb375-5"><a href="stats_validation.html#cb375-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb375-6"><a href="stats_validation.html#cb375-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> software)</span>
<span id="cb375-7"><a href="stats_validation.html#cb375-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb375-8"><a href="stats_validation.html#cb375-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod5&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb375-9"><a href="stats_validation.html#cb375-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb375-10"><a href="stats_validation.html#cb375-10" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb375-11"><a href="stats_validation.html#cb375-11" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">distinct</span>(software) <span class="sc">%&gt;%</span> </span>
<span id="cb375-12"><a href="stats_validation.html#cb375-12" tabindex="-1"></a>      tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb375-13"><a href="stats_validation.html#cb375-13" tabindex="-1"></a>        brms_f_mod4</span>
<span id="cb375-14"><a href="stats_validation.html#cb375-14" tabindex="-1"></a>        <span class="co"># this part is crucial</span></span>
<span id="cb375-15"><a href="stats_validation.html#cb375-15" tabindex="-1"></a>        , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> software)</span>
<span id="cb375-16"><a href="stats_validation.html#cb375-16" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb375-17"><a href="stats_validation.html#cb375-17" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod4&quot;</span>)</span>
<span id="cb375-18"><a href="stats_validation.html#cb375-18" tabindex="-1"></a>    , ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb375-19"><a href="stats_validation.html#cb375-19" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">distinct</span>(software) <span class="sc">%&gt;%</span> </span>
<span id="cb375-20"><a href="stats_validation.html#cb375-20" tabindex="-1"></a>      tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb375-21"><a href="stats_validation.html#cb375-21" tabindex="-1"></a>        brms_f_mod3</span>
<span id="cb375-22"><a href="stats_validation.html#cb375-22" tabindex="-1"></a>        <span class="co"># this part is crucial</span></span>
<span id="cb375-23"><a href="stats_validation.html#cb375-23" tabindex="-1"></a>        , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> software)</span>
<span id="cb375-24"><a href="stats_validation.html#cb375-24" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb375-25"><a href="stats_validation.html#cb375-25" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value =</span> .epred, <span class="at">src =</span> <span class="st">&quot;brms_f_mod3&quot;</span>)</span>
<span id="cb375-26"><a href="stats_validation.html#cb375-26" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb375-27"><a href="stats_validation.html#cb375-27" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> src, <span class="at">x =</span> value, <span class="at">color =</span> src, <span class="at">group =</span> src)) <span class="sc">+</span></span>
<span id="cb375-28"><a href="stats_validation.html#cb375-28" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_pointinterval</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb375-29"><a href="stats_validation.html#cb375-29" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(software), <span class="at">switch =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb375-30"><a href="stats_validation.html#cb375-30" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb375-31"><a href="stats_validation.html#cb375-31" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> viridis<span class="sc">::</span><span class="fu">turbo</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]) <span class="sc">+</span></span>
<span id="cb375-32"><a href="stats_validation.html#cb375-32" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb375-33"><a href="stats_validation.html#cb375-33" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb375-34"><a href="stats_validation.html#cb375-34" tabindex="-1"></a>    , <span class="at">color =</span> <span class="st">&quot;model&quot;</span></span>
<span id="cb375-35"><a href="stats_validation.html#cb375-35" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb375-36"><a href="stats_validation.html#cb375-36" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb375-37"><a href="stats_validation.html#cb375-37" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-280-1.png" width="1008" /></p>
<p>we can also perform pairwise comparisons after collapsing across the filtering mode, dense cloud quality setting, and study site to compare the software main effect</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="stats_validation.html#cb376-1" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span></span>
<span id="cb376-2"><a href="stats_validation.html#cb376-2" tabindex="-1"></a>  ptcld_validation_data <span class="sc">%&gt;%</span></span>
<span id="cb376-3"><a href="stats_validation.html#cb376-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(software) <span class="sc">%&gt;%</span> </span>
<span id="cb376-4"><a href="stats_validation.html#cb376-4" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb376-5"><a href="stats_validation.html#cb376-5" tabindex="-1"></a>      brms_f_mod5, <span class="at">allow_new_levels =</span> T</span>
<span id="cb376-6"><a href="stats_validation.html#cb376-6" tabindex="-1"></a>      <span class="co"># this part is crucial</span></span>
<span id="cb376-7"><a href="stats_validation.html#cb376-7" tabindex="-1"></a>      , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> software)</span>
<span id="cb376-8"><a href="stats_validation.html#cb376-8" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb376-9"><a href="stats_validation.html#cb376-9" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb376-10"><a href="stats_validation.html#cb376-10" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb376-11"><a href="stats_validation.html#cb376-11" tabindex="-1"></a>      value</span>
<span id="cb376-12"><a href="stats_validation.html#cb376-12" tabindex="-1"></a>      , <span class="at">by =</span> software</span>
<span id="cb376-13"><a href="stats_validation.html#cb376-13" tabindex="-1"></a>      , <span class="at">comparison =</span> <span class="st">&quot;pairwise&quot;</span></span>
<span id="cb376-14"><a href="stats_validation.html#cb376-14" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb376-15"><a href="stats_validation.html#cb376-15" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> software) <span class="sc">%&gt;%</span> </span>
<span id="cb376-16"><a href="stats_validation.html#cb376-16" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb376-17"><a href="stats_validation.html#cb376-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast) <span class="sc">%&gt;%</span></span>
<span id="cb376-18"><a href="stats_validation.html#cb376-18" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb376-19"><a href="stats_validation.html#cb376-19" tabindex="-1"></a></span>
<span id="cb376-20"><a href="stats_validation.html#cb376-20" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb376-21"><a href="stats_validation.html#cb376-21" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 120,000
## Columns: 14
## Groups: contrast [3]
## $ .chain              &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .iteration          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .draw               &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,…
## $ contrast            &lt;chr&gt; &quot;OPENDRONEMAP - METASHAPE&quot;, &quot;OPENDRONEMAP - METASH…
## $ value               &lt;dbl&gt; 0.010268798, 0.001525174, -0.043253041, 0.12083930…
## $ median_hdi_est      &lt;dbl&gt; -0.008867835, -0.008867835, -0.008867835, -0.00886…
## $ median_hdi_lower    &lt;dbl&gt; -0.1637326, -0.1637326, -0.1637326, -0.1637326, -0…
## $ median_hdi_upper    &lt;dbl&gt; 0.1115038, 0.1115038, 0.1115038, 0.1115038, 0.1115…
## $ is_gt_zero          &lt;lgl&gt; FALSE, FALSE, TRUE, FALSE, FALSE, TRUE, TRUE, FALS…
## $ pct_gt_zero         &lt;dbl&gt; 0.602275, 0.602275, 0.602275, 0.602275, 0.602275, …
## $ pct_gt_zero_lab     &lt;chr&gt; &quot;Pr(MtaShp&gt;ODM)=60%&quot;, &quot;Pr(MtaShp&gt;ODM)=60%&quot;, &quot;Pr(Mt…
## $ pct_gt_zero_lab_sm  &lt;chr&gt; &quot;Pr(&lt;0)=60%&quot;, &quot;Pr(&lt;0)=60%&quot;, &quot;Pr(&lt;0)=60%&quot;, &quot;Pr(&lt;0)=…
## $ pct_gt_zero_lab_pos &lt;dbl&gt; -0.1760125, -0.1760125, -0.1760125, -0.1760125, -0…
## $ sig_level           &lt;ord&gt; &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;8…</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="stats_validation.html#cb378-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb378-2"><a href="stats_validation.html#cb378-2" tabindex="-1"></a>  brms_contrast_temp</span>
<span id="cb378-3"><a href="stats_validation.html#cb378-3" tabindex="-1"></a>  <span class="co"># , caption_text = form_temp</span></span>
<span id="cb378-4"><a href="stats_validation.html#cb378-4" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;software&quot;</span></span>
<span id="cb378-5"><a href="stats_validation.html#cb378-5" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-282-1.png" width="1008" /></p>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="stats_validation.html#cb379-1" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb379-2"><a href="stats_validation.html#cb379-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb379-3"><a href="stats_validation.html#cb379-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb379-4"><a href="stats_validation.html#cb379-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb379-5"><a href="stats_validation.html#cb379-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, value, .lower, .upper) <span class="sc">%&gt;%</span> </span>
<span id="cb379-6"><a href="stats_validation.html#cb379-6" tabindex="-1"></a>   </span>
<span id="cb379-7"><a href="stats_validation.html#cb379-7" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb379-8"><a href="stats_validation.html#cb379-8" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb379-9"><a href="stats_validation.html#cb379-9" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb379-10"><a href="stats_validation.html#cb379-10" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb379-11"><a href="stats_validation.html#cb379-11" tabindex="-1"></a>      <span class="st">&quot;software contrast&quot;</span></span>
<span id="cb379-12"><a href="stats_validation.html#cb379-12" tabindex="-1"></a>      , <span class="st">&quot;difference (F-score)&quot;</span></span>
<span id="cb379-13"><a href="stats_validation.html#cb379-13" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb379-14"><a href="stats_validation.html#cb379-14" tabindex="-1"></a>    )</span>
<span id="cb379-15"><a href="stats_validation.html#cb379-15" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb379-16"><a href="stats_validation.html#cb379-16" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-283">Table 6.27: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;">
software contrast
</th>
<th style="text-align:right;">
difference (F-score)
</th>
<th style="text-align:right;">
HDI low
</th>
<th style="text-align:right;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
OPENDRONEMAP - METASHAPE
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
-0.16
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - METASHAPE
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.13
</td>
<td style="text-align:right;">
-0.12
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - METASHAPE
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.18
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - OPENDRONEMAP
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
-0.09
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - OPENDRONEMAP
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.21
</td>
</tr>
</tbody>
</table>
</div>
<div id="sigma-posteriors" class="section level4 hasAnchor" number="6.7.2.9">
<h4><span class="header-section-number">6.7.2.9</span> <span class="math inline">\(\sigma\)</span> posteriors<a href="stats_validation.html#sigma-posteriors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Finally, we can quantify the variation in F-score by comparing the <span class="math inline">\(\sigma\)</span> (<code>sd</code>) posteriors</p>
<p><em>unsure about the scale of the <span class="math inline">\(\sigma\)</span> parameters are on in the beta model. Here, we invert the logit <code>sd</code> values from the model using <code>plogis()</code> which converts the parameter values to a probability/proportion (e.g.; 0-1) because they are parameters of the intercept and interaction effects so must be on the transformed (<code>link = "logit"</code>) scale…double check</em></p>
<p>For a phenomenally excellent overview of binary logistic regression and how to interpret coefficients, see Steven Miller’s most excellent lab <a href="https://post8000.svmiller.com/lab-scripts/logistic-regression-lab.html">script here</a></p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="stats_validation.html#cb380-1" tabindex="-1"></a><span class="co"># tidybayes::get_variables(brms_f_mod5)</span></span>
<span id="cb380-2"><a href="stats_validation.html#cb380-2" tabindex="-1"></a><span class="co"># extract the posterior draws</span></span>
<span id="cb380-3"><a href="stats_validation.html#cb380-3" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod5) <span class="sc">%&gt;%</span> </span>
<span id="cb380-4"><a href="stats_validation.html#cb380-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sd_&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb380-5"><a href="stats_validation.html#cb380-5" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(dplyr<span class="sc">::</span><span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb380-6"><a href="stats_validation.html#cb380-6" tabindex="-1"></a>  <span class="co"># dplyr::group_by(name) %&gt;% </span></span>
<span id="cb380-7"><a href="stats_validation.html#cb380-7" tabindex="-1"></a>  <span class="co"># tidybayes::median_hdi(value) %&gt;% </span></span>
<span id="cb380-8"><a href="stats_validation.html#cb380-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb380-9"><a href="stats_validation.html#cb380-9" tabindex="-1"></a>    <span class="at">name =</span> name <span class="sc">%&gt;%</span> </span>
<span id="cb380-10"><a href="stats_validation.html#cb380-10" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_quality&quot;</span>, <span class="st">&quot;quality&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb380-11"><a href="stats_validation.html#cb380-11" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span>, <span class="st">&quot;filtering&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb380-12"><a href="stats_validation.html#cb380-12" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(value)</span>
<span id="cb380-13"><a href="stats_validation.html#cb380-13" tabindex="-1"></a>    , <span class="at">value =</span> <span class="fu">plogis</span>(value)</span>
<span id="cb380-14"><a href="stats_validation.html#cb380-14" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb380-15"><a href="stats_validation.html#cb380-15" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb380-16"><a href="stats_validation.html#cb380-16" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> name)) <span class="sc">+</span></span>
<span id="cb380-17"><a href="stats_validation.html#cb380-17" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_dotsinterval</span>(</span>
<span id="cb380-18"><a href="stats_validation.html#cb380-18" tabindex="-1"></a>    <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb380-19"><a href="stats_validation.html#cb380-19" tabindex="-1"></a>    , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.04</span></span>
<span id="cb380-20"><a href="stats_validation.html#cb380-20" tabindex="-1"></a>    , <span class="at">shape =</span> <span class="dv">21</span> <span class="co">#, point_size = 3</span></span>
<span id="cb380-21"><a href="stats_validation.html#cb380-21" tabindex="-1"></a>    , <span class="at">quantiles =</span> <span class="dv">100</span></span>
<span id="cb380-22"><a href="stats_validation.html#cb380-22" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb380-23"><a href="stats_validation.html#cb380-23" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb380-24"><a href="stats_validation.html#cb380-24" tabindex="-1"></a>       <span class="co"># , caption = form_temp</span></span>
<span id="cb380-25"><a href="stats_validation.html#cb380-25" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb380-26"><a href="stats_validation.html#cb380-26" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-284-1.png" width="1008" /></p>
<p>Variance of study site is stronger than variance of depth map generation quality, but the posterior predictive distributions overlap a good deal. The study site (the “subjects” in our study) seems to have the overall strongest effect, but this comes with high uncertainty. Taken alone, the influence of quality, filtering, and software comes with huge uncertainty. This makes sense as the influence of software largely depends on the depth map generation quality, of which we are fairly certain. Filtering mode has the overall weakest effect on tree detection and this comes with relatively high certainty, especially conditional on the depth map generation quality.</p>
<p>and perform model selection via information criteria with the <code>brms::loo_compare()</code> function</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="stats_validation.html#cb381-1" tabindex="-1"></a>brms_f_mod5 <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">add_criterion</span>(brms_f_mod5, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</span>
<span id="cb381-2"><a href="stats_validation.html#cb381-2" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">loo_compare</span>(brms_f_mod1, brms_f_mod2, brms_f_mod3, brms_f_mod4, brms_f_mod5, <span class="at">criterion =</span> <span class="st">&quot;loo&quot;</span>)</span></code></pre></div>
<pre><code>##             elpd_diff se_diff
## brms_f_mod5   0.0       0.0  
## brms_f_mod4  -1.2       6.3  
## brms_f_mod3 -92.2      11.5  
## brms_f_mod1 -92.5      11.3  
## brms_f_mod2 -94.2      11.2</code></pre>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="stats_validation.html#cb383-1" tabindex="-1"></a><span class="co"># brms::model_weights(brms_f_mod1, brms_f_mod2, brms_f_mod3, brms_f_mod4) %&gt;% round(3)</span></span></code></pre></div>
</div>
<div id="additional-plots-for-export" class="section level4 hasAnchor" number="6.7.2.10">
<h4><span class="header-section-number">6.7.2.10</span> Additional Plots for Export<a href="stats_validation.html#additional-plots-for-export" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>patchwork</code> of F-score contrasts</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="stats_validation.html#cb384-1" tabindex="-1"></a>layout_temp <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb384-2"><a href="stats_validation.html#cb384-2" tabindex="-1"></a>    <span class="co"># area(t, l, b, r)</span></span>
<span id="cb384-3"><a href="stats_validation.html#cb384-3" tabindex="-1"></a>    patchwork<span class="sc">::</span><span class="fu">area</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb384-4"><a href="stats_validation.html#cb384-4" tabindex="-1"></a>    , patchwork<span class="sc">::</span><span class="fu">area</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb384-5"><a href="stats_validation.html#cb384-5" tabindex="-1"></a>    , patchwork<span class="sc">::</span><span class="fu">area</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">3</span>)</span>
<span id="cb384-6"><a href="stats_validation.html#cb384-6" tabindex="-1"></a>  )</span>
<span id="cb384-7"><a href="stats_validation.html#cb384-7" tabindex="-1"></a>  <span class="co"># check the layout</span></span>
<span id="cb384-8"><a href="stats_validation.html#cb384-8" tabindex="-1"></a>  <span class="co"># plot(layout_temp)</span></span>
<span id="cb384-9"><a href="stats_validation.html#cb384-9" tabindex="-1"></a><span class="do">############################</span></span>
<span id="cb384-10"><a href="stats_validation.html#cb384-10" tabindex="-1"></a><span class="co"># patchwork for height</span></span>
<span id="cb384-11"><a href="stats_validation.html#cb384-11" tabindex="-1"></a><span class="do">############################</span></span>
<span id="cb384-12"><a href="stats_validation.html#cb384-12" tabindex="-1"></a>  ptchwrk_qlty_sftwr_comp <span class="sc">+</span> </span>
<span id="cb384-13"><a href="stats_validation.html#cb384-13" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;A: Quality Contrast by Software&quot;</span>) <span class="sc">+</span></span>
<span id="cb384-14"><a href="stats_validation.html#cb384-14" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;gray88&quot;</span>, <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">size=</span><span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb384-15"><a href="stats_validation.html#cb384-15" tabindex="-1"></a>  ptchwrk_fltr_sftwr_comp <span class="sc">+</span> </span>
<span id="cb384-16"><a href="stats_validation.html#cb384-16" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;B: Filtering Mode Contrast by Software&quot;</span>) <span class="sc">+</span></span>
<span id="cb384-17"><a href="stats_validation.html#cb384-17" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;gray88&quot;</span>, <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">size=</span><span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb384-18"><a href="stats_validation.html#cb384-18" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">free</span>(</span>
<span id="cb384-19"><a href="stats_validation.html#cb384-19" tabindex="-1"></a>    ptchwrk_sftwr_qlty_comp <span class="sc">+</span> </span>
<span id="cb384-20"><a href="stats_validation.html#cb384-20" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;C: Software Contrast by Quality&quot;</span>) <span class="sc">+</span></span>
<span id="cb384-21"><a href="stats_validation.html#cb384-21" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;gray88&quot;</span>, <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">size=</span><span class="dv">3</span>)) ) <span class="sc">+</span></span>
<span id="cb384-22"><a href="stats_validation.html#cb384-22" tabindex="-1"></a>  <span class="co"># plot_annotation(tag_levels = list(c(&#39;#&#39;, &#39;&amp;&#39;), &#39;1&#39;)) +</span></span>
<span id="cb384-23"><a href="stats_validation.html#cb384-23" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(</span>
<span id="cb384-24"><a href="stats_validation.html#cb384-24" tabindex="-1"></a>    <span class="at">design =</span> layout_temp</span>
<span id="cb384-25"><a href="stats_validation.html#cb384-25" tabindex="-1"></a>    , <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.01</span>,<span class="dv">1</span>)</span>
<span id="cb384-26"><a href="stats_validation.html#cb384-26" tabindex="-1"></a>    , <span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.01</span>,<span class="dv">1</span>,<span class="fl">0.01</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb384-27"><a href="stats_validation.html#cb384-27" tabindex="-1"></a>  ) <span class="sc">&amp;</span></span>
<span id="cb384-28"><a href="stats_validation.html#cb384-28" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb384-29"><a href="stats_validation.html#cb384-29" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.58</span>,<span class="fl">0.96</span>)</span>
<span id="cb384-30"><a href="stats_validation.html#cb384-30" tabindex="-1"></a>    , <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="fl">0.4</span>)</span>
<span id="cb384-31"><a href="stats_validation.html#cb384-31" tabindex="-1"></a>    , <span class="at">labels =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="fl">0.4</span>) <span class="sc">%&gt;%</span> scales<span class="sc">::</span><span class="fu">number</span>(<span class="at">accuracy =</span> <span class="fl">0.1</span>)</span>
<span id="cb384-32"><a href="stats_validation.html#cb384-32" tabindex="-1"></a>  ) <span class="sc">&amp;</span></span>
<span id="cb384-33"><a href="stats_validation.html#cb384-33" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb384-34"><a href="stats_validation.html#cb384-34" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb384-35"><a href="stats_validation.html#cb384-35" tabindex="-1"></a>    , <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.0</span>)</span>
<span id="cb384-36"><a href="stats_validation.html#cb384-36" tabindex="-1"></a>    <span class="co"># , plot.background = element_rect(colour = &quot;gray88&quot;, fill=NA, size=3)</span></span>
<span id="cb384-37"><a href="stats_validation.html#cb384-37" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-287-1.png" width="1008" /></p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="stats_validation.html#cb385-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb385-2"><a href="stats_validation.html#cb385-2" tabindex="-1"></a>    <span class="at">filename =</span> <span class="fu">paste0</span>(<span class="st">&quot;../data/all_fscore_contrasts.jpeg&quot;</span>)</span>
<span id="cb385-3"><a href="stats_validation.html#cb385-3" tabindex="-1"></a>    , <span class="at">plot =</span> ggplot2<span class="sc">::</span><span class="fu">last_plot</span>()</span>
<span id="cb385-4"><a href="stats_validation.html#cb385-4" tabindex="-1"></a>    , <span class="at">width =</span> <span class="dv">11</span></span>
<span id="cb385-5"><a href="stats_validation.html#cb385-5" tabindex="-1"></a>    , <span class="at">height =</span> <span class="fl">8.5</span></span>
<span id="cb385-6"><a href="stats_validation.html#cb385-6" tabindex="-1"></a>    , <span class="at">units =</span> <span class="st">&quot;in&quot;</span></span>
<span id="cb385-7"><a href="stats_validation.html#cb385-7" tabindex="-1"></a>    , <span class="at">dpi =</span> <span class="st">&quot;print&quot;</span></span>
<span id="cb385-8"><a href="stats_validation.html#cb385-8" tabindex="-1"></a>  )</span></code></pre></div>
</div>
</div>
</div>
<div id="heterogeneous-variances-and-robustness-against-outliers" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> Heterogeneous variances and robustness against outliers<a href="stats_validation.html#heterogeneous-variances-and-robustness-against-outliers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In our previous model of the data <span class="math inline">\(y_i\)</span> described by a beta distribution with <a href="stats_validation.html#beta_mod">three nominal predictors and site effects</a> our <a href="stats_validation.html#ppcheck_mod5">posterior predictive checks</a> indicated potential improvements for our model fit.</p>
<p><a href="https://sites.google.com/site/doingbayesiandataanalysis/">Kruschke (2015)</a> notes:</p>
<blockquote>
<p>As was mentioned earlier in the chapter, we have assumed normally distributed data within groups, and equal variances across the groups, merely for simplicity and for consistency with traditional ANOVA. We can relax those assumptions in Bayesian software. In this section, we use t distributed noise instead of normal distributions, and we provide every group with its own standard-deviation parameter. Moreover, we put a hierarchical prior on the standard-deviation parameters, so that each group mutually informs the standard deviations of the other groups via the higher-level distribution…Instead of there being a single <span class="math inline">\(\sigma_y\)</span> parameter that applies to all groups, each group has its own scale parameter, <span class="math inline">\(\sigma_j\)</span>. (p. 573-574)</p>
</blockquote>
<p>and see section 20 from <a href="https://bookdown.org/content/3686/metric-predicted-variable-with-multiple-nominal-predictors.html#heterogeneous-variances-and-robustness-against-outliers-1">Kurz’s ebook supplement</a></p>
<div id="f_5_5_pred_mod_bays" class="section level3 hasAnchor" number="6.8.1">
<h3><span class="header-section-number">6.8.1</span> Bayesian<a href="stats_validation.html#f_5_5_pred_mod_bays" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With the beta likelihood our model with three nominal predictor variables, subject-level effects, and heterogeneous variances and robustness against outliers the model becomes:</p>
<p><span class="math display">\[\begin{align*}
y_{i} \sim &amp; {\sf Beta} \bigl(\mu_{i}, , \phi_{[jkf](i)} \bigr) \\
\operatorname{logit}(\mu_{i}) = &amp; \beta_0 \\
&amp; + \sum_{j} \beta_{1[j]} x_{1[j]} + \sum_{k} \beta_{2[k]} x_{2[k]} + \sum_{f} \beta_{3[f]} x_{3[f]} + \sum_{s} \beta_{4[s]} x_{4[s]}  \\
&amp; + \sum_{j,k} \beta_{1\times2[j,k]} x_{1\times2[j,k]} + \sum_{j,f} \beta_{1\times3[j,f]} x_{1\times3[j,f]} + \sum_{k,f} \beta_{2\times3[k,f]} x_{2\times3[k,f]} \\
&amp; + \sum_{j,k,f} \beta_{1\times2\times3[j,k,f]} x_{1\times2\times3[j,k,f]} \\
\beta_{0}  \sim &amp; {\sf Normal} (0,1) \\
\beta_{1[j]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{1}}) \\
\beta_{2[k]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{2}}) \\
\beta_{3[f]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{3}}) \\
\beta_{4[s]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{4}}) \\
\beta_{1\times2[j,k]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{1\times2}}) \\
\beta_{1\times3[j,f]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{1\times3}}) \\
\beta_{2\times3[k,f]}  \sim &amp; {\sf Normal} (0,\sigma_{\beta_{2\times3}}) \\
\sigma_{\beta_{1}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{2}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{3}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{4}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{1\times2}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{1\times3}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\sigma_{\beta_{2\times3}} \sim &amp; {\sf Gamma} (1.28,0.005) \\
\phi_{[jkf](i)} \sim &amp; {\sf Gamma} (\alpha,\theta) \\
\alpha \sim &amp; {\sf XXX} (xxx,xxx) \\
\theta \sim &amp; {\sf XXX} (xxx,xxx)
\end{align*}\]</span></p>
<p><em>!!!! Need to check how our <span class="math inline">\(\phi_{[jkf](i)}\)</span> is distributed</em></p>
<p>, where <span class="math inline">\(j\)</span> is the depth map generation quality setting corresponding to observation <span class="math inline">\(i\)</span>, <span class="math inline">\(k\)</span> is the depth map filtering mode setting corresponding to observation <span class="math inline">\(i\)</span>, <span class="math inline">\(f\)</span> is the processing software corresponding to observation <span class="math inline">\(i\)</span>, and <span class="math inline">\(s\)</span> is the study site corresponding to observation <span class="math inline">\(i\)</span></p>
<p><code>brms</code> allows us to model the precision (<span class="math inline">\(\phi\)</span>) but it is not required. If <span class="math inline">\(\phi\)</span> is not modeled, you still get a precision component, but it is universal across all the different coefficients (it doesn’t vary across any variables in the model). <a href="https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/#b-beta-regression-bayesian-style">Heiss</a> explains that:</p>
<blockquote>
<p>for whatever mathy reasons, when you don’t explicitly model the precision, the resulting coefficient in the table isn’t on the log scale—it’s a regular non-logged number, so there’s no need to exponentiate.</p>
</blockquote>
<p>in thie <code>brms</code> <a href="https://discourse.mc-stan.org/t/understanding-parameters-of-beta-family-in-brms/21640/8">community post</a> it is similarly noted that:</p>
<blockquote>
<p>If you don’t predict the parameters, you give priors for them on non-transformed scale. When you predict them, the predictors become linear coefficients as any other and work on the transformed scale - the transformations are specified by the link_XX parameters of the families (and you can change them if you need).</p>
</blockquote>
<p><em>Need to check our prior selection…just go with <code>brms</code> defaults for now</em></p>
<p>Now fit the model.</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="stats_validation.html#cb386-1" tabindex="-1"></a>brms_f_mod5_5 <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb386-2"><a href="stats_validation.html#cb386-2" tabindex="-1"></a>  <span class="at">formula =</span> brms<span class="sc">::</span><span class="fu">bf</span>(</span>
<span id="cb386-3"><a href="stats_validation.html#cb386-3" tabindex="-1"></a>  <span class="do">### model for y</span></span>
<span id="cb386-4"><a href="stats_validation.html#cb386-4" tabindex="-1"></a>    f_score <span class="sc">~</span> </span>
<span id="cb386-5"><a href="stats_validation.html#cb386-5" tabindex="-1"></a>    <span class="co"># baseline</span></span>
<span id="cb386-6"><a href="stats_validation.html#cb386-6" tabindex="-1"></a>    <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb386-7"><a href="stats_validation.html#cb386-7" tabindex="-1"></a>    <span class="co"># main effects</span></span>
<span id="cb386-8"><a href="stats_validation.html#cb386-8" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span></span>
<span id="cb386-9"><a href="stats_validation.html#cb386-9" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode) <span class="sc">+</span> </span>
<span id="cb386-10"><a href="stats_validation.html#cb386-10" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> software) <span class="sc">+</span></span>
<span id="cb386-11"><a href="stats_validation.html#cb386-11" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> study_site) <span class="sc">+</span> <span class="co"># only fitting main effects of site and not interactions</span></span>
<span id="cb386-12"><a href="stats_validation.html#cb386-12" tabindex="-1"></a>    <span class="co"># two-way interactions</span></span>
<span id="cb386-13"><a href="stats_validation.html#cb386-13" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode) <span class="sc">+</span></span>
<span id="cb386-14"><a href="stats_validation.html#cb386-14" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>software) <span class="sc">+</span></span>
<span id="cb386-15"><a href="stats_validation.html#cb386-15" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode<span class="sc">:</span>software) <span class="sc">+</span></span>
<span id="cb386-16"><a href="stats_validation.html#cb386-16" tabindex="-1"></a>    <span class="co"># three-way interactions</span></span>
<span id="cb386-17"><a href="stats_validation.html#cb386-17" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode<span class="sc">:</span>software)</span>
<span id="cb386-18"><a href="stats_validation.html#cb386-18" tabindex="-1"></a>  <span class="do">### model for phi</span></span>
<span id="cb386-19"><a href="stats_validation.html#cb386-19" tabindex="-1"></a>    , phi  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode<span class="sc">:</span>software)</span>
<span id="cb386-20"><a href="stats_validation.html#cb386-20" tabindex="-1"></a>  )</span>
<span id="cb386-21"><a href="stats_validation.html#cb386-21" tabindex="-1"></a>  , <span class="at">data =</span> ptcld_validation_data</span>
<span id="cb386-22"><a href="stats_validation.html#cb386-22" tabindex="-1"></a>  , <span class="at">family =</span> <span class="fu">Beta</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)</span>
<span id="cb386-23"><a href="stats_validation.html#cb386-23" tabindex="-1"></a>  , <span class="at">iter =</span> <span class="dv">20000</span>, <span class="at">warmup =</span> <span class="dv">10000</span>, <span class="at">chains =</span> <span class="dv">4</span></span>
<span id="cb386-24"><a href="stats_validation.html#cb386-24" tabindex="-1"></a>  , <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>, <span class="at">max_treedepth =</span> <span class="dv">13</span>)</span>
<span id="cb386-25"><a href="stats_validation.html#cb386-25" tabindex="-1"></a>  , <span class="at">cores =</span> <span class="fu">round</span>(parallel<span class="sc">::</span><span class="fu">detectCores</span>()<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb386-26"><a href="stats_validation.html#cb386-26" tabindex="-1"></a>  , <span class="at">file =</span> <span class="fu">paste0</span>(rootdir, <span class="st">&quot;/fits/brms_f_mod5_5&quot;</span>)</span>
<span id="cb386-27"><a href="stats_validation.html#cb386-27" tabindex="-1"></a>)</span>
<span id="cb386-28"><a href="stats_validation.html#cb386-28" tabindex="-1"></a><span class="co"># brms::make_stancode(brms_f_mod5_5)</span></span>
<span id="cb386-29"><a href="stats_validation.html#cb386-29" tabindex="-1"></a><span class="co"># print(brms_f_mod5_5)</span></span>
<span id="cb386-30"><a href="stats_validation.html#cb386-30" tabindex="-1"></a><span class="co"># brms::prior_summary(brms_f_mod5_5)</span></span></code></pre></div>
<div id="posterior-predictive-checks" class="section level4 hasAnchor" number="6.8.1.1">
<h4><span class="header-section-number">6.8.1.1</span> Posterior Predictive Checks<a href="stats_validation.html#posterior-predictive-checks" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Markov chain Monte Carlo (MCMC) simulations were conducted using the <code>brms</code> package (Bürkner 2017) to estimate posterior predictive distributions of the parameters of interest. We ran three chains of 100,000 iterations with the first 50,000 discarded as burn-in. Trace-plots were utilized to visually assess model convergence and sufficient convergence was checked with <span class="math inline">\(\hat{R}\)</span> values near 1 (<a href="https://scholar.google.com/scholar?cluster=14209404114665352991&amp;hl=en&amp;as_sdt=0,6">Brooks &amp; Gelman, 1998</a>). Posterior predictive checks were used to evaluate model goodness-of-fit by comparing data simulated from the model with the observed data used to estimate the model parameters (<a href="https://scholar.google.com/scholar?cluster=9228589188684720156&amp;hl=en&amp;as_sdt=0,6">Hobbs &amp; Hooten, 2015</a>). Calculating the proportion of MCMC iterations in which the test statistic (i.e., mean and sum of squares) from the simulated data and observed data are more extreme than one another provides the Bayesian P-value. Lack of fit is indicated by a value close to 0 or 1 while a value of 0.5 indicates perfect fit (<a href="https://scholar.google.com/scholar?cluster=9228589188684720156&amp;hl=en&amp;as_sdt=0,6">Hobbs &amp; Hooten, 2015</a>).</p>
<p>To learn more about this approach to posterior predictive checks, check out Gabry’s (2022) vignette, <a href="https://cran.r-project.org/web/packages/bayesplot/vignettes/graphical-ppcs.html">Graphical posterior predictive checks using the bayesplot package</a>.</p>
<p>check the trace plots for problems with convergence of the Markov chains</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="stats_validation.html#cb387-1" tabindex="-1"></a><span class="fu">plot</span>(brms_f_mod5_5)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-291-1.png" width="1008" /><img src="metashape_testing_files/figure-html/unnamed-chunk-291-2.png" width="1008" /><img src="metashape_testing_files/figure-html/unnamed-chunk-291-3.png" width="1008" /></p>
<p>and check our <span class="math inline">\(\hat{R}\)</span> values</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="stats_validation.html#cb388-1" tabindex="-1"></a>brms_f_mod5_5 <span class="sc">%&gt;%</span> </span>
<span id="cb388-2"><a href="stats_validation.html#cb388-2" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">rhat</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb388-3"><a href="stats_validation.html#cb388-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb388-4"><a href="stats_validation.html#cb388-4" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameter&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb388-5"><a href="stats_validation.html#cb388-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(tolower) <span class="sc">%&gt;%</span> </span>
<span id="cb388-6"><a href="stats_validation.html#cb388-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">rhat =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb388-7"><a href="stats_validation.html#cb388-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb388-8"><a href="stats_validation.html#cb388-8" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_starts</span>(parameter, <span class="st">&quot;b_&quot;</span>) </span>
<span id="cb388-9"><a href="stats_validation.html#cb388-9" tabindex="-1"></a>    <span class="sc">|</span> stringr<span class="sc">::</span><span class="fu">str_starts</span>(parameter, <span class="st">&quot;r_&quot;</span>) </span>
<span id="cb388-10"><a href="stats_validation.html#cb388-10" tabindex="-1"></a>    <span class="sc">|</span> stringr<span class="sc">::</span><span class="fu">str_starts</span>(parameter, <span class="st">&quot;sd_&quot;</span>) </span>
<span id="cb388-11"><a href="stats_validation.html#cb388-11" tabindex="-1"></a>    <span class="sc">|</span> parameter <span class="sc">==</span> <span class="st">&quot;phi&quot;</span></span>
<span id="cb388-12"><a href="stats_validation.html#cb388-12" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb388-13"><a href="stats_validation.html#cb388-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb388-14"><a href="stats_validation.html#cb388-14" tabindex="-1"></a>    <span class="at">parameter =</span> parameter <span class="sc">%&gt;%</span> </span>
<span id="cb388-15"><a href="stats_validation.html#cb388-15" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_quality&quot;</span>, <span class="st">&quot;quality&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb388-16"><a href="stats_validation.html#cb388-16" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span>, <span class="st">&quot;filtering&quot;</span>)</span>
<span id="cb388-17"><a href="stats_validation.html#cb388-17" tabindex="-1"></a>    , <span class="at">chk =</span> (rhat <span class="sc">&lt;=</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">0.998</span> <span class="sc">|</span> rhat <span class="sc">&gt;=</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">1.002</span>)</span>
<span id="cb388-18"><a href="stats_validation.html#cb388-18" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb388-19"><a href="stats_validation.html#cb388-19" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> rhat, <span class="at">y =</span> parameter, <span class="at">color =</span> chk, <span class="at">fill =</span> chk)) <span class="sc">+</span></span>
<span id="cb388-20"><a href="stats_validation.html#cb388-20" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray44&quot;</span>, <span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb388-21"><a href="stats_validation.html#cb388-21" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">0.998</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb388-22"><a href="stats_validation.html#cb388-22" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">1.002</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb388-23"><a href="stats_validation.html#cb388-23" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">0.999</span>, <span class="at">lwd =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="st">&quot;gray33&quot;</span>) <span class="sc">+</span></span>
<span id="cb388-24"><a href="stats_validation.html#cb388-24" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">1.001</span>, <span class="at">lwd =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="st">&quot;gray33&quot;</span>) <span class="sc">+</span></span>
<span id="cb388-25"><a href="stats_validation.html#cb388-25" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb388-26"><a href="stats_validation.html#cb388-26" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;firebrick&quot;</span>)) <span class="sc">+</span></span>
<span id="cb388-27"><a href="stats_validation.html#cb388-27" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;firebrick&quot;</span>)) <span class="sc">+</span></span>
<span id="cb388-28"><a href="stats_validation.html#cb388-28" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb388-29"><a href="stats_validation.html#cb388-29" tabindex="-1"></a>    <span class="at">x =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">hat{R}$&quot;</span>)</span>
<span id="cb388-30"><a href="stats_validation.html#cb388-30" tabindex="-1"></a>    , <span class="at">subtitle =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">&quot;posterior-predictive check for parameter $</span><span class="sc">\\</span><span class="st">hat{R}$ estimates&quot;</span>)</span>
<span id="cb388-31"><a href="stats_validation.html#cb388-31" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb388-32"><a href="stats_validation.html#cb388-32" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb388-33"><a href="stats_validation.html#cb388-33" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb388-34"><a href="stats_validation.html#cb388-34" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb388-35"><a href="stats_validation.html#cb388-35" tabindex="-1"></a>    , <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">4</span>)</span>
<span id="cb388-36"><a href="stats_validation.html#cb388-36" tabindex="-1"></a>    , <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb388-37"><a href="stats_validation.html#cb388-37" tabindex="-1"></a>    , <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb388-38"><a href="stats_validation.html#cb388-38" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-292-1.png" width="1008" /></p>
<p>posterior-predictive check to make sure the model does an okay job simulating data that resemble the sample data</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="stats_validation.html#cb389-1" tabindex="-1"></a><span class="co"># posterior predictive check</span></span>
<span id="cb389-2"><a href="stats_validation.html#cb389-2" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">pp_check</span>(</span>
<span id="cb389-3"><a href="stats_validation.html#cb389-3" tabindex="-1"></a>    brms_f_mod5_5</span>
<span id="cb389-4"><a href="stats_validation.html#cb389-4" tabindex="-1"></a>    , <span class="at">type =</span> <span class="st">&quot;dens_overlay&quot;</span></span>
<span id="cb389-5"><a href="stats_validation.html#cb389-5" tabindex="-1"></a>    , <span class="at">ndraws =</span> <span class="dv">100</span></span>
<span id="cb389-6"><a href="stats_validation.html#cb389-6" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb389-7"><a href="stats_validation.html#cb389-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;posterior-predictive check (overlaid densities)&quot;</span>) <span class="sc">+</span></span>
<span id="cb389-8"><a href="stats_validation.html#cb389-8" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb389-9"><a href="stats_validation.html#cb389-9" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb389-10"><a href="stats_validation.html#cb389-10" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb389-11"><a href="stats_validation.html#cb389-11" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb389-12"><a href="stats_validation.html#cb389-12" tabindex="-1"></a>    , <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb389-13"><a href="stats_validation.html#cb389-13" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-293-1.png" width="1008" /></p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="stats_validation.html#cb390-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="st">&quot;../data/ppchk_ovrll_mod5_5.png&quot;</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span>)</span></code></pre></div>
<p>another way</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="stats_validation.html#cb391-1" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">pp_check</span>(brms_f_mod5_5, <span class="at">type =</span> <span class="st">&quot;ecdf_overlay&quot;</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb391-2"><a href="stats_validation.html#cb391-2" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;posterior-predictive check (ECDF: empirical cumulative distribution function)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb391-3"><a href="stats_validation.html#cb391-3" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb391-4"><a href="stats_validation.html#cb391-4" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb391-5"><a href="stats_validation.html#cb391-5" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb391-6"><a href="stats_validation.html#cb391-6" tabindex="-1"></a>    , <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb391-7"><a href="stats_validation.html#cb391-7" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-294-1.png" width="1008" /></p>
<p>and another posterior predictive check for the overall model</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="stats_validation.html#cb392-1" tabindex="-1"></a><span class="co"># means</span></span>
<span id="cb392-2"><a href="stats_validation.html#cb392-2" tabindex="-1"></a>p1_temp <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(</span>
<span id="cb392-3"><a href="stats_validation.html#cb392-3" tabindex="-1"></a>    brms_f_mod5_5</span>
<span id="cb392-4"><a href="stats_validation.html#cb392-4" tabindex="-1"></a>    , <span class="at">type =</span> <span class="st">&quot;stat&quot;</span></span>
<span id="cb392-5"><a href="stats_validation.html#cb392-5" tabindex="-1"></a>    , <span class="at">stat =</span> <span class="st">&quot;mean&quot;</span></span>
<span id="cb392-6"><a href="stats_validation.html#cb392-6" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb392-7"><a href="stats_validation.html#cb392-7" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="cn">NULL</span>)) <span class="sc">+</span></span>
<span id="cb392-8"><a href="stats_validation.html#cb392-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;means&quot;</span>) <span class="sc">+</span></span>
<span id="cb392-9"><a href="stats_validation.html#cb392-9" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb392-10"><a href="stats_validation.html#cb392-10" tabindex="-1"></a><span class="co"># sds</span></span>
<span id="cb392-11"><a href="stats_validation.html#cb392-11" tabindex="-1"></a>p2_temp <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(</span>
<span id="cb392-12"><a href="stats_validation.html#cb392-12" tabindex="-1"></a>    brms_f_mod5_5</span>
<span id="cb392-13"><a href="stats_validation.html#cb392-13" tabindex="-1"></a>    , <span class="at">type =</span> <span class="st">&quot;stat&quot;</span></span>
<span id="cb392-14"><a href="stats_validation.html#cb392-14" tabindex="-1"></a>    , <span class="at">stat =</span> <span class="st">&quot;sd&quot;</span></span>
<span id="cb392-15"><a href="stats_validation.html#cb392-15" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb392-16"><a href="stats_validation.html#cb392-16" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="cn">NULL</span>)) <span class="sc">+</span></span>
<span id="cb392-17"><a href="stats_validation.html#cb392-17" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;sd&#39;s&quot;</span>) <span class="sc">+</span></span>
<span id="cb392-18"><a href="stats_validation.html#cb392-18" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb392-19"><a href="stats_validation.html#cb392-19" tabindex="-1"></a></span>
<span id="cb392-20"><a href="stats_validation.html#cb392-20" tabindex="-1"></a><span class="co"># combine </span></span>
<span id="cb392-21"><a href="stats_validation.html#cb392-21" tabindex="-1"></a>(p1_temp <span class="sc">+</span> p2_temp) <span class="sc">&amp;</span></span>
<span id="cb392-22"><a href="stats_validation.html#cb392-22" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb392-23"><a href="stats_validation.html#cb392-23" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb392-24"><a href="stats_validation.html#cb392-24" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Posterior-predictive statistical checks</span><span class="sc">\n</span><span class="st">overall model&quot;</span></span>
<span id="cb392-25"><a href="stats_validation.html#cb392-25" tabindex="-1"></a>    , <span class="at">subtitle =</span> <span class="fu">expression</span>(</span>
<span id="cb392-26"><a href="stats_validation.html#cb392-26" tabindex="-1"></a>      <span class="st">&quot;The dark blue lines are &quot;</span><span class="sc">*</span><span class="fu">italic</span>(<span class="fu">T</span>(y))<span class="sc">*</span><span class="st">&quot;, and the light blue bars are for &quot;</span><span class="sc">*</span><span class="fu">italic</span>(T)(<span class="fu">italic</span>(y)[rep])<span class="sc">*</span><span class="st">&quot;.&quot;</span>)</span>
<span id="cb392-27"><a href="stats_validation.html#cb392-27" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-295-1.png" width="1008" /></p>
<p>and another posterior predictive check for the overall model combining mean and sd</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="stats_validation.html#cb393-1" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">pp_check</span>(brms_f_mod5_5, <span class="at">type =</span> <span class="st">&quot;stat_2d&quot;</span>) <span class="sc">+</span></span>
<span id="cb393-2"><a href="stats_validation.html#cb393-2" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb393-3"><a href="stats_validation.html#cb393-3" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb393-4"><a href="stats_validation.html#cb393-4" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb393-5"><a href="stats_validation.html#cb393-5" tabindex="-1"></a>    , <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb393-6"><a href="stats_validation.html#cb393-6" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-296-1.png" width="1008" /></p>
<p>How’d we do capturing the conditional means and standard deviations by depth map generation quality?</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="stats_validation.html#cb394-1" tabindex="-1"></a><span class="co"># means</span></span>
<span id="cb394-2"><a href="stats_validation.html#cb394-2" tabindex="-1"></a>p1_temp <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(</span>
<span id="cb394-3"><a href="stats_validation.html#cb394-3" tabindex="-1"></a>    brms_f_mod5_5</span>
<span id="cb394-4"><a href="stats_validation.html#cb394-4" tabindex="-1"></a>    , <span class="at">type =</span> <span class="st">&quot;stat_grouped&quot;</span> <span class="co"># &quot;dens_overlay_grouped&quot;</span></span>
<span id="cb394-5"><a href="stats_validation.html#cb394-5" tabindex="-1"></a>    , <span class="at">stat =</span> <span class="st">&quot;mean&quot;</span></span>
<span id="cb394-6"><a href="stats_validation.html#cb394-6" tabindex="-1"></a>    , <span class="at">group =</span> <span class="st">&quot;depth_maps_generation_quality&quot;</span></span>
<span id="cb394-7"><a href="stats_validation.html#cb394-7" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb394-8"><a href="stats_validation.html#cb394-8" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="cn">NULL</span>)) <span class="sc">+</span></span>
<span id="cb394-9"><a href="stats_validation.html#cb394-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;means&quot;</span>) <span class="sc">+</span></span>
<span id="cb394-10"><a href="stats_validation.html#cb394-10" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(group), <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb394-11"><a href="stats_validation.html#cb394-11" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb394-12"><a href="stats_validation.html#cb394-12" tabindex="-1"></a><span class="co"># sds</span></span>
<span id="cb394-13"><a href="stats_validation.html#cb394-13" tabindex="-1"></a>p2_temp <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(</span>
<span id="cb394-14"><a href="stats_validation.html#cb394-14" tabindex="-1"></a>    brms_f_mod5_5</span>
<span id="cb394-15"><a href="stats_validation.html#cb394-15" tabindex="-1"></a>    , <span class="at">type =</span> <span class="st">&quot;stat_grouped&quot;</span> <span class="co"># &quot;dens_overlay_grouped&quot;</span></span>
<span id="cb394-16"><a href="stats_validation.html#cb394-16" tabindex="-1"></a>    , <span class="at">stat =</span> <span class="st">&quot;sd&quot;</span></span>
<span id="cb394-17"><a href="stats_validation.html#cb394-17" tabindex="-1"></a>    , <span class="at">group =</span> <span class="st">&quot;depth_maps_generation_quality&quot;</span></span>
<span id="cb394-18"><a href="stats_validation.html#cb394-18" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb394-19"><a href="stats_validation.html#cb394-19" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="cn">NULL</span>)) <span class="sc">+</span></span>
<span id="cb394-20"><a href="stats_validation.html#cb394-20" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;sd&#39;s&quot;</span>) <span class="sc">+</span></span>
<span id="cb394-21"><a href="stats_validation.html#cb394-21" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(group), <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb394-22"><a href="stats_validation.html#cb394-22" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb394-23"><a href="stats_validation.html#cb394-23" tabindex="-1"></a><span class="co"># combine </span></span>
<span id="cb394-24"><a href="stats_validation.html#cb394-24" tabindex="-1"></a>(p1_temp <span class="sc">/</span> p2_temp) <span class="sc">&amp;</span></span>
<span id="cb394-25"><a href="stats_validation.html#cb394-25" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb394-26"><a href="stats_validation.html#cb394-26" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb394-27"><a href="stats_validation.html#cb394-27" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Posterior-predictive statistical checks</span><span class="sc">\n</span><span class="st">by dense cloud quality&quot;</span></span>
<span id="cb394-28"><a href="stats_validation.html#cb394-28" tabindex="-1"></a>    , <span class="at">subtitle =</span> <span class="fu">expression</span>(</span>
<span id="cb394-29"><a href="stats_validation.html#cb394-29" tabindex="-1"></a>      <span class="st">&quot;The dark blue lines are &quot;</span><span class="sc">*</span><span class="fu">italic</span>(<span class="fu">T</span>(y))<span class="sc">*</span><span class="st">&quot;, and the light blue bars are for &quot;</span><span class="sc">*</span><span class="fu">italic</span>(T)(<span class="fu">italic</span>(y)[rep])<span class="sc">*</span><span class="st">&quot;.&quot;</span>)</span>
<span id="cb394-30"><a href="stats_validation.html#cb394-30" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-297-1.png" width="1008" /></p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="stats_validation.html#cb395-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="st">&quot;../data/ppchk_qlty_mod5_5.png&quot;</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span>)</span></code></pre></div>
<p>Both the means and sd’s of the F-score are well represented across the different levels of dense cloud quality</p>
<p>What about for the software?</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="stats_validation.html#cb396-1" tabindex="-1"></a><span class="fu">pp_check</span>(brms_f_mod5_5, <span class="st">&quot;dens_overlay_grouped&quot;</span>, <span class="at">group =</span> <span class="st">&quot;software&quot;</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb396-2"><a href="stats_validation.html#cb396-2" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;posterior-predictive check (overlaid densities)</span><span class="sc">\n</span><span class="st">by software&quot;</span>) <span class="sc">+</span></span>
<span id="cb396-3"><a href="stats_validation.html#cb396-3" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb396-4"><a href="stats_validation.html#cb396-4" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb396-5"><a href="stats_validation.html#cb396-5" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb396-6"><a href="stats_validation.html#cb396-6" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb396-7"><a href="stats_validation.html#cb396-7" tabindex="-1"></a>    , <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb396-8"><a href="stats_validation.html#cb396-8" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-298-1.png" width="1008" /></p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="stats_validation.html#cb397-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="st">&quot;../data/ppchk_sftwr_mod5_5.png&quot;</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span>)</span></code></pre></div>
<p>and what about for the filtering mode?</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="stats_validation.html#cb398-1" tabindex="-1"></a><span class="fu">pp_check</span>(brms_f_mod5_5, <span class="st">&quot;dens_overlay_grouped&quot;</span>, <span class="at">group =</span> <span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb398-2"><a href="stats_validation.html#cb398-2" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;posterior-predictive check (overlaid densities)</span><span class="sc">\n</span><span class="st">by filtering mode&quot;</span>) <span class="sc">+</span></span>
<span id="cb398-3"><a href="stats_validation.html#cb398-3" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb398-4"><a href="stats_validation.html#cb398-4" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb398-5"><a href="stats_validation.html#cb398-5" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb398-6"><a href="stats_validation.html#cb398-6" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb398-7"><a href="stats_validation.html#cb398-7" tabindex="-1"></a>    , <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb398-8"><a href="stats_validation.html#cb398-8" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-299-1.png" width="1008" /></p>
<p>We didn’t see much change in our posterior predictive checks compared to our previous model of the data <span class="math inline">\(y_i\)</span> described by a beta distribution with <a href="stats_validation.html#beta_mod">three nominal predictors and site effects</a> our <a href="stats_validation.html#ppcheck_mod5">posterior predictive checks</a>.</p>
<p>The Bayesian p-value is the probability that a test statistic in the reference distribution exceeds its value in the data. The Bayesian p-value is calculated from the posterior predictive distribution of the new data and the distribution of the observed data. We estimate the probability that the test statistic calculated from “new” data arising from our model (<span class="math inline">\(y_{new}\)</span>) is more extreme than the test statistic calculated from the observed data (<span class="math inline">\(y\)</span>): <span class="math inline">\(\text{P-value}(y) = Pr(T(y_{new}) &gt; T(y))\)</span> where the test statistic <span class="math inline">\(T(y)\)</span> describes the distribution of the data as a summary of the data; it could be the mean, variance, the coefﬁcient of variation, the kurtosis, the maximum, or the minimum of the observed data set, or it might be an “omnibus” statistic like a squared discrepancy or a chi-square value <a href="https://scholar.google.com/scholar?cluster=9228589188684720156&amp;oi=gsb&amp;hl=en&amp;as_sdt=0,6">Hobbs and Hooten (2015, p. 188)</a></p>
<blockquote>
<p>Bayesian P values for mean and standard deviation test statistics The P values for the mean (P mean) give the probability that the mean of the data of new, out-of-sample observations simulated from the model exceeds the mean of the observed data. The P values for the standard deviation (P SD) give the probability that the standard deviation of new, out-of-sample observations simulated from the model exceeds the standard deviation of the observed data. Large (<span class="math inline">\(\gtrapprox 0.90\)</span>) or small (<span class="math inline">\(\lessapprox 0.10\)</span>) values indicate lack of fit. <a href="https://scholar.google.com/scholar?cluster=9228589188684720156&amp;oi=gsb&amp;hl=en&amp;as_sdt=0,6">Hobbs and Hooten (2015)</a>;<a href="https://esajournals.onlinelibrary.wiley.com/doi/abs/10.1002/ecm.1598">Hobbs et al. (2024, Appendix S2 p. 8)</a></p>
</blockquote>
<p>Check the Bayesian p-values between the models</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="stats_validation.html#cb399-1" tabindex="-1"></a>get_mod_p_val <span class="ot">=</span> <span class="cf">function</span>(my_mod, <span class="at">ndraws =</span> <span class="dv">1000</span>){</span>
<span id="cb399-2"><a href="stats_validation.html#cb399-2" tabindex="-1"></a>  <span class="co"># get draws from the posterior predictive distribution</span></span>
<span id="cb399-3"><a href="stats_validation.html#cb399-3" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">posterior_predict</span>(my_mod, <span class="at">ndraws =</span> ndraws) <span class="sc">%&gt;%</span> </span>
<span id="cb399-4"><a href="stats_validation.html#cb399-4" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb399-5"><a href="stats_validation.html#cb399-5" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">draw =</span> dplyr<span class="sc">::</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb399-6"><a href="stats_validation.html#cb399-6" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>draw, <span class="at">values_to =</span> <span class="st">&quot;y_rep&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb399-7"><a href="stats_validation.html#cb399-7" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">y_n =</span> readr<span class="sc">::</span><span class="fu">parse_number</span>(name)) <span class="sc">%&gt;%</span> </span>
<span id="cb399-8"><a href="stats_validation.html#cb399-8" tabindex="-1"></a>    <span class="co"># join with original data</span></span>
<span id="cb399-9"><a href="stats_validation.html#cb399-9" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb399-10"><a href="stats_validation.html#cb399-10" tabindex="-1"></a>      ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb399-11"><a href="stats_validation.html#cb399-11" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(f_score) <span class="sc">%&gt;%</span> </span>
<span id="cb399-12"><a href="stats_validation.html#cb399-12" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">y=</span>f_score) <span class="sc">%&gt;%</span> </span>
<span id="cb399-13"><a href="stats_validation.html#cb399-13" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">y_n =</span> dplyr<span class="sc">::</span><span class="fu">row_number</span>())</span>
<span id="cb399-14"><a href="stats_validation.html#cb399-14" tabindex="-1"></a>      , <span class="at">by =</span> dplyr<span class="sc">::</span><span class="fu">join_by</span>(<span class="st">&quot;y_n&quot;</span>)</span>
<span id="cb399-15"><a href="stats_validation.html#cb399-15" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb399-16"><a href="stats_validation.html#cb399-16" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(y_n)) <span class="sc">%&gt;%</span> </span>
<span id="cb399-17"><a href="stats_validation.html#cb399-17" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(draw) <span class="sc">%&gt;%</span> </span>
<span id="cb399-18"><a href="stats_validation.html#cb399-18" tabindex="-1"></a>    <span class="co"># make test statistic</span></span>
<span id="cb399-19"><a href="stats_validation.html#cb399-19" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb399-20"><a href="stats_validation.html#cb399-20" tabindex="-1"></a>      <span class="co"># test statistics y</span></span>
<span id="cb399-21"><a href="stats_validation.html#cb399-21" tabindex="-1"></a>      <span class="at">mean_y =</span> <span class="fu">mean</span>(y)</span>
<span id="cb399-22"><a href="stats_validation.html#cb399-22" tabindex="-1"></a>      , <span class="at">sd_y =</span> <span class="fu">sd</span>(y)</span>
<span id="cb399-23"><a href="stats_validation.html#cb399-23" tabindex="-1"></a>      <span class="co"># test statistics y_sim</span></span>
<span id="cb399-24"><a href="stats_validation.html#cb399-24" tabindex="-1"></a>      , <span class="at">mean_y_rep =</span> <span class="fu">mean</span>(y_rep)</span>
<span id="cb399-25"><a href="stats_validation.html#cb399-25" tabindex="-1"></a>      , <span class="at">sd_y_rep =</span> <span class="fu">sd</span>(y_rep)</span>
<span id="cb399-26"><a href="stats_validation.html#cb399-26" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb399-27"><a href="stats_validation.html#cb399-27" tabindex="-1"></a>    <span class="co"># p-values</span></span>
<span id="cb399-28"><a href="stats_validation.html#cb399-28" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb399-29"><a href="stats_validation.html#cb399-29" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb399-30"><a href="stats_validation.html#cb399-30" tabindex="-1"></a>      <span class="at">p_val_mean =</span> <span class="fu">as.numeric</span>(mean_y_rep <span class="sc">&gt;</span> mean_y)</span>
<span id="cb399-31"><a href="stats_validation.html#cb399-31" tabindex="-1"></a>      , <span class="at">p_val_sd =</span> <span class="fu">as.numeric</span>(sd_y_rep <span class="sc">&gt;</span> sd_y)</span>
<span id="cb399-32"><a href="stats_validation.html#cb399-32" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb399-33"><a href="stats_validation.html#cb399-33" tabindex="-1"></a>    <span class="co"># summarize p-vals</span></span>
<span id="cb399-34"><a href="stats_validation.html#cb399-34" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb399-35"><a href="stats_validation.html#cb399-35" tabindex="-1"></a>      <span class="at">P.mean =</span> <span class="fu">mean</span>(p_val_mean)</span>
<span id="cb399-36"><a href="stats_validation.html#cb399-36" tabindex="-1"></a>      , <span class="at">P.sd =</span> <span class="fu">mean</span>(p_val_sd)</span>
<span id="cb399-37"><a href="stats_validation.html#cb399-37" tabindex="-1"></a>    )</span>
<span id="cb399-38"><a href="stats_validation.html#cb399-38" tabindex="-1"></a>}</span>
<span id="cb399-39"><a href="stats_validation.html#cb399-39" tabindex="-1"></a><span class="co"># get the model p-values</span></span>
<span id="cb399-40"><a href="stats_validation.html#cb399-40" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb399-41"><a href="stats_validation.html#cb399-41" tabindex="-1"></a>    <span class="fu">get_mod_p_val</span>(brms_f_mod4, <span class="at">ndraws =</span> <span class="dv">5000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb399-42"><a href="stats_validation.html#cb399-42" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;brms_f_mod4&quot;</span>)</span>
<span id="cb399-43"><a href="stats_validation.html#cb399-43" tabindex="-1"></a>    , <span class="fu">get_mod_p_val</span>(brms_f_mod5, <span class="at">ndraws =</span> <span class="dv">5000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb399-44"><a href="stats_validation.html#cb399-44" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;brms_f_mod5&quot;</span>)</span>
<span id="cb399-45"><a href="stats_validation.html#cb399-45" tabindex="-1"></a>    , <span class="fu">get_mod_p_val</span>(brms_f_mod5_5, <span class="at">ndraws =</span> <span class="dv">5000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb399-46"><a href="stats_validation.html#cb399-46" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;brms_f_mod5_5&quot;</span>)</span>
<span id="cb399-47"><a href="stats_validation.html#cb399-47" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb399-48"><a href="stats_validation.html#cb399-48" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb399-49"><a href="stats_validation.html#cb399-49" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb399-50"><a href="stats_validation.html#cb399-50" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
model
</th>
<th style="text-align:right;">
P.mean
</th>
<th style="text-align:right;">
P.sd
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
brms_f_mod4
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
0.61
</td>
</tr>
<tr>
<td style="text-align:left;">
brms_f_mod5
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.88
</td>
</tr>
<tr>
<td style="text-align:left;">
brms_f_mod5_5
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.87
</td>
</tr>
</tbody>
</table>
<p>perhaps we should use <code>brms_f_mod4</code> in which we <a href="stats_validation.html#f_4_pred_mod_bays">modeled F-score presuming a Gaussian likelihood</a>??? What are the pros and cons? Surely, an accurate representation of the <span class="math inline">\(y_i\)</span> data (as represented by the beta distribution) is meaningful even if “worse” p-values are found.</p>
<p>let’s perform model selection via information criteria with the <code>brms::loo_compare()</code> function to check</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="stats_validation.html#cb400-1" tabindex="-1"></a>brms_f_mod5_5 <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">add_criterion</span>(brms_f_mod5_5, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</span>
<span id="cb400-2"><a href="stats_validation.html#cb400-2" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">loo_compare</span>(brms_f_mod1, brms_f_mod2, brms_f_mod3, brms_f_mod4, brms_f_mod5, brms_f_mod5_5, <span class="at">criterion =</span> <span class="st">&quot;loo&quot;</span>)</span></code></pre></div>
<pre><code>##               elpd_diff se_diff
## brms_f_mod5     0.0       0.0  
## brms_f_mod4    -1.2       6.3  
## brms_f_mod5_5  -7.5       4.3  
## brms_f_mod3   -92.2      11.5  
## brms_f_mod1   -92.5      11.3  
## brms_f_mod2   -94.2      11.2</code></pre>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="stats_validation.html#cb402-1" tabindex="-1"></a><span class="co"># brms::model_weights(brms_f_mod1, brms_f_mod2, brms_f_mod3, brms_f_mod4) %&gt;% round(3)</span></span></code></pre></div>
<p>The information criteria suggests that we continue with <code>brms_f_mod5</code> in which <span class="math inline">\(y_i\)</span> is described by a beta distribution with <a href="stats_validation.html#beta_mod">three nominal predictors and site effects</a> and we did not model dispersion, instead using a single <span class="math inline">\(\phi_y\)</span> parameter that applies to all groups</p>
</div>
</div>
</div>
<div id="overstory-and-understory-validation" class="section level2 hasAnchor" number="6.9">
<h2><span class="header-section-number">6.9</span> Overstory and Understory Validation<a href="stats_validation.html#overstory-and-understory-validation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In our <a href="field_valid.html#field_valid">validation data creation process</a> we calculated F-score for overstory and understory trees separately.</p>
<p>Here, let’s add a factor variable with levels for overstory and understory as a predictor to our <a href="stats_validation.html#beta_mod">final model from above</a>.</p>
<p>The overall F-score is not the same as combining the overstory and understory F-score by calculating the mean of these values due to the differing number of observations in each. To build this model we need to convert our data to long format so that a row is also unique by our overstory/understory factor.</p>
<p>Each study site contributes one observation per dense cloud quality, filtering mode, software, and overstory/understory factor. That is, a row in the underlying data is unique by study site, software, dense cloud quality, filtering mode, and overstory/understory factor.</p>
<div id="summary-statistics-10" class="section level3 hasAnchor" number="6.9.1">
<h3><span class="header-section-number">6.9.1</span> Summary Statistics<a href="stats_validation.html#summary-statistics-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="stats_validation.html#cb403-1" tabindex="-1"></a>ou_ptcld_validation_data <span class="ot">=</span></span>
<span id="cb403-2"><a href="stats_validation.html#cb403-2" tabindex="-1"></a>  ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb403-3"><a href="stats_validation.html#cb403-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb403-4"><a href="stats_validation.html#cb403-4" tabindex="-1"></a>    study_site, software</span>
<span id="cb403-5"><a href="stats_validation.html#cb403-5" tabindex="-1"></a>    , depth_maps_generation_quality</span>
<span id="cb403-6"><a href="stats_validation.html#cb403-6" tabindex="-1"></a>    , depth_maps_generation_filtering_mode</span>
<span id="cb403-7"><a href="stats_validation.html#cb403-7" tabindex="-1"></a>    <span class="co"># our dependent var in wide format</span></span>
<span id="cb403-8"><a href="stats_validation.html#cb403-8" tabindex="-1"></a>    , understory_f_score, overstory_f_score</span>
<span id="cb403-9"><a href="stats_validation.html#cb403-9" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb403-10"><a href="stats_validation.html#cb403-10" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb403-11"><a href="stats_validation.html#cb403-11" tabindex="-1"></a>    <span class="at">cols =</span> tidyselect<span class="sc">::</span><span class="fu">ends_with</span>(<span class="st">&quot;_f_score&quot;</span>)</span>
<span id="cb403-12"><a href="stats_validation.html#cb403-12" tabindex="-1"></a>    , <span class="at">names_to =</span> <span class="st">&quot;story&quot;</span></span>
<span id="cb403-13"><a href="stats_validation.html#cb403-13" tabindex="-1"></a>    , <span class="at">values_to =</span> <span class="st">&quot;f_score&quot;</span></span>
<span id="cb403-14"><a href="stats_validation.html#cb403-14" tabindex="-1"></a>    , <span class="at">values_drop_na =</span> F</span>
<span id="cb403-15"><a href="stats_validation.html#cb403-15" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb403-16"><a href="stats_validation.html#cb403-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb403-17"><a href="stats_validation.html#cb403-17" tabindex="-1"></a>    <span class="at">story =</span> story <span class="sc">%&gt;%</span> stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(<span class="st">&quot;_f_score&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">factor</span>()</span>
<span id="cb403-18"><a href="stats_validation.html#cb403-18" tabindex="-1"></a>  )</span>
<span id="cb403-19"><a href="stats_validation.html#cb403-19" tabindex="-1"></a><span class="co"># what is this data?</span></span>
<span id="cb403-20"><a href="stats_validation.html#cb403-20" tabindex="-1"></a>ou_ptcld_validation_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 520
## Columns: 6
## $ study_site                           &lt;chr&gt; &quot;KAIBAB_HIGH&quot;, &quot;KAIBAB_HIGH&quot;, &quot;KA…
## $ software                             &lt;chr&gt; &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;METASH…
## $ depth_maps_generation_quality        &lt;ord&gt; high, high, high, high, high, hig…
## $ depth_maps_generation_filtering_mode &lt;ord&gt; aggressive, aggressive, disabled,…
## $ story                                &lt;fct&gt; understory, overstory, understory…
## $ f_score                              &lt;dbl&gt; 0.2634731, 0.3461179, 0.4105263, …</code></pre>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="stats_validation.html#cb405-1" tabindex="-1"></a><span class="co"># a row is unique by...</span></span>
<span id="cb405-2"><a href="stats_validation.html#cb405-2" tabindex="-1"></a><span class="fu">identical</span>(</span>
<span id="cb405-3"><a href="stats_validation.html#cb405-3" tabindex="-1"></a>  <span class="fu">nrow</span>(ou_ptcld_validation_data)</span>
<span id="cb405-4"><a href="stats_validation.html#cb405-4" tabindex="-1"></a>  , ou_ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb405-5"><a href="stats_validation.html#cb405-5" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(</span>
<span id="cb405-6"><a href="stats_validation.html#cb405-6" tabindex="-1"></a>      study_site, software</span>
<span id="cb405-7"><a href="stats_validation.html#cb405-7" tabindex="-1"></a>      , depth_maps_generation_quality</span>
<span id="cb405-8"><a href="stats_validation.html#cb405-8" tabindex="-1"></a>      , depth_maps_generation_filtering_mode</span>
<span id="cb405-9"><a href="stats_validation.html#cb405-9" tabindex="-1"></a>      , story</span>
<span id="cb405-10"><a href="stats_validation.html#cb405-10" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb405-11"><a href="stats_validation.html#cb405-11" tabindex="-1"></a>    <span class="fu">nrow</span>()</span>
<span id="cb405-12"><a href="stats_validation.html#cb405-12" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="stats_validation.html#cb407-1" tabindex="-1"></a><span class="co"># and we should have 2 times the rows as the orignial data</span></span>
<span id="cb407-2"><a href="stats_validation.html#cb407-2" tabindex="-1"></a><span class="fu">identical</span>(</span>
<span id="cb407-3"><a href="stats_validation.html#cb407-3" tabindex="-1"></a>  <span class="fu">nrow</span>(ou_ptcld_validation_data) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>() <span class="co"># long data</span></span>
<span id="cb407-4"><a href="stats_validation.html#cb407-4" tabindex="-1"></a>  , <span class="fu">nrow</span>(ptcld_validation_data)<span class="sc">*</span><span class="dv">2</span> <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>() <span class="co"># original wide data</span></span>
<span id="cb407-5"><a href="stats_validation.html#cb407-5" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>quick summary stats</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="stats_validation.html#cb409-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb409-2"><a href="stats_validation.html#cb409-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(tidyselect<span class="sc">::</span><span class="fu">ends_with</span>(<span class="st">&quot;_f_score&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb409-3"><a href="stats_validation.html#cb409-3" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>##  overstory_f_score understory_f_score
##  Min.   :0.0001    Min.   :0.0001    
##  1st Qu.:0.3250    1st Qu.:0.1372    
##  Median :0.4992    Median :0.3448    
##  Mean   :0.5163    Mean   :0.3271    
##  3rd Qu.:0.7297    3rd Qu.:0.5046    
##  Max.   :0.9408    Max.   :0.7419</code></pre>
<p>let’s check this data with our <code>geom_tile</code> plot</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="stats_validation.html#cb411-1" tabindex="-1"></a><span class="co"># create function for combining plots with patchwork</span></span>
<span id="cb411-2"><a href="stats_validation.html#cb411-2" tabindex="-1"></a>plt_tile_fn_temp <span class="ot">=</span> <span class="cf">function</span>(<span class="at">ss =</span> <span class="st">&quot;overstory&quot;</span>){</span>
<span id="cb411-3"><a href="stats_validation.html#cb411-3" tabindex="-1"></a>  ou_ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb411-4"><a href="stats_validation.html#cb411-4" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tolower</span>(story) <span class="sc">==</span> <span class="fu">tolower</span>(ss)) <span class="sc">%&gt;%</span> </span>
<span id="cb411-5"><a href="stats_validation.html#cb411-5" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(story, software, depth_maps_generation_quality, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span></span>
<span id="cb411-6"><a href="stats_validation.html#cb411-6" tabindex="-1"></a>    <span class="co"># collapse across study site</span></span>
<span id="cb411-7"><a href="stats_validation.html#cb411-7" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb411-8"><a href="stats_validation.html#cb411-8" tabindex="-1"></a>      <span class="at">mean_f_score =</span> <span class="fu">mean</span>(f_score, <span class="at">na.rm =</span> T)</span>
<span id="cb411-9"><a href="stats_validation.html#cb411-9" tabindex="-1"></a>      <span class="co"># , med_f_score = median(f_score, na.rm = T)</span></span>
<span id="cb411-10"><a href="stats_validation.html#cb411-10" tabindex="-1"></a>      , <span class="at">sd_f_score =</span> <span class="fu">sd</span>(f_score, <span class="at">na.rm =</span> T)</span>
<span id="cb411-11"><a href="stats_validation.html#cb411-11" tabindex="-1"></a>      , <span class="at">n =</span> dplyr<span class="sc">::</span><span class="fu">n</span>()</span>
<span id="cb411-12"><a href="stats_validation.html#cb411-12" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb411-13"><a href="stats_validation.html#cb411-13" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb411-14"><a href="stats_validation.html#cb411-14" tabindex="-1"></a>      <span class="at">y =</span> depth_maps_generation_quality</span>
<span id="cb411-15"><a href="stats_validation.html#cb411-15" tabindex="-1"></a>      , <span class="at">x =</span> depth_maps_generation_filtering_mode</span>
<span id="cb411-16"><a href="stats_validation.html#cb411-16" tabindex="-1"></a>      , <span class="at">fill =</span> mean_f_score</span>
<span id="cb411-17"><a href="stats_validation.html#cb411-17" tabindex="-1"></a>      , <span class="at">label =</span> <span class="fu">paste0</span>(scales<span class="sc">::</span><span class="fu">comma</span>(mean_f_score,<span class="at">accuracy =</span> <span class="fl">0.01</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">(n=&quot;</span>, n,<span class="st">&quot;)&quot;</span>)</span>
<span id="cb411-18"><a href="stats_validation.html#cb411-18" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb411-19"><a href="stats_validation.html#cb411-19" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb411-20"><a href="stats_validation.html#cb411-20" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb411-21"><a href="stats_validation.html#cb411-21" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(software)) <span class="sc">+</span> </span>
<span id="cb411-22"><a href="stats_validation.html#cb411-22" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb411-23"><a href="stats_validation.html#cb411-23" tabindex="-1"></a>    <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb411-24"><a href="stats_validation.html#cb411-24" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>(</span>
<span id="cb411-25"><a href="stats_validation.html#cb411-25" tabindex="-1"></a>      <span class="at">option =</span> <span class="st">&quot;cividis&quot;</span>, <span class="at">begin =</span> <span class="fl">0.3</span>, <span class="at">end =</span> <span class="fl">0.9</span></span>
<span id="cb411-26"><a href="stats_validation.html#cb411-26" tabindex="-1"></a>      , <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.75</span>)</span>
<span id="cb411-27"><a href="stats_validation.html#cb411-27" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb411-28"><a href="stats_validation.html#cb411-28" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb411-29"><a href="stats_validation.html#cb411-29" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">&quot;filtering mode&quot;</span></span>
<span id="cb411-30"><a href="stats_validation.html#cb411-30" tabindex="-1"></a>      , <span class="at">y =</span> <span class="st">&quot;quality&quot;</span></span>
<span id="cb411-31"><a href="stats_validation.html#cb411-31" tabindex="-1"></a>      , <span class="at">fill =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb411-32"><a href="stats_validation.html#cb411-32" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;mean F-score and # of study sites&quot;</span></span>
<span id="cb411-33"><a href="stats_validation.html#cb411-33" tabindex="-1"></a>      , <span class="at">title =</span> <span class="fu">toupper</span>(ss)</span>
<span id="cb411-34"><a href="stats_validation.html#cb411-34" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb411-35"><a href="stats_validation.html#cb411-35" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span> </span>
<span id="cb411-36"><a href="stats_validation.html#cb411-36" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb411-37"><a href="stats_validation.html#cb411-37" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb411-38"><a href="stats_validation.html#cb411-38" tabindex="-1"></a>      , <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb411-39"><a href="stats_validation.html#cb411-39" tabindex="-1"></a>      , <span class="at">panel.background =</span> <span class="fu">element_blank</span>()</span>
<span id="cb411-40"><a href="stats_validation.html#cb411-40" tabindex="-1"></a>      , <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb411-41"><a href="stats_validation.html#cb411-41" tabindex="-1"></a>      , <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb411-42"><a href="stats_validation.html#cb411-42" tabindex="-1"></a>      , <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb411-43"><a href="stats_validation.html#cb411-43" tabindex="-1"></a>      , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb411-44"><a href="stats_validation.html#cb411-44" tabindex="-1"></a>    )</span>
<span id="cb411-45"><a href="stats_validation.html#cb411-45" tabindex="-1"></a>}</span>
<span id="cb411-46"><a href="stats_validation.html#cb411-46" tabindex="-1"></a><span class="fu">plt_tile_fn_temp</span>(<span class="st">&quot;overstory&quot;</span>) <span class="sc">/</span> <span class="fu">plt_tile_fn_temp</span>(<span class="st">&quot;understory&quot;</span>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-305-1.png" width="1008" /></p>
<p>now let’s check by our other predictor variables</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="stats_validation.html#cb412-1" tabindex="-1"></a>sum_stats_dta <span class="ot">=</span> <span class="cf">function</span>(my_var){</span>
<span id="cb412-2"><a href="stats_validation.html#cb412-2" tabindex="-1"></a>  sum_fns <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb412-3"><a href="stats_validation.html#cb412-3" tabindex="-1"></a>    <span class="at">n =</span> <span class="sc">~</span><span class="fu">sum</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(.x), <span class="dv">0</span>, <span class="dv">1</span>))  </span>
<span id="cb412-4"><a href="stats_validation.html#cb412-4" tabindex="-1"></a>    , <span class="at">min =</span> <span class="sc">~</span><span class="fu">min</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb412-5"><a href="stats_validation.html#cb412-5" tabindex="-1"></a>    , <span class="at">max =</span> <span class="sc">~</span><span class="fu">max</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb412-6"><a href="stats_validation.html#cb412-6" tabindex="-1"></a>    , <span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb412-7"><a href="stats_validation.html#cb412-7" tabindex="-1"></a>    , <span class="at">median =</span> <span class="sc">~</span><span class="fu">median</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb412-8"><a href="stats_validation.html#cb412-8" tabindex="-1"></a>    , <span class="at">sd =</span> <span class="sc">~</span><span class="fu">sd</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb412-9"><a href="stats_validation.html#cb412-9" tabindex="-1"></a>  )</span>
<span id="cb412-10"><a href="stats_validation.html#cb412-10" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb412-11"><a href="stats_validation.html#cb412-11" tabindex="-1"></a>  (</span>
<span id="cb412-12"><a href="stats_validation.html#cb412-12" tabindex="-1"></a>    <span class="fu">ggplot</span>(</span>
<span id="cb412-13"><a href="stats_validation.html#cb412-13" tabindex="-1"></a>      <span class="at">data =</span> ou_ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb412-14"><a href="stats_validation.html#cb412-14" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">group_by</span>(.data[[my_var]]) <span class="sc">%&gt;%</span></span>
<span id="cb412-15"><a href="stats_validation.html#cb412-15" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">m =</span> <span class="fu">median</span>(f_score))</span>
<span id="cb412-16"><a href="stats_validation.html#cb412-16" tabindex="-1"></a>      , <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb412-17"><a href="stats_validation.html#cb412-17" tabindex="-1"></a>        <span class="at">y =</span> .data[[my_var]]</span>
<span id="cb412-18"><a href="stats_validation.html#cb412-18" tabindex="-1"></a>        , <span class="at">x =</span> f_score, <span class="at">fill =</span> m)</span>
<span id="cb412-19"><a href="stats_validation.html#cb412-19" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb412-20"><a href="stats_validation.html#cb412-20" tabindex="-1"></a>      <span class="fu">geom_violin</span>(<span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb412-21"><a href="stats_validation.html#cb412-21" tabindex="-1"></a>      <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb412-22"><a href="stats_validation.html#cb412-22" tabindex="-1"></a>      <span class="fu">geom_rug</span>() <span class="sc">+</span></span>
<span id="cb412-23"><a href="stats_validation.html#cb412-23" tabindex="-1"></a>      <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(story)) <span class="sc">+</span></span>
<span id="cb412-24"><a href="stats_validation.html#cb412-24" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;mako&quot;</span>, <span class="at">begin =</span> <span class="fl">0.3</span>, <span class="at">end =</span> <span class="fl">0.9</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb412-25"><a href="stats_validation.html#cb412-25" tabindex="-1"></a>      <span class="fu">labs</span>(</span>
<span id="cb412-26"><a href="stats_validation.html#cb412-26" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb412-27"><a href="stats_validation.html#cb412-27" tabindex="-1"></a>        , <span class="at">y =</span> stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(my_var, <span class="at">pattern =</span> <span class="st">&quot;_&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb412-28"><a href="stats_validation.html#cb412-28" tabindex="-1"></a>        , <span class="at">subtitle =</span> stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(my_var, <span class="at">pattern =</span> <span class="st">&quot;_&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot; &quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb412-29"><a href="stats_validation.html#cb412-29" tabindex="-1"></a>          stringr<span class="sc">::</span><span class="fu">str_to_title</span>()</span>
<span id="cb412-30"><a href="stats_validation.html#cb412-30" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb412-31"><a href="stats_validation.html#cb412-31" tabindex="-1"></a>      <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb412-32"><a href="stats_validation.html#cb412-32" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span>
<span id="cb412-33"><a href="stats_validation.html#cb412-33" tabindex="-1"></a>  )</span>
<span id="cb412-34"><a href="stats_validation.html#cb412-34" tabindex="-1"></a>  </span>
<span id="cb412-35"><a href="stats_validation.html#cb412-35" tabindex="-1"></a>}</span>
<span id="cb412-36"><a href="stats_validation.html#cb412-36" tabindex="-1"></a><span class="co"># sum_stats_dta(&quot;software&quot;)</span></span></code></pre></div>
<p>summarize for all variables of interest</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="stats_validation.html#cb413-1" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;software&quot;</span>, <span class="st">&quot;study_site&quot;</span></span>
<span id="cb413-2"><a href="stats_validation.html#cb413-2" tabindex="-1"></a>  , <span class="st">&quot;depth_maps_generation_quality&quot;</span></span>
<span id="cb413-3"><a href="stats_validation.html#cb413-3" tabindex="-1"></a>  , <span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span></span>
<span id="cb413-4"><a href="stats_validation.html#cb413-4" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb413-5"><a href="stats_validation.html#cb413-5" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(sum_stats_dta)</span></code></pre></div>
<pre><code>## [[1]]</code></pre>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-307-1.png" width="1008" /></p>
<pre><code>## 
## [[2]]</code></pre>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-307-2.png" width="1008" /></p>
<pre><code>## 
## [[3]]</code></pre>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-307-3.png" width="1008" /></p>
<pre><code>## 
## [[4]]</code></pre>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-307-4.png" width="1008" /></p>
</div>
<div id="f_6_pred_mod_bays" class="section level3 hasAnchor" number="6.9.2">
<h3><span class="header-section-number">6.9.2</span> Bayesian<a href="stats_validation.html#f_6_pred_mod_bays" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>Need to check our prior selection…just go with <code>brms</code> defaults for now</em></p>
<p>Now fit the model.</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="stats_validation.html#cb418-1" tabindex="-1"></a>brms_f_mod6 <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">brm</span>(</span>
<span id="cb418-2"><a href="stats_validation.html#cb418-2" tabindex="-1"></a>  <span class="at">formula =</span> f_score <span class="sc">~</span> </span>
<span id="cb418-3"><a href="stats_validation.html#cb418-3" tabindex="-1"></a>    <span class="co"># baseline</span></span>
<span id="cb418-4"><a href="stats_validation.html#cb418-4" tabindex="-1"></a>    <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb418-5"><a href="stats_validation.html#cb418-5" tabindex="-1"></a>    <span class="co"># main effects</span></span>
<span id="cb418-6"><a href="stats_validation.html#cb418-6" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span></span>
<span id="cb418-7"><a href="stats_validation.html#cb418-7" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode) <span class="sc">+</span> </span>
<span id="cb418-8"><a href="stats_validation.html#cb418-8" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> software) <span class="sc">+</span></span>
<span id="cb418-9"><a href="stats_validation.html#cb418-9" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> story) <span class="sc">+</span></span>
<span id="cb418-10"><a href="stats_validation.html#cb418-10" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> study_site) <span class="sc">+</span> <span class="co"># only fitting main effects of site and not interactions</span></span>
<span id="cb418-11"><a href="stats_validation.html#cb418-11" tabindex="-1"></a>    <span class="co"># two-way interactions</span></span>
<span id="cb418-12"><a href="stats_validation.html#cb418-12" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode) <span class="sc">+</span></span>
<span id="cb418-13"><a href="stats_validation.html#cb418-13" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>software) <span class="sc">+</span></span>
<span id="cb418-14"><a href="stats_validation.html#cb418-14" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode<span class="sc">:</span>software) <span class="sc">+</span></span>
<span id="cb418-15"><a href="stats_validation.html#cb418-15" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>story) <span class="sc">+</span></span>
<span id="cb418-16"><a href="stats_validation.html#cb418-16" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode<span class="sc">:</span>story) <span class="sc">+</span></span>
<span id="cb418-17"><a href="stats_validation.html#cb418-17" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> software<span class="sc">:</span>story) <span class="sc">+</span></span>
<span id="cb418-18"><a href="stats_validation.html#cb418-18" tabindex="-1"></a>    <span class="co"># three-way interactions</span></span>
<span id="cb418-19"><a href="stats_validation.html#cb418-19" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode<span class="sc">:</span>software) <span class="sc">+</span></span>
<span id="cb418-20"><a href="stats_validation.html#cb418-20" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode<span class="sc">:</span>story) <span class="sc">+</span></span>
<span id="cb418-21"><a href="stats_validation.html#cb418-21" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>software<span class="sc">:</span>story) <span class="sc">+</span></span>
<span id="cb418-22"><a href="stats_validation.html#cb418-22" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode<span class="sc">:</span>software<span class="sc">:</span>story) <span class="sc">+</span></span>
<span id="cb418-23"><a href="stats_validation.html#cb418-23" tabindex="-1"></a>    <span class="co"># four-way interactions</span></span>
<span id="cb418-24"><a href="stats_validation.html#cb418-24" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode<span class="sc">:</span>software<span class="sc">:</span>story)</span>
<span id="cb418-25"><a href="stats_validation.html#cb418-25" tabindex="-1"></a>  , <span class="at">data =</span> ou_ptcld_validation_data</span>
<span id="cb418-26"><a href="stats_validation.html#cb418-26" tabindex="-1"></a>  , <span class="at">family =</span> <span class="fu">Beta</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)</span>
<span id="cb418-27"><a href="stats_validation.html#cb418-27" tabindex="-1"></a>  , <span class="at">iter =</span> <span class="dv">20000</span>, <span class="at">warmup =</span> <span class="dv">10000</span>, <span class="at">chains =</span> <span class="dv">4</span></span>
<span id="cb418-28"><a href="stats_validation.html#cb418-28" tabindex="-1"></a>  , <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.999</span>, <span class="at">max_treedepth =</span> <span class="dv">13</span>)</span>
<span id="cb418-29"><a href="stats_validation.html#cb418-29" tabindex="-1"></a>  , <span class="at">cores =</span> <span class="fu">round</span>(parallel<span class="sc">::</span><span class="fu">detectCores</span>()<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb418-30"><a href="stats_validation.html#cb418-30" tabindex="-1"></a>  , <span class="at">file =</span> <span class="fu">paste0</span>(rootdir, <span class="st">&quot;/fits/brms_f_mod6&quot;</span>)</span>
<span id="cb418-31"><a href="stats_validation.html#cb418-31" tabindex="-1"></a>)</span></code></pre></div>
<p>check the trace plots for problems with convergence of the Markov chains</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="stats_validation.html#cb419-1" tabindex="-1"></a><span class="fu">plot</span>(brms_f_mod6)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-310-1.png" width="1008" /><img src="metashape_testing_files/figure-html/unnamed-chunk-310-2.png" width="1008" /><img src="metashape_testing_files/figure-html/unnamed-chunk-310-3.png" width="1008" /><img src="metashape_testing_files/figure-html/unnamed-chunk-310-4.png" width="1008" /></p>
<p>posterior-predictive check to make sure the model does an okay job simulating data that resemble the sample data</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="stats_validation.html#cb420-1" tabindex="-1"></a><span class="co"># posterior predictive check</span></span>
<span id="cb420-2"><a href="stats_validation.html#cb420-2" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">pp_check</span>(</span>
<span id="cb420-3"><a href="stats_validation.html#cb420-3" tabindex="-1"></a>    brms_f_mod6</span>
<span id="cb420-4"><a href="stats_validation.html#cb420-4" tabindex="-1"></a>    , <span class="at">type =</span> <span class="st">&quot;dens_overlay&quot;</span></span>
<span id="cb420-5"><a href="stats_validation.html#cb420-5" tabindex="-1"></a>    , <span class="at">ndraws =</span> <span class="dv">100</span></span>
<span id="cb420-6"><a href="stats_validation.html#cb420-6" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb420-7"><a href="stats_validation.html#cb420-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;posterior-predictive check (overlaid densities)&quot;</span>) <span class="sc">+</span></span>
<span id="cb420-8"><a href="stats_validation.html#cb420-8" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb420-9"><a href="stats_validation.html#cb420-9" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb420-10"><a href="stats_validation.html#cb420-10" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb420-11"><a href="stats_validation.html#cb420-11" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb420-12"><a href="stats_validation.html#cb420-12" tabindex="-1"></a>    , <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb420-13"><a href="stats_validation.html#cb420-13" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-311-1.png" width="1008" /></p>
<p>How’d we do capturing the conditional means and standard deviations by depth map generation quality?</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="stats_validation.html#cb421-1" tabindex="-1"></a><span class="co"># means</span></span>
<span id="cb421-2"><a href="stats_validation.html#cb421-2" tabindex="-1"></a>p1_temp <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(</span>
<span id="cb421-3"><a href="stats_validation.html#cb421-3" tabindex="-1"></a>    brms_f_mod6</span>
<span id="cb421-4"><a href="stats_validation.html#cb421-4" tabindex="-1"></a>    , <span class="at">type =</span> <span class="st">&quot;stat_grouped&quot;</span> <span class="co"># &quot;dens_overlay_grouped&quot;</span></span>
<span id="cb421-5"><a href="stats_validation.html#cb421-5" tabindex="-1"></a>    , <span class="at">stat =</span> <span class="st">&quot;mean&quot;</span></span>
<span id="cb421-6"><a href="stats_validation.html#cb421-6" tabindex="-1"></a>    , <span class="at">group =</span> <span class="st">&quot;depth_maps_generation_quality&quot;</span></span>
<span id="cb421-7"><a href="stats_validation.html#cb421-7" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb421-8"><a href="stats_validation.html#cb421-8" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="cn">NULL</span>)) <span class="sc">+</span></span>
<span id="cb421-9"><a href="stats_validation.html#cb421-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;means&quot;</span>) <span class="sc">+</span></span>
<span id="cb421-10"><a href="stats_validation.html#cb421-10" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(group), <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb421-11"><a href="stats_validation.html#cb421-11" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb421-12"><a href="stats_validation.html#cb421-12" tabindex="-1"></a><span class="co"># sds</span></span>
<span id="cb421-13"><a href="stats_validation.html#cb421-13" tabindex="-1"></a>p2_temp <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">pp_check</span>(</span>
<span id="cb421-14"><a href="stats_validation.html#cb421-14" tabindex="-1"></a>    brms_f_mod6</span>
<span id="cb421-15"><a href="stats_validation.html#cb421-15" tabindex="-1"></a>    , <span class="at">type =</span> <span class="st">&quot;stat_grouped&quot;</span> <span class="co"># &quot;dens_overlay_grouped&quot;</span></span>
<span id="cb421-16"><a href="stats_validation.html#cb421-16" tabindex="-1"></a>    , <span class="at">stat =</span> <span class="st">&quot;sd&quot;</span></span>
<span id="cb421-17"><a href="stats_validation.html#cb421-17" tabindex="-1"></a>    , <span class="at">group =</span> <span class="st">&quot;depth_maps_generation_quality&quot;</span></span>
<span id="cb421-18"><a href="stats_validation.html#cb421-18" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb421-19"><a href="stats_validation.html#cb421-19" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="cn">NULL</span>)) <span class="sc">+</span></span>
<span id="cb421-20"><a href="stats_validation.html#cb421-20" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;sd&#39;s&quot;</span>) <span class="sc">+</span></span>
<span id="cb421-21"><a href="stats_validation.html#cb421-21" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(group), <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb421-22"><a href="stats_validation.html#cb421-22" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb421-23"><a href="stats_validation.html#cb421-23" tabindex="-1"></a><span class="co"># combine </span></span>
<span id="cb421-24"><a href="stats_validation.html#cb421-24" tabindex="-1"></a>(p1_temp <span class="sc">/</span> p2_temp) <span class="sc">&amp;</span></span>
<span id="cb421-25"><a href="stats_validation.html#cb421-25" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb421-26"><a href="stats_validation.html#cb421-26" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb421-27"><a href="stats_validation.html#cb421-27" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Posterior-predictive statistical checks</span><span class="sc">\n</span><span class="st">by dense cloud quality&quot;</span></span>
<span id="cb421-28"><a href="stats_validation.html#cb421-28" tabindex="-1"></a>    , <span class="at">subtitle =</span> <span class="fu">expression</span>(</span>
<span id="cb421-29"><a href="stats_validation.html#cb421-29" tabindex="-1"></a>      <span class="st">&quot;The dark blue lines are &quot;</span><span class="sc">*</span><span class="fu">italic</span>(<span class="fu">T</span>(y))<span class="sc">*</span><span class="st">&quot;, and the light blue bars are for &quot;</span><span class="sc">*</span><span class="fu">italic</span>(T)(<span class="fu">italic</span>(y)[rep])<span class="sc">*</span><span class="st">&quot;.&quot;</span>)</span>
<span id="cb421-30"><a href="stats_validation.html#cb421-30" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-312-1.png" width="1008" /></p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="stats_validation.html#cb422-1" tabindex="-1"></a><span class="co"># brms_f_mod6 %&gt;% </span></span>
<span id="cb422-2"><a href="stats_validation.html#cb422-2" tabindex="-1"></a><span class="co">#   brms::posterior_summary()</span></span></code></pre></div>
<p>The means and sd’s of the F-score are less well represented across the different levels of dense cloud quality. We may want to look into modelling heterogeneous variances as shown by <a href="https://sites.google.com/site/doingbayesiandataanalysis/">Kruschke</a> chapter 20 and <a href="https://bookdown.org/content/3686/metric-predicted-variable-with-multiple-nominal-predictors.html#heterogeneous-variances-and-robustness-against-outliers-1">Kurz</a></p>
<p>What about for the software?</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="stats_validation.html#cb423-1" tabindex="-1"></a><span class="fu">pp_check</span>(brms_f_mod6, <span class="st">&quot;dens_overlay_grouped&quot;</span>, <span class="at">group =</span> <span class="st">&quot;software&quot;</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb423-2"><a href="stats_validation.html#cb423-2" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;posterior-predictive check (overlaid densities)</span><span class="sc">\n</span><span class="st">by software&quot;</span>) <span class="sc">+</span></span>
<span id="cb423-3"><a href="stats_validation.html#cb423-3" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb423-4"><a href="stats_validation.html#cb423-4" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb423-5"><a href="stats_validation.html#cb423-5" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb423-6"><a href="stats_validation.html#cb423-6" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb423-7"><a href="stats_validation.html#cb423-7" tabindex="-1"></a>    , <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb423-8"><a href="stats_validation.html#cb423-8" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-313-1.png" width="1008" /></p>
<p>What about for the overstory/understory?</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="stats_validation.html#cb424-1" tabindex="-1"></a><span class="fu">pp_check</span>(brms_f_mod6, <span class="st">&quot;dens_overlay_grouped&quot;</span>, <span class="at">group =</span> <span class="st">&quot;story&quot;</span>, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb424-2"><a href="stats_validation.html#cb424-2" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;posterior-predictive check (overlaid densities)</span><span class="sc">\n</span><span class="st">by story&quot;</span>) <span class="sc">+</span></span>
<span id="cb424-3"><a href="stats_validation.html#cb424-3" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb424-4"><a href="stats_validation.html#cb424-4" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb424-5"><a href="stats_validation.html#cb424-5" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb424-6"><a href="stats_validation.html#cb424-6" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb424-7"><a href="stats_validation.html#cb424-7" tabindex="-1"></a>    , <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb424-8"><a href="stats_validation.html#cb424-8" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-314-1.png" width="1008" /></p>
<p>We may not be capturing the high versus low tree predictive performance that is being driven by differences at the study site level.</p>
<p><em>this should be addressed…is validation really that bad for some study sites?</em></p>
<p>We can look at the model noise standard deviation (concentration) <span class="math inline">\(\phi\)</span>.</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="stats_validation.html#cb425-1" tabindex="-1"></a><span class="co"># get formula</span></span>
<span id="cb425-2"><a href="stats_validation.html#cb425-2" tabindex="-1"></a>form_temp <span class="ot">=</span> brms_f_mod6<span class="sc">$</span>formula<span class="sc">$</span>formula[<span class="dv">3</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb425-3"><a href="stats_validation.html#cb425-3" tabindex="-1"></a>  <span class="fu">as.character</span>() <span class="sc">%&gt;%</span> <span class="fu">get_frmla_text</span>(<span class="at">split_chrs =</span> <span class="dv">115</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb425-4"><a href="stats_validation.html#cb425-4" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_quality&quot;</span>, <span class="st">&quot;quality&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb425-5"><a href="stats_validation.html#cb425-5" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span>, <span class="st">&quot;filtering&quot;</span>)</span>
<span id="cb425-6"><a href="stats_validation.html#cb425-6" tabindex="-1"></a><span class="co"># extract the posterior draws</span></span>
<span id="cb425-7"><a href="stats_validation.html#cb425-7" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod6) <span class="sc">%&gt;%</span> </span>
<span id="cb425-8"><a href="stats_validation.html#cb425-8" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb425-9"><a href="stats_validation.html#cb425-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> phi, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb425-10"><a href="stats_validation.html#cb425-10" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_dotsinterval</span>(</span>
<span id="cb425-11"><a href="stats_validation.html#cb425-11" tabindex="-1"></a>    <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb425-12"><a href="stats_validation.html#cb425-12" tabindex="-1"></a>    , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.04</span></span>
<span id="cb425-13"><a href="stats_validation.html#cb425-13" tabindex="-1"></a>    , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_size =</span> <span class="dv">3</span></span>
<span id="cb425-14"><a href="stats_validation.html#cb425-14" tabindex="-1"></a>    , <span class="at">quantiles =</span> <span class="dv">100</span></span>
<span id="cb425-15"><a href="stats_validation.html#cb425-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb425-16"><a href="stats_validation.html#cb425-16" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb425-17"><a href="stats_validation.html#cb425-17" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb425-18"><a href="stats_validation.html#cb425-18" tabindex="-1"></a>    <span class="at">x =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">phi$&quot;</span>)</span>
<span id="cb425-19"><a href="stats_validation.html#cb425-19" tabindex="-1"></a>    , <span class="at">caption =</span> form_temp</span>
<span id="cb425-20"><a href="stats_validation.html#cb425-20" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb425-21"><a href="stats_validation.html#cb425-21" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-315-1.png" width="1008" /></p>
<p>we can compare this to our beta model above without any overstory/understory predictor variable.</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="stats_validation.html#cb426-1" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb426-2"><a href="stats_validation.html#cb426-2" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod6) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(phi) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">src =</span> <span class="st">&quot;brms_f_mod6&quot;</span>)</span>
<span id="cb426-3"><a href="stats_validation.html#cb426-3" tabindex="-1"></a>  , brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod5) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(phi) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">src =</span> <span class="st">&quot;brms_f_mod5&quot;</span>)</span>
<span id="cb426-4"><a href="stats_validation.html#cb426-4" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb426-5"><a href="stats_validation.html#cb426-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> src, <span class="at">x =</span> phi, <span class="at">color =</span> src, <span class="at">group =</span> src)) <span class="sc">+</span></span>
<span id="cb426-6"><a href="stats_validation.html#cb426-6" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_pointinterval</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb426-7"><a href="stats_validation.html#cb426-7" tabindex="-1"></a>    <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb426-8"><a href="stats_validation.html#cb426-8" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> viridis<span class="sc">::</span><span class="fu">turbo</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>)[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>]) <span class="sc">+</span></span>
<span id="cb426-9"><a href="stats_validation.html#cb426-9" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb426-10"><a href="stats_validation.html#cb426-10" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">phi$&quot;</span>)</span>
<span id="cb426-11"><a href="stats_validation.html#cb426-11" tabindex="-1"></a>      , <span class="at">color =</span> <span class="st">&quot;model&quot;</span></span>
<span id="cb426-12"><a href="stats_validation.html#cb426-12" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb426-13"><a href="stats_validation.html#cb426-13" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb426-14"><a href="stats_validation.html#cb426-14" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-316-1.png" width="1008" /></p>
<p>This indicates that our model including overstory/understory has less dispersion</p>
<div id="story---main-effect" class="section level4 hasAnchor" number="6.9.2.1">
<h4><span class="header-section-number">6.9.2.1</span> Story - main effect<a href="stats_validation.html#story---main-effect" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now, we’ll look at the main effect of overstory/understory on F-score by collapsing across the filtering mode, dense cloud quality setting, study site, and software and then performing a pairwise comparison between overstory and understory</p>
<p>In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="stats_validation.html#cb427-1" tabindex="-1"></a>ou_ptcld_validation_data <span class="sc">%&gt;%</span></span>
<span id="cb427-2"><a href="stats_validation.html#cb427-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(story) <span class="sc">%&gt;%</span> </span>
<span id="cb427-3"><a href="stats_validation.html#cb427-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb427-4"><a href="stats_validation.html#cb427-4" tabindex="-1"></a>    brms_f_mod6, <span class="at">allow_new_levels =</span> T</span>
<span id="cb427-5"><a href="stats_validation.html#cb427-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb427-6"><a href="stats_validation.html#cb427-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> story)</span>
<span id="cb427-7"><a href="stats_validation.html#cb427-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb427-8"><a href="stats_validation.html#cb427-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb427-9"><a href="stats_validation.html#cb427-9" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb427-10"><a href="stats_validation.html#cb427-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb427-11"><a href="stats_validation.html#cb427-11" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb427-12"><a href="stats_validation.html#cb427-12" tabindex="-1"></a>      <span class="at">x =</span> value, <span class="at">y =</span> story</span>
<span id="cb427-13"><a href="stats_validation.html#cb427-13" tabindex="-1"></a>      , <span class="at">fill =</span> story</span>
<span id="cb427-14"><a href="stats_validation.html#cb427-14" tabindex="-1"></a>    )</span>
<span id="cb427-15"><a href="stats_validation.html#cb427-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb427-16"><a href="stats_validation.html#cb427-16" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb427-17"><a href="stats_validation.html#cb427-17" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb427-18"><a href="stats_validation.html#cb427-18" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;gray66&quot;</span></span>
<span id="cb427-19"><a href="stats_validation.html#cb427-19" tabindex="-1"></a>      , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_color =</span> <span class="st">&quot;gray66&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb427-20"><a href="stats_validation.html#cb427-20" tabindex="-1"></a>      , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb427-21"><a href="stats_validation.html#cb427-21" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb427-22"><a href="stats_validation.html#cb427-22" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;viridis&quot;</span>, <span class="at">begin =</span> <span class="fl">0.3</span>, <span class="at">end =</span> <span class="fl">0.7</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb427-23"><a href="stats_validation.html#cb427-23" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb427-24"><a href="stats_validation.html#cb427-24" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb427-25"><a href="stats_validation.html#cb427-25" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb427-26"><a href="stats_validation.html#cb427-26" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI&quot;</span></span>
<span id="cb427-27"><a href="stats_validation.html#cb427-27" tabindex="-1"></a>      , <span class="at">caption =</span> form_temp</span>
<span id="cb427-28"><a href="stats_validation.html#cb427-28" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb427-29"><a href="stats_validation.html#cb427-29" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb427-30"><a href="stats_validation.html#cb427-30" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-317-1.png" width="1008" /></p>
<p>we can view the posterior HDI of these estimates</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="stats_validation.html#cb428-1" tabindex="-1"></a>ou_ptcld_validation_data <span class="sc">%&gt;%</span></span>
<span id="cb428-2"><a href="stats_validation.html#cb428-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(story) <span class="sc">%&gt;%</span> </span>
<span id="cb428-3"><a href="stats_validation.html#cb428-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb428-4"><a href="stats_validation.html#cb428-4" tabindex="-1"></a>    brms_f_mod6, <span class="at">allow_new_levels =</span> T</span>
<span id="cb428-5"><a href="stats_validation.html#cb428-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb428-6"><a href="stats_validation.html#cb428-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> story)</span>
<span id="cb428-7"><a href="stats_validation.html#cb428-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb428-8"><a href="stats_validation.html#cb428-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span>  </span>
<span id="cb428-9"><a href="stats_validation.html#cb428-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(story) <span class="sc">%&gt;%</span> </span>
<span id="cb428-10"><a href="stats_validation.html#cb428-10" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb428-11"><a href="stats_validation.html#cb428-11" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(.point,.interval, .width)) <span class="sc">%&gt;%</span> </span>
<span id="cb428-12"><a href="stats_validation.html#cb428-12" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb428-13"><a href="stats_validation.html#cb428-13" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb428-14"><a href="stats_validation.html#cb428-14" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of F-score&quot;</span></span>
<span id="cb428-15"><a href="stats_validation.html#cb428-15" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb428-16"><a href="stats_validation.html#cb428-16" tabindex="-1"></a>      <span class="st">&quot;&quot;</span></span>
<span id="cb428-17"><a href="stats_validation.html#cb428-17" tabindex="-1"></a>      , <span class="st">&quot;F-score&quot;</span></span>
<span id="cb428-18"><a href="stats_validation.html#cb428-18" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb428-19"><a href="stats_validation.html#cb428-19" tabindex="-1"></a>    )</span>
<span id="cb428-20"><a href="stats_validation.html#cb428-20" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb428-21"><a href="stats_validation.html#cb428-21" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-318">Table 6.28: </span>brms::brm model: 95% HDI of the posterior predictive distribution of F-score
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
F-score
</th>
<th style="text-align:right;">
HDI low
</th>
<th style="text-align:right;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
overstory
</td>
<td style="text-align:right;">
0.48
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.81
</td>
</tr>
<tr>
<td style="text-align:left;">
understory
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.65
</td>
</tr>
</tbody>
</table>
<p>compare this to the quick summary stats</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="stats_validation.html#cb429-1" tabindex="-1"></a>ou_ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb429-2"><a href="stats_validation.html#cb429-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(story) <span class="sc">%&gt;%</span> </span>
<span id="cb429-3"><a href="stats_validation.html#cb429-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb429-4"><a href="stats_validation.html#cb429-4" tabindex="-1"></a>    <span class="at">mean_f =</span> <span class="fu">mean</span>(f_score)</span>
<span id="cb429-5"><a href="stats_validation.html#cb429-5" tabindex="-1"></a>    , <span class="at">f_05 =</span> <span class="fu">quantile</span>(f_score, <span class="at">probs =</span> <span class="fl">0.05</span>)</span>
<span id="cb429-6"><a href="stats_validation.html#cb429-6" tabindex="-1"></a>    , <span class="at">f_95 =</span> <span class="fu">quantile</span>(f_score, <span class="at">probs =</span> <span class="fl">0.95</span>)</span>
<span id="cb429-7"><a href="stats_validation.html#cb429-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb429-8"><a href="stats_validation.html#cb429-8" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb429-9"><a href="stats_validation.html#cb429-9" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb429-10"><a href="stats_validation.html#cb429-10" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;summary statistics of F-score&quot;</span></span>
<span id="cb429-11"><a href="stats_validation.html#cb429-11" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb429-12"><a href="stats_validation.html#cb429-12" tabindex="-1"></a>      <span class="st">&quot;&quot;</span></span>
<span id="cb429-13"><a href="stats_validation.html#cb429-13" tabindex="-1"></a>      , <span class="st">&quot;mean F-score&quot;</span></span>
<span id="cb429-14"><a href="stats_validation.html#cb429-14" tabindex="-1"></a>      , <span class="st">&quot;5% value&quot;</span>, <span class="st">&quot;95% value&quot;</span></span>
<span id="cb429-15"><a href="stats_validation.html#cb429-15" tabindex="-1"></a>    )</span>
<span id="cb429-16"><a href="stats_validation.html#cb429-16" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb429-17"><a href="stats_validation.html#cb429-17" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-319">Table 6.29: </span>summary statistics of F-score
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
mean F-score
</th>
<th style="text-align:right;">
5% value
</th>
<th style="text-align:right;">
95% value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
overstory
</td>
<td style="text-align:right;">
0.52
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.89
</td>
</tr>
<tr>
<td style="text-align:left;">
understory
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.60
</td>
</tr>
</tbody>
</table>
<p>now we’ll make our contrast of overstory/understory</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="stats_validation.html#cb430-1" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span></span>
<span id="cb430-2"><a href="stats_validation.html#cb430-2" tabindex="-1"></a>  ou_ptcld_validation_data <span class="sc">%&gt;%</span></span>
<span id="cb430-3"><a href="stats_validation.html#cb430-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(story) <span class="sc">%&gt;%</span> </span>
<span id="cb430-4"><a href="stats_validation.html#cb430-4" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb430-5"><a href="stats_validation.html#cb430-5" tabindex="-1"></a>      brms_f_mod6, <span class="at">allow_new_levels =</span> T</span>
<span id="cb430-6"><a href="stats_validation.html#cb430-6" tabindex="-1"></a>      <span class="co"># this part is crucial</span></span>
<span id="cb430-7"><a href="stats_validation.html#cb430-7" tabindex="-1"></a>      , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> story)</span>
<span id="cb430-8"><a href="stats_validation.html#cb430-8" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb430-9"><a href="stats_validation.html#cb430-9" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb430-10"><a href="stats_validation.html#cb430-10" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb430-11"><a href="stats_validation.html#cb430-11" tabindex="-1"></a>      value</span>
<span id="cb430-12"><a href="stats_validation.html#cb430-12" tabindex="-1"></a>      , <span class="at">by =</span> story</span>
<span id="cb430-13"><a href="stats_validation.html#cb430-13" tabindex="-1"></a>      , <span class="at">comparison =</span> tidybayes<span class="sc">::</span><span class="fu">emmeans_comparison</span>(<span class="st">&quot;revpairwise&quot;</span>)</span>
<span id="cb430-14"><a href="stats_validation.html#cb430-14" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb430-15"><a href="stats_validation.html#cb430-15" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> story) <span class="sc">%&gt;%</span> </span>
<span id="cb430-16"><a href="stats_validation.html#cb430-16" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb430-17"><a href="stats_validation.html#cb430-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb430-18"><a href="stats_validation.html#cb430-18" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb430-19"><a href="stats_validation.html#cb430-19" tabindex="-1"></a></span>
<span id="cb430-20"><a href="stats_validation.html#cb430-20" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb430-21"><a href="stats_validation.html#cb430-21" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 40,000
## Columns: 14
## Groups: contrast [1]
## $ .chain              &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .iteration          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .draw               &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,…
## $ contrast            &lt;chr&gt; &quot;overstory - understory&quot;, &quot;overstory - understory&quot;…
## $ value               &lt;dbl&gt; 0.243671696, 0.196395881, 0.122113387, 0.187161358…
## $ median_hdi_est      &lt;dbl&gt; 0.1519276, 0.1519276, 0.1519276, 0.1519276, 0.1519…
## $ median_hdi_lower    &lt;dbl&gt; -0.06039082, -0.06039082, -0.06039082, -0.06039082…
## $ median_hdi_upper    &lt;dbl&gt; 0.357243, 0.357243, 0.357243, 0.357243, 0.357243, …
## $ is_gt_zero          &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, FA…
## $ pct_gt_zero         &lt;dbl&gt; 0.918425, 0.918425, 0.918425, 0.918425, 0.918425, …
## $ pct_gt_zero_lab     &lt;chr&gt; &quot;Pr(overstory&gt;understory)=92%&quot;, &quot;Pr(overstory&gt;unde…
## $ pct_gt_zero_lab_sm  &lt;chr&gt; &quot;Pr(&gt;0)=92%&quot;, &quot;Pr(&gt;0)=92%&quot;, &quot;Pr(&gt;0)=92%&quot;, &quot;Pr(&gt;0)=…
## $ pct_gt_zero_lab_pos &lt;dbl&gt; 0.3840362, 0.3840362, 0.3840362, 0.3840362, 0.3840…
## $ sig_level           &lt;ord&gt; 90%, 90%, 90%, 90%, 90%, 90%, 90%, 90%, 90%, 90%, …</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="stats_validation.html#cb432-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb432-2"><a href="stats_validation.html#cb432-2" tabindex="-1"></a>  brms_contrast_temp, <span class="at">caption_text =</span> form_temp</span>
<span id="cb432-3"><a href="stats_validation.html#cb432-3" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;story&quot;</span></span>
<span id="cb432-4"><a href="stats_validation.html#cb432-4" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-321-1.png" width="1008" /></p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="stats_validation.html#cb433-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb433-2"><a href="stats_validation.html#cb433-2" tabindex="-1"></a>  <span class="st">&quot;../data/stry_comp_mod6.png&quot;</span></span>
<span id="cb433-3"><a href="stats_validation.html#cb433-3" tabindex="-1"></a>  , <span class="at">plot =</span> ggplot2<span class="sc">::</span><span class="fu">last_plot</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb433-4"><a href="stats_validation.html#cb433-4" tabindex="-1"></a>  , <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span></span>
<span id="cb433-5"><a href="stats_validation.html#cb433-5" tabindex="-1"></a>)</span></code></pre></div>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="stats_validation.html#cb434-1" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb434-2"><a href="stats_validation.html#cb434-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb434-3"><a href="stats_validation.html#cb434-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb434-4"><a href="stats_validation.html#cb434-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb434-5"><a href="stats_validation.html#cb434-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, value, .lower, .upper) <span class="sc">%&gt;%</span> </span>
<span id="cb434-6"><a href="stats_validation.html#cb434-6" tabindex="-1"></a>   </span>
<span id="cb434-7"><a href="stats_validation.html#cb434-7" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb434-8"><a href="stats_validation.html#cb434-8" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb434-9"><a href="stats_validation.html#cb434-9" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb434-10"><a href="stats_validation.html#cb434-10" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb434-11"><a href="stats_validation.html#cb434-11" tabindex="-1"></a>      <span class="st">&quot;overstory contrast&quot;</span></span>
<span id="cb434-12"><a href="stats_validation.html#cb434-12" tabindex="-1"></a>      , <span class="st">&quot;difference (F-score)&quot;</span></span>
<span id="cb434-13"><a href="stats_validation.html#cb434-13" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb434-14"><a href="stats_validation.html#cb434-14" tabindex="-1"></a>    )</span>
<span id="cb434-15"><a href="stats_validation.html#cb434-15" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb434-16"><a href="stats_validation.html#cb434-16" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-322">Table 6.30: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;">
overstory contrast
</th>
<th style="text-align:right;">
difference (F-score)
</th>
<th style="text-align:right;">
HDI low
</th>
<th style="text-align:right;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
overstory - understory
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.36
</td>
</tr>
</tbody>
</table>
<p>Averaging across all levels of filtering mode, dense cloud quality setting, study site, and software the process does a better job detecting overstory trees than understory trees. Because this is a Bayesian analysis we can quantify this probability: there is a 91.8% that overstory trees will be detected with better accuracy than understory trees (see coloring on posterior predictive distribution above)</p>
</div>
<div id="storysoftware---interaction" class="section level4 hasAnchor" number="6.9.2.2">
<h4><span class="header-section-number">6.9.2.2</span> Story:Software - interaction<a href="stats_validation.html#storysoftware---interaction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now, we’ll address the question of “are there differences in F-score based on the processing software used for detecting overstory and understory trees?”</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="stats_validation.html#cb435-1" tabindex="-1"></a><span class="co"># get draws</span></span>
<span id="cb435-2"><a href="stats_validation.html#cb435-2" tabindex="-1"></a>stry_sftwr_draws_temp <span class="ot">=</span> ou_ptcld_validation_data <span class="sc">%&gt;%</span></span>
<span id="cb435-3"><a href="stats_validation.html#cb435-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(software, story) <span class="sc">%&gt;%</span> </span>
<span id="cb435-4"><a href="stats_validation.html#cb435-4" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb435-5"><a href="stats_validation.html#cb435-5" tabindex="-1"></a>    brms_f_mod6, <span class="at">allow_new_levels =</span> T</span>
<span id="cb435-6"><a href="stats_validation.html#cb435-6" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb435-7"><a href="stats_validation.html#cb435-7" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> story) <span class="sc">+</span></span>
<span id="cb435-8"><a href="stats_validation.html#cb435-8" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> software) <span class="sc">+</span> </span>
<span id="cb435-9"><a href="stats_validation.html#cb435-9" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> software<span class="sc">:</span>story)</span>
<span id="cb435-10"><a href="stats_validation.html#cb435-10" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb435-11"><a href="stats_validation.html#cb435-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred)</span>
<span id="cb435-12"><a href="stats_validation.html#cb435-12" tabindex="-1"></a><span class="co"># calculate contrast</span></span>
<span id="cb435-13"><a href="stats_validation.html#cb435-13" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> stry_sftwr_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb435-14"><a href="stats_validation.html#cb435-14" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb435-15"><a href="stats_validation.html#cb435-15" tabindex="-1"></a>    value</span>
<span id="cb435-16"><a href="stats_validation.html#cb435-16" tabindex="-1"></a>    , <span class="at">by =</span> software</span>
<span id="cb435-17"><a href="stats_validation.html#cb435-17" tabindex="-1"></a>    , <span class="at">comparison =</span> <span class="st">&quot;pairwise&quot;</span></span>
<span id="cb435-18"><a href="stats_validation.html#cb435-18" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb435-19"><a href="stats_validation.html#cb435-19" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> software) <span class="sc">%&gt;%</span> </span>
<span id="cb435-20"><a href="stats_validation.html#cb435-20" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb435-21"><a href="stats_validation.html#cb435-21" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, story) <span class="sc">%&gt;%</span> </span>
<span id="cb435-22"><a href="stats_validation.html#cb435-22" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb435-23"><a href="stats_validation.html#cb435-23" tabindex="-1"></a></span>
<span id="cb435-24"><a href="stats_validation.html#cb435-24" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb435-25"><a href="stats_validation.html#cb435-25" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 240,000
## Columns: 15
## Groups: contrast, story [6]
## $ story               &lt;fct&gt; overstory, overstory, overstory, overstory, overst…
## $ .chain              &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .iteration          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .draw               &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,…
## $ contrast            &lt;chr&gt; &quot;OPENDRONEMAP - METASHAPE&quot;, &quot;OPENDRONEMAP - METASH…
## $ value               &lt;dbl&gt; -0.023445297, 0.029402995, 0.041254983, -0.0102837…
## $ median_hdi_est      &lt;dbl&gt; -0.01381908, -0.01381908, -0.01381908, -0.01381908…
## $ median_hdi_lower    &lt;dbl&gt; -0.2029299, -0.2029299, -0.2029299, -0.2029299, -0…
## $ median_hdi_upper    &lt;dbl&gt; 0.1648562, 0.1648562, 0.1648562, 0.1648562, 0.1648…
## $ is_gt_zero          &lt;lgl&gt; TRUE, FALSE, FALSE, TRUE, TRUE, FALSE, TRUE, TRUE,…
## $ pct_gt_zero         &lt;dbl&gt; 0.567825, 0.567825, 0.567825, 0.567825, 0.567825, …
## $ pct_gt_zero_lab     &lt;chr&gt; &quot;Pr(MtaShp&gt;ODM)=57%&quot;, &quot;Pr(MtaShp&gt;ODM)=57%&quot;, &quot;Pr(Mt…
## $ pct_gt_zero_lab_sm  &lt;chr&gt; &quot;Pr(&lt;0)=57%&quot;, &quot;Pr(&lt;0)=57%&quot;, &quot;Pr(&lt;0)=57%&quot;, &quot;Pr(&lt;0)=…
## $ pct_gt_zero_lab_pos &lt;dbl&gt; -0.2181497, -0.2181497, -0.2181497, -0.2181497, -0…
## $ sig_level           &lt;ord&gt; &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;8…</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="stats_validation.html#cb437-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb437-2"><a href="stats_validation.html#cb437-2" tabindex="-1"></a>  brms_contrast_temp, <span class="at">caption_text =</span> form_temp</span>
<span id="cb437-3"><a href="stats_validation.html#cb437-3" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;software&quot;</span></span>
<span id="cb437-4"><a href="stats_validation.html#cb437-4" tabindex="-1"></a>  , <span class="at">facet =</span> <span class="st">&quot;story&quot;</span></span>
<span id="cb437-5"><a href="stats_validation.html#cb437-5" tabindex="-1"></a>  , <span class="at">label_size =</span> <span class="fl">2.5</span></span>
<span id="cb437-6"><a href="stats_validation.html#cb437-6" tabindex="-1"></a>  , <span class="at">x_expand =</span> <span class="fu">c</span>(<span class="fl">0.17</span>,<span class="fl">0.3</span>)</span>
<span id="cb437-7"><a href="stats_validation.html#cb437-7" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb437-8"><a href="stats_validation.html#cb437-8" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb437-9"><a href="stats_validation.html#cb437-9" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of group constrasts with 95% &amp; 50% HDI</span><span class="sc">\n</span><span class="st">by overstory/understory&quot;</span></span>
<span id="cb437-10"><a href="stats_validation.html#cb437-10" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-324-1.png" width="1008" /></p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="stats_validation.html#cb438-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb438-2"><a href="stats_validation.html#cb438-2" tabindex="-1"></a>  <span class="st">&quot;../data/sftwr_stry_comp_mod6.png&quot;</span></span>
<span id="cb438-3"><a href="stats_validation.html#cb438-3" tabindex="-1"></a>  , <span class="at">plot =</span> ggplot2<span class="sc">::</span><span class="fu">last_plot</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb438-4"><a href="stats_validation.html#cb438-4" tabindex="-1"></a>  , <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span></span>
<span id="cb438-5"><a href="stats_validation.html#cb438-5" tabindex="-1"></a>)</span></code></pre></div>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="stats_validation.html#cb439-1" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb439-2"><a href="stats_validation.html#cb439-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, story) <span class="sc">%&gt;%</span> </span>
<span id="cb439-3"><a href="stats_validation.html#cb439-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb439-4"><a href="stats_validation.html#cb439-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast, story) <span class="sc">%&gt;%</span> </span>
<span id="cb439-5"><a href="stats_validation.html#cb439-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, story, value, .lower, .upper) <span class="sc">%&gt;%</span> </span>
<span id="cb439-6"><a href="stats_validation.html#cb439-6" tabindex="-1"></a>   </span>
<span id="cb439-7"><a href="stats_validation.html#cb439-7" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb439-8"><a href="stats_validation.html#cb439-8" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb439-9"><a href="stats_validation.html#cb439-9" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb439-10"><a href="stats_validation.html#cb439-10" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb439-11"><a href="stats_validation.html#cb439-11" tabindex="-1"></a>      <span class="st">&quot;software contrast&quot;</span></span>
<span id="cb439-12"><a href="stats_validation.html#cb439-12" tabindex="-1"></a>      , <span class="st">&quot;overstory/understory&quot;</span></span>
<span id="cb439-13"><a href="stats_validation.html#cb439-13" tabindex="-1"></a>      , <span class="st">&quot;difference (F-score)&quot;</span></span>
<span id="cb439-14"><a href="stats_validation.html#cb439-14" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb439-15"><a href="stats_validation.html#cb439-15" tabindex="-1"></a>    )</span>
<span id="cb439-16"><a href="stats_validation.html#cb439-16" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb439-17"><a href="stats_validation.html#cb439-17" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-325">Table 6.31: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;">
software contrast
</th>
<th style="text-align:left;">
overstory/understory
</th>
<th style="text-align:right;">
difference (F-score)
</th>
<th style="text-align:right;">
HDI low
</th>
<th style="text-align:right;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
OPENDRONEMAP - METASHAPE
</td>
<td style="text-align:left;">
overstory
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
-0.20
</td>
<td style="text-align:right;">
0.16
</td>
</tr>
<tr>
<td style="text-align:left;">
OPENDRONEMAP - METASHAPE
</td>
<td style="text-align:left;">
understory
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
-0.24
</td>
<td style="text-align:right;">
0.06
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - METASHAPE
</td>
<td style="text-align:left;">
overstory
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
-0.20
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - METASHAPE
</td>
<td style="text-align:left;">
understory
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.27
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - OPENDRONEMAP
</td>
<td style="text-align:left;">
overstory
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.18
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - OPENDRONEMAP
</td>
<td style="text-align:left;">
understory
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.35
</td>
</tr>
</tbody>
</table>
</div>
<div id="storyquality---interaction" class="section level4 hasAnchor" number="6.9.2.3">
<h4><span class="header-section-number">6.9.2.3</span> Story:Quality - interaction<a href="stats_validation.html#storyquality---interaction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>What is the difference in F-score between overstory and understory for the different levels of dense cloud quality?</p>
<p>Note that how within <code>tidybayes::add_epred_draws</code>, we used the <code>re_formula</code> argument to average over the effects of study site, software, and filtering mode to compare the dense cloud quality and story effects.</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="stats_validation.html#cb440-1" tabindex="-1"></a>ou_ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb440-2"><a href="stats_validation.html#cb440-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality, story) <span class="sc">%&gt;%</span> </span>
<span id="cb440-3"><a href="stats_validation.html#cb440-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb440-4"><a href="stats_validation.html#cb440-4" tabindex="-1"></a>    brms_f_mod6, <span class="at">allow_new_levels =</span> T</span>
<span id="cb440-5"><a href="stats_validation.html#cb440-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb440-6"><a href="stats_validation.html#cb440-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span></span>
<span id="cb440-7"><a href="stats_validation.html#cb440-7" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> story) <span class="sc">+</span> </span>
<span id="cb440-8"><a href="stats_validation.html#cb440-8" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>story)</span>
<span id="cb440-9"><a href="stats_validation.html#cb440-9" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb440-10"><a href="stats_validation.html#cb440-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb440-11"><a href="stats_validation.html#cb440-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">depth_maps_generation_quality =</span> depth_maps_generation_quality <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb440-12"><a href="stats_validation.html#cb440-12" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb440-13"><a href="stats_validation.html#cb440-13" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb440-14"><a href="stats_validation.html#cb440-14" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb440-15"><a href="stats_validation.html#cb440-15" tabindex="-1"></a>      <span class="at">y =</span> value, <span class="at">x =</span> story</span>
<span id="cb440-16"><a href="stats_validation.html#cb440-16" tabindex="-1"></a>      , <span class="at">fill =</span> story</span>
<span id="cb440-17"><a href="stats_validation.html#cb440-17" tabindex="-1"></a>    )</span>
<span id="cb440-18"><a href="stats_validation.html#cb440-18" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb440-19"><a href="stats_validation.html#cb440-19" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_eye</span>(</span>
<span id="cb440-20"><a href="stats_validation.html#cb440-20" tabindex="-1"></a>    <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb440-21"><a href="stats_validation.html#cb440-21" tabindex="-1"></a>    , <span class="at">slab_alpha =</span> <span class="fl">0.8</span></span>
<span id="cb440-22"><a href="stats_validation.html#cb440-22" tabindex="-1"></a>    , <span class="at">interval_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb440-23"><a href="stats_validation.html#cb440-23" tabindex="-1"></a>    , <span class="at">point_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_size =</span> <span class="dv">1</span></span>
<span id="cb440-24"><a href="stats_validation.html#cb440-24" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb440-25"><a href="stats_validation.html#cb440-25" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;viridis&quot;</span>, <span class="at">begin =</span> <span class="fl">0.3</span>, <span class="at">end =</span> <span class="fl">0.7</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb440-26"><a href="stats_validation.html#cb440-26" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb440-27"><a href="stats_validation.html#cb440-27" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(depth_maps_generation_quality)) <span class="sc">+</span></span>
<span id="cb440-28"><a href="stats_validation.html#cb440-28" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb440-29"><a href="stats_validation.html#cb440-29" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;story&quot;</span>, <span class="at">y =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb440-30"><a href="stats_validation.html#cb440-30" tabindex="-1"></a>    , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI</span><span class="sc">\n</span><span class="st">by dense cloud quality&quot;</span></span>
<span id="cb440-31"><a href="stats_validation.html#cb440-31" tabindex="-1"></a>    , <span class="at">caption =</span> form_temp</span>
<span id="cb440-32"><a href="stats_validation.html#cb440-32" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb440-33"><a href="stats_validation.html#cb440-33" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb440-34"><a href="stats_validation.html#cb440-34" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb440-35"><a href="stats_validation.html#cb440-35" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb440-36"><a href="stats_validation.html#cb440-36" tabindex="-1"></a>    , <span class="at">legend.direction  =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb440-37"><a href="stats_validation.html#cb440-37" tabindex="-1"></a>    , <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb440-38"><a href="stats_validation.html#cb440-38" tabindex="-1"></a>    , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb440-39"><a href="stats_validation.html#cb440-39" tabindex="-1"></a>  ) </span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-326-1.png" width="1008" /></p>
</div>
<div id="qualityfiltering---interaction-1" class="section level4 hasAnchor" number="6.9.2.4">
<h4><span class="header-section-number">6.9.2.4</span> Quality:Filtering - interaction<a href="stats_validation.html#qualityfiltering---interaction-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Are there differences in F-score based on dense point cloud generation quality within each level of filtering mode?</p>
<p>Here, we collapse across the study site, software, and story to compare the combined dense cloud quality and filtering mode effect.</p>
<p>In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="stats_validation.html#cb441-1" tabindex="-1"></a>qlty_filter_draws_temp <span class="ot">=</span> </span>
<span id="cb441-2"><a href="stats_validation.html#cb441-2" tabindex="-1"></a>  ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb441-3"><a href="stats_validation.html#cb441-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb441-4"><a href="stats_validation.html#cb441-4" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb441-5"><a href="stats_validation.html#cb441-5" tabindex="-1"></a>      brms_f_mod6, <span class="at">allow_new_levels =</span> T</span>
<span id="cb441-6"><a href="stats_validation.html#cb441-6" tabindex="-1"></a>      <span class="co"># this part is crucial</span></span>
<span id="cb441-7"><a href="stats_validation.html#cb441-7" tabindex="-1"></a>      , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span></span>
<span id="cb441-8"><a href="stats_validation.html#cb441-8" tabindex="-1"></a>        (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode) <span class="sc">+</span> </span>
<span id="cb441-9"><a href="stats_validation.html#cb441-9" tabindex="-1"></a>        (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode)</span>
<span id="cb441-10"><a href="stats_validation.html#cb441-10" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb441-11"><a href="stats_validation.html#cb441-11" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred)</span>
<span id="cb441-12"><a href="stats_validation.html#cb441-12" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb441-13"><a href="stats_validation.html#cb441-13" tabindex="-1"></a>  qlty_filter_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb441-14"><a href="stats_validation.html#cb441-14" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">depth_maps_generation_quality =</span> depth_maps_generation_quality <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb441-15"><a href="stats_validation.html#cb441-15" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb441-16"><a href="stats_validation.html#cb441-16" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb441-17"><a href="stats_validation.html#cb441-17" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb441-18"><a href="stats_validation.html#cb441-18" tabindex="-1"></a>      <span class="at">y =</span> value, <span class="at">x =</span> depth_maps_generation_filtering_mode</span>
<span id="cb441-19"><a href="stats_validation.html#cb441-19" tabindex="-1"></a>      , <span class="at">fill =</span> depth_maps_generation_filtering_mode</span>
<span id="cb441-20"><a href="stats_validation.html#cb441-20" tabindex="-1"></a>    )</span>
<span id="cb441-21"><a href="stats_validation.html#cb441-21" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb441-22"><a href="stats_validation.html#cb441-22" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_eye</span>(</span>
<span id="cb441-23"><a href="stats_validation.html#cb441-23" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb441-24"><a href="stats_validation.html#cb441-24" tabindex="-1"></a>      , <span class="at">slab_alpha =</span> <span class="fl">0.8</span></span>
<span id="cb441-25"><a href="stats_validation.html#cb441-25" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb441-26"><a href="stats_validation.html#cb441-26" tabindex="-1"></a>      , <span class="at">point_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_size =</span> <span class="dv">1</span></span>
<span id="cb441-27"><a href="stats_validation.html#cb441-27" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb441-28"><a href="stats_validation.html#cb441-28" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb441-29"><a href="stats_validation.html#cb441-29" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb441-30"><a href="stats_validation.html#cb441-30" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(depth_maps_generation_quality)) <span class="sc">+</span></span>
<span id="cb441-31"><a href="stats_validation.html#cb441-31" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb441-32"><a href="stats_validation.html#cb441-32" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">&quot;filtering mode&quot;</span>, <span class="at">y =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb441-33"><a href="stats_validation.html#cb441-33" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI</span><span class="sc">\n</span><span class="st">by dense cloud quality&quot;</span></span>
<span id="cb441-34"><a href="stats_validation.html#cb441-34" tabindex="-1"></a>      , <span class="at">fill =</span> <span class="st">&quot;Filtering Mode&quot;</span></span>
<span id="cb441-35"><a href="stats_validation.html#cb441-35" tabindex="-1"></a>      , <span class="at">caption =</span> form_temp</span>
<span id="cb441-36"><a href="stats_validation.html#cb441-36" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb441-37"><a href="stats_validation.html#cb441-37" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb441-38"><a href="stats_validation.html#cb441-38" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb441-39"><a href="stats_validation.html#cb441-39" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb441-40"><a href="stats_validation.html#cb441-40" tabindex="-1"></a>      , <span class="at">legend.direction  =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb441-41"><a href="stats_validation.html#cb441-41" tabindex="-1"></a>      , <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb441-42"><a href="stats_validation.html#cb441-42" tabindex="-1"></a>      , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb441-43"><a href="stats_validation.html#cb441-43" tabindex="-1"></a>    ) </span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-327-1.png" width="1008" /></p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="stats_validation.html#cb442-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb442-2"><a href="stats_validation.html#cb442-2" tabindex="-1"></a>  <span class="st">&quot;../data/qlty_fltr_mod6.png&quot;</span></span>
<span id="cb442-3"><a href="stats_validation.html#cb442-3" tabindex="-1"></a>  , <span class="at">plot =</span> ggplot2<span class="sc">::</span><span class="fu">last_plot</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb442-4"><a href="stats_validation.html#cb442-4" tabindex="-1"></a>  , <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span></span>
<span id="cb442-5"><a href="stats_validation.html#cb442-5" tabindex="-1"></a>)</span></code></pre></div>
<p>we can also make pairwise comparisons so long as we continue using <code>tidybayes::add_epred_draws</code> with the <code>re_formula</code> argument</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="stats_validation.html#cb443-1" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> qlty_filter_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb443-2"><a href="stats_validation.html#cb443-2" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb443-3"><a href="stats_validation.html#cb443-3" tabindex="-1"></a>      value</span>
<span id="cb443-4"><a href="stats_validation.html#cb443-4" tabindex="-1"></a>      , <span class="at">by =</span> depth_maps_generation_quality</span>
<span id="cb443-5"><a href="stats_validation.html#cb443-5" tabindex="-1"></a>      , <span class="at">comparison =</span> </span>
<span id="cb443-6"><a href="stats_validation.html#cb443-6" tabindex="-1"></a>        contrast_list</span>
<span id="cb443-7"><a href="stats_validation.html#cb443-7" tabindex="-1"></a>        <span class="co"># tidybayes::emmeans_comparison(&quot;revpairwise&quot;) </span></span>
<span id="cb443-8"><a href="stats_validation.html#cb443-8" tabindex="-1"></a>        <span class="co">#&quot;pairwise&quot;</span></span>
<span id="cb443-9"><a href="stats_validation.html#cb443-9" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb443-10"><a href="stats_validation.html#cb443-10" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> depth_maps_generation_quality)</span>
<span id="cb443-11"><a href="stats_validation.html#cb443-11" tabindex="-1"></a></span>
<span id="cb443-12"><a href="stats_validation.html#cb443-12" tabindex="-1"></a><span class="co"># separate contrast</span></span>
<span id="cb443-13"><a href="stats_validation.html#cb443-13" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb443-14"><a href="stats_validation.html#cb443-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb443-15"><a href="stats_validation.html#cb443-15" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(</span>
<span id="cb443-16"><a href="stats_validation.html#cb443-16" tabindex="-1"></a>    <span class="at">cols =</span> contrast</span>
<span id="cb443-17"><a href="stats_validation.html#cb443-17" tabindex="-1"></a>    , <span class="at">delim =</span> <span class="st">&quot; - &quot;</span></span>
<span id="cb443-18"><a href="stats_validation.html#cb443-18" tabindex="-1"></a>    , <span class="at">names =</span> <span class="fu">paste0</span>(</span>
<span id="cb443-19"><a href="stats_validation.html#cb443-19" tabindex="-1"></a>        <span class="st">&quot;sorter&quot;</span></span>
<span id="cb443-20"><a href="stats_validation.html#cb443-20" tabindex="-1"></a>        , <span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(stringr<span class="sc">::</span><span class="fu">str_count</span>(brms_contrast_temp<span class="sc">$</span>contrast, <span class="st">&quot;-&quot;</span>))<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb443-21"><a href="stats_validation.html#cb443-21" tabindex="-1"></a>      )</span>
<span id="cb443-22"><a href="stats_validation.html#cb443-22" tabindex="-1"></a>    , <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span></span>
<span id="cb443-23"><a href="stats_validation.html#cb443-23" tabindex="-1"></a>    , <span class="at">cols_remove =</span> F</span>
<span id="cb443-24"><a href="stats_validation.html#cb443-24" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb443-25"><a href="stats_validation.html#cb443-25" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sorter1<span class="sc">!=</span>sorter2) <span class="sc">%&gt;%</span> </span>
<span id="cb443-26"><a href="stats_validation.html#cb443-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb443-27"><a href="stats_validation.html#cb443-27" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb443-28"><a href="stats_validation.html#cb443-28" tabindex="-1"></a>      tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sorter&quot;</span>)</span>
<span id="cb443-29"><a href="stats_validation.html#cb443-29" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="cf">function</span>(x){<span class="fu">factor</span>(</span>
<span id="cb443-30"><a href="stats_validation.html#cb443-30" tabindex="-1"></a>        x, <span class="at">ordered =</span> T</span>
<span id="cb443-31"><a href="stats_validation.html#cb443-31" tabindex="-1"></a>        , <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_quality)</span>
<span id="cb443-32"><a href="stats_validation.html#cb443-32" tabindex="-1"></a>      )}</span>
<span id="cb443-33"><a href="stats_validation.html#cb443-33" tabindex="-1"></a>    )</span>
<span id="cb443-34"><a href="stats_validation.html#cb443-34" tabindex="-1"></a>    , <span class="at">contrast =</span> contrast <span class="sc">%&gt;%</span> </span>
<span id="cb443-35"><a href="stats_validation.html#cb443-35" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb443-36"><a href="stats_validation.html#cb443-36" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="fu">as.numeric</span>(sorter1), <span class="fu">as.numeric</span>(sorter2)) <span class="sc">%&gt;%</span> </span>
<span id="cb443-37"><a href="stats_validation.html#cb443-37" tabindex="-1"></a>        <span class="fu">as.numeric</span>()</span>
<span id="cb443-38"><a href="stats_validation.html#cb443-38" tabindex="-1"></a>      )</span>
<span id="cb443-39"><a href="stats_validation.html#cb443-39" tabindex="-1"></a>    , <span class="at">depth_maps_generation_filtering_mode =</span> depth_maps_generation_filtering_mode <span class="sc">%&gt;%</span> </span>
<span id="cb443-40"><a href="stats_validation.html#cb443-40" tabindex="-1"></a>      <span class="fu">factor</span>(</span>
<span id="cb443-41"><a href="stats_validation.html#cb443-41" tabindex="-1"></a>        <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_filtering_mode)</span>
<span id="cb443-42"><a href="stats_validation.html#cb443-42" tabindex="-1"></a>        , <span class="at">ordered =</span> T</span>
<span id="cb443-43"><a href="stats_validation.html#cb443-43" tabindex="-1"></a>      )</span>
<span id="cb443-44"><a href="stats_validation.html#cb443-44" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb443-45"><a href="stats_validation.html#cb443-45" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb443-46"><a href="stats_validation.html#cb443-46" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast,depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb443-47"><a href="stats_validation.html#cb443-47" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb443-48"><a href="stats_validation.html#cb443-48" tabindex="-1"></a></span>
<span id="cb443-49"><a href="stats_validation.html#cb443-49" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb443-50"><a href="stats_validation.html#cb443-50" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 1,600,000
## Columns: 17
## Groups: contrast, depth_maps_generation_filtering_mode [40]
## $ depth_maps_generation_filtering_mode &lt;ord&gt; aggressive, aggressive, aggressiv…
## $ .chain                               &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ .iteration                           &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ .draw                                &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11…
## $ sorter1                              &lt;ord&gt; ultra high, ultra high, ultra hig…
## $ sorter2                              &lt;ord&gt; high, high, high, high, high, hig…
## $ contrast                             &lt;fct&gt; ultra high - high, ultra high - h…
## $ value                                &lt;dbl&gt; 0.069614286, 0.040784609, -0.0046…
## $ median_hdi_est                       &lt;dbl&gt; 0.01972114, 0.01972114, 0.0197211…
## $ median_hdi_lower                     &lt;dbl&gt; -0.160384, -0.160384, -0.160384, …
## $ median_hdi_upper                     &lt;dbl&gt; 0.2231248, 0.2231248, 0.2231248, …
## $ is_gt_zero                           &lt;lgl&gt; TRUE, TRUE, FALSE, TRUE, FALSE, T…
## $ pct_gt_zero                          &lt;dbl&gt; 0.6208, 0.6208, 0.6208, 0.6208, 0…
## $ pct_gt_zero_lab                      &lt;chr&gt; &quot;Pr(ultra high&gt;high)=62%&quot;, &quot;Pr(ul…
## $ pct_gt_zero_lab_sm                   &lt;chr&gt; &quot;Pr(&gt;0)=62%&quot;, &quot;Pr(&gt;0)=62%&quot;, &quot;Pr(&gt;…
## $ pct_gt_zero_lab_pos                  &lt;dbl&gt; 0.2398591, 0.2398591, 0.2398591, …
## $ sig_level                            &lt;ord&gt; &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80…</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="stats_validation.html#cb445-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb445-2"><a href="stats_validation.html#cb445-2" tabindex="-1"></a>  brms_contrast_temp, <span class="at">caption_text =</span> form_temp</span>
<span id="cb445-3"><a href="stats_validation.html#cb445-3" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;quality&quot;</span></span>
<span id="cb445-4"><a href="stats_validation.html#cb445-4" tabindex="-1"></a>  , <span class="at">facet =</span> <span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span></span>
<span id="cb445-5"><a href="stats_validation.html#cb445-5" tabindex="-1"></a>  , <span class="at">label_size =</span> <span class="fl">2.0</span></span>
<span id="cb445-6"><a href="stats_validation.html#cb445-6" tabindex="-1"></a>  , <span class="at">x_expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>)</span>
<span id="cb445-7"><a href="stats_validation.html#cb445-7" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb445-8"><a href="stats_validation.html#cb445-8" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb445-9"><a href="stats_validation.html#cb445-9" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of group constrasts with 95% &amp; 50% HDI</span><span class="sc">\n</span><span class="st">by filtering mode&quot;</span></span>
<span id="cb445-10"><a href="stats_validation.html#cb445-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb445-11"><a href="stats_validation.html#cb445-11" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb445-12"><a href="stats_validation.html#cb445-12" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>)</span>
<span id="cb445-13"><a href="stats_validation.html#cb445-13" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-329-1.png" width="1008" /></p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="stats_validation.html#cb446-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb446-2"><a href="stats_validation.html#cb446-2" tabindex="-1"></a>  <span class="st">&quot;../data/qlty_fltr_comp_mod6.png&quot;</span></span>
<span id="cb446-3"><a href="stats_validation.html#cb446-3" tabindex="-1"></a>  , <span class="at">plot =</span> ggplot2<span class="sc">::</span><span class="fu">last_plot</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb446-4"><a href="stats_validation.html#cb446-4" tabindex="-1"></a>  , <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span></span>
<span id="cb446-5"><a href="stats_validation.html#cb446-5" tabindex="-1"></a>)</span></code></pre></div>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="stats_validation.html#cb447-1" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb447-2"><a href="stats_validation.html#cb447-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb447-3"><a href="stats_validation.html#cb447-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb447-4"><a href="stats_validation.html#cb447-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast, depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb447-5"><a href="stats_validation.html#cb447-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, depth_maps_generation_filtering_mode, value, .lower, .upper) <span class="sc">%&gt;%</span> </span>
<span id="cb447-6"><a href="stats_validation.html#cb447-6" tabindex="-1"></a>   </span>
<span id="cb447-7"><a href="stats_validation.html#cb447-7" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb447-8"><a href="stats_validation.html#cb447-8" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb447-9"><a href="stats_validation.html#cb447-9" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb447-10"><a href="stats_validation.html#cb447-10" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb447-11"><a href="stats_validation.html#cb447-11" tabindex="-1"></a>      <span class="st">&quot;quality contrast&quot;</span></span>
<span id="cb447-12"><a href="stats_validation.html#cb447-12" tabindex="-1"></a>      , <span class="st">&quot;filtering mode&quot;</span></span>
<span id="cb447-13"><a href="stats_validation.html#cb447-13" tabindex="-1"></a>      , <span class="st">&quot;difference (F-score)&quot;</span></span>
<span id="cb447-14"><a href="stats_validation.html#cb447-14" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb447-15"><a href="stats_validation.html#cb447-15" tabindex="-1"></a>    )</span>
<span id="cb447-16"><a href="stats_validation.html#cb447-16" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb447-17"><a href="stats_validation.html#cb447-17" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb447-18"><a href="stats_validation.html#cb447-18" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;8in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:8in; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-330">Table 6.32: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
quality contrast
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
filtering mode
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
difference (F-score)
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI low
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.16
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.15
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.16
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.29
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.29
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.34
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.35
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.34
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.33
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - lowest
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.47
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - lowest
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.47
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - lowest
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.47
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - lowest
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.47
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.13
</td>
<td style="text-align:right;">
0.26
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
0.26
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.26
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.13
</td>
<td style="text-align:right;">
0.26
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.26
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.31
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
<tr>
<td style="text-align:left;">
high - lowest
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.43
</td>
</tr>
<tr>
<td style="text-align:left;">
high - lowest
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.44
</td>
</tr>
<tr>
<td style="text-align:left;">
high - lowest
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.44
</td>
</tr>
<tr>
<td style="text-align:left;">
high - lowest
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.43
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.15
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.36
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.36
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.36
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.36
</td>
</tr>
<tr>
<td style="text-align:left;">
low - lowest
</td>
<td style="text-align:left;">
aggressive
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
<tr>
<td style="text-align:left;">
low - lowest
</td>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
<tr>
<td style="text-align:left;">
low - lowest
</td>
<td style="text-align:left;">
mild
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.31
</td>
</tr>
<tr>
<td style="text-align:left;">
low - lowest
</td>
<td style="text-align:left;">
disabled
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.31
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="softwarequality---interaction-1" class="section level4 hasAnchor" number="6.9.2.5">
<h4><span class="header-section-number">6.9.2.5</span> Software:Quality - interaction<a href="stats_validation.html#softwarequality---interaction-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>It might be more important to understand the difference in F-score by dense cloud quality and software rather than filtering mode since filtering mode had such a small effect on the SfM predictive ability</p>
<p>Are there differences in F-score based on dense point cloud generation quality within each different processing software? We will also address the similar but slightly different question of “are there differences in F-score based on the processing software used at a given dense point cloud generation quality?”</p>
<p>Here, we collapse across the study site, filtering mode, and story to compare the combined dense cloud quality and software effect.</p>
<p>In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="stats_validation.html#cb448-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb448-2"><a href="stats_validation.html#cb448-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality, software) <span class="sc">%&gt;%</span> </span>
<span id="cb448-3"><a href="stats_validation.html#cb448-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb448-4"><a href="stats_validation.html#cb448-4" tabindex="-1"></a>    brms_f_mod6, <span class="at">allow_new_levels =</span> T</span>
<span id="cb448-5"><a href="stats_validation.html#cb448-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb448-6"><a href="stats_validation.html#cb448-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span></span>
<span id="cb448-7"><a href="stats_validation.html#cb448-7" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> software) <span class="sc">+</span> </span>
<span id="cb448-8"><a href="stats_validation.html#cb448-8" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>software)</span>
<span id="cb448-9"><a href="stats_validation.html#cb448-9" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb448-10"><a href="stats_validation.html#cb448-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb448-11"><a href="stats_validation.html#cb448-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">depth_maps_generation_quality =</span> depth_maps_generation_quality <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb448-12"><a href="stats_validation.html#cb448-12" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb448-13"><a href="stats_validation.html#cb448-13" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb448-14"><a href="stats_validation.html#cb448-14" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb448-15"><a href="stats_validation.html#cb448-15" tabindex="-1"></a>      <span class="at">y =</span> value, <span class="at">x =</span> software</span>
<span id="cb448-16"><a href="stats_validation.html#cb448-16" tabindex="-1"></a>      , <span class="at">fill =</span> software</span>
<span id="cb448-17"><a href="stats_validation.html#cb448-17" tabindex="-1"></a>    )</span>
<span id="cb448-18"><a href="stats_validation.html#cb448-18" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb448-19"><a href="stats_validation.html#cb448-19" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_eye</span>(</span>
<span id="cb448-20"><a href="stats_validation.html#cb448-20" tabindex="-1"></a>    <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb448-21"><a href="stats_validation.html#cb448-21" tabindex="-1"></a>    , <span class="at">slab_alpha =</span> <span class="fl">0.8</span></span>
<span id="cb448-22"><a href="stats_validation.html#cb448-22" tabindex="-1"></a>    , <span class="at">interval_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb448-23"><a href="stats_validation.html#cb448-23" tabindex="-1"></a>    , <span class="at">point_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_size =</span> <span class="dv">1</span></span>
<span id="cb448-24"><a href="stats_validation.html#cb448-24" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb448-25"><a href="stats_validation.html#cb448-25" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;rocket&quot;</span>, <span class="at">begin =</span> <span class="fl">0.3</span>, <span class="at">end =</span> <span class="fl">0.9</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb448-26"><a href="stats_validation.html#cb448-26" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb448-27"><a href="stats_validation.html#cb448-27" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(depth_maps_generation_quality)) <span class="sc">+</span></span>
<span id="cb448-28"><a href="stats_validation.html#cb448-28" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb448-29"><a href="stats_validation.html#cb448-29" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;software&quot;</span>, <span class="at">y =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb448-30"><a href="stats_validation.html#cb448-30" tabindex="-1"></a>    , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI</span><span class="sc">\n</span><span class="st">by dense cloud quality&quot;</span></span>
<span id="cb448-31"><a href="stats_validation.html#cb448-31" tabindex="-1"></a>    , <span class="at">caption =</span> form_temp</span>
<span id="cb448-32"><a href="stats_validation.html#cb448-32" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb448-33"><a href="stats_validation.html#cb448-33" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb448-34"><a href="stats_validation.html#cb448-34" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb448-35"><a href="stats_validation.html#cb448-35" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb448-36"><a href="stats_validation.html#cb448-36" tabindex="-1"></a>    , <span class="at">legend.direction  =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb448-37"><a href="stats_validation.html#cb448-37" tabindex="-1"></a>    , <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb448-38"><a href="stats_validation.html#cb448-38" tabindex="-1"></a>    , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb448-39"><a href="stats_validation.html#cb448-39" tabindex="-1"></a>  ) </span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-331-1.png" width="1008" /></p>
<p>we can also make pairwise comparisons so long as we continue using <code>tidybayes::add_epred_draws</code> with the <code>re_formula</code> argument</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="stats_validation.html#cb449-1" tabindex="-1"></a><span class="co"># get draws</span></span>
<span id="cb449-2"><a href="stats_validation.html#cb449-2" tabindex="-1"></a>qlty_sftwr_draws_temp <span class="ot">=</span> </span>
<span id="cb449-3"><a href="stats_validation.html#cb449-3" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">crossing</span>(</span>
<span id="cb449-4"><a href="stats_validation.html#cb449-4" tabindex="-1"></a>    <span class="at">depth_maps_generation_quality =</span> <span class="fu">unique</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_quality)</span>
<span id="cb449-5"><a href="stats_validation.html#cb449-5" tabindex="-1"></a>    , <span class="at">software =</span> <span class="fu">unique</span>(ptcld_validation_data<span class="sc">$</span>software)</span>
<span id="cb449-6"><a href="stats_validation.html#cb449-6" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb449-7"><a href="stats_validation.html#cb449-7" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb449-8"><a href="stats_validation.html#cb449-8" tabindex="-1"></a>    brms_f_mod6, <span class="at">allow_new_levels =</span> T</span>
<span id="cb449-9"><a href="stats_validation.html#cb449-9" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb449-10"><a href="stats_validation.html#cb449-10" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span></span>
<span id="cb449-11"><a href="stats_validation.html#cb449-11" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> software) <span class="sc">+</span> </span>
<span id="cb449-12"><a href="stats_validation.html#cb449-12" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>software)</span>
<span id="cb449-13"><a href="stats_validation.html#cb449-13" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb449-14"><a href="stats_validation.html#cb449-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred)</span>
<span id="cb449-15"><a href="stats_validation.html#cb449-15" tabindex="-1"></a></span>
<span id="cb449-16"><a href="stats_validation.html#cb449-16" tabindex="-1"></a><span class="co"># calculate contrast</span></span>
<span id="cb449-17"><a href="stats_validation.html#cb449-17" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> qlty_sftwr_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb449-18"><a href="stats_validation.html#cb449-18" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb449-19"><a href="stats_validation.html#cb449-19" tabindex="-1"></a>    value</span>
<span id="cb449-20"><a href="stats_validation.html#cb449-20" tabindex="-1"></a>    , <span class="at">by =</span> depth_maps_generation_quality</span>
<span id="cb449-21"><a href="stats_validation.html#cb449-21" tabindex="-1"></a>    , <span class="at">comparison =</span> contrast_list</span>
<span id="cb449-22"><a href="stats_validation.html#cb449-22" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb449-23"><a href="stats_validation.html#cb449-23" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> depth_maps_generation_quality)</span>
<span id="cb449-24"><a href="stats_validation.html#cb449-24" tabindex="-1"></a></span>
<span id="cb449-25"><a href="stats_validation.html#cb449-25" tabindex="-1"></a><span class="co"># separate contrast</span></span>
<span id="cb449-26"><a href="stats_validation.html#cb449-26" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb449-27"><a href="stats_validation.html#cb449-27" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb449-28"><a href="stats_validation.html#cb449-28" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(</span>
<span id="cb449-29"><a href="stats_validation.html#cb449-29" tabindex="-1"></a>    <span class="at">cols =</span> contrast</span>
<span id="cb449-30"><a href="stats_validation.html#cb449-30" tabindex="-1"></a>    , <span class="at">delim =</span> <span class="st">&quot; - &quot;</span></span>
<span id="cb449-31"><a href="stats_validation.html#cb449-31" tabindex="-1"></a>    , <span class="at">names =</span> <span class="fu">paste0</span>(</span>
<span id="cb449-32"><a href="stats_validation.html#cb449-32" tabindex="-1"></a>      <span class="st">&quot;sorter&quot;</span></span>
<span id="cb449-33"><a href="stats_validation.html#cb449-33" tabindex="-1"></a>      , <span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(stringr<span class="sc">::</span><span class="fu">str_count</span>(brms_contrast_temp<span class="sc">$</span>contrast, <span class="st">&quot;-&quot;</span>))<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb449-34"><a href="stats_validation.html#cb449-34" tabindex="-1"></a>    )</span>
<span id="cb449-35"><a href="stats_validation.html#cb449-35" tabindex="-1"></a>    , <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span></span>
<span id="cb449-36"><a href="stats_validation.html#cb449-36" tabindex="-1"></a>    , <span class="at">cols_remove =</span> F</span>
<span id="cb449-37"><a href="stats_validation.html#cb449-37" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb449-38"><a href="stats_validation.html#cb449-38" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sorter1<span class="sc">!=</span>sorter2) <span class="sc">%&gt;%</span> </span>
<span id="cb449-39"><a href="stats_validation.html#cb449-39" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb449-40"><a href="stats_validation.html#cb449-40" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb449-41"><a href="stats_validation.html#cb449-41" tabindex="-1"></a>      tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sorter&quot;</span>)</span>
<span id="cb449-42"><a href="stats_validation.html#cb449-42" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="cf">function</span>(x){<span class="fu">factor</span>(</span>
<span id="cb449-43"><a href="stats_validation.html#cb449-43" tabindex="-1"></a>        x, <span class="at">ordered =</span> T</span>
<span id="cb449-44"><a href="stats_validation.html#cb449-44" tabindex="-1"></a>        , <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_quality)</span>
<span id="cb449-45"><a href="stats_validation.html#cb449-45" tabindex="-1"></a>      )}</span>
<span id="cb449-46"><a href="stats_validation.html#cb449-46" tabindex="-1"></a>    )</span>
<span id="cb449-47"><a href="stats_validation.html#cb449-47" tabindex="-1"></a>    , <span class="at">contrast =</span> contrast <span class="sc">%&gt;%</span> </span>
<span id="cb449-48"><a href="stats_validation.html#cb449-48" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb449-49"><a href="stats_validation.html#cb449-49" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="fu">as.numeric</span>(sorter1), <span class="fu">as.numeric</span>(sorter2)) <span class="sc">%&gt;%</span> </span>
<span id="cb449-50"><a href="stats_validation.html#cb449-50" tabindex="-1"></a>          <span class="fu">as.numeric</span>()</span>
<span id="cb449-51"><a href="stats_validation.html#cb449-51" tabindex="-1"></a>      )</span>
<span id="cb449-52"><a href="stats_validation.html#cb449-52" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb449-53"><a href="stats_validation.html#cb449-53" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb449-54"><a href="stats_validation.html#cb449-54" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, software) <span class="sc">%&gt;%</span> </span>
<span id="cb449-55"><a href="stats_validation.html#cb449-55" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb449-56"><a href="stats_validation.html#cb449-56" tabindex="-1"></a></span>
<span id="cb449-57"><a href="stats_validation.html#cb449-57" tabindex="-1"></a><span class="co"># remove out-of-sample obs</span></span>
<span id="cb449-58"><a href="stats_validation.html#cb449-58" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb449-59"><a href="stats_validation.html#cb449-59" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb449-60"><a href="stats_validation.html#cb449-60" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(software, depth_maps_generation_quality)</span>
<span id="cb449-61"><a href="stats_validation.html#cb449-61" tabindex="-1"></a>    , <span class="at">by =</span> dplyr<span class="sc">::</span><span class="fu">join_by</span>(software, sorter1 <span class="sc">==</span> depth_maps_generation_quality)</span>
<span id="cb449-62"><a href="stats_validation.html#cb449-62" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb449-63"><a href="stats_validation.html#cb449-63" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb449-64"><a href="stats_validation.html#cb449-64" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(software, depth_maps_generation_quality)</span>
<span id="cb449-65"><a href="stats_validation.html#cb449-65" tabindex="-1"></a>    , <span class="at">by =</span> dplyr<span class="sc">::</span><span class="fu">join_by</span>(software, sorter2 <span class="sc">==</span> depth_maps_generation_quality)</span>
<span id="cb449-66"><a href="stats_validation.html#cb449-66" tabindex="-1"></a>  )</span>
<span id="cb449-67"><a href="stats_validation.html#cb449-67" tabindex="-1"></a>  </span>
<span id="cb449-68"><a href="stats_validation.html#cb449-68" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb449-69"><a href="stats_validation.html#cb449-69" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 1,040,000
## Columns: 17
## Groups: contrast, software [26]
## $ software            &lt;chr&gt; &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;METASHAPE&quot;…
## $ .chain              &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .iteration          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .draw               &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,…
## $ sorter1             &lt;ord&gt; ultra high, ultra high, ultra high, ultra high, ul…
## $ sorter2             &lt;ord&gt; high, high, high, high, high, high, high, high, hi…
## $ contrast            &lt;fct&gt; ultra high - high, ultra high - high, ultra high -…
## $ value               &lt;dbl&gt; 0.158376692, -0.015628733, 0.185569876, 0.15198170…
## $ median_hdi_est      &lt;dbl&gt; 0.01621978, 0.01621978, 0.01621978, 0.01621978, 0.…
## $ median_hdi_lower    &lt;dbl&gt; -0.1248058, -0.1248058, -0.1248058, -0.1248058, -0…
## $ median_hdi_upper    &lt;dbl&gt; 0.169538, 0.169538, 0.169538, 0.169538, 0.169538, …
## $ is_gt_zero          &lt;lgl&gt; TRUE, FALSE, TRUE, TRUE, FALSE, TRUE, TRUE, TRUE, …
## $ pct_gt_zero         &lt;dbl&gt; 0.619, 0.619, 0.619, 0.619, 0.619, 0.619, 0.619, 0…
## $ pct_gt_zero_lab     &lt;chr&gt; &quot;Pr(ultra high&gt;high)=62%&quot;, &quot;Pr(ultra high&gt;high)=62…
## $ pct_gt_zero_lab_sm  &lt;chr&gt; &quot;Pr(&gt;0)=62%&quot;, &quot;Pr(&gt;0)=62%&quot;, &quot;Pr(&gt;0)=62%&quot;, &quot;Pr(&gt;0)=…
## $ pct_gt_zero_lab_pos &lt;dbl&gt; 0.1822533, 0.1822533, 0.1822533, 0.1822533, 0.1822…
## $ sig_level           &lt;ord&gt; &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;8…</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="stats_validation.html#cb451-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb451-2"><a href="stats_validation.html#cb451-2" tabindex="-1"></a>  brms_contrast_temp, <span class="at">caption_text =</span> form_temp</span>
<span id="cb451-3"><a href="stats_validation.html#cb451-3" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;quality&quot;</span></span>
<span id="cb451-4"><a href="stats_validation.html#cb451-4" tabindex="-1"></a>  , <span class="at">facet =</span> <span class="st">&quot;software&quot;</span></span>
<span id="cb451-5"><a href="stats_validation.html#cb451-5" tabindex="-1"></a>  , <span class="at">label_size =</span> <span class="fl">2.2</span></span>
<span id="cb451-6"><a href="stats_validation.html#cb451-6" tabindex="-1"></a>  , <span class="at">x_expand =</span> <span class="fu">c</span>(<span class="fl">0.46</span>,<span class="fl">0.75</span>)</span>
<span id="cb451-7"><a href="stats_validation.html#cb451-7" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb451-8"><a href="stats_validation.html#cb451-8" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb451-9"><a href="stats_validation.html#cb451-9" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of group constrasts with 95% &amp; 50% HDI</span><span class="sc">\n</span><span class="st">by software&quot;</span></span>
<span id="cb451-10"><a href="stats_validation.html#cb451-10" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-333-1.png" width="1008" /></p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="stats_validation.html#cb452-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb452-2"><a href="stats_validation.html#cb452-2" tabindex="-1"></a>  <span class="st">&quot;../data/qlty_sftwr_comp_mod6.png&quot;</span></span>
<span id="cb452-3"><a href="stats_validation.html#cb452-3" tabindex="-1"></a>  , <span class="at">plot =</span> ggplot2<span class="sc">::</span><span class="fu">last_plot</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb452-4"><a href="stats_validation.html#cb452-4" tabindex="-1"></a>  , <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span></span>
<span id="cb452-5"><a href="stats_validation.html#cb452-5" tabindex="-1"></a>)</span></code></pre></div>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="stats_validation.html#cb453-1" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb453-2"><a href="stats_validation.html#cb453-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, software) <span class="sc">%&gt;%</span> </span>
<span id="cb453-3"><a href="stats_validation.html#cb453-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb453-4"><a href="stats_validation.html#cb453-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast, software) <span class="sc">%&gt;%</span> </span>
<span id="cb453-5"><a href="stats_validation.html#cb453-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, software, value, .lower, .upper) <span class="sc">%&gt;%</span> </span>
<span id="cb453-6"><a href="stats_validation.html#cb453-6" tabindex="-1"></a>   </span>
<span id="cb453-7"><a href="stats_validation.html#cb453-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(software, contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb453-8"><a href="stats_validation.html#cb453-8" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb453-9"><a href="stats_validation.html#cb453-9" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb453-10"><a href="stats_validation.html#cb453-10" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb453-11"><a href="stats_validation.html#cb453-11" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb453-12"><a href="stats_validation.html#cb453-12" tabindex="-1"></a>      <span class="st">&quot;quality contrast&quot;</span></span>
<span id="cb453-13"><a href="stats_validation.html#cb453-13" tabindex="-1"></a>      , <span class="st">&quot;software&quot;</span></span>
<span id="cb453-14"><a href="stats_validation.html#cb453-14" tabindex="-1"></a>      , <span class="st">&quot;difference (F-score)&quot;</span></span>
<span id="cb453-15"><a href="stats_validation.html#cb453-15" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb453-16"><a href="stats_validation.html#cb453-16" tabindex="-1"></a>    )</span>
<span id="cb453-17"><a href="stats_validation.html#cb453-17" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb453-18"><a href="stats_validation.html#cb453-18" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb453-19"><a href="stats_validation.html#cb453-19" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;6in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:6in; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-334">Table 6.33: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
quality contrast
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
software
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
difference (F-score)
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI low
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.33
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - lowest
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.58
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.20
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.31
</td>
</tr>
<tr>
<td style="text-align:left;">
high - lowest
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.57
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.51
</td>
</tr>
<tr>
<td style="text-align:left;">
low - lowest
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.39
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.43
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.41
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - lowest
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.42
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.33
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.32
</td>
</tr>
<tr>
<td style="text-align:left;">
high - lowest
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.34
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
-0.15
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;">
-0.17
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;">
0.13
</td>
</tr>
<tr>
<td style="text-align:left;">
low - lowest
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
0.15
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.15
</td>
<td style="text-align:right;">
0.16
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.16
</td>
<td style="text-align:right;">
0.16
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.24
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.16
</td>
<td style="text-align:right;">
0.15
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
</tbody>
</table>
</div>
<p>The contrasts above address the question “are there differences in F-score based on dense point cloud generation quality within each software?”.</p>
<p>To address the different question of “are there differences in F-score based on the processing software used at a given dense point cloud generation quality?” we need to utilize a different formulation of the <code>comparison</code> parameter within our call to the <code>tidybayes::compare_levels</code> function and calculate the contrast by <code>software</code> instead</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="stats_validation.html#cb454-1" tabindex="-1"></a><span class="co"># calculate contrast</span></span>
<span id="cb454-2"><a href="stats_validation.html#cb454-2" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> qlty_sftwr_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb454-3"><a href="stats_validation.html#cb454-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb454-4"><a href="stats_validation.html#cb454-4" tabindex="-1"></a>    value</span>
<span id="cb454-5"><a href="stats_validation.html#cb454-5" tabindex="-1"></a>    , <span class="at">by =</span> software</span>
<span id="cb454-6"><a href="stats_validation.html#cb454-6" tabindex="-1"></a>    , <span class="at">comparison =</span> <span class="st">&quot;pairwise&quot;</span></span>
<span id="cb454-7"><a href="stats_validation.html#cb454-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb454-8"><a href="stats_validation.html#cb454-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> software) <span class="sc">%&gt;%</span> </span>
<span id="cb454-9"><a href="stats_validation.html#cb454-9" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb454-10"><a href="stats_validation.html#cb454-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb454-11"><a href="stats_validation.html#cb454-11" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb454-12"><a href="stats_validation.html#cb454-12" tabindex="-1"></a></span>
<span id="cb454-13"><a href="stats_validation.html#cb454-13" tabindex="-1"></a><span class="co"># remove out-of-sample obs</span></span>
<span id="cb454-14"><a href="stats_validation.html#cb454-14" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb454-15"><a href="stats_validation.html#cb454-15" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(</span>
<span id="cb454-16"><a href="stats_validation.html#cb454-16" tabindex="-1"></a>    <span class="at">cols =</span> contrast</span>
<span id="cb454-17"><a href="stats_validation.html#cb454-17" tabindex="-1"></a>    , <span class="at">delim =</span> <span class="st">&quot; - &quot;</span></span>
<span id="cb454-18"><a href="stats_validation.html#cb454-18" tabindex="-1"></a>    , <span class="at">names =</span> <span class="fu">paste0</span>(</span>
<span id="cb454-19"><a href="stats_validation.html#cb454-19" tabindex="-1"></a>      <span class="st">&quot;sorter&quot;</span></span>
<span id="cb454-20"><a href="stats_validation.html#cb454-20" tabindex="-1"></a>      , <span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(stringr<span class="sc">::</span><span class="fu">str_count</span>(brms_contrast_temp<span class="sc">$</span>contrast, <span class="st">&quot;-&quot;</span>))<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb454-21"><a href="stats_validation.html#cb454-21" tabindex="-1"></a>    )</span>
<span id="cb454-22"><a href="stats_validation.html#cb454-22" tabindex="-1"></a>    , <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span></span>
<span id="cb454-23"><a href="stats_validation.html#cb454-23" tabindex="-1"></a>    , <span class="at">cols_remove =</span> F</span>
<span id="cb454-24"><a href="stats_validation.html#cb454-24" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb454-25"><a href="stats_validation.html#cb454-25" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sorter1<span class="sc">!=</span>sorter2) <span class="sc">%&gt;%</span> </span>
<span id="cb454-26"><a href="stats_validation.html#cb454-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb454-27"><a href="stats_validation.html#cb454-27" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(software, depth_maps_generation_quality)</span>
<span id="cb454-28"><a href="stats_validation.html#cb454-28" tabindex="-1"></a>    , <span class="at">by =</span> dplyr<span class="sc">::</span><span class="fu">join_by</span>(sorter1 <span class="sc">==</span> software, depth_maps_generation_quality)</span>
<span id="cb454-29"><a href="stats_validation.html#cb454-29" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb454-30"><a href="stats_validation.html#cb454-30" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb454-31"><a href="stats_validation.html#cb454-31" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(software, depth_maps_generation_quality)</span>
<span id="cb454-32"><a href="stats_validation.html#cb454-32" tabindex="-1"></a>    , <span class="at">by =</span> dplyr<span class="sc">::</span><span class="fu">join_by</span>(sorter2 <span class="sc">==</span> software, depth_maps_generation_quality)</span>
<span id="cb454-33"><a href="stats_validation.html#cb454-33" tabindex="-1"></a>  )</span>
<span id="cb454-34"><a href="stats_validation.html#cb454-34" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb454-35"><a href="stats_validation.html#cb454-35" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 520,000
## Columns: 17
## Groups: contrast, depth_maps_generation_quality [13]
## $ depth_maps_generation_quality &lt;ord&gt; ultra high, ultra high, ultra high, ultr…
## $ .chain                        &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ .iteration                    &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ .draw                         &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1…
## $ sorter1                       &lt;chr&gt; &quot;OPENDRONEMAP&quot;, &quot;OPENDRONEMAP&quot;, &quot;OPENDRO…
## $ sorter2                       &lt;chr&gt; &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;…
## $ contrast                      &lt;chr&gt; &quot;OPENDRONEMAP - METASHAPE&quot;, &quot;OPENDRONEMA…
## $ value                         &lt;dbl&gt; -0.0106825948, -0.0492929373, -0.1107246…
## $ median_hdi_est                &lt;dbl&gt; -0.007731576, -0.007731576, -0.007731576…
## $ median_hdi_lower              &lt;dbl&gt; -0.2333937, -0.2333937, -0.2333937, -0.2…
## $ median_hdi_upper              &lt;dbl&gt; 0.2114123, 0.2114123, 0.2114123, 0.21141…
## $ is_gt_zero                    &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, FALSE, TRUE, FAL…
## $ pct_gt_zero                   &lt;dbl&gt; 0.54255, 0.54255, 0.54255, 0.54255, 0.54…
## $ pct_gt_zero_lab               &lt;chr&gt; &quot;Pr(MtaShp&gt;ODM)=54%&quot;, &quot;Pr(MtaShp&gt;ODM)=54…
## $ pct_gt_zero_lab_sm            &lt;chr&gt; &quot;Pr(&lt;0)=54%&quot;, &quot;Pr(&lt;0)=54%&quot;, &quot;Pr(&lt;0)=54%&quot;…
## $ pct_gt_zero_lab_pos           &lt;dbl&gt; -0.2508982, -0.2508982, -0.2508982, -0.2…
## $ sig_level                     &lt;ord&gt; &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%…</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="stats_validation.html#cb456-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb456-2"><a href="stats_validation.html#cb456-2" tabindex="-1"></a>  brms_contrast_temp, <span class="at">caption_text =</span> form_temp</span>
<span id="cb456-3"><a href="stats_validation.html#cb456-3" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;software&quot;</span></span>
<span id="cb456-4"><a href="stats_validation.html#cb456-4" tabindex="-1"></a>  , <span class="at">facet =</span> <span class="st">&quot;depth_maps_generation_quality&quot;</span></span>
<span id="cb456-5"><a href="stats_validation.html#cb456-5" tabindex="-1"></a>  , <span class="at">label_size =</span> <span class="fl">2.0</span></span>
<span id="cb456-6"><a href="stats_validation.html#cb456-6" tabindex="-1"></a>  , <span class="at">x_expand =</span> <span class="fu">c</span>(<span class="fl">0.17</span>,<span class="fl">0.14</span>)</span>
<span id="cb456-7"><a href="stats_validation.html#cb456-7" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb456-8"><a href="stats_validation.html#cb456-8" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(depth_maps_generation_quality), <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb456-9"><a href="stats_validation.html#cb456-9" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb456-10"><a href="stats_validation.html#cb456-10" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of group constrasts with 95% &amp; 50% HDI</span><span class="sc">\n</span><span class="st">by dense cloud quality&quot;</span></span>
<span id="cb456-11"><a href="stats_validation.html#cb456-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb456-12"><a href="stats_validation.html#cb456-12" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb456-13"><a href="stats_validation.html#cb456-13" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">75</span>, .<span class="dv">13</span>)</span>
<span id="cb456-14"><a href="stats_validation.html#cb456-14" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb456-15"><a href="stats_validation.html#cb456-15" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb456-16"><a href="stats_validation.html#cb456-16" tabindex="-1"></a>    <span class="at">legend.key.width  =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;lines&quot;</span>),</span>
<span id="cb456-17"><a href="stats_validation.html#cb456-17" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">7</span>, <span class="st">&quot;lines&quot;</span>)</span>
<span id="cb456-18"><a href="stats_validation.html#cb456-18" tabindex="-1"></a>  )))</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-336-1.png" width="1008" /></p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="stats_validation.html#cb457-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb457-2"><a href="stats_validation.html#cb457-2" tabindex="-1"></a>  <span class="st">&quot;../data/sftwr_qlty_comp_mod6.png&quot;</span></span>
<span id="cb457-3"><a href="stats_validation.html#cb457-3" tabindex="-1"></a>  , <span class="at">plot =</span> ggplot2<span class="sc">::</span><span class="fu">last_plot</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb457-4"><a href="stats_validation.html#cb457-4" tabindex="-1"></a>  , <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span></span>
<span id="cb457-5"><a href="stats_validation.html#cb457-5" tabindex="-1"></a>)</span></code></pre></div>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="stats_validation.html#cb458-1" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb458-2"><a href="stats_validation.html#cb458-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb458-3"><a href="stats_validation.html#cb458-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb458-4"><a href="stats_validation.html#cb458-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast, depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb458-5"><a href="stats_validation.html#cb458-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, depth_maps_generation_quality, value, .lower, .upper) <span class="sc">%&gt;%</span> </span>
<span id="cb458-6"><a href="stats_validation.html#cb458-6" tabindex="-1"></a>   </span>
<span id="cb458-7"><a href="stats_validation.html#cb458-7" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb458-8"><a href="stats_validation.html#cb458-8" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb458-9"><a href="stats_validation.html#cb458-9" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb458-10"><a href="stats_validation.html#cb458-10" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb458-11"><a href="stats_validation.html#cb458-11" tabindex="-1"></a>      <span class="st">&quot;software contrast&quot;</span></span>
<span id="cb458-12"><a href="stats_validation.html#cb458-12" tabindex="-1"></a>      , <span class="st">&quot;quality&quot;</span></span>
<span id="cb458-13"><a href="stats_validation.html#cb458-13" tabindex="-1"></a>      , <span class="st">&quot;difference (F-score)&quot;</span></span>
<span id="cb458-14"><a href="stats_validation.html#cb458-14" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb458-15"><a href="stats_validation.html#cb458-15" tabindex="-1"></a>    )</span>
<span id="cb458-16"><a href="stats_validation.html#cb458-16" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb458-17"><a href="stats_validation.html#cb458-17" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb458-18"><a href="stats_validation.html#cb458-18" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;8in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:8in; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-337">Table 6.34: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
software contrast
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
quality
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
difference (F-score)
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI low
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
OPENDRONEMAP - METASHAPE
</td>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
-0.23
</td>
<td style="text-align:right;">
0.21
</td>
</tr>
<tr>
<td style="text-align:left;">
OPENDRONEMAP - METASHAPE
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
-0.30
</td>
<td style="text-align:right;">
0.14
</td>
</tr>
<tr>
<td style="text-align:left;">
OPENDRONEMAP - METASHAPE
</td>
<td style="text-align:left;">
medium
</td>
<td style="text-align:right;">
-0.20
</td>
<td style="text-align:right;">
-0.44
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
OPENDRONEMAP - METASHAPE
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
-0.31
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
OPENDRONEMAP - METASHAPE
</td>
<td style="text-align:left;">
lowest
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.34
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - METASHAPE
</td>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
-0.28
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - METASHAPE
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
-0.27
</td>
<td style="text-align:right;">
0.18
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - METASHAPE
</td>
<td style="text-align:left;">
medium
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.21
</td>
<td style="text-align:right;">
0.24
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - METASHAPE
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.26
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - OPENDRONEMAP
</td>
<td style="text-align:left;">
ultra high
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
-0.28
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - OPENDRONEMAP
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.27
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - OPENDRONEMAP
</td>
<td style="text-align:left;">
medium
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.45
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - OPENDRONEMAP
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.36
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="softwarefiltering---interaction-1" class="section level4 hasAnchor" number="6.9.2.6">
<h4><span class="header-section-number">6.9.2.6</span> Software:Filtering - interaction<a href="stats_validation.html#softwarefiltering---interaction-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Are there differences in F-score based on dense point cloud filtering mode within each processing software?</p>
<p>Here, we collapse across the study site, depth map generation quality, and story to compare the combined filtering mode and software effect.</p>
<p>In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<p>Even though filtering mode had a small effect on the SfM predictive ability when averaging across all softwares, there might still be differences in filtering mode within software when we average across all depth map generation quality settings. Let’s check the difference in F-score by depth map filtering mode and software.</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="stats_validation.html#cb459-1" tabindex="-1"></a><span class="co"># get draws</span></span>
<span id="cb459-2"><a href="stats_validation.html#cb459-2" tabindex="-1"></a>fltr_sftwr_draws_temp <span class="ot">=</span> ptcld_validation_data <span class="sc">%&gt;%</span></span>
<span id="cb459-3"><a href="stats_validation.html#cb459-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_filtering_mode, software) <span class="sc">%&gt;%</span> </span>
<span id="cb459-4"><a href="stats_validation.html#cb459-4" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb459-5"><a href="stats_validation.html#cb459-5" tabindex="-1"></a>    brms_f_mod6, <span class="at">allow_new_levels =</span> T</span>
<span id="cb459-6"><a href="stats_validation.html#cb459-6" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb459-7"><a href="stats_validation.html#cb459-7" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode) <span class="sc">+</span></span>
<span id="cb459-8"><a href="stats_validation.html#cb459-8" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> software) <span class="sc">+</span> </span>
<span id="cb459-9"><a href="stats_validation.html#cb459-9" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode<span class="sc">:</span>software)</span>
<span id="cb459-10"><a href="stats_validation.html#cb459-10" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb459-11"><a href="stats_validation.html#cb459-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred)</span>
<span id="cb459-12"><a href="stats_validation.html#cb459-12" tabindex="-1"></a></span>
<span id="cb459-13"><a href="stats_validation.html#cb459-13" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb459-14"><a href="stats_validation.html#cb459-14" tabindex="-1"></a>fltr_sftwr_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb459-15"><a href="stats_validation.html#cb459-15" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb459-16"><a href="stats_validation.html#cb459-16" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb459-17"><a href="stats_validation.html#cb459-17" tabindex="-1"></a>      <span class="at">y =</span> value, <span class="at">x =</span> software</span>
<span id="cb459-18"><a href="stats_validation.html#cb459-18" tabindex="-1"></a>      , <span class="at">fill =</span> software</span>
<span id="cb459-19"><a href="stats_validation.html#cb459-19" tabindex="-1"></a>    )</span>
<span id="cb459-20"><a href="stats_validation.html#cb459-20" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb459-21"><a href="stats_validation.html#cb459-21" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_eye</span>(</span>
<span id="cb459-22"><a href="stats_validation.html#cb459-22" tabindex="-1"></a>    <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb459-23"><a href="stats_validation.html#cb459-23" tabindex="-1"></a>    , <span class="at">slab_alpha =</span> <span class="fl">0.8</span></span>
<span id="cb459-24"><a href="stats_validation.html#cb459-24" tabindex="-1"></a>    , <span class="at">interval_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb459-25"><a href="stats_validation.html#cb459-25" tabindex="-1"></a>    , <span class="at">point_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_size =</span> <span class="dv">1</span></span>
<span id="cb459-26"><a href="stats_validation.html#cb459-26" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb459-27"><a href="stats_validation.html#cb459-27" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;rocket&quot;</span>, <span class="at">begin =</span> <span class="fl">0.3</span>, <span class="at">end =</span> <span class="fl">0.9</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb459-28"><a href="stats_validation.html#cb459-28" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb459-29"><a href="stats_validation.html#cb459-29" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(depth_maps_generation_filtering_mode)) <span class="sc">+</span></span>
<span id="cb459-30"><a href="stats_validation.html#cb459-30" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb459-31"><a href="stats_validation.html#cb459-31" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;software&quot;</span>, <span class="at">y =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb459-32"><a href="stats_validation.html#cb459-32" tabindex="-1"></a>    , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI</span><span class="sc">\n</span><span class="st">by filtering mode&quot;</span></span>
<span id="cb459-33"><a href="stats_validation.html#cb459-33" tabindex="-1"></a>    , <span class="at">caption =</span> form_temp</span>
<span id="cb459-34"><a href="stats_validation.html#cb459-34" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb459-35"><a href="stats_validation.html#cb459-35" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb459-36"><a href="stats_validation.html#cb459-36" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb459-37"><a href="stats_validation.html#cb459-37" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb459-38"><a href="stats_validation.html#cb459-38" tabindex="-1"></a>    , <span class="at">legend.direction  =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb459-39"><a href="stats_validation.html#cb459-39" tabindex="-1"></a>    , <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb459-40"><a href="stats_validation.html#cb459-40" tabindex="-1"></a>    , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb459-41"><a href="stats_validation.html#cb459-41" tabindex="-1"></a>  ) </span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-338-1.png" width="1008" /></p>
<p>we can also make pairwise comparisons so long as we continue using <code>tidybayes::add_epred_draws</code> with the <code>re_formula</code> argument</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="stats_validation.html#cb460-1" tabindex="-1"></a><span class="co"># calculate contrast</span></span>
<span id="cb460-2"><a href="stats_validation.html#cb460-2" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> fltr_sftwr_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb460-3"><a href="stats_validation.html#cb460-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb460-4"><a href="stats_validation.html#cb460-4" tabindex="-1"></a>    value</span>
<span id="cb460-5"><a href="stats_validation.html#cb460-5" tabindex="-1"></a>    , <span class="at">by =</span> depth_maps_generation_filtering_mode</span>
<span id="cb460-6"><a href="stats_validation.html#cb460-6" tabindex="-1"></a>    , <span class="at">comparison =</span> <span class="st">&quot;pairwise&quot;</span></span>
<span id="cb460-7"><a href="stats_validation.html#cb460-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb460-8"><a href="stats_validation.html#cb460-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> depth_maps_generation_filtering_mode)</span>
<span id="cb460-9"><a href="stats_validation.html#cb460-9" tabindex="-1"></a></span>
<span id="cb460-10"><a href="stats_validation.html#cb460-10" tabindex="-1"></a><span class="co"># separate contrast</span></span>
<span id="cb460-11"><a href="stats_validation.html#cb460-11" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb460-12"><a href="stats_validation.html#cb460-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb460-13"><a href="stats_validation.html#cb460-13" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(</span>
<span id="cb460-14"><a href="stats_validation.html#cb460-14" tabindex="-1"></a>    <span class="at">cols =</span> contrast</span>
<span id="cb460-15"><a href="stats_validation.html#cb460-15" tabindex="-1"></a>    , <span class="at">delim =</span> <span class="st">&quot; - &quot;</span></span>
<span id="cb460-16"><a href="stats_validation.html#cb460-16" tabindex="-1"></a>    , <span class="at">names =</span> <span class="fu">paste0</span>(</span>
<span id="cb460-17"><a href="stats_validation.html#cb460-17" tabindex="-1"></a>      <span class="st">&quot;sorter&quot;</span></span>
<span id="cb460-18"><a href="stats_validation.html#cb460-18" tabindex="-1"></a>      , <span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(stringr<span class="sc">::</span><span class="fu">str_count</span>(brms_contrast_temp<span class="sc">$</span>contrast, <span class="st">&quot;-&quot;</span>))<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb460-19"><a href="stats_validation.html#cb460-19" tabindex="-1"></a>    )</span>
<span id="cb460-20"><a href="stats_validation.html#cb460-20" tabindex="-1"></a>    , <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span></span>
<span id="cb460-21"><a href="stats_validation.html#cb460-21" tabindex="-1"></a>    , <span class="at">cols_remove =</span> F</span>
<span id="cb460-22"><a href="stats_validation.html#cb460-22" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb460-23"><a href="stats_validation.html#cb460-23" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sorter1<span class="sc">!=</span>sorter2) <span class="sc">%&gt;%</span> </span>
<span id="cb460-24"><a href="stats_validation.html#cb460-24" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb460-25"><a href="stats_validation.html#cb460-25" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb460-26"><a href="stats_validation.html#cb460-26" tabindex="-1"></a>      tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sorter&quot;</span>)</span>
<span id="cb460-27"><a href="stats_validation.html#cb460-27" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="cf">function</span>(x){<span class="fu">factor</span>(</span>
<span id="cb460-28"><a href="stats_validation.html#cb460-28" tabindex="-1"></a>        x, <span class="at">ordered =</span> T</span>
<span id="cb460-29"><a href="stats_validation.html#cb460-29" tabindex="-1"></a>        , <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_filtering_mode)</span>
<span id="cb460-30"><a href="stats_validation.html#cb460-30" tabindex="-1"></a>      )}</span>
<span id="cb460-31"><a href="stats_validation.html#cb460-31" tabindex="-1"></a>    )</span>
<span id="cb460-32"><a href="stats_validation.html#cb460-32" tabindex="-1"></a>    , <span class="at">contrast =</span> contrast <span class="sc">%&gt;%</span> </span>
<span id="cb460-33"><a href="stats_validation.html#cb460-33" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb460-34"><a href="stats_validation.html#cb460-34" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="fu">as.numeric</span>(sorter1), <span class="fu">as.numeric</span>(sorter2)) <span class="sc">%&gt;%</span> </span>
<span id="cb460-35"><a href="stats_validation.html#cb460-35" tabindex="-1"></a>          <span class="fu">as.numeric</span>()</span>
<span id="cb460-36"><a href="stats_validation.html#cb460-36" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb460-37"><a href="stats_validation.html#cb460-37" tabindex="-1"></a>      <span class="co"># re order for filtering mode</span></span>
<span id="cb460-38"><a href="stats_validation.html#cb460-38" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_rev</span>()</span>
<span id="cb460-39"><a href="stats_validation.html#cb460-39" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb460-40"><a href="stats_validation.html#cb460-40" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb460-41"><a href="stats_validation.html#cb460-41" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, software) <span class="sc">%&gt;%</span> </span>
<span id="cb460-42"><a href="stats_validation.html#cb460-42" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb460-43"><a href="stats_validation.html#cb460-43" tabindex="-1"></a></span>
<span id="cb460-44"><a href="stats_validation.html#cb460-44" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb460-45"><a href="stats_validation.html#cb460-45" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 600,000
## Columns: 17
## Groups: contrast, software [15]
## $ software            &lt;chr&gt; &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;METASHAPE&quot;…
## $ .chain              &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .iteration          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .draw               &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,…
## $ sorter1             &lt;ord&gt; moderate, moderate, moderate, moderate, moderate, …
## $ sorter2             &lt;ord&gt; aggressive, aggressive, aggressive, aggressive, ag…
## $ contrast            &lt;fct&gt; moderate - aggressive, moderate - aggressive, mode…
## $ value               &lt;dbl&gt; -0.006856818, 0.076603376, 0.060906550, 0.05321381…
## $ median_hdi_est      &lt;dbl&gt; 0.05709402, 0.05709402, 0.05709402, 0.05709402, 0.…
## $ median_hdi_lower    &lt;dbl&gt; -0.02673803, -0.02673803, -0.02673803, -0.02673803…
## $ median_hdi_upper    &lt;dbl&gt; 0.1642191, 0.1642191, 0.1642191, 0.1642191, 0.1642…
## $ is_gt_zero          &lt;lgl&gt; FALSE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, T…
## $ pct_gt_zero         &lt;dbl&gt; 0.9202, 0.9202, 0.9202, 0.9202, 0.9202, 0.9202, 0.…
## $ pct_gt_zero_lab     &lt;chr&gt; &quot;Pr(moderate&gt;aggressive)=92%&quot;, &quot;Pr(moderate&gt;aggres…
## $ pct_gt_zero_lab_sm  &lt;chr&gt; &quot;Pr(&gt;0)=92%&quot;, &quot;Pr(&gt;0)=92%&quot;, &quot;Pr(&gt;0)=92%&quot;, &quot;Pr(&gt;0)=…
## $ pct_gt_zero_lab_pos &lt;dbl&gt; 0.1765355, 0.1765355, 0.1765355, 0.1765355, 0.1765…
## $ sig_level           &lt;ord&gt; 90%, 90%, 90%, 90%, 90%, 90%, 90%, 90%, 90%, 90%, …</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="stats_validation.html#cb462-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb462-2"><a href="stats_validation.html#cb462-2" tabindex="-1"></a>  brms_contrast_temp, <span class="at">caption_text =</span> form_temp</span>
<span id="cb462-3"><a href="stats_validation.html#cb462-3" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;filtering mode&quot;</span></span>
<span id="cb462-4"><a href="stats_validation.html#cb462-4" tabindex="-1"></a>  , <span class="at">facet =</span> <span class="st">&quot;software&quot;</span></span>
<span id="cb462-5"><a href="stats_validation.html#cb462-5" tabindex="-1"></a>  , <span class="at">label_size =</span> <span class="fl">2.0</span></span>
<span id="cb462-6"><a href="stats_validation.html#cb462-6" tabindex="-1"></a>  , <span class="at">x_expand =</span> <span class="fu">c</span>(<span class="fl">0.85</span>,<span class="fl">0.8</span>) <span class="co"># c(1,1.4)</span></span>
<span id="cb462-7"><a href="stats_validation.html#cb462-7" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb462-8"><a href="stats_validation.html#cb462-8" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb462-9"><a href="stats_validation.html#cb462-9" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of group constrasts with 95% &amp; 50% HDI</span><span class="sc">\n</span><span class="st">by software&quot;</span></span>
<span id="cb462-10"><a href="stats_validation.html#cb462-10" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-340-1.png" width="1008" /></p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="stats_validation.html#cb463-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb463-2"><a href="stats_validation.html#cb463-2" tabindex="-1"></a>  <span class="st">&quot;../data/fltr_sftwr_comp_mod6.png&quot;</span></span>
<span id="cb463-3"><a href="stats_validation.html#cb463-3" tabindex="-1"></a>  , <span class="at">plot =</span> ggplot2<span class="sc">::</span><span class="fu">last_plot</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb463-4"><a href="stats_validation.html#cb463-4" tabindex="-1"></a>  , <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span></span>
<span id="cb463-5"><a href="stats_validation.html#cb463-5" tabindex="-1"></a>)</span></code></pre></div>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="stats_validation.html#cb464-1" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb464-2"><a href="stats_validation.html#cb464-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, software) <span class="sc">%&gt;%</span> </span>
<span id="cb464-3"><a href="stats_validation.html#cb464-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb464-4"><a href="stats_validation.html#cb464-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast, software) <span class="sc">%&gt;%</span> </span>
<span id="cb464-5"><a href="stats_validation.html#cb464-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, software, value, .lower, .upper) <span class="sc">%&gt;%</span> </span>
<span id="cb464-6"><a href="stats_validation.html#cb464-6" tabindex="-1"></a>   </span>
<span id="cb464-7"><a href="stats_validation.html#cb464-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(software, contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb464-8"><a href="stats_validation.html#cb464-8" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb464-9"><a href="stats_validation.html#cb464-9" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb464-10"><a href="stats_validation.html#cb464-10" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb464-11"><a href="stats_validation.html#cb464-11" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb464-12"><a href="stats_validation.html#cb464-12" tabindex="-1"></a>      <span class="st">&quot;filtering contrast&quot;</span></span>
<span id="cb464-13"><a href="stats_validation.html#cb464-13" tabindex="-1"></a>      , <span class="st">&quot;software&quot;</span></span>
<span id="cb464-14"><a href="stats_validation.html#cb464-14" tabindex="-1"></a>      , <span class="st">&quot;difference (F-score)&quot;</span></span>
<span id="cb464-15"><a href="stats_validation.html#cb464-15" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb464-16"><a href="stats_validation.html#cb464-16" tabindex="-1"></a>    )</span>
<span id="cb464-17"><a href="stats_validation.html#cb464-17" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb464-18"><a href="stats_validation.html#cb464-18" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb464-19"><a href="stats_validation.html#cb464-19" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;6in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:6in; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-341">Table 6.35: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
filtering contrast
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
software
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
difference (F-score)
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI low
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
disabled - mild
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.10
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled - moderate
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.16
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled - aggressive
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;">
mild - moderate
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.15
</td>
</tr>
<tr>
<td style="text-align:left;">
mild - aggressive
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
<tr>
<td style="text-align:left;">
moderate - aggressive
</td>
<td style="text-align:left;">
METASHAPE
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.16
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled - mild
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.09
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled - moderate
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.08
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled - aggressive
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
-0.16
</td>
<td style="text-align:right;">
0.04
</td>
</tr>
<tr>
<td style="text-align:left;">
mild - moderate
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:left;">
mild - aggressive
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;">
0.03
</td>
</tr>
<tr>
<td style="text-align:left;">
moderate - aggressive
</td>
<td style="text-align:left;">
OPENDRONEMAP
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
-0.15
</td>
<td style="text-align:right;">
0.04
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled - mild
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.10
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled - moderate
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.14
</td>
</tr>
<tr>
<td style="text-align:left;">
mild - moderate
</td>
<td style="text-align:left;">
PIX4D
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.14
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="softwarequalityfiltering---interaction-1" class="section level4 hasAnchor" number="6.9.2.7">
<h4><span class="header-section-number">6.9.2.7</span> Software:Quality:Filtering - interaction<a href="stats_validation.html#softwarequalityfiltering---interaction-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The contrasts immediately above address the question “are there differences in F-score based on dense point cloud filtering mode within each software?”. Although the impact of filtering mode is small, it is highly probable when averaging across all quality settings. What if we don’t average out the impact of quality and instead get the full, three-way interaction between software, quality, and filtering mode?</p>
<p>Let’s get the model’s answer to the question “For each software, are there differences in F-score based on dense point cloud filtering mode within each point cloud generation quality?”.</p>
<p>Here, we collapse across the study site and story to compare the dense cloud quality, filtering mode, and software effect.</p>
<p>In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="stats_validation.html#cb465-1" tabindex="-1"></a><span class="co"># get draws</span></span>
<span id="cb465-2"><a href="stats_validation.html#cb465-2" tabindex="-1"></a>fltr_sftwr_draws_temp <span class="ot">=</span></span>
<span id="cb465-3"><a href="stats_validation.html#cb465-3" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">crossing</span>(</span>
<span id="cb465-4"><a href="stats_validation.html#cb465-4" tabindex="-1"></a>    <span class="at">depth_maps_generation_quality =</span> <span class="fu">unique</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_quality)</span>
<span id="cb465-5"><a href="stats_validation.html#cb465-5" tabindex="-1"></a>    , <span class="at">depth_maps_generation_filtering_mode =</span> <span class="fu">unique</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_filtering_mode)</span>
<span id="cb465-6"><a href="stats_validation.html#cb465-6" tabindex="-1"></a>    , <span class="at">software =</span> <span class="fu">unique</span>(ptcld_validation_data<span class="sc">$</span>software)</span>
<span id="cb465-7"><a href="stats_validation.html#cb465-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb465-8"><a href="stats_validation.html#cb465-8" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb465-9"><a href="stats_validation.html#cb465-9" tabindex="-1"></a>    brms_f_mod6, <span class="at">allow_new_levels =</span> T</span>
<span id="cb465-10"><a href="stats_validation.html#cb465-10" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb465-11"><a href="stats_validation.html#cb465-11" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span> <span class="co"># main effects</span></span>
<span id="cb465-12"><a href="stats_validation.html#cb465-12" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality) <span class="sc">+</span></span>
<span id="cb465-13"><a href="stats_validation.html#cb465-13" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode) <span class="sc">+</span> </span>
<span id="cb465-14"><a href="stats_validation.html#cb465-14" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> software) <span class="sc">+</span></span>
<span id="cb465-15"><a href="stats_validation.html#cb465-15" tabindex="-1"></a>    <span class="co"># two-way interactions</span></span>
<span id="cb465-16"><a href="stats_validation.html#cb465-16" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode) <span class="sc">+</span></span>
<span id="cb465-17"><a href="stats_validation.html#cb465-17" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>software) <span class="sc">+</span></span>
<span id="cb465-18"><a href="stats_validation.html#cb465-18" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode<span class="sc">:</span>software) <span class="sc">+</span></span>
<span id="cb465-19"><a href="stats_validation.html#cb465-19" tabindex="-1"></a>    <span class="co"># three-way interactions</span></span>
<span id="cb465-20"><a href="stats_validation.html#cb465-20" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality<span class="sc">:</span>depth_maps_generation_filtering_mode<span class="sc">:</span>software)</span>
<span id="cb465-21"><a href="stats_validation.html#cb465-21" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb465-22"><a href="stats_validation.html#cb465-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred)</span>
<span id="cb465-23"><a href="stats_validation.html#cb465-23" tabindex="-1"></a></span>
<span id="cb465-24"><a href="stats_validation.html#cb465-24" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb465-25"><a href="stats_validation.html#cb465-25" tabindex="-1"></a>fltr_sftwr_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb465-26"><a href="stats_validation.html#cb465-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb465-27"><a href="stats_validation.html#cb465-27" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(software, depth_maps_generation_quality, depth_maps_generation_filtering_mode)</span>
<span id="cb465-28"><a href="stats_validation.html#cb465-28" tabindex="-1"></a>    , <span class="at">by =</span> dplyr<span class="sc">::</span><span class="fu">join_by</span>(software, depth_maps_generation_quality, depth_maps_generation_filtering_mode)</span>
<span id="cb465-29"><a href="stats_validation.html#cb465-29" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb465-30"><a href="stats_validation.html#cb465-30" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">depth_maps_generation_quality =</span> depth_maps_generation_quality <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb465-31"><a href="stats_validation.html#cb465-31" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb465-32"><a href="stats_validation.html#cb465-32" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb465-33"><a href="stats_validation.html#cb465-33" tabindex="-1"></a>      <span class="at">y =</span> value</span>
<span id="cb465-34"><a href="stats_validation.html#cb465-34" tabindex="-1"></a>      , <span class="at">x =</span> depth_maps_generation_filtering_mode</span>
<span id="cb465-35"><a href="stats_validation.html#cb465-35" tabindex="-1"></a>      , <span class="at">fill =</span> depth_maps_generation_filtering_mode</span>
<span id="cb465-36"><a href="stats_validation.html#cb465-36" tabindex="-1"></a>    )</span>
<span id="cb465-37"><a href="stats_validation.html#cb465-37" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb465-38"><a href="stats_validation.html#cb465-38" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_eye</span>(</span>
<span id="cb465-39"><a href="stats_validation.html#cb465-39" tabindex="-1"></a>    <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb465-40"><a href="stats_validation.html#cb465-40" tabindex="-1"></a>    , <span class="at">slab_alpha =</span> <span class="fl">0.8</span></span>
<span id="cb465-41"><a href="stats_validation.html#cb465-41" tabindex="-1"></a>    , <span class="at">interval_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb465-42"><a href="stats_validation.html#cb465-42" tabindex="-1"></a>    , <span class="at">point_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">point_size =</span> <span class="dv">1</span></span>
<span id="cb465-43"><a href="stats_validation.html#cb465-43" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb465-44"><a href="stats_validation.html#cb465-44" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb465-45"><a href="stats_validation.html#cb465-45" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb465-46"><a href="stats_validation.html#cb465-46" tabindex="-1"></a>  <span class="fu">facet_grid</span>(</span>
<span id="cb465-47"><a href="stats_validation.html#cb465-47" tabindex="-1"></a>    <span class="at">rows =</span> <span class="fu">vars</span>(software)</span>
<span id="cb465-48"><a href="stats_validation.html#cb465-48" tabindex="-1"></a>    , <span class="at">cols =</span> <span class="fu">vars</span>(depth_maps_generation_quality)</span>
<span id="cb465-49"><a href="stats_validation.html#cb465-49" tabindex="-1"></a>    <span class="co"># , switch = &quot;y&quot;</span></span>
<span id="cb465-50"><a href="stats_validation.html#cb465-50" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb465-51"><a href="stats_validation.html#cb465-51" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb465-52"><a href="stats_validation.html#cb465-52" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;filtering mode&quot;</span></span>
<span id="cb465-53"><a href="stats_validation.html#cb465-53" tabindex="-1"></a>    , <span class="at">x =</span> <span class="st">&quot;filtering mode&quot;</span>, <span class="at">y =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb465-54"><a href="stats_validation.html#cb465-54" tabindex="-1"></a>    , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI</span><span class="sc">\n</span><span class="st">by dense cloud quality and software&quot;</span></span>
<span id="cb465-55"><a href="stats_validation.html#cb465-55" tabindex="-1"></a>    <span class="co"># , caption = form_temp</span></span>
<span id="cb465-56"><a href="stats_validation.html#cb465-56" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb465-57"><a href="stats_validation.html#cb465-57" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb465-58"><a href="stats_validation.html#cb465-58" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb465-59"><a href="stats_validation.html#cb465-59" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span></span>
<span id="cb465-60"><a href="stats_validation.html#cb465-60" tabindex="-1"></a>    , <span class="at">legend.direction  =</span> <span class="st">&quot;horizontal&quot;</span></span>
<span id="cb465-61"><a href="stats_validation.html#cb465-61" tabindex="-1"></a>    , <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb465-62"><a href="stats_validation.html#cb465-62" tabindex="-1"></a>    , <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb465-63"><a href="stats_validation.html#cb465-63" tabindex="-1"></a>    <span class="co"># , strip.placement = &quot;outside&quot;</span></span>
<span id="cb465-64"><a href="stats_validation.html#cb465-64" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb465-65"><a href="stats_validation.html#cb465-65" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb465-66"><a href="stats_validation.html#cb465-66" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">lwd =</span> <span class="cn">NA</span>))</span>
<span id="cb465-67"><a href="stats_validation.html#cb465-67" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-342-1.png" width="1008" /></p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="stats_validation.html#cb466-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb466-2"><a href="stats_validation.html#cb466-2" tabindex="-1"></a>  <span class="st">&quot;../data/qlty_fltr_sftwr_mod6.png&quot;</span></span>
<span id="cb466-3"><a href="stats_validation.html#cb466-3" tabindex="-1"></a>  , <span class="at">plot =</span> ggplot2<span class="sc">::</span><span class="fu">last_plot</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb466-4"><a href="stats_validation.html#cb466-4" tabindex="-1"></a>  , <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span></span>
<span id="cb466-5"><a href="stats_validation.html#cb466-5" tabindex="-1"></a>)</span></code></pre></div>
<p>we can also make pairwise comparisons so long as we continue using <code>tidybayes::add_epred_draws</code> with the <code>re_formula</code> argument</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="stats_validation.html#cb467-1" tabindex="-1"></a><span class="co"># calculate contrast</span></span>
<span id="cb467-2"><a href="stats_validation.html#cb467-2" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> fltr_sftwr_draws_temp <span class="sc">%&gt;%</span> </span>
<span id="cb467-3"><a href="stats_validation.html#cb467-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb467-4"><a href="stats_validation.html#cb467-4" tabindex="-1"></a>    value</span>
<span id="cb467-5"><a href="stats_validation.html#cb467-5" tabindex="-1"></a>    , <span class="at">by =</span> depth_maps_generation_filtering_mode</span>
<span id="cb467-6"><a href="stats_validation.html#cb467-6" tabindex="-1"></a>    , <span class="at">comparison =</span> <span class="st">&quot;pairwise&quot;</span></span>
<span id="cb467-7"><a href="stats_validation.html#cb467-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb467-8"><a href="stats_validation.html#cb467-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> depth_maps_generation_filtering_mode)</span>
<span id="cb467-9"><a href="stats_validation.html#cb467-9" tabindex="-1"></a></span>
<span id="cb467-10"><a href="stats_validation.html#cb467-10" tabindex="-1"></a><span class="co"># separate contrast</span></span>
<span id="cb467-11"><a href="stats_validation.html#cb467-11" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb467-12"><a href="stats_validation.html#cb467-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb467-13"><a href="stats_validation.html#cb467-13" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(</span>
<span id="cb467-14"><a href="stats_validation.html#cb467-14" tabindex="-1"></a>    <span class="at">cols =</span> contrast</span>
<span id="cb467-15"><a href="stats_validation.html#cb467-15" tabindex="-1"></a>    , <span class="at">delim =</span> <span class="st">&quot; - &quot;</span></span>
<span id="cb467-16"><a href="stats_validation.html#cb467-16" tabindex="-1"></a>    , <span class="at">names =</span> <span class="fu">paste0</span>(</span>
<span id="cb467-17"><a href="stats_validation.html#cb467-17" tabindex="-1"></a>      <span class="st">&quot;sorter&quot;</span></span>
<span id="cb467-18"><a href="stats_validation.html#cb467-18" tabindex="-1"></a>      , <span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(stringr<span class="sc">::</span><span class="fu">str_count</span>(brms_contrast_temp<span class="sc">$</span>contrast, <span class="st">&quot;-&quot;</span>))<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb467-19"><a href="stats_validation.html#cb467-19" tabindex="-1"></a>    )</span>
<span id="cb467-20"><a href="stats_validation.html#cb467-20" tabindex="-1"></a>    , <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span></span>
<span id="cb467-21"><a href="stats_validation.html#cb467-21" tabindex="-1"></a>    , <span class="at">cols_remove =</span> F</span>
<span id="cb467-22"><a href="stats_validation.html#cb467-22" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb467-23"><a href="stats_validation.html#cb467-23" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sorter1<span class="sc">!=</span>sorter2) <span class="sc">%&gt;%</span> </span>
<span id="cb467-24"><a href="stats_validation.html#cb467-24" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb467-25"><a href="stats_validation.html#cb467-25" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb467-26"><a href="stats_validation.html#cb467-26" tabindex="-1"></a>      tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sorter&quot;</span>)</span>
<span id="cb467-27"><a href="stats_validation.html#cb467-27" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="cf">function</span>(x){<span class="fu">factor</span>(</span>
<span id="cb467-28"><a href="stats_validation.html#cb467-28" tabindex="-1"></a>        x, <span class="at">ordered =</span> T</span>
<span id="cb467-29"><a href="stats_validation.html#cb467-29" tabindex="-1"></a>        , <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_filtering_mode)</span>
<span id="cb467-30"><a href="stats_validation.html#cb467-30" tabindex="-1"></a>      )}</span>
<span id="cb467-31"><a href="stats_validation.html#cb467-31" tabindex="-1"></a>    )</span>
<span id="cb467-32"><a href="stats_validation.html#cb467-32" tabindex="-1"></a>    , <span class="at">contrast =</span> contrast <span class="sc">%&gt;%</span> </span>
<span id="cb467-33"><a href="stats_validation.html#cb467-33" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb467-34"><a href="stats_validation.html#cb467-34" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="fu">as.numeric</span>(sorter1), <span class="fu">as.numeric</span>(sorter2)) <span class="sc">%&gt;%</span> </span>
<span id="cb467-35"><a href="stats_validation.html#cb467-35" tabindex="-1"></a>          <span class="fu">as.numeric</span>()</span>
<span id="cb467-36"><a href="stats_validation.html#cb467-36" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb467-37"><a href="stats_validation.html#cb467-37" tabindex="-1"></a>      <span class="co"># re order for filtering mode</span></span>
<span id="cb467-38"><a href="stats_validation.html#cb467-38" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_rev</span>()</span>
<span id="cb467-39"><a href="stats_validation.html#cb467-39" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb467-40"><a href="stats_validation.html#cb467-40" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb467-41"><a href="stats_validation.html#cb467-41" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast, software, depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb467-42"><a href="stats_validation.html#cb467-42" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb467-43"><a href="stats_validation.html#cb467-43" tabindex="-1"></a></span>
<span id="cb467-44"><a href="stats_validation.html#cb467-44" tabindex="-1"></a><span class="co"># remove out-of-sample obs</span></span>
<span id="cb467-45"><a href="stats_validation.html#cb467-45" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb467-46"><a href="stats_validation.html#cb467-46" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb467-47"><a href="stats_validation.html#cb467-47" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(software, depth_maps_generation_quality, depth_maps_generation_filtering_mode)</span>
<span id="cb467-48"><a href="stats_validation.html#cb467-48" tabindex="-1"></a>    , <span class="at">by =</span> dplyr<span class="sc">::</span><span class="fu">join_by</span>(software, depth_maps_generation_quality, sorter1<span class="sc">==</span>depth_maps_generation_filtering_mode)</span>
<span id="cb467-49"><a href="stats_validation.html#cb467-49" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb467-50"><a href="stats_validation.html#cb467-50" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb467-51"><a href="stats_validation.html#cb467-51" tabindex="-1"></a>    ptcld_validation_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>(software, depth_maps_generation_quality, depth_maps_generation_filtering_mode)</span>
<span id="cb467-52"><a href="stats_validation.html#cb467-52" tabindex="-1"></a>    , <span class="at">by =</span> dplyr<span class="sc">::</span><span class="fu">join_by</span>(software, depth_maps_generation_quality, sorter2<span class="sc">==</span>depth_maps_generation_filtering_mode)</span>
<span id="cb467-53"><a href="stats_validation.html#cb467-53" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb467-54"><a href="stats_validation.html#cb467-54" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">depth_maps_generation_quality =</span> depth_maps_generation_quality <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>())</span>
<span id="cb467-55"><a href="stats_validation.html#cb467-55" tabindex="-1"></a></span>
<span id="cb467-56"><a href="stats_validation.html#cb467-56" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb467-57"><a href="stats_validation.html#cb467-57" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 2,880,000
## Columns: 18
## Groups: contrast, software, depth_maps_generation_quality [72]
## $ depth_maps_generation_quality &lt;ord&gt; ultra high, ultra high, ultra high, ultr…
## $ software                      &lt;chr&gt; &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;METASHAPE&quot;, &quot;…
## $ .chain                        &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ .iteration                    &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ .draw                         &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1…
## $ sorter1                       &lt;ord&gt; moderate, moderate, moderate, moderate, …
## $ sorter2                       &lt;ord&gt; aggressive, aggressive, aggressive, aggr…
## $ contrast                      &lt;fct&gt; moderate - aggressive, moderate - aggres…
## $ value                         &lt;dbl&gt; -0.003468489, 0.068129488, 0.092618344, …
## $ median_hdi_est                &lt;dbl&gt; 0.06468366, 0.06468366, 0.06468366, 0.06…
## $ median_hdi_lower              &lt;dbl&gt; -0.03619306, -0.03619306, -0.03619306, -…
## $ median_hdi_upper              &lt;dbl&gt; 0.1828082, 0.1828082, 0.1828082, 0.18280…
## $ is_gt_zero                    &lt;lgl&gt; FALSE, TRUE, TRUE, TRUE, TRUE, TRUE, TRU…
## $ pct_gt_zero                   &lt;dbl&gt; 0.90815, 0.90815, 0.90815, 0.90815, 0.90…
## $ pct_gt_zero_lab               &lt;chr&gt; &quot;Pr(moderate&gt;aggressive)=91%&quot;, &quot;Pr(moder…
## $ pct_gt_zero_lab_sm            &lt;chr&gt; &quot;Pr(&gt;0)=91%&quot;, &quot;Pr(&gt;0)=91%&quot;, &quot;Pr(&gt;0)=91%&quot;…
## $ pct_gt_zero_lab_pos           &lt;dbl&gt; 0.1965188, 0.1965188, 0.1965188, 0.19651…
## $ sig_level                     &lt;ord&gt; 90%, 90%, 90%, 90%, 90%, 90%, 90%, 90%, …</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="stats_validation.html#cb469-1" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb469-2"><a href="stats_validation.html#cb469-2" tabindex="-1"></a>  <span class="fu">plt_contrast</span>(</span>
<span id="cb469-3"><a href="stats_validation.html#cb469-3" tabindex="-1"></a>    <span class="at">facet =</span> <span class="fu">c</span>(<span class="st">&quot;depth_maps_generation_quality&quot;</span>, <span class="st">&quot;software&quot;</span>)</span>
<span id="cb469-4"><a href="stats_validation.html#cb469-4" tabindex="-1"></a>    , <span class="at">y_axis_title =</span> <span class="st">&quot;filtering mode&quot;</span></span>
<span id="cb469-5"><a href="stats_validation.html#cb469-5" tabindex="-1"></a>    , <span class="at">label_size =</span> <span class="dv">0</span></span>
<span id="cb469-6"><a href="stats_validation.html#cb469-6" tabindex="-1"></a>    , <span class="at">x_expand =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>,<span class="sc">-</span><span class="fl">0.1</span>)</span>
<span id="cb469-7"><a href="stats_validation.html#cb469-7" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb469-8"><a href="stats_validation.html#cb469-8" tabindex="-1"></a>  <span class="fu">facet_grid</span>(</span>
<span id="cb469-9"><a href="stats_validation.html#cb469-9" tabindex="-1"></a>    <span class="at">rows =</span> <span class="fu">vars</span>(software)</span>
<span id="cb469-10"><a href="stats_validation.html#cb469-10" tabindex="-1"></a>    , <span class="at">cols =</span> <span class="fu">vars</span>(depth_maps_generation_quality)</span>
<span id="cb469-11"><a href="stats_validation.html#cb469-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb469-12"><a href="stats_validation.html#cb469-12" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb469-13"><a href="stats_validation.html#cb469-13" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of group constrasts with 95% &amp; 50% HDI</span><span class="sc">\n</span><span class="st">by dense cloud quality and software&quot;</span></span>
<span id="cb469-14"><a href="stats_validation.html#cb469-14" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-344-1.png" width="1008" /></p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="stats_validation.html#cb470-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(</span>
<span id="cb470-2"><a href="stats_validation.html#cb470-2" tabindex="-1"></a>  <span class="st">&quot;../data/qlty_fltr_sftwr_comp_mod6.png&quot;</span></span>
<span id="cb470-3"><a href="stats_validation.html#cb470-3" tabindex="-1"></a>  , <span class="at">plot =</span> ggplot2<span class="sc">::</span><span class="fu">last_plot</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb470-4"><a href="stats_validation.html#cb470-4" tabindex="-1"></a>  , <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="fl">10.5</span></span>
<span id="cb470-5"><a href="stats_validation.html#cb470-5" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="quality---main-effect-1" class="section level4 hasAnchor" number="6.9.2.8">
<h4><span class="header-section-number">6.9.2.8</span> Quality - main effect<a href="stats_validation.html#quality---main-effect-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>let’s collapse across the story, filtering mode, software, and study site to compare the dense cloud quality setting effect.
In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="stats_validation.html#cb471-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb471-2"><a href="stats_validation.html#cb471-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb471-3"><a href="stats_validation.html#cb471-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb471-4"><a href="stats_validation.html#cb471-4" tabindex="-1"></a>    brms_f_mod6</span>
<span id="cb471-5"><a href="stats_validation.html#cb471-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb471-6"><a href="stats_validation.html#cb471-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality)</span>
<span id="cb471-7"><a href="stats_validation.html#cb471-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb471-8"><a href="stats_validation.html#cb471-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb471-9"><a href="stats_validation.html#cb471-9" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb471-10"><a href="stats_validation.html#cb471-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb471-11"><a href="stats_validation.html#cb471-11" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb471-12"><a href="stats_validation.html#cb471-12" tabindex="-1"></a>      <span class="at">x =</span> value, <span class="at">y =</span> depth_maps_generation_quality</span>
<span id="cb471-13"><a href="stats_validation.html#cb471-13" tabindex="-1"></a>      , <span class="at">fill =</span> depth_maps_generation_quality</span>
<span id="cb471-14"><a href="stats_validation.html#cb471-14" tabindex="-1"></a>    )</span>
<span id="cb471-15"><a href="stats_validation.html#cb471-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb471-16"><a href="stats_validation.html#cb471-16" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb471-17"><a href="stats_validation.html#cb471-17" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb471-18"><a href="stats_validation.html#cb471-18" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;gray66&quot;</span></span>
<span id="cb471-19"><a href="stats_validation.html#cb471-19" tabindex="-1"></a>      , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_color =</span> <span class="st">&quot;gray66&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb471-20"><a href="stats_validation.html#cb471-20" tabindex="-1"></a>      , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb471-21"><a href="stats_validation.html#cb471-21" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb471-22"><a href="stats_validation.html#cb471-22" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;inferno&quot;</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb471-23"><a href="stats_validation.html#cb471-23" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb471-24"><a href="stats_validation.html#cb471-24" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb471-25"><a href="stats_validation.html#cb471-25" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;quality&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb471-26"><a href="stats_validation.html#cb471-26" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI&quot;</span></span>
<span id="cb471-27"><a href="stats_validation.html#cb471-27" tabindex="-1"></a>      , <span class="at">caption =</span> form_temp</span>
<span id="cb471-28"><a href="stats_validation.html#cb471-28" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb471-29"><a href="stats_validation.html#cb471-29" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb471-30"><a href="stats_validation.html#cb471-30" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-345-1.png" width="1008" /></p>
<p>we can also perform pairwise comparisons</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="stats_validation.html#cb472-1" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span></span>
<span id="cb472-2"><a href="stats_validation.html#cb472-2" tabindex="-1"></a>  ptcld_validation_data <span class="sc">%&gt;%</span></span>
<span id="cb472-3"><a href="stats_validation.html#cb472-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_quality) <span class="sc">%&gt;%</span> </span>
<span id="cb472-4"><a href="stats_validation.html#cb472-4" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb472-5"><a href="stats_validation.html#cb472-5" tabindex="-1"></a>      brms_f_mod6, <span class="at">allow_new_levels =</span> T</span>
<span id="cb472-6"><a href="stats_validation.html#cb472-6" tabindex="-1"></a>      <span class="co"># this part is crucial</span></span>
<span id="cb472-7"><a href="stats_validation.html#cb472-7" tabindex="-1"></a>      , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_quality)</span>
<span id="cb472-8"><a href="stats_validation.html#cb472-8" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb472-9"><a href="stats_validation.html#cb472-9" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb472-10"><a href="stats_validation.html#cb472-10" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb472-11"><a href="stats_validation.html#cb472-11" tabindex="-1"></a>      value</span>
<span id="cb472-12"><a href="stats_validation.html#cb472-12" tabindex="-1"></a>      , <span class="at">by =</span> depth_maps_generation_quality</span>
<span id="cb472-13"><a href="stats_validation.html#cb472-13" tabindex="-1"></a>      , <span class="at">comparison =</span> </span>
<span id="cb472-14"><a href="stats_validation.html#cb472-14" tabindex="-1"></a>        contrast_list</span>
<span id="cb472-15"><a href="stats_validation.html#cb472-15" tabindex="-1"></a>        <span class="co"># tidybayes::emmeans_comparison(&quot;revpairwise&quot;) </span></span>
<span id="cb472-16"><a href="stats_validation.html#cb472-16" tabindex="-1"></a>        <span class="co">#&quot;pairwise&quot;</span></span>
<span id="cb472-17"><a href="stats_validation.html#cb472-17" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb472-18"><a href="stats_validation.html#cb472-18" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> depth_maps_generation_quality)</span>
<span id="cb472-19"><a href="stats_validation.html#cb472-19" tabindex="-1"></a></span>
<span id="cb472-20"><a href="stats_validation.html#cb472-20" tabindex="-1"></a><span class="co"># separate contrast</span></span>
<span id="cb472-21"><a href="stats_validation.html#cb472-21" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb472-22"><a href="stats_validation.html#cb472-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb472-23"><a href="stats_validation.html#cb472-23" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(</span>
<span id="cb472-24"><a href="stats_validation.html#cb472-24" tabindex="-1"></a>    <span class="at">cols =</span> contrast</span>
<span id="cb472-25"><a href="stats_validation.html#cb472-25" tabindex="-1"></a>    , <span class="at">delim =</span> <span class="st">&quot; - &quot;</span></span>
<span id="cb472-26"><a href="stats_validation.html#cb472-26" tabindex="-1"></a>    , <span class="at">names =</span> <span class="fu">paste0</span>(</span>
<span id="cb472-27"><a href="stats_validation.html#cb472-27" tabindex="-1"></a>        <span class="st">&quot;sorter&quot;</span></span>
<span id="cb472-28"><a href="stats_validation.html#cb472-28" tabindex="-1"></a>        , <span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(stringr<span class="sc">::</span><span class="fu">str_count</span>(brms_contrast_temp<span class="sc">$</span>contrast, <span class="st">&quot;-&quot;</span>))<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb472-29"><a href="stats_validation.html#cb472-29" tabindex="-1"></a>      )</span>
<span id="cb472-30"><a href="stats_validation.html#cb472-30" tabindex="-1"></a>    , <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span></span>
<span id="cb472-31"><a href="stats_validation.html#cb472-31" tabindex="-1"></a>    , <span class="at">cols_remove =</span> F</span>
<span id="cb472-32"><a href="stats_validation.html#cb472-32" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb472-33"><a href="stats_validation.html#cb472-33" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sorter1<span class="sc">!=</span>sorter2) <span class="sc">%&gt;%</span> </span>
<span id="cb472-34"><a href="stats_validation.html#cb472-34" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb472-35"><a href="stats_validation.html#cb472-35" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb472-36"><a href="stats_validation.html#cb472-36" tabindex="-1"></a>      tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sorter&quot;</span>)</span>
<span id="cb472-37"><a href="stats_validation.html#cb472-37" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="cf">function</span>(x){<span class="fu">factor</span>(</span>
<span id="cb472-38"><a href="stats_validation.html#cb472-38" tabindex="-1"></a>        x, <span class="at">ordered =</span> T</span>
<span id="cb472-39"><a href="stats_validation.html#cb472-39" tabindex="-1"></a>        , <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_quality)</span>
<span id="cb472-40"><a href="stats_validation.html#cb472-40" tabindex="-1"></a>      )}</span>
<span id="cb472-41"><a href="stats_validation.html#cb472-41" tabindex="-1"></a>    )</span>
<span id="cb472-42"><a href="stats_validation.html#cb472-42" tabindex="-1"></a>    , <span class="at">contrast =</span> contrast <span class="sc">%&gt;%</span> </span>
<span id="cb472-43"><a href="stats_validation.html#cb472-43" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb472-44"><a href="stats_validation.html#cb472-44" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="fu">as.numeric</span>(sorter1), <span class="fu">as.numeric</span>(sorter2)) <span class="sc">%&gt;%</span> </span>
<span id="cb472-45"><a href="stats_validation.html#cb472-45" tabindex="-1"></a>        <span class="fu">as.numeric</span>()</span>
<span id="cb472-46"><a href="stats_validation.html#cb472-46" tabindex="-1"></a>      )</span>
<span id="cb472-47"><a href="stats_validation.html#cb472-47" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb472-48"><a href="stats_validation.html#cb472-48" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb472-49"><a href="stats_validation.html#cb472-49" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb472-50"><a href="stats_validation.html#cb472-50" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb472-51"><a href="stats_validation.html#cb472-51" tabindex="-1"></a></span>
<span id="cb472-52"><a href="stats_validation.html#cb472-52" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb472-53"><a href="stats_validation.html#cb472-53" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 400,000
## Columns: 16
## Groups: contrast [10]
## $ .chain              &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .iteration          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .draw               &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,…
## $ sorter1             &lt;ord&gt; ultra high, ultra high, ultra high, ultra high, ul…
## $ sorter2             &lt;ord&gt; high, high, high, high, high, high, high, high, hi…
## $ contrast            &lt;fct&gt; ultra high - high, ultra high - high, ultra high -…
## $ value               &lt;dbl&gt; 0.081821389, 0.010165042, -0.004214973, -0.0063328…
## $ median_hdi_est      &lt;dbl&gt; 0.01748438, 0.01748438, 0.01748438, 0.01748438, 0.…
## $ median_hdi_lower    &lt;dbl&gt; -0.1672428, -0.1672428, -0.1672428, -0.1672428, -0…
## $ median_hdi_upper    &lt;dbl&gt; 0.2111465, 0.2111465, 0.2111465, 0.2111465, 0.2111…
## $ is_gt_zero          &lt;lgl&gt; TRUE, TRUE, FALSE, FALSE, FALSE, TRUE, FALSE, FALS…
## $ pct_gt_zero         &lt;dbl&gt; 0.61515, 0.61515, 0.61515, 0.61515, 0.61515, 0.615…
## $ pct_gt_zero_lab     &lt;chr&gt; &quot;Pr(ultra high&gt;high)=62%&quot;, &quot;Pr(ultra high&gt;high)=62…
## $ pct_gt_zero_lab_sm  &lt;chr&gt; &quot;Pr(&gt;0)=62%&quot;, &quot;Pr(&gt;0)=62%&quot;, &quot;Pr(&gt;0)=62%&quot;, &quot;Pr(&gt;0)=…
## $ pct_gt_zero_lab_pos &lt;dbl&gt; 0.2269825, 0.2269825, 0.2269825, 0.2269825, 0.2269…
## $ sig_level           &lt;ord&gt; &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;8…</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="stats_validation.html#cb474-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb474-2"><a href="stats_validation.html#cb474-2" tabindex="-1"></a>  brms_contrast_temp, <span class="at">caption_text =</span> form_temp</span>
<span id="cb474-3"><a href="stats_validation.html#cb474-3" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;quality&quot;</span></span>
<span id="cb474-4"><a href="stats_validation.html#cb474-4" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-347-1.png" width="1008" /></p>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="stats_validation.html#cb475-1" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb475-2"><a href="stats_validation.html#cb475-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb475-3"><a href="stats_validation.html#cb475-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb475-4"><a href="stats_validation.html#cb475-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb475-5"><a href="stats_validation.html#cb475-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, value, .lower, .upper) <span class="sc">%&gt;%</span> </span>
<span id="cb475-6"><a href="stats_validation.html#cb475-6" tabindex="-1"></a>   </span>
<span id="cb475-7"><a href="stats_validation.html#cb475-7" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb475-8"><a href="stats_validation.html#cb475-8" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb475-9"><a href="stats_validation.html#cb475-9" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb475-10"><a href="stats_validation.html#cb475-10" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb475-11"><a href="stats_validation.html#cb475-11" tabindex="-1"></a>      <span class="st">&quot;quality contrast&quot;</span></span>
<span id="cb475-12"><a href="stats_validation.html#cb475-12" tabindex="-1"></a>      , <span class="st">&quot;difference (F-score)&quot;</span></span>
<span id="cb475-13"><a href="stats_validation.html#cb475-13" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb475-14"><a href="stats_validation.html#cb475-14" tabindex="-1"></a>    )</span>
<span id="cb475-15"><a href="stats_validation.html#cb475-15" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb475-16"><a href="stats_validation.html#cb475-16" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-348">Table 6.36: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;">
quality contrast
</th>
<th style="text-align:right;">
difference (F-score)
</th>
<th style="text-align:right;">
HDI low
</th>
<th style="text-align:right;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ultra high - high
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;">
0.21
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - medium
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.29
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - low
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.34
</td>
</tr>
<tr>
<td style="text-align:left;">
ultra high - lowest
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.47
</td>
</tr>
<tr>
<td style="text-align:left;">
high - medium
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.13
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;">
high - low
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.31
</td>
</tr>
<tr>
<td style="text-align:left;">
high - lowest
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
-0.04
</td>
<td style="text-align:right;">
0.43
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - low
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:left;">
medium - lowest
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.36
</td>
</tr>
<tr>
<td style="text-align:left;">
low - lowest
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
</tbody>
</table>
</div>
<div id="filtering---main-effect-1" class="section level4 hasAnchor" number="6.9.2.9">
<h4><span class="header-section-number">6.9.2.9</span> Filtering - main effect<a href="stats_validation.html#filtering---main-effect-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>let’s collapse across the story, dense cloud quality, software, and study site to compare the filtering mode setting effect.
In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="stats_validation.html#cb476-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb476-2"><a href="stats_validation.html#cb476-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb476-3"><a href="stats_validation.html#cb476-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb476-4"><a href="stats_validation.html#cb476-4" tabindex="-1"></a>    brms_f_mod6</span>
<span id="cb476-5"><a href="stats_validation.html#cb476-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb476-6"><a href="stats_validation.html#cb476-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode)</span>
<span id="cb476-7"><a href="stats_validation.html#cb476-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb476-8"><a href="stats_validation.html#cb476-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb476-9"><a href="stats_validation.html#cb476-9" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb476-10"><a href="stats_validation.html#cb476-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb476-11"><a href="stats_validation.html#cb476-11" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb476-12"><a href="stats_validation.html#cb476-12" tabindex="-1"></a>      <span class="at">x =</span> value, <span class="at">y =</span> depth_maps_generation_filtering_mode</span>
<span id="cb476-13"><a href="stats_validation.html#cb476-13" tabindex="-1"></a>      , <span class="at">fill =</span> depth_maps_generation_filtering_mode</span>
<span id="cb476-14"><a href="stats_validation.html#cb476-14" tabindex="-1"></a>    )</span>
<span id="cb476-15"><a href="stats_validation.html#cb476-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb476-16"><a href="stats_validation.html#cb476-16" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb476-17"><a href="stats_validation.html#cb476-17" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb476-18"><a href="stats_validation.html#cb476-18" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;gray66&quot;</span></span>
<span id="cb476-19"><a href="stats_validation.html#cb476-19" tabindex="-1"></a>      , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_color =</span> <span class="st">&quot;gray66&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb476-20"><a href="stats_validation.html#cb476-20" tabindex="-1"></a>      , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb476-21"><a href="stats_validation.html#cb476-21" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb476-22"><a href="stats_validation.html#cb476-22" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb476-23"><a href="stats_validation.html#cb476-23" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb476-24"><a href="stats_validation.html#cb476-24" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb476-25"><a href="stats_validation.html#cb476-25" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;filtering mode&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb476-26"><a href="stats_validation.html#cb476-26" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI&quot;</span></span>
<span id="cb476-27"><a href="stats_validation.html#cb476-27" tabindex="-1"></a>      , <span class="at">caption =</span> form_temp</span>
<span id="cb476-28"><a href="stats_validation.html#cb476-28" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb476-29"><a href="stats_validation.html#cb476-29" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb476-30"><a href="stats_validation.html#cb476-30" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-349-1.png" width="1008" /></p>
<p>we can also perform pairwise comparisons</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="stats_validation.html#cb477-1" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span></span>
<span id="cb477-2"><a href="stats_validation.html#cb477-2" tabindex="-1"></a>  ptcld_validation_data <span class="sc">%&gt;%</span></span>
<span id="cb477-3"><a href="stats_validation.html#cb477-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(depth_maps_generation_filtering_mode) <span class="sc">%&gt;%</span> </span>
<span id="cb477-4"><a href="stats_validation.html#cb477-4" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb477-5"><a href="stats_validation.html#cb477-5" tabindex="-1"></a>      brms_f_mod6, <span class="at">allow_new_levels =</span> T</span>
<span id="cb477-6"><a href="stats_validation.html#cb477-6" tabindex="-1"></a>      <span class="co"># this part is crucial</span></span>
<span id="cb477-7"><a href="stats_validation.html#cb477-7" tabindex="-1"></a>      , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> depth_maps_generation_filtering_mode)</span>
<span id="cb477-8"><a href="stats_validation.html#cb477-8" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb477-9"><a href="stats_validation.html#cb477-9" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb477-10"><a href="stats_validation.html#cb477-10" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb477-11"><a href="stats_validation.html#cb477-11" tabindex="-1"></a>      value</span>
<span id="cb477-12"><a href="stats_validation.html#cb477-12" tabindex="-1"></a>      , <span class="at">by =</span> depth_maps_generation_filtering_mode</span>
<span id="cb477-13"><a href="stats_validation.html#cb477-13" tabindex="-1"></a>      , <span class="at">comparison =</span> <span class="st">&quot;pairwise&quot;</span></span>
<span id="cb477-14"><a href="stats_validation.html#cb477-14" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb477-15"><a href="stats_validation.html#cb477-15" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> depth_maps_generation_filtering_mode)</span>
<span id="cb477-16"><a href="stats_validation.html#cb477-16" tabindex="-1"></a></span>
<span id="cb477-17"><a href="stats_validation.html#cb477-17" tabindex="-1"></a><span class="co"># separate contrast</span></span>
<span id="cb477-18"><a href="stats_validation.html#cb477-18" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span> brms_contrast_temp <span class="sc">%&gt;%</span> </span>
<span id="cb477-19"><a href="stats_validation.html#cb477-19" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb477-20"><a href="stats_validation.html#cb477-20" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(</span>
<span id="cb477-21"><a href="stats_validation.html#cb477-21" tabindex="-1"></a>    <span class="at">cols =</span> contrast</span>
<span id="cb477-22"><a href="stats_validation.html#cb477-22" tabindex="-1"></a>    , <span class="at">delim =</span> <span class="st">&quot; - &quot;</span></span>
<span id="cb477-23"><a href="stats_validation.html#cb477-23" tabindex="-1"></a>    , <span class="at">names =</span> <span class="fu">paste0</span>(</span>
<span id="cb477-24"><a href="stats_validation.html#cb477-24" tabindex="-1"></a>        <span class="st">&quot;sorter&quot;</span></span>
<span id="cb477-25"><a href="stats_validation.html#cb477-25" tabindex="-1"></a>        , <span class="dv">1</span><span class="sc">:</span>(<span class="fu">max</span>(stringr<span class="sc">::</span><span class="fu">str_count</span>(brms_contrast_temp<span class="sc">$</span>contrast, <span class="st">&quot;-&quot;</span>))<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb477-26"><a href="stats_validation.html#cb477-26" tabindex="-1"></a>      )</span>
<span id="cb477-27"><a href="stats_validation.html#cb477-27" tabindex="-1"></a>    , <span class="at">too_few =</span> <span class="st">&quot;align_start&quot;</span></span>
<span id="cb477-28"><a href="stats_validation.html#cb477-28" tabindex="-1"></a>    , <span class="at">cols_remove =</span> F</span>
<span id="cb477-29"><a href="stats_validation.html#cb477-29" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb477-30"><a href="stats_validation.html#cb477-30" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sorter1<span class="sc">!=</span>sorter2) <span class="sc">%&gt;%</span> </span>
<span id="cb477-31"><a href="stats_validation.html#cb477-31" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb477-32"><a href="stats_validation.html#cb477-32" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb477-33"><a href="stats_validation.html#cb477-33" tabindex="-1"></a>      tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sorter&quot;</span>)</span>
<span id="cb477-34"><a href="stats_validation.html#cb477-34" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="cf">function</span>(x){<span class="fu">factor</span>(</span>
<span id="cb477-35"><a href="stats_validation.html#cb477-35" tabindex="-1"></a>        x, <span class="at">ordered =</span> T</span>
<span id="cb477-36"><a href="stats_validation.html#cb477-36" tabindex="-1"></a>        , <span class="at">levels =</span> <span class="fu">levels</span>(ptcld_validation_data<span class="sc">$</span>depth_maps_generation_filtering_mode)</span>
<span id="cb477-37"><a href="stats_validation.html#cb477-37" tabindex="-1"></a>      )}</span>
<span id="cb477-38"><a href="stats_validation.html#cb477-38" tabindex="-1"></a>    )</span>
<span id="cb477-39"><a href="stats_validation.html#cb477-39" tabindex="-1"></a>    , <span class="at">contrast =</span> contrast <span class="sc">%&gt;%</span> </span>
<span id="cb477-40"><a href="stats_validation.html#cb477-40" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(</span>
<span id="cb477-41"><a href="stats_validation.html#cb477-41" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="fu">as.numeric</span>(sorter1), <span class="fu">as.numeric</span>(sorter2)) <span class="sc">%&gt;%</span> </span>
<span id="cb477-42"><a href="stats_validation.html#cb477-42" tabindex="-1"></a>        <span class="fu">as.numeric</span>()</span>
<span id="cb477-43"><a href="stats_validation.html#cb477-43" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb477-44"><a href="stats_validation.html#cb477-44" tabindex="-1"></a>      <span class="co"># re order for filtering mode</span></span>
<span id="cb477-45"><a href="stats_validation.html#cb477-45" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_rev</span>()</span>
<span id="cb477-46"><a href="stats_validation.html#cb477-46" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb477-47"><a href="stats_validation.html#cb477-47" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb477-48"><a href="stats_validation.html#cb477-48" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb477-49"><a href="stats_validation.html#cb477-49" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb477-50"><a href="stats_validation.html#cb477-50" tabindex="-1"></a></span>
<span id="cb477-51"><a href="stats_validation.html#cb477-51" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb477-52"><a href="stats_validation.html#cb477-52" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 240,000
## Columns: 16
## Groups: contrast [6]
## $ .chain              &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .iteration          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .draw               &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,…
## $ sorter1             &lt;ord&gt; moderate, moderate, moderate, moderate, moderate, …
## $ sorter2             &lt;ord&gt; aggressive, aggressive, aggressive, aggressive, ag…
## $ contrast            &lt;fct&gt; moderate - aggressive, moderate - aggressive, mode…
## $ value               &lt;dbl&gt; -0.0103292621, -0.0367862977, -0.0056778029, -0.00…
## $ median_hdi_est      &lt;dbl&gt; 0.0001174049, 0.0001174049, 0.0001174049, 0.000117…
## $ median_hdi_lower    &lt;dbl&gt; -0.09076018, -0.09076018, -0.09076018, -0.09076018…
## $ median_hdi_upper    &lt;dbl&gt; 0.09457266, 0.09457266, 0.09457266, 0.09457266, 0.…
## $ is_gt_zero          &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE, TR…
## $ pct_gt_zero         &lt;dbl&gt; 0.507075, 0.507075, 0.507075, 0.507075, 0.507075, …
## $ pct_gt_zero_lab     &lt;chr&gt; &quot;Pr(moderate&gt;aggressive)=51%&quot;, &quot;Pr(moderate&gt;aggres…
## $ pct_gt_zero_lab_sm  &lt;chr&gt; &quot;Pr(&gt;0)=51%&quot;, &quot;Pr(&gt;0)=51%&quot;, &quot;Pr(&gt;0)=51%&quot;, &quot;Pr(&gt;0)=…
## $ pct_gt_zero_lab_pos &lt;dbl&gt; 0.1016656, 0.1016656, 0.1016656, 0.1016656, 0.1016…
## $ sig_level           &lt;ord&gt; &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;8…</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="stats_validation.html#cb479-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb479-2"><a href="stats_validation.html#cb479-2" tabindex="-1"></a>  brms_contrast_temp, <span class="at">caption_text =</span> form_temp</span>
<span id="cb479-3"><a href="stats_validation.html#cb479-3" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;filtering mode&quot;</span></span>
<span id="cb479-4"><a href="stats_validation.html#cb479-4" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-351-1.png" width="1008" /></p>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="stats_validation.html#cb480-1" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb480-2"><a href="stats_validation.html#cb480-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb480-3"><a href="stats_validation.html#cb480-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb480-4"><a href="stats_validation.html#cb480-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb480-5"><a href="stats_validation.html#cb480-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, value, .lower, .upper) <span class="sc">%&gt;%</span> </span>
<span id="cb480-6"><a href="stats_validation.html#cb480-6" tabindex="-1"></a>   </span>
<span id="cb480-7"><a href="stats_validation.html#cb480-7" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb480-8"><a href="stats_validation.html#cb480-8" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb480-9"><a href="stats_validation.html#cb480-9" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb480-10"><a href="stats_validation.html#cb480-10" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb480-11"><a href="stats_validation.html#cb480-11" tabindex="-1"></a>      <span class="st">&quot;filtering mode contrast&quot;</span></span>
<span id="cb480-12"><a href="stats_validation.html#cb480-12" tabindex="-1"></a>      , <span class="st">&quot;difference (F-score)&quot;</span></span>
<span id="cb480-13"><a href="stats_validation.html#cb480-13" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb480-14"><a href="stats_validation.html#cb480-14" tabindex="-1"></a>    )</span>
<span id="cb480-15"><a href="stats_validation.html#cb480-15" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb480-16"><a href="stats_validation.html#cb480-16" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-352">Table 6.37: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;">
filtering mode contrast
</th>
<th style="text-align:right;">
difference (F-score)
</th>
<th style="text-align:right;">
HDI low
</th>
<th style="text-align:right;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
disabled - mild
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
0.09
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled - moderate
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
disabled - aggressive
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
<tr>
<td style="text-align:left;">
mild - moderate
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
mild - moderate
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
mild - aggressive
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.08
</td>
<td style="text-align:right;">
-0.08
</td>
</tr>
<tr>
<td style="text-align:left;">
mild - aggressive
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
mild - aggressive
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
<tr>
<td style="text-align:left;">
moderate - aggressive
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.09
</td>
<td style="text-align:right;">
0.09
</td>
</tr>
<tr>
<td style="text-align:left;">
moderate - aggressive
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.10
</td>
</tr>
</tbody>
</table>
</div>
<div id="software---main-effect-1" class="section level4 hasAnchor" number="6.9.2.10">
<h4><span class="header-section-number">6.9.2.10</span> Software - main effect<a href="stats_validation.html#software---main-effect-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>to address one of our main questions, let’s also collapse across the story, study site, dense cloud quality, and filtering mode setting to compare the software effect.
In a hierarchical model structure, we have to make use of the <code>re_formula</code> argument within <code>tidybayes::add_epred_draws</code></p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="stats_validation.html#cb481-1" tabindex="-1"></a>ptcld_validation_data <span class="sc">%&gt;%</span> </span>
<span id="cb481-2"><a href="stats_validation.html#cb481-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(software) <span class="sc">%&gt;%</span> </span>
<span id="cb481-3"><a href="stats_validation.html#cb481-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb481-4"><a href="stats_validation.html#cb481-4" tabindex="-1"></a>    brms_f_mod6</span>
<span id="cb481-5"><a href="stats_validation.html#cb481-5" tabindex="-1"></a>    <span class="co"># this part is crucial</span></span>
<span id="cb481-6"><a href="stats_validation.html#cb481-6" tabindex="-1"></a>    , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> software)</span>
<span id="cb481-7"><a href="stats_validation.html#cb481-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb481-8"><a href="stats_validation.html#cb481-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb481-9"><a href="stats_validation.html#cb481-9" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb481-10"><a href="stats_validation.html#cb481-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb481-11"><a href="stats_validation.html#cb481-11" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb481-12"><a href="stats_validation.html#cb481-12" tabindex="-1"></a>      <span class="at">x =</span> value, <span class="at">y =</span> software</span>
<span id="cb481-13"><a href="stats_validation.html#cb481-13" tabindex="-1"></a>      , <span class="at">fill =</span> software</span>
<span id="cb481-14"><a href="stats_validation.html#cb481-14" tabindex="-1"></a>    )</span>
<span id="cb481-15"><a href="stats_validation.html#cb481-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb481-16"><a href="stats_validation.html#cb481-16" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb481-17"><a href="stats_validation.html#cb481-17" tabindex="-1"></a>      <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb481-18"><a href="stats_validation.html#cb481-18" tabindex="-1"></a>      , <span class="at">interval_color =</span> <span class="st">&quot;gray66&quot;</span></span>
<span id="cb481-19"><a href="stats_validation.html#cb481-19" tabindex="-1"></a>      , <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">point_color =</span> <span class="st">&quot;gray66&quot;</span>, <span class="at">point_fill =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb481-20"><a href="stats_validation.html#cb481-20" tabindex="-1"></a>      , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.01</span></span>
<span id="cb481-21"><a href="stats_validation.html#cb481-21" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb481-22"><a href="stats_validation.html#cb481-22" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;rocket&quot;</span>, <span class="at">begin =</span> <span class="fl">0.3</span>, <span class="at">end =</span> <span class="fl">0.9</span>, <span class="at">drop =</span> F) <span class="sc">+</span></span>
<span id="cb481-23"><a href="stats_validation.html#cb481-23" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">n=</span><span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb481-24"><a href="stats_validation.html#cb481-24" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb481-25"><a href="stats_validation.html#cb481-25" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;software&quot;</span>, <span class="at">x =</span> <span class="st">&quot;F-score&quot;</span></span>
<span id="cb481-26"><a href="stats_validation.html#cb481-26" tabindex="-1"></a>      , <span class="at">subtitle =</span> <span class="st">&quot;posterior predictive distribution of F-score with 95% HDI&quot;</span></span>
<span id="cb481-27"><a href="stats_validation.html#cb481-27" tabindex="-1"></a>      , <span class="at">caption =</span> form_temp</span>
<span id="cb481-28"><a href="stats_validation.html#cb481-28" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb481-29"><a href="stats_validation.html#cb481-29" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb481-30"><a href="stats_validation.html#cb481-30" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-353-1.png" width="1008" /></p>
<p>we can also perform pairwise comparisons</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="stats_validation.html#cb482-1" tabindex="-1"></a>brms_contrast_temp <span class="ot">=</span></span>
<span id="cb482-2"><a href="stats_validation.html#cb482-2" tabindex="-1"></a>  ptcld_validation_data <span class="sc">%&gt;%</span></span>
<span id="cb482-3"><a href="stats_validation.html#cb482-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(software) <span class="sc">%&gt;%</span> </span>
<span id="cb482-4"><a href="stats_validation.html#cb482-4" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(</span>
<span id="cb482-5"><a href="stats_validation.html#cb482-5" tabindex="-1"></a>      brms_f_mod6, <span class="at">allow_new_levels =</span> T</span>
<span id="cb482-6"><a href="stats_validation.html#cb482-6" tabindex="-1"></a>      <span class="co"># this part is crucial</span></span>
<span id="cb482-7"><a href="stats_validation.html#cb482-7" tabindex="-1"></a>      , <span class="at">re_formula =</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> software)</span>
<span id="cb482-8"><a href="stats_validation.html#cb482-8" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb482-9"><a href="stats_validation.html#cb482-9" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">value =</span> .epred) <span class="sc">%&gt;%</span> </span>
<span id="cb482-10"><a href="stats_validation.html#cb482-10" tabindex="-1"></a>    tidybayes<span class="sc">::</span><span class="fu">compare_levels</span>(</span>
<span id="cb482-11"><a href="stats_validation.html#cb482-11" tabindex="-1"></a>      value</span>
<span id="cb482-12"><a href="stats_validation.html#cb482-12" tabindex="-1"></a>      , <span class="at">by =</span> software</span>
<span id="cb482-13"><a href="stats_validation.html#cb482-13" tabindex="-1"></a>      , <span class="at">comparison =</span> <span class="st">&quot;pairwise&quot;</span></span>
<span id="cb482-14"><a href="stats_validation.html#cb482-14" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb482-15"><a href="stats_validation.html#cb482-15" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">contrast =</span> software) <span class="sc">%&gt;%</span> </span>
<span id="cb482-16"><a href="stats_validation.html#cb482-16" tabindex="-1"></a>  <span class="co"># median_hdi summary for coloring </span></span>
<span id="cb482-17"><a href="stats_validation.html#cb482-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast) <span class="sc">%&gt;%</span></span>
<span id="cb482-18"><a href="stats_validation.html#cb482-18" tabindex="-1"></a>  <span class="fu">make_contrast_vars</span>()</span>
<span id="cb482-19"><a href="stats_validation.html#cb482-19" tabindex="-1"></a></span>
<span id="cb482-20"><a href="stats_validation.html#cb482-20" tabindex="-1"></a><span class="co"># what?</span></span>
<span id="cb482-21"><a href="stats_validation.html#cb482-21" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 120,000
## Columns: 14
## Groups: contrast [3]
## $ .chain              &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .iteration          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .draw               &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,…
## $ contrast            &lt;chr&gt; &quot;OPENDRONEMAP - METASHAPE&quot;, &quot;OPENDRONEMAP - METASH…
## $ value               &lt;dbl&gt; -9.337236e-02, 4.289334e-02, -5.244894e-02, -5.874…
## $ median_hdi_est      &lt;dbl&gt; -0.01532781, -0.01532781, -0.01532781, -0.01532781…
## $ median_hdi_lower    &lt;dbl&gt; -0.2559431, -0.2559431, -0.2559431, -0.2559431, -0…
## $ median_hdi_upper    &lt;dbl&gt; 0.1696568, 0.1696568, 0.1696568, 0.1696568, 0.1696…
## $ is_gt_zero          &lt;lgl&gt; TRUE, FALSE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, F…
## $ pct_gt_zero         &lt;dbl&gt; 0.6325, 0.6325, 0.6325, 0.6325, 0.6325, 0.6325, 0.…
## $ pct_gt_zero_lab     &lt;chr&gt; &quot;Pr(MtaShp&gt;ODM)=63%&quot;, &quot;Pr(MtaShp&gt;ODM)=63%&quot;, &quot;Pr(Mt…
## $ pct_gt_zero_lab_sm  &lt;chr&gt; &quot;Pr(&lt;0)=63%&quot;, &quot;Pr(&lt;0)=63%&quot;, &quot;Pr(&lt;0)=63%&quot;, &quot;Pr(&lt;0)=…
## $ pct_gt_zero_lab_pos &lt;dbl&gt; -0.2751388, -0.2751388, -0.2751388, -0.2751388, -0…
## $ sig_level           &lt;ord&gt; &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;80%, &lt;8…</code></pre>
<p>plot it</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="stats_validation.html#cb484-1" tabindex="-1"></a><span class="fu">plt_contrast</span>(</span>
<span id="cb484-2"><a href="stats_validation.html#cb484-2" tabindex="-1"></a>  brms_contrast_temp, <span class="at">caption_text =</span> form_temp</span>
<span id="cb484-3"><a href="stats_validation.html#cb484-3" tabindex="-1"></a>  , <span class="at">y_axis_title =</span> <span class="st">&quot;software&quot;</span></span>
<span id="cb484-4"><a href="stats_validation.html#cb484-4" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-355-1.png" width="1008" /></p>
<p>and summarize these contrasts</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="stats_validation.html#cb485-1" tabindex="-1"></a>brms_contrast_temp <span class="sc">%&gt;%</span></span>
<span id="cb485-2"><a href="stats_validation.html#cb485-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb485-3"><a href="stats_validation.html#cb485-3" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_hdi</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb485-4"><a href="stats_validation.html#cb485-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb485-5"><a href="stats_validation.html#cb485-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(contrast, value, .lower, .upper) <span class="sc">%&gt;%</span> </span>
<span id="cb485-6"><a href="stats_validation.html#cb485-6" tabindex="-1"></a>   </span>
<span id="cb485-7"><a href="stats_validation.html#cb485-7" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb485-8"><a href="stats_validation.html#cb485-8" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb485-9"><a href="stats_validation.html#cb485-9" tabindex="-1"></a>    , <span class="at">caption =</span> <span class="st">&quot;brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts&quot;</span></span>
<span id="cb485-10"><a href="stats_validation.html#cb485-10" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb485-11"><a href="stats_validation.html#cb485-11" tabindex="-1"></a>      <span class="st">&quot;software contrast&quot;</span></span>
<span id="cb485-12"><a href="stats_validation.html#cb485-12" tabindex="-1"></a>      , <span class="st">&quot;difference (F-score)&quot;</span></span>
<span id="cb485-13"><a href="stats_validation.html#cb485-13" tabindex="-1"></a>      , <span class="st">&quot;HDI low&quot;</span>, <span class="st">&quot;HDI high&quot;</span></span>
<span id="cb485-14"><a href="stats_validation.html#cb485-14" tabindex="-1"></a>    )</span>
<span id="cb485-15"><a href="stats_validation.html#cb485-15" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb485-16"><a href="stats_validation.html#cb485-16" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-356">Table 6.38: </span>brms::brm model: 95% HDI of the posterior predictive distribution of group constrasts
</caption>
<thead>
<tr>
<th style="text-align:left;">
software contrast
</th>
<th style="text-align:right;">
difference (F-score)
</th>
<th style="text-align:right;">
HDI low
</th>
<th style="text-align:right;">
HDI high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
OPENDRONEMAP - METASHAPE
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
-0.26
</td>
<td style="text-align:right;">
0.17
</td>
</tr>
<tr>
<td style="text-align:left;">
OPENDRONEMAP - METASHAPE
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.18
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - METASHAPE
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.20
</td>
<td style="text-align:right;">
-0.19
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - METASHAPE
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.18
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - METASHAPE
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
0.26
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - OPENDRONEMAP
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.15
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
<tr>
<td style="text-align:left;">
PIX4D - OPENDRONEMAP
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
0.31
</td>
</tr>
</tbody>
</table>
</div>
<div id="sigma-posteriors-1" class="section level4 hasAnchor" number="6.9.2.11">
<h4><span class="header-section-number">6.9.2.11</span> <span class="math inline">\(\sigma\)</span> posteriors<a href="stats_validation.html#sigma-posteriors-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Finally, we can quantify the variation in F-score by comparing the <span class="math inline">\(\sigma\)</span> (<code>sd</code>) posteriors</p>
<p><em>unsure about the scale of the <span class="math inline">\(\sigma\)</span> parameters are on in the beta model. Here, we invert the logit <code>sd</code> values from the model using <code>plogis()</code> which converts the parameter values to a probability/proportion (e.g.; 0-1) because they are parameters of the intercept and interaction effects so must be on the transformed (<code>link = "logit"</code>) scale…double check</em></p>
<p>For a phenomenally excellent overview of binary logistic regression and how to interpret coefficients, see Steven Miller’s most excellent lab <a href="https://post8000.svmiller.com/lab-scripts/logistic-regression-lab.html">script here</a></p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="stats_validation.html#cb486-1" tabindex="-1"></a><span class="co"># tidybayes::get_variables(brms_f_mod6)</span></span>
<span id="cb486-2"><a href="stats_validation.html#cb486-2" tabindex="-1"></a><span class="co"># extract the posterior draws</span></span>
<span id="cb486-3"><a href="stats_validation.html#cb486-3" tabindex="-1"></a>brms<span class="sc">::</span><span class="fu">as_draws_df</span>(brms_f_mod6) <span class="sc">%&gt;%</span> </span>
<span id="cb486-4"><a href="stats_validation.html#cb486-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;sd_&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb486-5"><a href="stats_validation.html#cb486-5" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(dplyr<span class="sc">::</span><span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb486-6"><a href="stats_validation.html#cb486-6" tabindex="-1"></a>  <span class="co"># dplyr::group_by(name) %&gt;% </span></span>
<span id="cb486-7"><a href="stats_validation.html#cb486-7" tabindex="-1"></a>  <span class="co"># tidybayes::median_hdi(value) %&gt;% </span></span>
<span id="cb486-8"><a href="stats_validation.html#cb486-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb486-9"><a href="stats_validation.html#cb486-9" tabindex="-1"></a>    <span class="at">name =</span> name <span class="sc">%&gt;%</span> </span>
<span id="cb486-10"><a href="stats_validation.html#cb486-10" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_quality&quot;</span>, <span class="st">&quot;quality&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb486-11"><a href="stats_validation.html#cb486-11" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">&quot;depth_maps_generation_filtering_mode&quot;</span>, <span class="st">&quot;filtering&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb486-12"><a href="stats_validation.html#cb486-12" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_reorder</span>(value)</span>
<span id="cb486-13"><a href="stats_validation.html#cb486-13" tabindex="-1"></a>    , <span class="at">value =</span> <span class="fu">plogis</span>(value)</span>
<span id="cb486-14"><a href="stats_validation.html#cb486-14" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb486-15"><a href="stats_validation.html#cb486-15" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb486-16"><a href="stats_validation.html#cb486-16" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> name)) <span class="sc">+</span></span>
<span id="cb486-17"><a href="stats_validation.html#cb486-17" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">stat_dotsinterval</span>(</span>
<span id="cb486-18"><a href="stats_validation.html#cb486-18" tabindex="-1"></a>    <span class="at">point_interval =</span> median_hdi, <span class="at">.width =</span> .<span class="dv">95</span></span>
<span id="cb486-19"><a href="stats_validation.html#cb486-19" tabindex="-1"></a>    , <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.04</span></span>
<span id="cb486-20"><a href="stats_validation.html#cb486-20" tabindex="-1"></a>    , <span class="at">shape =</span> <span class="dv">21</span> <span class="co">#, point_size = 3</span></span>
<span id="cb486-21"><a href="stats_validation.html#cb486-21" tabindex="-1"></a>    , <span class="at">quantiles =</span> <span class="dv">100</span></span>
<span id="cb486-22"><a href="stats_validation.html#cb486-22" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb486-23"><a href="stats_validation.html#cb486-23" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">caption =</span> form_temp) <span class="sc">+</span></span>
<span id="cb486-24"><a href="stats_validation.html#cb486-24" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="metashape_testing_files/figure-html/unnamed-chunk-357-1.png" width="1008" /></p>
<p>Determining overstory or understory seems to have the strongest effect on our ability to accurately detect trees but this effect is highly uncertain. Variance of study site is stronger than variance of depth map generation quality, but the posterior predictive distributions overlap a good deal. The study site (the “subjects” in our study) seems to have the overall strongest effect, but this comes with high uncertainty. Taken alone, the influence of quality, filtering, and software comes with huge uncertainty. This makes sense as the influence of software largely depends on the depth map generation quality, of which we are fairly certain. Filtering mode has the overall weakest effect on tree detection and this comes with relatively high certainty, especially conditional on the depth map generation quality.</p>
<p>and perform model selection via the <a href="https://stat.columbia.edu/~gelman/research/published/bayes_R2_v3.pdf">R-squared for Bayesian</a> regression models using <code>brms::bayes_R2()</code> since we can’t compare models with different number of observations using information criteria (we could also use the p-value approach as done above)</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="stats_validation.html#cb487-1" tabindex="-1"></a>brms_f_mod6 <span class="ot">=</span> brms<span class="sc">::</span><span class="fu">add_criterion</span>(brms_f_mod6, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</span>
<span id="cb487-2"><a href="stats_validation.html#cb487-2" tabindex="-1"></a><span class="co"># r-squared</span></span>
<span id="cb487-3"><a href="stats_validation.html#cb487-3" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb487-4"><a href="stats_validation.html#cb487-4" tabindex="-1"></a>  brms<span class="sc">::</span><span class="fu">bayes_R2</span>(brms_f_mod6) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;brms_f_mod6&quot;</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">relocate</span>(model)</span>
<span id="cb487-5"><a href="stats_validation.html#cb487-5" tabindex="-1"></a>  , brms<span class="sc">::</span><span class="fu">bayes_R2</span>(brms_f_mod5) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;brms_f_mod5&quot;</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">relocate</span>(model)</span>
<span id="cb487-6"><a href="stats_validation.html#cb487-6" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb487-7"><a href="stats_validation.html#cb487-7" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">rename_with</span>(tolower) <span class="sc">%&gt;%</span> </span>
<span id="cb487-8"><a href="stats_validation.html#cb487-8" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(estimate)) <span class="sc">%&gt;%</span> </span>
<span id="cb487-9"><a href="stats_validation.html#cb487-9" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">R2.estimate =</span> estimate)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 5
##   model       R2.estimate est.error  q2.5 q97.5
##   &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 brms_f_mod5       0.665    0.0247 0.611 0.708
## 2 brms_f_mod6       0.573    0.0204 0.530 0.610</code></pre>
<p>Our model without the effects of overstory/understory is a better parsimonious fit of the data in this case…let’s roll with <code>brms_f_mod5</code> <a href="stats_validation.html#f_5_pred_mod_bays">model</a> for the research article even though our model including overstory/understory has less dispersion (see our <span class="math inline">\(\phi\)</span> <a href="stats_validation.html#f_6_pred_mod_bays">posterior</a>)</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="field_valid.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="stats_detected.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
